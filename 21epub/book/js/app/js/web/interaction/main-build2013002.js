/*! jQuery v@1.8.1 jquery.com | jquery.org/license */

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org

/**
* Bootstrap.js by @fat & @mdo
* plugins: bootstrap-transition.js, bootstrap-modal.js, bootstrap-dropdown.js, bootstrap-scrollspy.js, bootstrap-tab.js, bootstrap-tooltip.js, bootstrap-popover.js, bootstrap-affix.js, bootstrap-alert.js, bootstrap-button.js, bootstrap-collapse.js, bootstrap-carousel.js, bootstrap-typeahead.js
* Copyright 2012 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/

/**
 * @license RequireJS text 2.0.5+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * VERSION: beta 1.9.1
 * DATE: 2013-03-19
 * JavaScript (ActionScript 3 and 2 also available)
 * UPDATES AND DOCS AT: http://www.greensock.com
 * 
 * Includes all of the following: TweenLite, TweenMax, TimelineLite, TimelineMax, easing.EasePack, plugins.CSSPlugin, plugins.RoundPropsPlugin, plugins.BezierPlugin
 *
 * @license Copyright (c) 2008-2013, GreenSock. All rights reserved.
 * This work is subject to the terms in http://www.greensock.com/terms_of_use.html or for 
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 **/

/*!
Video.js - HTML5 Video Player
Version 3.2.0

LGPL v3 LICENSE INFO
This file is part of Video.js. Copyright 2011 Zencoder, Inc.

Video.js is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Video.js is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with Video.js.  If not, see <http://www.gnu.org/licenses/>.
*/

// ----------------------------------------------------------------------------
// Buzz, a Javascript HTML5 Audio library
// v 1.0.6
// Licensed under the MIT license.
// http://buzz.jaysalvat.com/
// ----------------------------------------------------------------------------
// Copyright (C) 2013 Jay Salvat
// http://jaysalvat.com/
// ----------------------------------------------------------------------------
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files ( the "Software" ), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
// ----------------------------------------------------------------------------

/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/

/*!
 * reveal.js
 * http://lab.hakim.se/reveal-js
 * MIT licensed
 *
 * Copyright (C) 2013 Hakim El Hattab, http://hakim.se
 */

/*! jQuery UI - v1.10.0 - 2013-01-17
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */

/**
 * http://github.com/valums/file-uploader
 * 
 * Multiple file upload component with progress-bar, drag-and-drop. 
 * © 2010 Andrew Valums andrew(at)valums.com 
 * 
 * Licensed under GNU GPL 2 or later, see license.txt.
 *  
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>. 
 */

/*
Uploadify v2.1.0
Release Date: August 24, 2009

Copyright (c) 2009 Ronnie Garcia, Travis Nickels

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

/*	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/

function jqwait_simple(e){if(!jqwait_on){if(!e)var e={};e.modal||(e.modal=!1),preventhandle(),jqwait_create_fancybox(e.modal),jqwait_on=!0}}function jqwait_simple_close(e){jqwait_on&&(jqwait_close_fancybox(),releasepreventhandle(),jqwait_on=!1)}function jqwait(e){if(jqwait_available){if(!e)var e={};e.modal||(e.modal=!1),jqwait_available=!1,preventhandle(),jqwait_args=e,jqwait_create_fancybox(e.modal),e.start&&e.start(),jqwaitid=setInterval(jqwait_check,500)}}function jqwait_check(){var e=[];for(derective in derectives){if(_.include(derectivechecklist,derectives[derective]))continue;e.push(derectives[derective])}derectives=e,_.isEmpty(derectives)&&(jqwait_close(),jqwait_args.end())}function jqwait_create_fancybox(e){$("body").append(loading=$('<div id="fancybox-loading" style="display:none;"><div></div></div>'),overlay=$('<div id="fancybox-overlay" class="mask modal"></div>')),e&&overlay.addClass("ui-widget-overlay"),clearInterval(loadingTimer),overlay.show(),loading.show(),loadingTimer=setInterval(_animate_loading,66)}function jqwait_close_fancybox(e){loading.hide(),overlay.hide(),loadingFrame=1,clearInterval(loadingTimer),loading.remove(),overlay.remove()}function jqwait_createpopup(e){if(!e||!e.width)e.width=32;if(!e||!e.height)e.height=50;if(!e||!e.waitname)e.waitname="jqwait";if(!e||!e.modal)e.modal=!1;$("body").children("div#jqwait").remove(),$("body").append('<div id="jqwait" style="width:32px;"></div>'),$("body").children("div#jqwait").dialog({autoOpen:!0,height:e.height,width:e.width,modal:e.modal,create:function(e,t){},close:function(e,t){},dialogClass:e.waitname,draggable:!1,resizable:!1})}function jqwait_closepopup(){$("div#jqwait").dialog("close"),$("div#jqwait").dialog("destroy"),$("div#jqwait").remove()}function jqwait_close(){clearInterval(jqwaitid),jqwait_close_fancybox(),releasepreventhandle(),jqwait_available=!0}function preventhandle(){$(document).bind("keypress",function(e,t){e.preventDefault()}),$(document).bind("mousedown",function(e,t){e.preventDefault()})}function releasepreventhandle(){$(document).unbind("keypress"),$(document).unbind("mousedown")}function set_click_event(e,t){$(e).live("click",t)}function cancel_click_event(e,t){t?$(e).die("click",t):$(e).die("click")}function set_hover_event(e,t,n){$(e).live("mouseover mouseout",function(e){e.type=="mouseover"?t(e):n(e)})}function cancel_hover_event(e){$(e).die("mouseover mouseout")}(function(e,t){function n(e){var t=dt[e]={};return Y.each(e.split(tt),function(e,n){t[n]=!0}),t}function r(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(mt,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:vt.test(r)?Y.parseJSON(r):r}catch(s){}Y.data(e,n,r)}else r=t}return r}function i(e){var t;for(t in e){if(t==="data"&&Y.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function s(){return!1}function o(){return!0}function u(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function a(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function f(e,t,n){t=t||0;if(Y.isFunction(t))return Y.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return Y.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=Y.grep(e,function(e){return e.nodeType===1});if(Bt.test(t))return Y.filter(t,r,!n);t=Y.filter(t,r)}return Y.grep(e,function(e,r){return Y.inArray(e,t)>=0===n})}function l(e){var t=It.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function c(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function h(e,t){if(t.nodeType!==1||!Y.hasData(e))return;var n,r,i,s=Y._data(e),o=Y._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)Y.event.add(t,n,u[n][r])}o.data&&(o.data=Y.extend({},o.data))}function p(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),Y.support.html5Clone&&e.innerHTML&&!Y.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Kt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(Y.expando)}function d(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function v(e){Kt.test(e.type)&&(e.defaultChecked=e.checked)}function m(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=yn.length;while(i--){t=yn[i]+n;if(t in e)return t}return r}function g(e,t){return e=t||e,Y.css(e,"display")==="none"||!Y.contains(e.ownerDocument,e)}function y(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=Y._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&g(n)&&(i[s]=Y._data(n,"olddisplay",S(n.nodeName)))):(r=nn(n,"display"),!i[s]&&r!=="none"&&Y._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function b(e,t,n){var r=cn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function w(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=Y.css(e,n+gn[i],!0)),r?(n==="content"&&(s-=parseFloat(nn(e,"padding"+gn[i]))||0),n!=="margin"&&(s-=parseFloat(nn(e,"border"+gn[i]+"Width"))||0)):(s+=parseFloat(nn(e,"padding"+gn[i]))||0,n!=="padding"&&(s+=parseFloat(nn(e,"border"+gn[i]+"Width"))||0));return s}function E(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=Y.support.boxSizing&&Y.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=nn(e,t);if(r<0||r==null)r=e.style[t];if(hn.test(r))return r;i=s&&(Y.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+w(e,t,n||(s?"border":"content"),i)+"px"}function S(e){if(dn[e])return dn[e];var t=Y("<"+e+">").appendTo(R.body),n=t.css("display");t.remove();if(n==="none"||n===""){rn=R.body.appendChild(rn||Y.extend(R.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!sn||!rn.createElement)sn=(rn.contentWindow||rn.contentDocument).document,sn.write("<!doctype html><html><body>"),sn.close();t=sn.body.appendChild(sn.createElement(e)),n=nn(t,"display"),R.body.removeChild(rn)}return dn[e]=n,n}function x(e,t,n,r){var i;if(Y.isArray(t))Y.each(t,function(t,i){n||En.test(e)?r(e,i):x(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&Y.type(t)==="object")for(i in t)x(e+"["+i+"]",t[i],n,r);else r(e,t)}function T(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(tt),u=0,a=o.length;if(Y.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function N(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===jn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=N(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=N(e,n,r,i,"*",o)),u}function C(e,n){var r,i,s=Y.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&Y.extend(!0,e,i)}function k(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function L(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function A(){try{return new e.XMLHttpRequest}catch(t){}}function O(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function M(){return setTimeout(function(){Jn=t},0),Jn=Y.now()}function _(e,t){Y.each(t,function(t,n){var r=(er[t]||[]).concat(er["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function D(e,t,n){var r,i=0,s=0,o=Zn.length,u=Y.Deferred().always(function(){delete a.elem}),a=function(){var t=Jn||M(),n=Math.max(0,f.startTime+f.duration-t),r=1-(n/f.duration||0),i=0,s=f.tweens.length;for(;i<s;i++)f.tweens[i].run(r);return u.notifyWith(e,[f,r,n]),r<1&&s?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:Y.extend({},t),opts:Y.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Jn||M(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=Y.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;P(l,f.opts.specialEasing);for(;i<o;i++){r=Zn[i].call(f,e,l,f.opts);if(r)return r}return _(f,l),Y.isFunction(f.opts.start)&&f.opts.start.call(e,f),Y.fx.timer(Y.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function P(e,t){var n,r,i,s,o;for(n in e){r=Y.camelCase(n),i=t[r],s=e[n],Y.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=Y.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function H(e,t,n){var r,i,s,o,u,a,f,l,c=this,h=e.style,p={},d=[],v=e.nodeType&&g(e);n.queue||(f=Y._queueHooks(e,"fx"),f.unqueued==null&&(f.unqueued=0,l=f.empty.fire,f.empty.fire=function(){f.unqueued||l()}),f.unqueued++,c.always(function(){c.always(function(){f.unqueued--,Y.queue(e,"fx").length||f.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],Y.css(e,"display")==="inline"&&Y.css(e,"float")==="none"&&(!Y.support.inlineBlockNeedsLayout||S(e.nodeName)==="inline"?h.display="inline-block":h.zoom=1)),n.overflow&&(h.overflow="hidden",Y.support.shrinkWrapBlocks||c.done(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Qn.exec(s)){delete t[r];if(s===(v?"hide":"show"))continue;d.push(r)}}o=d.length;if(o){u=Y._data(e,"fxshow")||Y._data(e,"fxshow",{}),v?Y(e).show():c.done(function(){Y(e).hide()}),c.done(function(){var t;Y.removeData(e,"fxshow",!0);for(t in p)Y.style(e,t,p[t])});for(r=0;r<o;r++)i=d[r],a=c.createTween(i,v?u[i]:0),p[i]=u[i]||Y.style(e,i),i in u||(u[i]=a.start,v&&(a.end=a.start,a.start=i==="width"||i==="height"?1:0))}}function B(e,t,n,r,i){return new B.prototype.init(e,t,n,r,i)}function j(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=gn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function F(e){return Y.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var I,q,R=e.document,U=e.location,z=e.navigator,W=e.jQuery,X=e.$,V=Array.prototype.push,$=Array.prototype.slice,J=Array.prototype.indexOf,K=Object.prototype.toString,Q=Object.prototype.hasOwnProperty,G=String.prototype.trim,Y=function(e,t){return new Y.fn.init(e,t,I)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,it=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,st=/^[\],:{}\s]*$/,ot=/(?:^|:|,)(?:\s*\[)+/g,ut=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,at=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ft=/^-ms-/,lt=/-([\da-z])/gi,ct=function(e,t){return(t+"").toUpperCase()},ht=function(){R.addEventListener?(R.removeEventListener("DOMContentLoaded",ht,!1),Y.ready()):R.readyState==="complete"&&(R.detachEvent("onreadystatechange",ht),Y.ready())},pt={};Y.fn=Y.prototype={constructor:Y,init:function(e,n,r){var i,s,o,u;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?i=[null,e,null]:i=rt.exec(e);if(i&&(i[1]||!n)){if(i[1])return n=n instanceof Y?n[0]:n,u=n&&n.nodeType?n.ownerDocument||n:R,e=Y.parseHTML(i[1],u,!0),it.test(i[1])&&Y.isPlainObject(n)&&this.attr.call(e,n,!0),Y.merge(this,e);s=R.getElementById(i[2]);if(s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=R,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return Y.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),Y.makeArray(e,this))},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return $.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=Y.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return Y.each(this,e,t)},ready:function(e){return Y.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack($.apply(this,arguments),"slice",$.call(arguments).join(","))},map:function(e){return this.pushStack(Y.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:[].sort,splice:[].splice},Y.fn.init.prototype=Y.fn,Y.extend=Y.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!Y.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(Y.isPlainObject(i)||(s=Y.isArray(i)))?(s?(s=!1,o=r&&Y.isArray(r)?r:[]):o=r&&Y.isPlainObject(r)?r:{},u[n]=Y.extend(l,o,i)):i!==t&&(u[n]=i)}return u},Y.extend({noConflict:function(t){return e.$===Y&&(e.$=X),t&&e.jQuery===Y&&(e.jQuery=W),Y},isReady:!1,readyWait:1,holdReady:function(e){e?Y.readyWait++:Y.ready(!0)},ready:function(e){if(e===!0?--Y.readyWait:Y.isReady)return;if(!R.body)return setTimeout(Y.ready,1);Y.isReady=!0;if(e!==!0&&--Y.readyWait>0)return;q.resolveWith(R,[Y]),Y.fn.trigger&&Y(R).trigger("ready").off("ready")},isFunction:function(e){return Y.type(e)==="function"},isArray:Array.isArray||function(e){return Y.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):pt[K.call(e)]||"object"},isPlainObject:function(e){if(!e||Y.type(e)!=="object"||e.nodeType||Y.isWindow(e))return!1;try{if(e.constructor&&!Q.call(e,"constructor")&&!Q.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||Q.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||R,(r=it.exec(e))?[t.createElement(r[1])]:(r=Y.buildFragment([e],t,n?null:[]),Y.merge([],(r.cacheable?Y.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=Y.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(st.test(t.replace(ut,"@").replace(at,"]").replace(ot,"")))return(new Function("return "+t))();Y.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&Y.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ft,"ms-").replace(lt,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||Y.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:G&&!G.call("﻿ ")?function(e){return e==null?"":G.call(e)}:function(e){return e==null?"":e.toString().replace(nt,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=Y.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||Y.isWindow(e)?V.call(r,e):Y.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(J)return J.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof Y||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||Y.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),Y.isFunction(e)?(i=$.call(arguments,2),s=function(){return e.apply(n,i.concat($.call(arguments)))},s.guid=e.guid=e.guid||s.guid||Y.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)Y.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&Y.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(Y(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),Y.ready.promise=function(t){if(!q){q=Y.Deferred();if(R.readyState==="complete")setTimeout(Y.ready,1);else if(R.addEventListener)R.addEventListener("DOMContentLoaded",ht,!1),e.addEventListener("load",Y.ready,!1);else{R.attachEvent("onreadystatechange",ht),e.attachEvent("onload",Y.ready);var n=!1;try{n=e.frameElement==null&&R.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!Y.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}Y.ready()}}()}}return q.promise(t)},Y.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pt["[object "+t+"]"]=t.toLowerCase()}),I=Y(R);var dt={};Y.Callbacks=function(e){e=typeof e=="string"?dt[e]||n(e):Y.extend({},e);var r,i,s,o,u,a,f=[],l=!e.once&&[],c=function(t){r=e.memory&&t,i=!0,a=o||0,o=0,u=f.length,s=!0;for(;f&&a<u;a++)if(f[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}s=!1,f&&(l?l.length&&c(l.shift()):r?f=[]:h.disable())},h={add:function(){if(f){var t=f.length;(function n(t){Y.each(t,function(t,r){var i=Y.type(r);i==="function"&&(!e.unique||!h.has(r))?f.push(r):r&&r.length&&i!=="string"&&n(r)})})(arguments),s?u=f.length:r&&(o=t,c(r))}return this},remove:function(){return f&&Y.each(arguments,function(e,t){var n;while((n=Y.inArray(t,f,n))>-1)f.splice(n,1),s&&(n<=u&&u--,n<=a&&a--)}),this},has:function(e){return Y.inArray(e,f)>-1},empty:function(){return f=[],this},disable:function(){return f=l=r=t,this},disabled:function(){return!f},lock:function(){return l=t,r||h.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],f&&(!i||l)&&(s?l.push(t):c(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!i}};return h},Y.extend({Deferred:function(e){var t=[["resolve","done",Y.Callbacks("once memory"),"resolved"],["reject","fail",Y.Callbacks("once memory"),"rejected"],["notify","progress",Y.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Y.Deferred(function(n){Y.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](Y.isFunction(o)?function(){var e=o.apply(this,arguments);e&&Y.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return typeof e=="object"?Y.extend(e,r):r}},i={};return r.pipe=r.then,Y.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=$.call(arguments),r=n.length,i=r!==1||e&&Y.isFunction(e.promise)?r:0,s=i===1?e:Y.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?$.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&Y.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),Y.support=function(){var t,n,r,i,s,o,u,a,f,l,c,h=R.createElement("div");h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=h.getElementsByTagName("*"),r=h.getElementsByTagName("a")[0],r.style.cssText="top:1px;float:left;opacity:.5";if(!n||!n.length||!r)return{};i=R.createElement("select"),s=i.appendChild(R.createElement("option")),o=h.getElementsByTagName("input")[0],t={leadingWhitespace:h.firstChild.nodeType===3,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:o.value==="on",optSelected:s.selected,getSetAttribute:h.className!=="t",enctype:!!R.createElement("form").enctype,html5Clone:R.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:R.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,i.disabled=!0,t.optDisabled=!s.disabled;try{delete h.test}catch(p){t.deleteExpando=!1}!h.addEventListener&&h.attachEvent&&h.fireEvent&&(h.attachEvent("onclick",c=function(){t.noCloneEvent=!1}),h.cloneNode(!0).fireEvent("onclick"),h.detachEvent("onclick",c)),o=R.createElement("input"),o.value="t",o.setAttribute("type","radio"),t.radioValue=o.value==="t",o.setAttribute("checked","checked"),o.setAttribute("name","t"),h.appendChild(o),u=R.createDocumentFragment(),u.appendChild(h.lastChild),t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=o.checked,u.removeChild(o),u.appendChild(h);if(h.attachEvent)for(f in{submit:!0,change:!0,focusin:!0})a="on"+f,l=a in h,l||(h.setAttribute(a,"return;"),l=typeof h[a]=="function"),t[f+"Bubbles"]=l;return Y(function(){var n,r,i,s,o="padding:0;margin:0;border:0;display:block;overflow:hidden;",u=R.getElementsByTagName("body")[0];if(!u)return;n=R.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",u.insertBefore(n,u.firstChild),r=R.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=r.getElementsByTagName("td"),i[0].style.cssText="padding:0;margin:0;border:0;display:none",l=i[0].offsetHeight===0,i[0].style.display="",i[1].style.display="none",t.reliableHiddenOffsets=l&&i[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=u.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",s=R.createElement("div"),s.style.cssText=r.style.cssText=o,s.style.marginRight=s.style.width="0",r.style.width="1px",r.appendChild(s),t.reliableMarginRight=!parseFloat((e.getComputedStyle(s,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),u.removeChild(n),n=r=i=s=null}),u.removeChild(h),n=r=i=s=o=u=h=null,t}();var vt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,mt=/([A-Z])/g;Y.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(Y.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?Y.cache[e[Y.expando]]:e[Y.expando],!!e&&!i(e)},data:function(e,n,r,i){if(!Y.acceptData(e))return;var s,o,u=Y.expando,a=typeof n=="string",f=e.nodeType,l=f?Y.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=Y.deletedIds.pop()||++Y.uuid:c=u),l[c]||(l[c]={},f||(l[c].toJSON=Y.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=Y.extend(l[c],n):l[c].data=Y.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[Y.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[Y.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!Y.acceptData(e))return;var r,s,o,u=e.nodeType,a=u?Y.cache:e,f=u?e[Y.expando]:Y.expando;if(!a[f])return;if(t){r=n?a[f]:a[f].data;if(r){Y.isArray(t)||(t in r?t=[t]:(t=Y.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(s=0,o=t.length;s<o;s++)delete r[t[s]];if(!(n?i:Y.isEmptyObject)(r))return}}if(!n){delete a[f].data;if(!i(a[f]))return}u?Y.cleanData([e],!0):Y.support.deleteExpando||a!=a.window?delete a[f]:a[f]=null},_data:function(e,t,n){return Y.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&Y.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),Y.fn.extend({data:function(e,n){var i,s,o,u,a,f=this[0],l=0,c=null;if(e===t){if(this.length){c=Y.data(f);if(f.nodeType===1&&!Y._data(f,"parsedAttrs")){o=f.attributes;for(a=o.length;l<a;l++)u=o[l].name,u.indexOf("data-")===0&&(u=Y.camelCase(u.substring(5)),r(f,u,c[u]));Y._data(f,"parsedAttrs",!0)}}return c}return typeof e=="object"?this.each(function(){Y.data(this,e)}):(i=e.split(".",2),i[1]=i[1]?"."+i[1]:"",s=i[1]+"!",Y.access(this,function(n){if(n===t)return c=this.triggerHandler("getData"+s,[i[0]]),c===t&&f&&(c=Y.data(f,e),c=r(f,e,c)),c===t&&i[1]?this.data(i[0]):c;i[1]=n,this.each(function(){var t=Y(this);t.triggerHandler("setData"+s,i),Y.data(this,e,n),t.triggerHandler("changeData"+s,i)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){Y.removeData(this,e)})}}),Y.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y._data(e,t),n&&(!r||Y.isArray(n)?r=Y._data(e,t,Y.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=Y.queue(e,t),r=n.length,i=n.shift(),s=Y._queueHooks(e,t),o=function(){Y.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y._data(e,n)||Y._data(e,n,{empty:Y.Callbacks("once memory").add(function(){Y.removeData(e,t+"queue",!0),Y.removeData(e,n,!0)})})}}),Y.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?Y.queue(this[0],e):n===t?this:this.each(function(){var t=Y.queue(this,e,n);Y._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&Y.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Y.dequeue(this,e)})},delay:function(e,t){return e=Y.fx?Y.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=Y.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=Y._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var gt,yt,bt,wt=/[\t\r\n]/g,Et=/\r/g,St=/^(?:button|input)$/i,xt=/^(?:button|input|object|select|textarea)$/i,Tt=/^a(?:rea|)$/i,Nt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ct=Y.support.getSetAttribute;Y.fn.extend({attr:function(e,t){return Y.access(this,Y.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Y.removeAttr(this,e)})},prop:function(e,t){return Y.access(this,Y.prop,e,t,arguments.length>1)},removeProp:function(e){return e=Y.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(Y.isFunction(e))return this.each(function(t){Y(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(tt);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)~s.indexOf(" "+t[o]+" ")||(s+=t[o]+" ");i.className=Y.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(Y.isFunction(e))return this.each(function(t){Y(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(tt);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(wt," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>-1)r=r.replace(" "+n[s]+" "," ");i.className=e?Y.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return Y.isFunction(e)?this.each(function(n){Y(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=Y(this),u=t,a=e.split(tt);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&Y._data(this,"__className__",this.className),this.className=this.className||e===!1?"":Y._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(wt," ").indexOf(t)>-1)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=Y.valHooks[s.type]||Y.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(Et,""):r==null?"":r);return}return i=Y.isFunction(e),this.each(function(r){var s,o=Y(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":Y.isArray(s)&&(s=Y.map(s,function(e){return e==null?"":e+""})),n=Y.valHooks[this.type]||Y.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),Y.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,s=e.selectedIndex,o=[],u=e.options,a=e.type==="select-one";if(s<0)return null;n=a?s:0,r=a?s+1:u.length;for(;n<r;n++){i=u[n];if(i.selected&&(Y.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!Y.nodeName(i.parentNode,"optgroup"))){t=Y(i).val();if(a)return t;o.push(t)}}return a&&!o.length&&u.length?Y(u[s]).val():o},set:function(e,t){var n=Y.makeArray(t);return Y(e).find("option").each(function(){this.selected=Y.inArray(Y(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&Y.isFunction(Y.fn[n]))return Y(e)[n](r);if(typeof e.getAttribute=="undefined")return Y.prop(e,n,r);u=a!==1||!Y.isXMLDoc(e),u&&(n=n.toLowerCase(),o=Y.attrHooks[n]||(Nt.test(n)?yt:gt));if(r!==t){if(r===null){Y.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,""+r),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(tt);for(;o<r.length;o++)i=r[o],i&&(n=Y.propFix[i]||i,s=Nt.test(i),s||Y.attr(e,i,""),e.removeAttribute(Ct?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(St.test(e.nodeName)&&e.parentNode)Y.error("type property can't be changed");else if(!Y.support.radioValue&&t==="radio"&&Y.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return gt&&Y.nodeName(e,"button")?gt.get(e,t):t in e?e.value:null},set:function(e,t,n){if(gt&&Y.nodeName(e,"button"))return gt.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!Y.isXMLDoc(e),o&&(n=Y.propFix[n]||n,s=Y.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):xt.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:t}}}}),yt={get:function(e,n){var r,i=Y.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?Y.removeAttr(e,n):(r=Y.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},Ct||(bt={name:!0,id:!0,coords:!0},gt=Y.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(bt[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=R.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},Y.each(["width","height"],function(e,t){Y.attrHooks[t]=Y.extend(Y.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),Y.attrHooks.contenteditable={get:gt.get,set:function(e,t,n){t===""&&(t="false"),gt.set(e,t,n)}}),Y.support.hrefNormalized||Y.each(["href","src","width","height"],function(e,n){Y.attrHooks[n]=Y.extend(Y.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),Y.support.style||(Y.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),Y.support.optSelected||(Y.propHooks.selected=Y.extend(Y.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),Y.support.enctype||(Y.propFix.enctype="encoding"),Y.support.checkOn||Y.each(["radio","checkbox"],function(){Y.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),Y.each(["radio","checkbox"],function(){Y.valHooks[this]=Y.extend(Y.valHooks[this],{set:function(e,t){if(Y.isArray(t))return e.checked=Y.inArray(Y(e).val(),t)>=0}})});var kt=/^(?:textarea|input|select)$/i,Lt=/^([^\.]*|)(?:\.(.+)|)$/,At=/(?:^|\s)hover(\.\S+|)\b/,Ot=/^key/,Mt=/^(?:mouse|contextmenu)|click/,_t=/^(?:focusinfocus|focusoutblur)$/,Dt=function(e){return Y.event.special.hover?e:e.replace(At,"mouseenter$1 mouseleave$1")};Y.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=Y._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=Y.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof Y=="undefined"||!!e&&Y.event.triggered===e.type?t:Y.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=Y.trim(Dt(n)).split(" ");for(f=0;f<n.length;f++){l=Lt.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),m=Y.event.special[c]||{},c=(s?m.delegateType:m.bindType)||c,m=Y.event.special[c]||{},p=Y.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,namespace:h.join(".")},d),v=a[c];if(!v){v=a[c]=[],v.delegateCount=0;if(!m.setup||m.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}m.add&&(m.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?v.splice(v.delegateCount++,0,p):v.push(p),Y.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=Y.hasData(e)&&Y._data(e);if(!m||!(h=m.events))return;t=Y.trim(Dt(t||"")).split(" ");for(s=0;s<t.length;s++){o=Lt.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)Y.event.remove(e,u+t[s],n,r,!0);continue}p=Y.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)v=d[c],(i||a===v.origType)&&(!n||n.guid===v.guid)&&(!f||f.test(v.namespace))&&(!r||r===v.selector||r==="**"&&v.selector)&&(d.splice(c--,1),v.selector&&d.delegateCount--,p.remove&&p.remove.call(e,v));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,m.handle)===!1)&&Y.removeEvent(e,u,m.handle),delete h[u])}Y.isEmptyObject(h)&&(delete m.handle,Y.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,s){if(!i||i.nodeType!==3&&i.nodeType!==8){var o,u,a,f,l,c,h,p,d,v,m=n.type||n,g=[];if(_t.test(m+Y.event.triggered))return;m.indexOf("!")>=0&&(m=m.slice(0,-1),u=!0),m.indexOf(".")>=0&&(g=m.split("."),m=g.shift(),g.sort());if((!i||Y.event.customEvent[m])&&!Y.event.global[m])return;n=typeof n=="object"?n[Y.expando]?n:new Y.Event(m,n):new Y.Event(m),n.type=m,n.isTrigger=!0,n.exclusive=u,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c=m.indexOf(":")<0?"on"+m:"";if(!i){o=Y.cache;for(a in o)o[a].events&&o[a].events[m]&&Y.event.trigger(n,r,o[a].handle.elem,!0);return}n.result=t,n.target||(n.target=i),r=r!=null?Y.makeArray(r):[],r.unshift(n),h=Y.event.special[m]||{};if(h.trigger&&h.trigger.apply(i,r)===!1)return;d=[[i,h.bindType||m]];if(!s&&!h.noBubble&&!Y.isWindow(i)){v=h.delegateType||m,f=_t.test(v+m)?i:i.parentNode;for(l=i;f;f=f.parentNode)d.push([f,v]),l=f;l===(i.ownerDocument||R)&&d.push([l.defaultView||l.parentWindow||e,v])}for(a=0;a<d.length&&!n.isPropagationStopped();a++)f=d[a][0],n.type=d[a][1],p=(Y._data(f,"events")||{})[n.type]&&Y._data(f,"handle"),p&&p.apply(f,r),p=c&&f[c],p&&Y.acceptData(f)&&p.apply(f,r)===!1&&n.preventDefault();return n.type=m,!s&&!n.isDefaultPrevented()&&(!h._default||h._default.apply(i.ownerDocument,r)===!1)&&(m!=="click"||!Y.nodeName(i,"a"))&&Y.acceptData(i)&&c&&i[m]&&(m!=="focus"&&m!=="blur"||n.target.offsetWidth!==0)&&!Y.isWindow(i)&&(l=i[c],l&&(i[c]=null),Y.event.triggered=m,i[m](),Y.event.triggered=t,l&&(i[c]=l)),n.result}return},dispatch:function(n){n=Y.event.fix(n||e.event);var r,i,s,o,u,a,f,l,c,h,p=(Y._data(this,"events")||{})[n.type]||[],d=p.delegateCount,v=[].slice.call(arguments),m=!n.exclusive&&!n.namespace,g=Y.event.special[n.type]||{},y=[];v[0]=n,n.delegateTarget=this;if(g.preDispatch&&g.preDispatch.call(this,n)===!1)return;if(d&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<d;r++)l=p[r],c=l.selector,u[c]===t&&(u[c]=Y(c,this).index(s)>=0),u[c]&&f.push(l);f.length&&y.push({elem:s,matches:f})}p.length>d&&y.push({elem:this,matches:p.slice(d)});for(r=0;r<y.length&&!n.isPropagationStopped();r++){a=y[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){l=a.matches[i];if(m||!n.namespace&&!l.namespace||n.namespace_re&&n.namespace_re.test(l.namespace))n.data=l.data,n.handleObj=l,o=((Y.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,v),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return g.postDispatch&&g.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,o=n.button,u=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||R,i=r.documentElement,s=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),!e.which&&o!==t&&(e.which=o&1?1:o&2?3:o&4?2:0),e}},fix:function(e){if(e[Y.expando])return e;var t,n,r=e,i=Y.event.fixHooks[e.type]||{},s=i.props?this.props.concat(i.props):this.props;e=Y.Event(r);for(t=s.length;t;)n=s[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||R),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){Y.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=Y.extend(new Y.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?Y.event.trigger(i,null,t):Y.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},Y.event.handle=Y.event.dispatch,Y.removeEvent=R.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},Y.Event=function(e,t){if(!(this instanceof Y.Event))return new Y.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?o:s):this.type=e,t&&Y.extend(this,t),this.timeStamp=e&&e.timeStamp||Y.now(),this[Y.expando]=!0},Y.Event.prototype={preventDefault:function(){this.isDefaultPrevented=o;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=o;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},Y.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Y.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!Y.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),Y.support.submitBubbles||(Y.event.special.submit={setup:function(){if(Y.nodeName(this,"form"))return!1;Y.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=Y.nodeName(n,"input")||Y.nodeName(n,"button")?n.form:t;r&&!Y._data(r,"_submit_attached")&&(Y.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),Y._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&Y.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(Y.nodeName(this,"form"))return!1;Y.event.remove(this,"._submit")}}),Y.support.changeBubbles||(Y.event.special.change={setup:function(){if(kt.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")Y.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),Y.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),Y.event.simulate("change",this,e,!0)});return!1}Y.event.add(this,"beforeactivate._change",function(e){var t=e.target;kt.test(t.nodeName)&&!Y._data(t,"_change_attached")&&(Y.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&Y.event.simulate("change",this.parentNode,e,!0)}),Y._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return Y.event.remove(this,"._change"),!kt.test(this.nodeName)}}),Y.support.focusinBubbles||Y.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){Y.event.simulate(t,e.target,Y.event.fix(e),!0)};Y.event.special[t]={setup:function(){n++===0&&R.addEventListener(e,r,!0)},teardown:function(){--n===0&&R.removeEventListener(e,r,!0)}}}),Y.fn.extend({on:function(e,n,r,i,o){var u,a;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=s;else if(!i)return this;return o===1&&(u=i,i=function(e){return Y().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=Y.guid++)),this.each(function(){Y.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Y(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(o in e)this.off(o,n,e[o]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=s),this.each(function(){Y.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return Y(this.context).on(e,this.selector,t,n),this},die:function(e,t){return Y(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length==1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){Y.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return Y.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||Y.guid++,r=0,i=function(n){var i=(Y._data(this,"lastToggle"+e.guid)||0)%r;return Y._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Y.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Y.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Ot.test(t)&&(Y.event.fixHooks[t]=Y.event.keyHooks),Mt.test(t)&&(Y.event.fixHooks[t]=Y.event.mouseHooks)}),function(e,t){function n(e,t,n,r){n=n||[],t=t||L;var i,s,o,u,a=t.nodeType;if(a!==1&&a!==9)return[];if(!e||typeof e!="string")return n;o=w(t);if(!o&&!r)if(i=K.exec(e))if(u=i[1]){if(a===9){s=t.getElementById(u);if(!s||!s.parentNode)return n;if(s.id===u)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(u))&&E(t,s)&&s.id===u)return n.push(s),n}else{if(i[2])return _.apply(n,M.call(t.getElementsByTagName(e),0)),n;if((u=i[3])&&at&&t.getElementsByClassName)return _.apply(n,M.call(t.getElementsByClassName(u),0)),n}return d(e,t,n,r,o)}function r(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function i(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function s(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function o(e,t,r,i){var s,o,u,a,f,l,c,h,p,d,v=!r&&t!==L,m=(v?"<s>":"")+e.replace(X,"$1<s>"),g=B[k][m];if(g)return i?0:M.call(g,0);f=e,l=[],h=0,p=y.preFilter,d=y.filter;while(f){if(!s||(o=V.exec(f)))o&&(f=f.slice(o[0].length),u.selector=c),l.push(u=[]),c="",v&&(f=" "+f);s=!1;if(o=$.exec(f))c+=o[0],f=f.slice(o[0].length),s=u.push({part:o.pop().replace(X," "),string:o[0],captures:o});for(a in d)(o=rt[a].exec(f))&&(!p[a]||(o=p[a](o,t,r)))&&(c+=o[0],f=f.slice(o[0].length),s=u.push({part:a,string:o.shift(),captures:o}));if(!s)break}return c&&(u.selector=c),i?f.length:f?n.error(e):M.call(B(m,l),0)}function u(e,t,n,r){var i=t.dir,s=O++;return e||(e=function(e){return e===n}),t.first?function(t){while(t=t[i])if(t.nodeType===1)return e(t)&&t}:r?function(t){while(t=t[i])if(t.nodeType===1&&e(t))return t}:function(t){var n,r=s+"."+v,o=r+"."+m;while(t=t[i])if(t.nodeType===1){if((n=t[k])===o)return t.sizset;if(typeof n=="string"&&n.indexOf(r)===0){if(t.sizset)return t}else{t[k]=o;if(e(t))return t.sizset=!0,t;t.sizset=!1}}}}function a(e,t){return e?function(n){var r=t(n);return r&&e(r===!0?n:r)}:t}function f(e,t,n){var r,i,s=0;for(;r=e[s];s++)y.relative[r.part]?i=u(i,y.relative[r.part],t,n):i=a(i,y.filter[r.part].apply(null,r.captures.concat(t,n)));return i}function l(e){return function(t){var n,r=0;for(;n=e[r];r++)if(n(t))return!0;return!1}}function c(e,t,r,i){var s=0,o=t.length;for(;s<o;s++)n(e,t[s],r,i)}function h(e,t,r,i,s,o){var u,a=y.setFilters[t.toLowerCase()];return a||n.error(t),(e||!(u=s))&&c(e||"*",i,u=[],s),u.length>0?a(u,r,o):[]}function p(e,r,i,s){var o,u,a,f,l,p,d,v,m,g,y,b,w,E=0,S=e.length,x=rt.POS,T=new RegExp("^"+x.source+"(?!"+F+")","i"),N=function(){var e=1,n=arguments.length-2;for(;e<n;e++)arguments[e]===t&&(m[e]=t)};for(;E<S;E++){o=e[E],u="",v=s;for(a=0,f=o.length;a<f;a++){l=o[a],p=l.string;if(l.part==="PSEUDO"){x.exec(""),d=0;while(m=x.exec(p)){g=!0,y=x.lastIndex=m.index+m[0].length;if(y>d){u+=p.slice(d,m.index),d=y,b=[r],$.test(u)&&(v&&(b=v),v=s);if(w=Z.test(u))u=u.slice(0,-5).replace($,"$&*"),d++;m.length>1&&m[0].replace(T,N),v=h(u,m[1],m[2],b,v,w)}u=""}}g||(u+=p),g=!1}u?$.test(u)?c(u,v||[r],i,s):n(u,r,i,s?s.concat(v):v):_.apply(i,v)}return S===1?i:n.uniqueSort(i)}function d(e,t,n,r,i){e=e.replace(X,"$1");var s,u,a,f,l,c,h,d,g,b,w=o(e,t,i),E=t.nodeType;if(rt.POS.test(e))return p(w,t,n,r);if(r)s=M.call(r,0);else if(w.length===1){if((c=M.call(w[0],0)).length>2&&(h=c[0]).part==="ID"&&E===9&&!i&&y.relative[c[1].part]){t=y.find.ID(h.captures[0].replace(nt,""),t,i)[0];if(!t)return n;e=e.slice(c.shift().string.length)}g=(w=G.exec(c[0].string))&&!w.index&&t.parentNode||t,d="";for(l=c.length-1;l>=0;l--){h=c[l],b=h.part,d=h.string+d;if(y.relative[b])break;if(y.order.test(b)){s=y.find[b](h.captures[0].replace(nt,""),g,i);if(s==null)continue;e=e.slice(0,e.length-d.length)+d.replace(rt[b],""),e||_.apply(n,M.call(s,0));break}}}if(e){u=S(e,t,i),v=u.dirruns++,s==null&&(s=y.find.TAG("*",G.test(e)&&t.parentNode||t));for(l=0;f=s[l];l++)m=u.runs++,u(f)&&n.push(f)}return n}var v,m,g,y,b,w,E,S,x,T,N=!0,C="undefined",k=("sizcache"+Math.random()).replace(".",""),L=e.document,A=L.documentElement,O=0,M=[].slice,_=[].push,D=function(e,t){return e[k]=t||!0,e},P=function(){var e={},t=[];return D(function(n,r){return t.push(n)>y.cacheLength&&delete e[t.shift()],e[n]=r},e)},H=P(),B=P(),j=P(),F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="([*^$|!~]?=)",U="\\["+F+"*("+I+")"+F+"*(?:"+R+F+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+q+")|)|)"+F+"*\\]",z=":("+I+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+U+")|[^:]|\\\\.)*|.*))\\)|)",W=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",X=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),V=new RegExp("^"+F+"*,"+F+"*"),$=new RegExp("^"+F+"*([\\x20\\t\\r\\n\\f>+~])"+F+"*"),J=new RegExp(z),K=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,Q=/^:not/,G=/[\x20\t\r\n\f]*[+~]/,Z=/:not\($/,et=/h\d/i,tt=/input|select|textarea|button/i,nt=/\\(?!\\)/g,rt={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),NAME:new RegExp("^\\[name=['\"]?("+I+")['\"]?\\]"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),POS:new RegExp(W,"ig"),needsContext:new RegExp("^"+F+"*[>+~]|"+W,"i")},it=function(e){var t=L.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},st=it(function(e){return e.appendChild(L.createComment("")),!e.getElementsByTagName("*").length}),ot=it(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==C&&e.firstChild.getAttribute("href")==="#"}),ut=it(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),at=it(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),ft=it(function(e){e.id=k+0,e.innerHTML="<a name='"+k+"'></a><div name='"+k+"'></div>",A.insertBefore(e,A.firstChild);var t=L.getElementsByName&&L.getElementsByName(k).length===2+L.getElementsByName(k+0).length;return g=!L.getElementById(k),A.removeChild(e),t});try{M.call(A.childNodes,0)[0].nodeType}catch(lt){M=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},b=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=b(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=b(t);return n},w=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},E=n.contains=A.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:A.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},n.attr=function(e,t){var n,r=w(e);return r||(t=t.toLowerCase()),y.attrHandle[t]?y.attrHandle[t](e):ut||r?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},y=n.selectors={cacheLength:50,createPseudo:D,match:rt,order:new RegExp("ID|TAG"+(ft?"|NAME":"")+(at?"|CLASS":"")),attrHandle:ot?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:g?function(e,t,n){if(typeof t.getElementById!==C&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==C&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==C&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:st?function(e,t){if(typeof t.getElementsByTagName!==C)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:function(e,t){if(typeof t.getElementsByName!==C)return t.getElementsByName(name)},CLASS:function(e,t,n){if(typeof t.getElementsByClassName!==C&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,""),e[3]=(e[4]||e[5]||"").replace(nt,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&n.error(e[0]),e},PSEUDO:function(e,t,n){var r,i;if(rt.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(r=e[4])J.test(r)&&(i=o(r,t,n,!0))&&(i=r.indexOf(")",r.length-i)-r.length)&&(r=r.slice(0,i),e[0]=e[0].slice(0,i)),e[2]=r;return e.slice(0,3)}},filter:{ID:g?function(e){return e=e.replace(nt,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(nt,""),function(t){var n=typeof t.getAttributeNode!==C&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace(nt,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=H[k][e];return t||(t=H(e,new RegExp("(^|"+F+")"+e+"("+F+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==C&&e.getAttribute("class")||"")}},ATTR:function(e,t,r){return t?function(i){var s=n.attr(i,e),o=s+"";if(s==null)return t==="!=";switch(t){case"=":return o===r;case"!=":return o!==r;case"^=":return r&&o.indexOf(r)===0;case"*=":return r&&o.indexOf(r)>-1;case"$=":return r&&o.substr(o.length-r.length)===r;case"~=":return(" "+o+" ").indexOf(r)>-1;case"|=":return o===r||o.substr(0,r.length+1)===r+"-"}}:function(t){return n.attr(t,e)!=null}},CHILD:function(e,t,n,r){if(e==="nth"){var i=O++;return function(e){var t,s,o=0,u=e;if(n===1&&r===0)return!0;t=e.parentNode;if(t&&(t[k]!==i||!e.sizset)){for(u=t.firstChild;u;u=u.nextSibling)if(u.nodeType===1){u.sizset=++o;if(u===e)break}t[k]=i}return s=e.sizset-r,n===0?s===0:s%n===0&&s/n>=0}}return function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t,r,i){var s,o=y.pseudos[e]||y.pseudos[e.toLowerCase()];return o||n.error("unsupported pseudo: "+e),o[k]?o(t,r,i):o.length>1?(s=[e,e,"",t],function(e){return o(e,0,s)}):o}},pseudos:{not:D(function(e,t,n){var r=S(e.replace(X,"$1"),t,n);return function(e){return!r(e)}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!y.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},contains:D(function(e){return function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),has:D(function(e){return function(t){return n(e,t).length>0}}),header:function(e){return et.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:r("radio"),checkbox:r("checkbox"),file:r("file"),password:r("password"),image:r("image"),submit:i("submit"),reset:i("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return tt.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&(!!e.type||!!e.href)},active:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t,n){return n?e.slice(1):[e[0]]},last:function(e,t,n){var r=e.pop();return n?e:[r]},even:function(e,t,n){var r=[],i=n?1:0,s=e.length;for(;i<s;i+=2)r.push(e[i]);return r},odd:function(e,t,n){var r=[],i=n?0:1,s=e.length;for(;i<s;i+=2)r.push(e[i]);return r},lt:function(e,t,n){return n?e.slice(+t):e.slice(0,+t)},gt:function(e,t,n){return n?e.slice(0,+t+1):e.slice(+t+1)},eq:function(e,t,n){var r=e.splice(+t,1);return n?e:r}}},x=A.compareDocumentPosition?function(e,t){return e===t?(T=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return T=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],o=[],u=e.parentNode,a=t.parentNode,f=u;if(u===a)return s(e,t);if(!u)return-1;if(!a)return 1;while(f)i.unshift(f),f=f.parentNode;f=a;while(f)o.unshift(f),f=f.parentNode;n=i.length,r=o.length;for(var l=0;l<n&&l<r;l++)if(i[l]!==o[l])return s(i[l],o[l]);return l===n?s(e,o[l],-1):s(i[l],t,1)},[0,0].sort(x),N=!T,n.uniqueSort=function(e){var t,n=1;T=N,e.sort(x);if(T)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},S=n.compile=function(e,t,n){var r,i,s,u=j[k][e];if(u&&u.context===t)return u;r=o(e,t,n);for(i=0,s=r.length;i<s;i++)r[i]=f(r[i],t,n);return u=j(e,l(r)),u.context=t,u.runs=u.dirruns=0,u},L.querySelectorAll&&function(){var e,t=d,r=/'|\\/g,i=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,s=[],u=[":active"],a=A.matchesSelector||A.mozMatchesSelector||A.webkitMatchesSelector||A.oMatchesSelector||A.msMatchesSelector;it(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||s.push("\\["+F+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||s.push(":checked")}),it(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&s.push("[*^$]="+F+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||s.push(":enabled",":disabled")}),s=s.length&&new RegExp(s.join("|")),d=function(e,n,i,u,a){if(!u&&!a&&(!s||!s.test(e)))if(n.nodeType===9)try{return _.apply(i,M.call(n.querySelectorAll(e),0)),i}catch(f){}else if(n.nodeType===1&&n.nodeName.toLowerCase()!=="object"){var l,c,h,p=n.getAttribute("id"),d=p||k,v=G.test(e)&&n.parentNode||n;p?d=d.replace(r,"\\$&"):n.setAttribute("id",d),l=o(e,n,a),d="[id='"+d+"']";for(c=0,h=l.length;c<h;c++)l[c]=d+l[c].selector;try{return _.apply(i,M.call(v.querySelectorAll(l.join(",")),0)),i}catch(f){}finally{p||n.removeAttribute("id")}}return t(e,n,i,u,a)},a&&(it(function(t){e=a.call(t,"div");try{a.call(t,"[test!='']:sizzle"),u.push(rt.PSEUDO.source,rt.POS.source,"!=")}catch(n){}}),u=new RegExp(u.join("|")),n.matchesSelector=function(t,r){r=r.replace(i,"='$1']");if(!w(t)&&!u.test(r)&&(!s||!s.test(r)))try{var o=a.call(t,r);if(o||e||t.document&&t.document.nodeType!==11)return o}catch(f){}return n(r,null,null,[t]).length>0})}(),y.setFilters.nth=y.setFilters.eq,y.filters=y.pseudos,n.attr=Y.attr,Y.find=n,Y.expr=n.selectors,Y.expr[":"]=Y.expr.pseudos,Y.unique=n.uniqueSort,Y.text=n.getText,Y.isXMLDoc=n.isXML,Y.contains=n.contains}(e);var Pt=/Until$/,Ht=/^(?:parents|prev(?:Until|All))/,Bt=/^.[^:#\[\.,]*$/,jt=Y.expr.match.needsContext,Ft={children:!0,contents:!0,next:!0,prev:!0};Y.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return Y(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(Y.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,Y.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=Y(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(Y.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(f(this,e,!1),"not",e)},filter:function(e){return this.pushStack(f(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?jt.test(e)?Y(e,this.context).index(this[0])>=0:Y.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=jt.test(e)||typeof e!="string"?Y(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:Y.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?Y.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?Y.inArray(this[0],Y(e)):Y.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?Y(e,t):Y.makeArray(e&&e.nodeType?[e]:e),r=Y.merge(this.get(),n);return this.pushStack(u(n[0])||u(r[0])?r:Y.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),Y.fn.andSelf=Y.fn.addBack,Y.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return Y.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Y.dir(e,"parentNode",n)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Y.dir(e,"nextSibling")},prevAll:function(e){return Y.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Y.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Y.dir(e,"previousSibling",n)},siblings:function(e){return Y.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Y.sibling(e.firstChild)},contents:function(e){return Y.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:Y.merge([],e.childNodes)}},function(e,t){Y.fn[e]=function(n,r){var i=Y.map(this,t,n);return Pt.test(e)||(r=n),r&&typeof r=="string"&&(i=Y.filter(r,i)),i=this.length>1&&!Ft[e]?Y.unique(i):i,this.length>1&&Ht.test(e)&&(i=i.reverse()),this.pushStack(i,e,$.call(arguments).join(","))}}),Y.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?Y.find.matchesSelector(t[0],e)?[t[0]]:[]:Y.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!Y(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var It="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qt=/ jQuery\d+="(?:null|\d+)"/g,Rt=/^\s+/,Ut=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,zt=/<([\w:]+)/,Wt=/<tbody/i,Xt=/<|&#?\w+;/,Vt=/<(?:script|style|link)/i,$t=/<(?:script|object|embed|option|style)/i,Jt=new RegExp("<(?:"+It+")[\\s/>]","i"),Kt=/^(?:checkbox|radio)$/,Qt=/checked\s*(?:[^=]|=\s*.checked.)/i,Gt=/\/(java|ecma)script/i,Yt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=l(R),tn=en.appendChild(R.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,Y.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),Y.fn.extend({text:function(e){return Y.access(this,function(e){return e===t?Y.text(this):this.empty().append((this[0]&&this[0].ownerDocument||R).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(Y.isFunction(e))return this.each(function(t){Y(this).wrapAll(e.call(this,t))});if(this[0]){var t=Y(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return Y.isFunction(e)?this.each(function(t){Y(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Y(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Y.isFunction(e);return this.each(function(n){Y(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Y.nodeName(this,"body")||Y(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!u(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=Y.clean(arguments);return this.pushStack(Y.merge(e,this),"before",this.selector)}},after:function(){if(!u(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=Y.clean(arguments);return this.pushStack(Y.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||Y.filter(e,[n]).length)!t&&n.nodeType===1&&(Y.cleanData(n.getElementsByTagName("*")),Y.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&Y.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return Y.clone(this,e,t)})},html:function(e){return Y.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(qt,""):t;if(typeof e=="string"&&!Vt.test(e)&&(Y.support.htmlSerialize||!Jt.test(e))&&(Y.support.leadingWhitespace||!Rt.test(e))&&!Zt[(zt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ut,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(Y.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return u(this[0])?this.length?this.pushStack(Y(Y.isFunction(e)?e():e),"replaceWith",e):this:Y.isFunction(e)?this.each(function(t){var n=Y(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=Y(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;Y(this).remove(),t?Y(t).before(e):Y(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],h=this.length;if(!Y.support.checkClone&&h>1&&typeof f=="string"&&Qt.test(f))return this.each(function(){Y(this).domManip(e,n,r)});if(Y.isFunction(f))return this.each(function(i){var s=Y(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=Y.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&Y.nodeName(s,"tr");for(u=i.cacheable||h-1;a<h;a++)r.call(n&&Y.nodeName(this[a],"table")?c(this[a],"tbody"):this[a],a===u?o:Y.clone(o,!0,!0))}o=s=null,l.length&&Y.each(l,function(e,t){t.src?Y.ajax?Y.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):Y.error("no ajax"):Y.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Yt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),Y.buildFragment=function(e,n,r){var i,s,o,u=e[0];return n=n||R,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof u=="string"&&u.length<512&&n===R&&u.charAt(0)==="<"&&!$t.test(u)&&(Y.support.checkClone||!Qt.test(u))&&(Y.support.html5Clone||!Jt.test(u))&&(s=!0,i=Y.fragments[u],o=i!==t),i||(i=n.createDocumentFragment(),Y.clean(e,n,i,r),s&&(Y.fragments[u]=o&&i)),{fragment:i,cacheable:s}},Y.fragments={},Y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Y.fn[e]=function(n){var r,i=0,s=[],o=Y(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),Y(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),Y.extend({clone:function(e,t,n){var r,i,s,o;Y.support.html5Clone||Y.isXMLDoc(e)||!Jt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(o=tn.firstChild));if((!Y.support.noCloneEvent||!Y.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!Y.isXMLDoc(e)){p(e,o),r=d(e),i=d(o);for(s=0;r[s];++s)i[s]&&p(r[s],i[s])}if(t){h(e,o);if(n){r=d(e),i=d(o);for(s=0;r[s];++s)h(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var i,s,o,u,a,f,c,h,p,d,m,g,y=t===R&&en,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=R;for(i=0;(o=e[i])!=null;i++){typeof o=="number"&&(o+="");if(!o)continue;if(typeof o=="string")if(!Xt.test(o))o=t.createTextNode(o);else{y=y||l(t),c=t.createElement("div"),y.appendChild(c),o=o.replace(Ut,"<$1></$2>"),u=(zt.exec(o)||["",""])[1].toLowerCase(),a=Zt[u]||Zt._default,f=a[0],c.innerHTML=a[1]+o+a[2];while(f--)c=c.lastChild;if(!Y.support.tbody){h=Wt.test(o),p=u==="table"&&!h?c.firstChild&&c.firstChild.childNodes:a[1]==="<table>"&&!h?c.childNodes:[];for(s=p.length-1;s>=0;--s)Y.nodeName(p[s],"tbody")&&!p[s].childNodes.length&&p[s].parentNode.removeChild(p[s])}!Y.support.leadingWhitespace&&Rt.test(o)&&c.insertBefore(t.createTextNode(Rt.exec(o)[0]),c.firstChild),o=c.childNodes,c.parentNode.removeChild(c)}o.nodeType?b.push(o):Y.merge(b,o)}c&&(o=c=y=null);if(!Y.support.appendChecked)for(i=0;(o=b[i])!=null;i++)Y.nodeName(o,"input")?v(o):typeof o.getElementsByTagName!="undefined"&&Y.grep(o.getElementsByTagName("input"),v);if(n){m=function(e){if(!e.type||Gt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(i=0;(o=b[i])!=null;i++)if(!Y.nodeName(o,"script")||!m(o))n.appendChild(o),typeof o.getElementsByTagName!="undefined"&&(g=Y.grep(Y.merge([],o.getElementsByTagName("script")),m),b.splice.apply(b,[i+1,0].concat(g)),i+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=Y.expando,a=Y.cache,f=Y.support.deleteExpando,l=Y.event.special;for(;(i=e[o])!=null;o++)if(t||Y.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?Y.event.remove(i,s):Y.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,Y.deletedIds.push(r))}}}}),function(){var e,t;Y.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=Y.uaMatch(z.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),Y.browser=t,Y.sub=function(){function e(t,n){return new e.fn.init(t,n)}Y.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function n(n,r){return r&&r instanceof Y&&!(r instanceof e)&&(r=e(r)),Y.fn.init.call(this,n,r,t)},e.fn.init.prototype=e.fn;var t=e(R);return e}}();var nn,rn,sn,on=/alpha\([^)]*\)/i,un=/opacity=([^)]*)/,an=/^(top|right|bottom|left)$/,fn=/^(none|table(?!-c[ea]).+)/,ln=/^margin/,cn=new RegExp("^("+Z+")(.*)$","i"),hn=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pn=new RegExp("^([-+])=("+Z+")","i"),dn={},vn={position:"absolute",visibility:"hidden",display:"block"},mn={letterSpacing:0,fontWeight:400},gn=["Top","Right","Bottom","Left"],yn=["Webkit","O","Moz","ms"],bn=Y.fn.toggle;Y.fn.extend({css:function(e,n){return Y.access(this,function(e,n,r){return r!==t?Y.style(e,n,r):Y.css(e,n)},e,n,arguments.length>1)},show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(e,t){var n=typeof e=="boolean";return Y.isFunction(e)&&Y.isFunction(t)?bn.apply(this,arguments):this.each(function(){(n?e:g(this))?Y(this).show():Y(this).hide()})}}),Y.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Y.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=Y.camelCase(n),f=e.style;n=Y.cssProps[a]||(Y.cssProps[a]=m(f,a)),u=Y.cssHooks[n]||Y.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=pn.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(Y.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!Y.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=Y.camelCase(n);return n=Y.cssProps[a]||(Y.cssProps[a]=m(e.style,a)),u=Y.cssHooks[n]||Y.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=nn(e,n)),s==="normal"&&n in mn&&(s=mn[n]),r||i!==t?(o=parseFloat(s),r||Y.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?nn=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u[n],r===""&&!Y.contains(t.ownerDocument,t)&&(r=Y.style(t,n)),hn.test(r)&&ln.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:R.documentElement.currentStyle&&(nn=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),hn.test(i)&&!an.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),Y.each(["height","width"],function(e,t){Y.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&fn.test(nn(e,"display"))?Y.swap(e,vn,function(){return E(e,t,r)}):E(e,t,r)},set:function(e,n,r){return b(e,n,r?w(e,t,r,Y.support.boxSizing&&Y.css(e,"boxSizing")==="border-box"):0)}}}),Y.support.opacity||(Y.cssHooks.opacity={get:function(e,t){return un.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=Y.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&Y.trim(s.replace(on,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=on.test(s)?s.replace(on,i):s+" "+i}}),Y(function(){Y.support.reliableMarginRight||(Y.cssHooks.marginRight={get:function(e,t){return Y.swap(e,{display:"inline-block"},function(){if(t)return nn(e,"marginRight")})}}),!Y.support.pixelPosition&&Y.fn.position&&Y.each(["top","left"],function(e,t){Y.cssHooks[t]={get:function(e,n){if(n){var r=nn(e,t);return hn.test(r)?Y(e).position()[t]+"px":r}}}})}),Y.expr&&Y.expr.filters&&(Y.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!Y.support.reliableHiddenOffsets&&(e.style&&e.style.display||nn(e,"display"))==="none"},Y.expr.filters.visible=function(e){return!Y.expr.filters.hidden(e)}),Y.each({margin:"",padding:"",border:"Width"},function(e,t){Y.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+gn[r]+t]=i[r]||i[r-2]||i[0];return s}},ln.test(e)||(Y.cssHooks[e+t].set=b)});var wn=/%20/g,En=/\[\]$/,Sn=/\r?\n/g,xn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Tn=/^(?:select|textarea)/i;Y.fn.extend({serialize:function(){return Y.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?Y.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Tn.test(this.nodeName)||xn.test(this.type))}).map(function(e,t){var n=Y(this).val();return n==null?null:Y.isArray(n)?Y.map(n,function(e,n){return{name:t.name,value:e.replace(Sn,"\r\n")}}):{name:t.name,value:n.replace(Sn,"\r\n")}}).get()}}),Y.param=function(e,n){var r,i=[],s=function(e,t){t=Y.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=Y.ajaxSettings&&Y.ajaxSettings.traditional);if(Y.isArray(e)||e.jquery&&!Y.isPlainObject(e))Y.each(e,function(){s(this.name,this.value)});else for(r in e)x(r,e[r],n,s);return i.join("&").replace(wn,"+")};var Nn,Cn,kn=/#.*$/,Ln=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,An=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,On=/^(?:GET|HEAD)$/,Mn=/^\/\//,_n=/\?/,Dn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Pn=/([?&])_=[^&]*/,Hn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Bn=Y.fn.load,jn={},Fn={},In=["*/"]+["*"];try{Nn=U.href}catch(qn){Nn=R.createElement("a"),Nn.href="",Nn=Nn.href}Cn=Hn.exec(Nn.toLowerCase())||[],Y.fn.load=function(e,n,r){if(typeof e!="string"&&Bn)return Bn.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),Y.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),Y.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?Y("<div>").append(e.replace(Dn,"")).find(i):e)}),this},Y.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){Y.fn[t]=function(e){return this.on(t,e)}}),Y.each(["get","post"],function(e,n){Y[n]=function(e,r,i,s){return Y.isFunction(r)&&(s=s||i,i=r,r=t),Y.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),Y.extend({getScript:function(e,n){return Y.get(e,t,n,"script")},getJSON:function(e,t,n){return Y.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?C(e,Y.ajaxSettings):(t=e,e=Y.ajaxSettings),C(e,t),e},ajaxSettings:{url:Nn,isLocal:An.test(Cn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":In},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":Y.parseJSON,"text xml":Y.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:T(jn),ajaxTransport:T(Fn),ajax:function(e,n){function r(e,n,r,o){var f,c,y,b,E,x=n;if(w===2)return;w=2,a&&clearTimeout(a),u=t,s=o||"",S.readyState=e>0?4:0,r&&(b=k(h,S,r));if(e>=200&&e<300||e===304)h.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(Y.lastModified[i]=E),E=S.getResponseHeader("Etag"),E&&(Y.etag[i]=E)),e===304?(x="notmodified",f=!0):(f=L(h,b),x=f.state,c=f.data,y=f.error,f=!y);else{y=x;if(!x||e)x="error",e<0&&(e=0)}S.status=e,S.statusText=""+(n||x),f?v.resolveWith(p,[c,x,S]):v.rejectWith(p,[S,x,y]),S.statusCode(g),g=t,l&&d.trigger("ajax"+(f?"Success":"Error"),[S,h,f?c:y]),m.fireWith(p,[S,x]),l&&(d.trigger("ajaxComplete",[S,h]),--Y.active||Y.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var i,s,o,u,a,f,l,c,h=Y.ajaxSetup({},n),p=h.context||h,d=p!==h&&(p.nodeType||p instanceof Y)?Y(p):Y.event,v=Y.Deferred(),m=Y.Callbacks("once memory"),g=h.statusCode||{},y={},b={},w=0,E="canceled",S={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=b[n]=b[n]||e,y[e]=t}return this},getAllResponseHeaders:function(){return w===2?s:null},getResponseHeader:function(e){var n;if(w===2){if(!o){o={};while(n=Ln.exec(s))o[n[1].toLowerCase()]=n[2]}n=o[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return w||(h.mimeType=e),this},abort:function(e){return e=e||E,u&&u.abort(e),r(0,e),this}};v.promise(S),S.success=S.done,S.error=S.fail,S.complete=m.add,S.statusCode=function(e){if(e){var t;if(w<2)for(t in e)g[t]=[g[t],e[t]];else t=e[S.status],S.always(t)}return this},h.url=((e||h.url)+"").replace(kn,"").replace(Mn,Cn[1]+"//"),h.dataTypes=Y.trim(h.dataType||"*").toLowerCase().split(tt),h.crossDomain==null&&(f=Hn.exec(h.url.toLowerCase()),h.crossDomain=!(!f||f[1]==Cn[1]&&f[2]==Cn[2]&&(f[3]||(f[1]==="http:"?80:443))==(Cn[3]||(Cn[1]==="http:"?80:443)))),h.data&&h.processData&&typeof h.data!="string"&&(h.data=Y.param(h.data,h.traditional)),N(jn,h,n,S);if(w===2)return S;l=h.global,h.type=h.type.toUpperCase(),h.hasContent=!On.test(h.type),l&&Y.active++===0&&Y.event.trigger("ajaxStart");if(!h.hasContent){h.data&&(h.url+=(_n.test(h.url)?"&":"?")+h.data,delete h.data),i=h.url;if(h.cache===!1){var x=Y.now(),T=h.url.replace(Pn,"$1_="+x);h.url=T+(T===h.url?(_n.test(h.url)?"&":"?")+"_="+x:"")}}(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(i=i||h.url,Y.lastModified[i]&&S.setRequestHeader("If-Modified-Since",Y.lastModified[i]),Y.etag[i]&&S.setRequestHeader("If-None-Match",Y.etag[i])),S.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+(h.dataTypes[0]!=="*"?", "+In+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)S.setRequestHeader(c,h.headers[c]);if(!h.beforeSend||h.beforeSend.call(p,S,h)!==!1&&w!==2){E="abort";for(c in{success:1,error:1,complete:1})S[c](h[c]);u=N(Fn,h,n,S);if(!u)r(-1,"No Transport");else{S.readyState=1,l&&d.trigger("ajaxSend",[S,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){S.abort("timeout")},h.timeout));try{w=1,u.send(y,r)}catch(C){if(!(w<2))throw C;r(-1,C)}}return S}return S.abort()},active:0,lastModified:{},etag:{}});var Rn=[],Un=/\?/,zn=/(=)\?(?=&|$)|\?\?/,Wn=Y.now();Y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rn.pop()||Y.expando+"_"+Wn++;return this[e]=!0,e}}),Y.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&zn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&zn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=Y.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(zn,"$1"+s):h?n.data=a.replace(zn,"$1"+s):l&&(n.url+=(Un.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||Y.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Rn.push(s)),u&&Y.isFunction(o)&&o(u[0]),u=o=t}),"script"}),Y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return Y.globalEval(e),e}}}),Y.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),Y.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=R.head||R.getElementsByTagName("head")[0]||R.documentElement;return{send:function(i,s){n=R.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||s(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Xn,Vn=e.ActiveXObject?function(){for(var e in Xn)Xn[e](0,1)}:!1,$n=0;Y.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&A()||O()}:A,function(e){Y.extend(Y.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(Y.ajaxSettings.xhr()),Y.support.ajax&&Y.ajaxTransport(function(n){if(!n.crossDomain||Y.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=Y.noop,Vn&&delete Xn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(e){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++$n,Vn&&(Xn||(Xn={},Y(e).unload(Vn)),Xn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var Jn,Kn,Qn=/^(?:toggle|show|hide)$/,Gn=new RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Yn=/queueHooks$/,Zn=[H],er={"*":[function(e,t){var n,r,i,s=this.createTween(e,t),o=Gn.exec(t),u=s.cur(),a=+u||0,f=1;if(o){n=+o[2],r=o[3]||(Y.cssNumber[e]?"":"px");if(r!=="px"&&a){a=Y.css(s.elem,e,!0)||n||1;do i=f=f||".5",a/=f,Y.style(s.elem,e,a+r),f=s.cur()/u;while(f!==1&&f!==i)}s.unit=r,s.start=a,s.end=o[1]?a+(o[1]+1)*n:n}return s}]};Y.Animation=Y.extend(D,{tweener:function(e,t){Y.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],er[n]=er[n]||[],er[n].unshift(t)},prefilter:function(e,t){t?Zn.unshift(e):Zn.push(e)}}),Y.Tween=B,B.prototype={constructor:B,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(Y.cssNumber[n]?"":"px")},cur:function(){var e=B.propHooks[this.prop];return e&&e.get?e.get(this):B.propHooks._default.get(this)},run:function(e){var t,n=B.propHooks[this.prop];return this.options.duration?this.pos=t=Y.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):B.propHooks._default.set(this),this}},B.prototype.init.prototype=B.prototype,B.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=Y.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){Y.fx.step[e.prop]?Y.fx.step[e.prop](e):e.elem.style&&(e.elem.style[Y.cssProps[e.prop]]!=null||Y.cssHooks[e.prop])?Y.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Y.each(["toggle","show","hide"],function(e,t){var n=Y.fn[t];Y.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&Y.isFunction(r)&&Y.isFunction(i)?n.apply(this,arguments):this.animate(j(t,!0),r,i,s)}}),Y.fn.extend({fadeTo:function(e,t,n,r){return this.filter(g).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=Y.isEmptyObject(e),s=Y.speed(t,n,r),o=function(){var t=D(this,Y.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=Y.timers,o=Y._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Yn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&Y.dequeue(this,e)})}}),Y.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Y.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Y.speed=function(e,t,n){var r=e&&typeof e=="object"?Y.extend({},e):{complete:n||!n&&t||Y.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Y.isFunction(t)&&t};r.duration=Y.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in Y.fx.speeds?Y.fx.speeds[r.duration]:Y.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){Y.isFunction(r.old)&&r.old.call(this),r.queue&&Y.dequeue(this,r.queue)},r},Y.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Y.timers=[],Y.fx=B.prototype.init,Y.fx.tick=function(){var e,t=Y.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||Y.fx.stop()},Y.fx.timer=function(e){e()&&Y.timers.push(e)&&!Kn&&(Kn=setInterval(Y.fx.tick,Y.fx.interval))},Y.fx.interval=13,Y.fx.stop=function(){clearInterval(Kn),Kn=null},Y.fx.speeds={slow:600,fast:200,_default:400},Y.fx.step={},Y.expr&&Y.expr.filters&&(Y.expr.filters.animated=function(e){return Y.grep(Y.timers,function(t){return e===t.elem}).length});var tr=/^(?:body|html)$/i;Y.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){Y.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f,l,c,h=this[0],p=h&&h.ownerDocument;if(!p)return;return(i=p.body)===h?Y.offset.bodyOffset(h):(r=p.documentElement,Y.contains(r,h)?(n=h.getBoundingClientRect(),s=F(p),o=r.clientTop||i.clientTop||0,u=r.clientLeft||i.clientLeft||0,a=s.pageYOffset||r.scrollTop,f=s.pageXOffset||r.scrollLeft,l=n.top+a-o,c=n.left+f-u,{top:l,left:c}):{top:0,left:0})},Y.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return Y.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(Y.css(e,"marginTop"))||0,n+=parseFloat(Y.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=Y.css(e,"position");r==="static"&&(e.style.position="relative");var i=Y(e),s=i.offset(),o=Y.css(e,"top"),u=Y.css(e,"left"),a=(r==="absolute"||r==="fixed")&&Y.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),Y.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},Y.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=tr.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(Y.css(e,"marginTop"))||0,n.left-=parseFloat(Y.css(e,"marginLeft"))||0,r.top+=parseFloat(Y.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(Y.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||R.body;while(e&&!tr.test(e.nodeName)&&Y.css(e,"position")==="static")e=e.offsetParent;return e||R.body})}}),Y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);Y.fn[e]=function(i){return Y.access(this,function(e,i,s){var o=F(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?Y(o).scrollLeft():s,r?s:Y(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),Y.each({Height:"height",Width:"width"},function(e,n){Y.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){Y.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return Y.access(this,function(n,r,i){var s;return Y.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?Y.css(n,r,i,u):Y.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=Y,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return Y})})(window),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=O(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&O(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;o="undefined"!=typeof exports?exports:e.Backbone={},o.VERSION="0.9.10";var u=e._;!u&&"undefined"!=typeof require&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if("object"==typeof n)for(var i in n)e[t].apply(e,[i,n[i]].concat(r));else{if(!a.test(n))return!0;n=n.split(a),i=0;for(var s=n.length;i<s;i++)e[t].apply(e,[n[i]].concat(r))}},l=function(e,t){var n,r=-1,i=e.length;switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);break;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0]);break;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1]);break;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1],t[2]);break;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},n=o.Events={on:function(e,t,n){return!f(this,"on",e,[t,n])||!t?this:(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this)},once:function(e,t,n){if(!f(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n),this},off:function(e,t,n){var r,i,s,o,a,l,c,h;if(!this._events||!f(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events),a=0;for(l=o.length;a<l;a++)if(e=o[a],r=this._events[e]){s=[];if(t||n){c=0;for(h=r.length;c<h;c++)i=r[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&s.push(i)}this._events[e]=s}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},listenTo:function(e,t,n){var r=this._listeners||(this._listeners={}),i=e._listenerId||(e._listenerId=u.uniqueId("l"));return r[i]=e,e.on(t,"object"==typeof t?this:n,this),this},stopListening:function(e,t,n){var r=this._listeners;if(r){if(e)e.off(t,"object"==typeof t?this:n,this),!t&&!n&&delete r[e._listenerId];else{"object"==typeof t&&(n=this);for(var i in r)r[i].off(t,n,this);this._listeners={}}return this}}};n.bind=n.on,n.unbind=n.off,u.extend(o,n);var c=o.Model=function(e,t){var n,r=e||{};this.cid=u.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};u.extend(c.prototype,n,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,s,o,a,f,l;if(null==e)return this;"object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,o=n.silent,e=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=u.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(l[r],t)||e.push(r),u.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete l[r]:l[r]=t;if(!o){e.length&&(this._pending=!0),t=0;for(r=e.length;t<r;t++)this.trigger("change:"+e[t],this,l[e[t]],n)}if(a)return this;if(!o)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={},n;for(n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes,i;for(i in e)u.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null==e||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){if(!e.set(e.parse(n,r),r))return!1;t&&t(e,n,r)},this.sync("read",this,e)},save:function(e,t,n){var r,i,s=this.attributes;return null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,r&&(!n||!n.wait)&&!this.set(r,n)?!1:(n=u.extend({validate:!0},n),this._validate(r,n)?(r&&n.wait&&(this.attributes=u.extend({},s,r)),void 0===n.parse&&(n.parse=!0),i=n.success,n.success=function(e,t,n){e.attributes=s;var o=e.parse(t,n);n.wait&&(o=u.extend(r||{},o));if(u.isObject(o)&&!e.set(o,n))return!1;i&&i(e,t,n)},e=this.isNew()?"create":n.patch?"patch":"update","patch"===e&&(n.attrs=r),e=this.sync(e,this,n),r&&n.wait&&(this.attributes=s),e):!1)},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(e,t,i){(i.wait||e.isNew())&&r(),n&&n(e,t,i)};if(this.isNew())return e.success(this,null,e),!1;var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||k();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var h=o.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))};u.extend(h.prototype,n,{model:c,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,i,o,a,f,l,c,h,p,d;c=[],h=t.at,p=this.comparator&&null==h&&0!=t.sort,d=u.isString(this.comparator)?this.comparator:null,n=0;for(i=e.length;n<i;n++)(o=this._prepareModel(a=e[n],t))?(f=this.get(o))?t.merge&&(f.set(a===o?o.attributes:a,t),p&&!l&&f.hasChanged(d)&&(l=!0)):(c.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)):this.trigger("invalid",this,a,t);c.length&&(p&&(l=!0),this.length+=c.length,null!=h?s.apply(this.models,[h,0].concat(c)):r.apply(this.models,c)),l&&this.sort({silent:!0});if(t.silent)return this;n=0;for(i=c.length;n<i;n++)(o=c[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;n=0;for(r=e.length;n<r;n++)if(s=this.get(e[n]))delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s);return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]},at:function(e){return this.models[e]},where:function(e){return u.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return u.invoke(this.models,"get",e)},update:function(e,t){t=u.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,r,i,s,o=[],a=[],f={};u.isArray(e)||(e=e?[e]:[]);if(t.add&&!t.remove)return this.add(e,t);r=0;for(i=e.length;r<i;r++)n=e[r],s=this.get(n),t.remove&&s&&(f[s.cid]=!0),(t.add&&!s||t.merge&&s)&&o.push(n);if(t.remove){r=0;for(i=this.models.length;r<i;r++)n=this.models[r],f[n.cid]||a.push(n)}return a.length&&this.remove(a,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){e[r.update?"update":"reset"](n,r),t&&t(e,n,r)},this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof c)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"===e||"remove"===e)&&n!==this||("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)}}),u.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(e){h.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}}),u.each(["groupBy","countBy","sortBy"],function(e){h.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var p=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,m=/\*\w+/g,g=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(p.prototype,n,{initialize:function(){},route:function(e,t,n){return u.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),o.history.route(e,u.bind(function(r){r=this._extractParameters(e,r),n&&n.apply(this,r),this.trigger.apply(this,["route:"+t].concat(r)),this.trigger("route",t,r),o.history.trigger("route",this,t,r)},this)),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(this.routes)for(var e,t=u.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(g,"\\$&").replace(d,"(?:$1)?").replace(v,function(e,t){return t?e:"([^/]+)"}).replace(m,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var y=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},b=/^[#\/]|\s+$/g,w=/^\/+|\/+$/g,E=/msie [\w.]+/,S=/\/$/;y.started=!1,u.extend(y.prototype,n,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(S,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(b,"")},start:function(e){if(y.started)throw Error("Backbone.history has already been started");y.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),e=this.getFragment();var t=document.documentMode,t=E.exec(navigator.userAgent.toLowerCase())&&(!t||7>=t);this.root=("/"+this.root+"/").replace(w,"/"),t&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!t?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e,e=this.location,t=e.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!t)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&t&&e.hash&&(this.fragment=this.getHash().replace(b,""),this.history.replaceState({},document.title,this.root+this.fragment+e.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),y.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe)));if(e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!y.started)return!1;if(!t||!0===t)t={trigger:t};e=this.getFragment(e||"");if(this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){n?(n=e.href.replace(/(javascript:|#).*$/,""),e.replace(n+"#"+t)):e.hash="#"+t}}),o.history=new y;var x=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},T=/^(\S+)\s*(.*)$/,N="model collection el id attributes className tagName events".split(" ");u.extend(x.prototype,n,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=u.result(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)throw Error('Method "'+e[t]+'" does not exist');var r=t.match(T),i=r[1],r=r[2],n=u.bind(n,this),i=i+(".delegateEvents"+this.cid);""===r?this.$el.on(i,n):this.$el.on(i,r,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,N)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className")),e=o.$("<"+u.result(this,"tagName")+">").attr(e),this.setElement(e,!1)}}});var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.sync=function(e,t,n){var r=C[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||k()),null==n.data&&t&&("create"===e||"update"===e||"patch"===e)&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}"GET"!==i.type&&!n.emulateJSON&&(i.processData=!1);var a=n.success;n.success=function(e){a&&a(t,e,n),t.trigger("sync",t,e,n)};var f=n.error;return n.error=function(e){f&&f(t,e,n),t.trigger("error",t,e,n)},e=n.xhr=o.ajax(u.extend(i,n)),t.trigger("request",t,e,n),e},o.ajax=function(){return o.$.ajax.apply(o.$,arguments)},c.extend=h.extend=p.extend=x.extend=y.extend=function(e,t){var n=this,r;r=e&&u.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};var k=function(){throw Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),!function(e){e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1).focus(),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})})}(window.jQuery),!function(e){function t(){n(e(r)).removeClass("open")}function n(t){var n=t.attr("data-target"),r;return n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),r=e(n),r.length||(r=t.parent()),r}var r="[data-toggle=dropdown]",i=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(r){var i=e(this),s,o;if(i.is(".disabled, :disabled"))return;return s=n(i),o=s.hasClass("open"),t(),o||(s.toggleClass("open"),i.focus()),!1},keydown:function(t){var r,i,s,o,u,f;if(!/(38|40|27)/.test(t.keyCode))return;r=e(this),t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;o=n(r),u=o.hasClass("open");if(!u||u&&t.keyCode==27)return r.click();i=e("[role=menu] li:not(.divider) a",o);if(!i.length)return;f=i.index(i.filter(":focus")),t.keyCode==38&&f>0&&f--,t.keyCode==40&&f<i.length-1&&f++,~f||(f=0),i.eq(f).focus()}},e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("dropdown");r||n.data("dropdown",r=new i(this)),typeof t=="string"&&r[t].call(n)})},e.fn.dropdown.Constructor=i,e(function(){e("html").on("click.dropdown.data-api touchstart.dropdown.data-api",t),e("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",r,i.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",r+", [role=menu]",i.prototype.keydown)})}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&r.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var s=n.find("> .active"),o=r&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,i):i(),s.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){r.off(e.support.transition.end).remove()},500);r.one(e.support.transition.end,function(){clearTimeout(t),r.remove()})}var n=this,r=this.tip();return r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():r.remove(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery),!function(e){var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",f;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),f=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===f)return;this.affixed=f,this.unpin=f=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(f?"-"+f:""))},e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery),!function(e){var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){s.trigger("closed").remove()}var r=e(this),i=r.attr("data-target"),s;i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),s=e(i),t&&t.preventDefault(),s.length||(s=r.hasClass("alert")?r:r.parent()),s.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.on(e.support.transition.end,n):n()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".item.active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle()),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",f=this,l=e.Event("slide",{relatedTarget:i[0]});this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(l);if(l.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),f.sliding=!1,setTimeout(function(){f.$element.trigger("slid")},0)})}else{this.$element.trigger(l);if(l.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery),define("bootstrap",["jquery"],function(){}),function(e,t,n){var r,i,s,o,u;o={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null},r="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,i=null,u=function(){var e,t;return e=n.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow="scroll",t.top="-9999px",n.body.appendChild(e),t=e.offsetWidth-e.clientWidth,n.body.removeChild(e),t},s=function(){function s(r,s){this.el=r,this.options=s,i||(i=u()),this.$el=e(this.el),this.doc=e(n),this.win=e(t),this.generate(),this.createEvents(),this.addEvents(),this.reset()}return s.prototype.preventScrolling=function(e,t){this.isActive&&("DOMMouseScroll"===e.type?("down"===t&&0<e.originalEvent.detail||"up"===t&&0>e.originalEvent.detail)&&e.preventDefault():"mousewheel"===e.type&&e.originalEvent&&e.originalEvent.wheelDelta&&("down"===t&&0>e.originalEvent.wheelDelta||"up"===t&&0<e.originalEvent.wheelDelta)&&e.preventDefault())},s.prototype.updateScrollValues=function(){var e;e=this.content[0],this.maxScrollTop=e.scrollHeight-e.clientHeight,this.contentScrollTop=e.scrollTop,this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop},s.prototype.createEvents=function(){var e=this;this.events={down:function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.pane.addClass("active"),e.doc.bind("mousemove",e.events.drag).bind("mouseup",e.events.up),!1},drag:function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scroll(),e.updateScrollValues(),e.contentScrollTop>=e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&e.$el.trigger("scrolltop"),!1},up:function(){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind("mousemove",e.events.drag).unbind("mouseup",e.events.up),!1},resize:function(){e.reset()},panedown:function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1},scroll:function(t){e.isBeingDragged||(e.updateScrollValues(),e.sliderY=e.sliderTop,e.slider.css({top:e.sliderTop}),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,"down"),e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,"up"),e.$el.trigger("scrolltop"))))},wheel:function(t){if(null!=t)return e.sliderY+=-t.wheelDeltaY||-t.delta,e.scroll(),!1}}},s.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind("resize",e.resize),this.slider.bind("mousedown",e.down),this.pane.bind("mousedown",e.panedown).bind("mousewheel DOMMouseScroll",e.wheel),this.content.bind("scroll mousewheel DOMMouseScroll touchmove",e.scroll)},s.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind("resize",e.resize),this.slider.unbind(),this.pane.unbind(),this.content.unbind("scroll mousewheel DOMMouseScroll touchmove",e.scroll).unbind("keydown",e.keydown).unbind("keyup",e.keyup)},s.prototype.generate=function(){var e,t,n,r,s;return n=this.options,r=n.paneClass,s=n.sliderClass,e=n.contentClass,!this.$el.find(""+r).length&&!this.$el.find(""+s).length&&this.$el.append('<div class="'+r+'"><div class="'+s+'" /></div>'),this.content=this.$el.children("."+e),this.content.attr("tabindex",0),this.slider=this.$el.find("."+s),this.pane=this.$el.find("."+r),i&&(t={right:-i},this.$el.addClass("has-scrollbar")),n.iOSNativeScrolling&&(null==t&&(t={}),t.WebkitOverflowScrolling="touch"),null!=t&&this.content.css(t),n.alwaysVisible&&this.pane.css({opacity:1,visibility:"visible"}),this},s.prototype.restore=function(){return this.stopped=!1,this.pane.show(),this.addEvents()},s.prototype.reset=function(){var e,t,n,s,o,u,a;return this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content[0],n=e.style,s=n.overflowY,r&&this.content.css({height:this.content.height()}),t=e.scrollHeight+i,u=this.pane.outerHeight(),a=parseInt(this.pane.css("top"),10),o=parseInt(this.pane.css("bottom"),10),o=u+a+o,a=Math.round(o/t*o),a<this.options.sliderMinHeight?a=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&a>this.options.sliderMaxHeight&&(a=this.options.sliderMaxHeight),"scroll"===s&&"scroll"!==n.overflowX&&(a+=i),this.maxSliderTop=o-a,this.contentHeight=t,this.paneHeight=u,this.paneOuterHeight=o,this.sliderHeight=a,this.slider.height(a),this.events.scroll(),this.pane.show(),this.isActive=!0,this.pane.outerHeight(!0)>=e.scrollHeight&&"scroll"!==s?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&"scroll"===s?this.slider.hide():this.slider.show(),this},s.prototype.scroll=function(){return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.content.scrollTop(-1*((this.paneHeight-this.contentHeight+i)*this.sliderY/this.maxSliderTop)),this.slider.css({top:this.sliderY}),this},s.prototype.scrollBottom=function(e){return this.reset(),this.content.scrollTop(this.contentHeight-this.content.height()-e).trigger("mousewheel"),this},s.prototype.scrollTop=function(e){return this.reset(),this.content.scrollTop(+e).trigger("mousewheel"),this},s.prototype.scrollTo=function(t){return this.reset(),t=e(t).offset().top,t>this.maxSliderTop&&(t/=this.contentHeight,this.sliderY=t*=this.maxSliderTop,this.scroll()),this},s.prototype.stop=function(){return this.stopped=!0,this.removeEvents(),this.pane.hide(),this},s.prototype.flash=function(){var e=this;return this.pane.addClass("flashed"),setTimeout(function(){e.pane.removeClass("flashed")},this.options.flashDelay),this},s}(),e.fn.nanoScroller=function(t){return this.each(function(){var n;(n=this.nanoscroller)||(n=e.extend({},o),t&&"object"==typeof t&&(n=e.extend(n,t)),this.nanoscroller=n=new s(this,n));if(t&&"object"==typeof t){e.extend(n.options,t);if(t.scrollBottom)return n.scrollBottom(t.scrollBottom);if(t.scrollTop)return n.scrollTop(t.scrollTop);if(t.scrollTo)return n.scrollTo(t.scrollTo);if("bottom"===t.scroll)return n.scrollBottom(0);if("top"===t.scroll)return n.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return n.scrollTo(t.scroll);if(t.stop)return n.stop();if(t.flash)return n.flash()}return n.reset()})}}(jQuery,window,document),define("jquery.nanoscroller",["jquery"],function(){}),!function(e){var t=function(t,n){this.$element=e(t),this.options=n,this.init()};t.prototype={init:function(){_.bindAll(this)},_animate_loading:function(){if(!this.loading.is(":visible")){clearInterval(this.loadingTimer);return}e("div",this.loading).css("top",this.loadingFrame*-40+"px"),this.loadingFrame=(this.loadingFrame+1)%12},load:function(){this.loadingTimer=this.loadingFrame=1,this.$element.append(this.loading=e('<div id="jswait-loading" style="display:none;"><div></div></div>'),this.overlay=e('<div id="jswait-overlay" class="mask hide"></div>')),this.options.modal&&overlay.addClass("ui-widget-overlay"),clearInterval(this.loadingTimer),this.loading.show(),this.loadingTimer=setInterval(this._animate_loading,66),this.waited=!0},close:function(){this.waited&&(this.loading.remove(),this.overlay.remove(),this.loadingFrame=1,clearInterval(this.loadingTimer),this.waited=!1)}},e.fn.jswait=function(n){return this.each(function(){var r=e(this),i=r.data("jswait"),s=e.extend({},e.fn.jswait.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:null;i||r.data("jswait",i=new t(this,s)),o?i[o]():i.load()})},e.fn.jswait.defaults={modal:!1},e.fn.jswait.Constructor=t}(window.jQuery),define("jswait",["jquery"],function(){});var garry_jqwait={type:"icon",mask:"transparent",preventhandle:!0,beforestart:function(){},end:function(){},interval:1e3,derectives:[],derectivechecklist:[],id:"",singlewait:!0,start:function(){jqwait_available&&(jqwait_available=!1,args.mask||(args.mask="transparent"),args.type||(args.type="icon"),showmask(args.mask),preventhandle(),jqwait_args=args,jqwait_showpopup(args.type),args.start&&args.start(),jqwaitid=setInterval(jqwait_check,1e3))},init:function(){}},derectives=[],derectivechecklist=[],jqwaitid,jqwait_args,jqwait_available=!0,loading,loadingTimer,loadingFrame=1,jqwait_on=!1;_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return}$("div",loading).css("top",loadingFrame*-40+"px"),loadingFrame=(loadingFrame+1)%12},define("jqwait",function(){}),function(){typeof global=="undefined"&&(global={}),typeof jqwait_on=="undefined"&&(jqwait_on=null),global.html={load:function(e,t,n){if(global.debug||n)e+="?debug=1";var r=$.ajax({url:e,type:"GET",data:"",success:function(e){$(document).trigger("server_ok"),t(e,e.code)},error:function(e){console.info(e),global.message("error","服务器请求未应答"),$(document).trigger("server_error"),jqwait_on&&jqwait_simple_close()}});return r}},global.json={load:function(e,t,n){if(global.debug||n)e+="?debug=1";var r=$.ajax({url:e,type:"GET",data:"",dataType:"JSON",success:function(e){$(document).trigger("server_ok"),t(e,e.code)},error:function(){global.message("error","服务器请求未应答"),$(document).trigger("server_error"),jqwait_on&&jqwait_simple_close()}});return r},post:function(e,t,n){$.ajax({url:e,type:"POST",data:t,dataType:"JSON",success:function(e){var t=e.code;$(document).trigger("server_ok"),n(e,e.code)},error:function(){global.message("error","服务器请求未应答"),$(document).trigger("server_error"),jqwait_on&&jqwait_simple_close()}})}},global.model={getIds:function(e){var t=[];return t=e.icollection.pluck("id"),e.icollection.each(function(e){t=_.union(t,global.model.getIds(e))}),t},getModelList:function(e,t){t.icollection.each(function(n){global.model.getModelList(e,n),e.add(t)})},getModelTreeByIdsTree:function(e,t){return _.each(t,function(t){t.id&&t.id!=""?t.model=global.model.getModelById(e,t.id):t.model=null,t.children=global.model.getModelTreeByIdsTree(e,t.children)}),t},getModelById:function(e,t){var n=null;return e.icollection.each(function(e){e.id==t&&(n=e);var r=global.model.getModelById(e,t);r&&(n=r)}),n},getRootModel:function(e){return e.Root},getModelCollectionById:function(e,t){var n=null;return e.icollection.get(t)?e.icollection:(e.icollection.each(function(e){var r=global.model.getModelCollectionById(e,t);r&&(n=r)}),n)},collection2model:function(e,t){var n=[];return e.icollection.length>0&&e.icollection.each(function(e){var t={};t=_.clone(e.toJSON()),n.push(t)}),n},tree2model:function(e,t,n){var r=[];return e.icollection.each(function(e){var i={};i=_.clone(e.toJSON()),i[t]=global.model.tree2model(e,n,n),r.push(i)}),r},model2collection:function(e,t){e.has(t)&&e.icollection.add(e.get(t))},model2tree:function(e,t,n){e.has(t)&&(e.icollection.add(e.get(t)),e.icollection.each(function(e){e.has(n)&&global.model.model2tree(e,n,n)}))},save:function(model,attributes,callback){attributes||(attributes=null),model.save(attributes,{wait:!0,success:function(m,response){$(".action-save").length>0&&$(".action-save").button("reset"),returned=eval(response),jqwait_on&&jqwait_simple_close(),callback(response)},error:function(){$(".action-save").button("reset"),global.message("error","服务器请求未应答"),$(document).trigger("server_error"),jqwait_on&&jqwait_simple_close()}})},saveall:function(e,t){},sort:function(e,t){e.icollection.reset(_.map(t,function(t){return e.icollection.get(t)}),{silent:!0})},sort_tree:function(e,t,n){if(n.length>0){for(i in n){var r=n[i].id;global.model.sort_tree(e,n[i].model,n[i].children)}t.icollection.reset(_.pluck(n,"model"),{silent:!0})}},remove:function(model,ids,callback){_.each(ids,function(id){var m=global.model.getModelById(model,id);m.destroy({wait:!0,success:function(m,response){returned=eval(response),callback(response)},error:function(){global.message("error","服务器请求未应答"),$(document).trigger("server_error"),jqwait_on&&jqwait_simple_close()}})})},translate:function(e){var t=[],n=_.clone(e.attributes);return e.translate&&(t=e.translate),_.each(t,function(e){n[e]=global.dict.query(n[e])}),n},replace:function(e,t,n){if(n)_.each(n,function(n){e.set(n,t.get(n))});else{var r=t.toJSON();delete r.id,e.set(r)}},copy:function(e,t,n,r){_.each(n,function(n){var i=global.model.getModelById(e,n);model_data=_.clone(i.toJSON()),r||(model_data.id=global.getUniqueId(t,t.Root.id+"_",null)),t.icollection.add(model_data)})},copy_tree:function(e,t,n,r){_.each(n,function(n){if(n.id&&n.id!=""){var i=global.model.getModelById(e,n.id),s=_.clone(i.toJSON());r||(s.id=global.getUniqueId(t,t.Root.id+"_",null)),t.icollection.add(s),global.model.copy_tree(e,t.icollection.get(s.id),n.children,r)}else global.model.copy_tree(e,t,n.children,r)})}}}(),define("global/data",["jquery","backbone","bootstrap"],function(){}),function(){typeof global=="undefined"&&(global={},global.template={}),global.template=$.extend({},global.template,{modal:_.template(['<div class="modal hide <%=type%>" id=<%=name%> tabindex="-1" role="dialog" aria-labelledby="<%=name%>Label" data-backdrop=false aria-hidden="true">',"<%if(options.header){%>",'	<div class="modal-header">','							<button class="close" aria-hidden="true" data-dismiss="modal" type="button">×</button>',"	</div>","<%}%>","<%if(options.body){%>",'	<div class="modal-body">',"	</div>","<%}%>","<%if(options.footer){%>",'	<div class="modal-footer">',"	</div>","<%}%>","</div>"].join("")),modal_preview:_.template(['			<div class="modal hide large-modal preview-modal" id=<%=name%> tabindex="-1" role="dialog" aria-labelledby="previewLabel" aria-hidden="true">',"			</div>"].join("")),list:_.template(['	      <div class="left-column">','	        <div class="column-hd">',"	          <h3>分类目录</h3>","	        </div>",'	        <div class="column-bd nanoscrollbar">','	          <div class="categories list-tree" id="contentstree">',"	            <ul>",'	              <li class="active">','					<div class="wraparea">','	                	<h4><a href="#">所有</a></h4>',"					</div>","	              </li>",'	              <li id="owner">','					<div class="wraparea">','	                <h4><a href="#">我的内容</a></h4>',"					</div>","	              </li>",'	              <li id="unset">','					<div class="wraparea">','	                <h4><a href="#">未分类</a></h4>',"					</div>","	              </li>","				</ul>","	          </div>","	        </div>","	      </div>",'	      <div class="right-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="hascheckbox units hascover list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_chapter:_.template(['	      <div class="left-column">','	        <div class="column-hd">',"	          <h3>目录</h3>","	        </div>",'	        <div class="column-bd nanoscrollbar">','	          <div class="categories list-tree" id="contentstree">',"	            <ul>","				</ul>","	          </div>","	        </div>","	      </div>",'	      <div class="right-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="hascheckbox units hascover list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_project:_.template(['	      <div class="left-column">','	        <div class="column-hd">',"	          <h3>项目列表</h3>","	        </div>",'	        <div class="column-bd nanoscrollbar">','	          <div class="categories list-tree" id="project">',"	            <ul>","				</ul>","	          </div>","	        </div>","	      </div>",'	      <div class="right-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="hascheckbox nocover list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_single:_.template(['	      <div class="main-column">','	        <div class="column-hd list-menu">',"	        </div>",'        <div class="column-bd nanoscrollbar">','	          <div class="categories list-content">',"	            <ul>","				</ul>","	          </div>","			</div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_single_1:_.template(['	      <div class="main-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="hascheckbox hascover units list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_single_1_nocover:_.template(['	      <div class="main-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="hascheckbox nocover units list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_single_1_nocheckbox:_.template(['	      <div class="main-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar list-content">','	          <table cellspacing="0" class="list">',"	            <tbody>","	            </tbody>","	          </table>","	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_2:_.template(['	      <div class="left-column">','	        <div class="column-hd">',"	          <h3>分类目录</h3>","	        </div>",'	        <div class="column-bd nanoscrollbar">','	          <div class="categories list-tree" id="contentstree">',"	            <ul>",'	              <li class="active">','					<div class="wraparea">','	                	<h4><a href="#">所有</a></h4>',"					</div>","	              </li>","				</ul>","	          </div>","	        </div>","	      </div>",'	      <div class="right-column">','	        <div class="column-hd list-menu">',"	        </div>",'	        <div class="column-bd nanoscrollbar">',' 		         <div class="categories list-content"></div>',"	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_3:_.template(['	      <div class="left-column">','	        <div class="column-hd">',"	          <h3>分类目录</h3>","	        </div>",'	        <div class="column-bd nanoscrollbar">','	          <div class="categories list-tree" id="contentstree">',"	            <ul>",'	              <li class="active">','					<div class="wraparea">','	                	<h4><a href="#">所有</a></h4>',"					</div>","	              </li>","				</ul>","	          </div>","	        </div>","	      </div>",'	      <div class="right-column">','			<div class="column-hd list-menu">',"        		<h3>内容分类</h3>",'      			 <div style="position:absolute; top:8px; right:30px; font-size:12px; line-height:20px;">','         		<input type="checkbox" value="checked_children">',"         		勾选子分类</div>","     		</div>",'	        <div class="column-bd nanoscrollbar">',' 		         <div class="categories list-content"></div>',"	        </div>",'	        <div class="column-ft list-page">',"	        </div>","	      </div>"].join("")),list_left:_.template(["	<ul>",'	              <li class="active">','	                <h4><a href="#">所有</a></h4>',"	              </li>",'	              <li id="owner">','	                <h4><a href="#">我的内容</a></h4>',"	              </li>",'	              <li id="unset">','	                <h4><a href="#">未分类</a></h4>',"	              </li>","				</ul>"].join("")),list_menu:_.template(['	          <table cellspacing="0" class="hascheckbox  units hascover list">',"	            <thead>","	              <tr>",'	                <th scope="col" width="5%"><input type="checkbox" value="selectall"></th>','	                <th scope="col" colspan="2">标题</th>','	                <th scope="col" width="12%">创建时间</th>',"	              </tr>","	            </thead>","	          </table>"].join("")),list_menu1:_.template(['	          <table cellspacing="0" class="hascheckbox list">',"	            <thead>","	              <tr>",'	                <th scope="col" width="5%"></th>','	                <th scope="col" colspan="2">标题</th>',"	              </tr>","	            </thead>","	          </table>"].join("")),ref_menu:_.template(['	          <table cellspacing="0" class="hascheckbox list">',"	            <thead>","	              <tr>",'	                <th scope="col" width="5%"><input type="checkbox" value="selectall"></th>','	                <th scope="col" colspan="2">标题</th>',"	              </tr>","	            </thead>","	          </table>"].join("")),update_menu:_.template(['	          <table cellspacing="0" class="hascheckbox list">',"	            <thead>","	              <tr>",'	                <th scope="col" width="5%"><input type="checkbox" value="selectall"></th>','	                <th scope="col" colspan="2">标题</th>','	                <th scope="col" width="12%">引用版本</th>','	                <th scope="col" width="12%">最新版本</th>',"	              </tr>","	            </thead>","	          </table>"].join("")),list_page:_.template(['	          <div class="pagination pagination-centered">',"	            <ul>","				 <% var startpage=global.get_page(page,numpages,10).start; var endpage=global.get_page(page,numpages,10).end; %>",'	              <li <% var left=(page!=1&&numpages>1)?"":"class=disabled";%><%=left%>><a class="first" href="#">«</a></li>','	              <li <% var left=(page!=1&&numpages>1)?"":"class=disabled";%><%=left%>><a class="prev" href="#">‹</a></li>',"				<% for(i=startpage;i<=endpage;i++){ %>",'					<li <% var current=(i==page)?"class=active":""; %><%=current%>><a class="page" href="#"><%=i%></a></li>',"				<% } %>",'	              <li <% var right=(page!=numpages&&numpages>0)?"":"class=disabled";%><%=right%>><a class="next" href="#">›</a></li>','	              <li <% var right=(page!=numpages&&numpages>0)?"":"class=disabled";%><%=right%>><a class="last" href="#">»</a></li>',"	            </ul>","	          </div>"].join("")),msg:_.template(['  			<div class="status <%=type%>">',"   			 <p><%=global.dict.query(msg)%></p>",'   		<a href="#" class="close">Close</a></div>'].join("")),preview:_.template(['	  <div class="modal-header">','	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>',"	    <h3><%=title%></h3>",'	    <!--<div class="pages">1/7</div>-->',"	  </div>",'	  <div class="modal-body">','	    <div class="preview-content"><%=preview%></div>',"	  </div>"].join("")),base_info:_.template(['    <div class="mod info-mod baseinfo" data-id="base_info" id="<%=id%>">','      <div class="mod-hd">基本信息</div>','      <div class="mod-bd">',"        <dl>","          <!--<dt>预览图</dt>-->","          <dd>",'            <div class="cover"><img src="<%=thumbnail%>" alt=""></div>',"          </dd>","        </dl>",'        <dl class="inputform">',"          <dt>标题</dt>","          <dd>",'            <p style="display: block;"><%=title%></p>',"        </dl>",'        <dl class="inputform">',"          <dt>作者</dt>","          <dd>",'            <p class="empty" style="display: block;"><%=author%></p>',"        </dl>",'        <dl class="textareaform">',"          <dt>描述</dt>","          <dd>","            <p><%=description%></p>","        </dl>","      </div>","    </div>"].join("")),text_form:_.template(['	   	<% if(type=="text"){ %>','			<div class="editform" style="display: block;">','           <form onsubmit="javascript:return false;">','				<input name=<%=id%> type="text" style="width:234px;" value="<%= (text=="点击添加内容")?"":text%>" >',"				<div>",'					<button class="btn btn-small btn-confirm btn-primary action-save" type="submit">确认</button>','					<button class="btn btn-small action-cancel" style="margin-left:10px;" type="button">取消</button>',"				</div>","            </form>","			</div>","		<% } else { %>",'			<div class="editform" style="display: block;">','           <form onsubmit="javascript:return false;">','				<textarea name=<%=id%> style="width:234px;"><%=(text=="点击添加内容"?"":text)%></textarea>',"				<div>",'					<button class="btn btn-small btn-primary action-save" type="button">确认</button>','					<button class="btn btn-small action-cancel" style="margin-left:10px;" type="button">取消</button>',"				</div>","            </form>","			</div>","		<% } %>"].join("")),operate_modal:_.template(['		  <div class="modal-header">','		    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>',"		    <h3><%=title%></h3>","		  </div>",'		  	<div class="modal-body">','		    <form class="form-horizontal">','      <div class="control-group">','        <label class="control-label" for="name" style="width:70px;">标题：</label>','        <div class="controls" style="margin-left:80px;">','          <input type="text" id="name" value="<%=name%>" disabled style="width:300px; margin-right:10px;">','          <input type="hidden" id="transition" value="<%=transition%>">','          <input type="hidden" id="objectid" value="<%=id%>">',"        </div>","      </div>",'      <div class="control-group" style="margin-bottom:0;">','        <label class="control-label" for="chapterCode" style="width:70px;">说明：</label>','        <div class="controls" style="margin-left:80px;">','          <textarea id="comment" rows="4" style="width:300px;"></textarea>',"        </div>","      </div>","		    </form>","			</div>",'		  <div class="modal-footer">','		    <button class="btn btn-primary btn-confirm">确定</button>',"		  </div>"].join("")),confirm:_.template(['		  <div class="modal-header">','		    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>',"		    <h3>确认框</h3>","		  </div>",'		  <div class="modal-body"> <span style="font-size:14px;"><%=msg%></span></div>','		  <div class="modal-footer">','		    <button class="btn btn-primary btn-confirm">确定</button>','		    <button aria-hidden="true" data-dismiss="modal" style="margin-left:20px;" class="btn btn-cancel">取消</button>',"		  </div>"].join(""))}),$("body").append(global.template.modal({name:"confirmModal",type:"small-modal",options:{}}))}(),define("global/template",["jquery","backbone","bootstrap"],function(){});var iCurrentModel=null,iAppModel=Backbone.Model.extend({defaults:{},initialize:function(){this.el=this.get("el"),this.wrap=this.get("wrap"),this.template=this.get("template"),this.unset("el"),this.unset("wrap"),this.unset("template"),this.collection?this.Root=this.collection.parentmodel.Root:this.Root=this,this.el=this.Root.el,this.wrap=this.Root.wrap,this.template=this.Root.template,this.setcollection(),this.setview(),this.setcollectionparentmodel()},setcollection:function(e){this.icollection=new iAppCollection},setcollectionparentmodel:function(){this.icollection.parentmodel=this},seturl:function(e){},setview:function(){this.iview=new iAppView({model:this})},setsync:function(e){return!1},removeeffect:!0,url:"",sync:function(e,t,n){n.url=this.seturl(e),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,this.setsync()&&Backbone.sync(e,t,n)},reseturl:function(){}}),iAppCollection=Backbone.Collection.extend({model:iAppModel,initialize:function(){},setonreset:function(){this.on("reset",function(e){$(this.parentmodel.el).empty()})},setoffadd:function(){this.off("add")},setonadd:function(){this.on("add",function(e){el=global.model.getRootModel(e).el,wrap=global.model.getRootModel(e).wrap;var t=e.attributes;template=global.model.getRootModel(e).template;var n="";typeof template=="function"?n=template(t):typeof template=="string"&&(n=_.template(template,t));var r=$(el);if(wrap){if(!(r.children(wrap).length>0)){var i=document.createElement(wrap);r.append(i)}$(el).children(wrap).append(n)}else $(el).append(n);e.iview.setElement($(el).find('[id="'+e.id+'"]'))})},setonaddtree:function(){this.on("add",function(e){el=e.Root.el,wrap=e.Root.wrap,template=e.Root.template;var t=e.attributes,n="";typeof template=="function"?n=template(t):typeof template=="string"&&(n=_.template(template,t));if(this.parentmodel.id!=e.Root.id)var r=this.parentmodel,i=$(el).find('[id="'+r.id+'"]');else var i=$(e.Root.el);if(wrap)if(i.children(wrap).length>0)i.children(wrap).append(n);else{var s=document.createElement(wrap);i.append(s),i.children(wrap).append(n)}else i.append(n);e.iview.setElement(i.find('[id="'+e.id+'"]'))})},setonremove:function(){var e=this;this.on("remove",function(t){t.Root.current==t.id&&$(".ui-layout-right").empty(),t.removeeffect?($(e.parentmodel.el).find('[id="'+t.id+'"]').addClass("updating"),$(e.parentmodel.el).find('[id="'+t.id+'"]').fadeOut(1e3,function(){$(e.parentmodel.el).find('[id="'+t.id+'"]').remove()})):$(e.parentmodel.el).find('[id="'+t.id+'"]').remove()})},otherset:function(){},setsync:function(e){return!1},url:"",reseturl:function(){},sync:function(e,t,n){this.reseturl(),e=="read"&&(n.url=hosturl+this.url+"overlayinit.json"),this.setsync(type)&&Backbone.sync(e,t,n)},reseturl:function(){}}),iAppElementCollection=Backbone.Collection.extend({initialize:function(){},onRemove:function(){this.on("remove",function(){})}}),iAppView=Backbone.View.extend({initialize:function(e){_.bindAll(this)},bind_remove:function(){},bind_update:function(){},render_model:function(e){e||(e=this.model.template);var t="";return typeof e=="function"?t=e(this.model.toJSON()):typeof e=="string"&&(t=_.template(e,this.model.toJSON())),t},render_collection:function(e){e||(e=this.model.template),this.model.icollection.each(function(t){var n=$(t.Root.el);if(t.Root.wrap){var r=t.Root.wrap;if(n.children(r).length>0)n.children(r).append(e(t.attributes));else{var i=document.createElement(r);n.append(i),n.children(r).append(e(t.attributes))}}else n.append(e(t.attributes))})},render_tree:function(e){e||(e=this.model.template);var t=this.model;this.model.icollection.each(function(n){if(t.id!=t.Root.id)var r=t,i=$(r.el).find('[id="'+r.id+'"]');else var i=$(n.Root.el);if(n.Root.wrap){var s=n.Root.wrap;if(i.children(s).length>0)i.children(s).append(e(n.attributes));else{var o=document.createElement(s);i.append(o),i.children(s).append(e(n.attributes))}}else i.append(e(n.attributes));n.iview.render_tree(e)})},return_tree:function(e){e||(e=this.model.template);var t="";typeof e=="function"?t=e(this.model.toJSON()):typeof e=="string"&&(t=_.template(e,this.model.toJSON()));var n="",r,i;n=t;if(this.model.icollection.length>0){r=i=$(n);if(this.model.wrap){var s=document.createElement(this.model.wrap);r.append(s.outerHTML),i=r.children(this.model.wrap)}this.model.icollection.each(function(t){var n=t.iview.return_tree(e);i.append(n)}),n=r[0].outerHTML}return n},update:function(){if(this.model.id!=this.model.Root.id){$(this.model.Root.el).find('[id="'+this.model.id+'"]').replaceWith(this.render_model()),$(this.model.Root.el).find('[id="'+this.model.id+'"]').addClass("updating");var e=$(this.model.Root.el).find('[id="'+this.model.id+'"]');t2=setTimeout(function(){e.removeClass("updating")},1e3)}},update_tree:function(){if(this.model.id!=this.model.Root.id){var e=!1,t=!1;$(this.model.Root.el).find('[id="'+this.model.id+'"]').hasClass("hasmenu")&&(e=!0),$(this.model.Root.el).find('[id="'+this.model.id+'"]').hasClass("unfold")&&(t=!0),$(this.model.Root.el).find('[id="'+this.model.id+'"]').replaceWith(this.return_tree()),e&&$(this.model.Root.el).find('[id="'+this.model.id+'"]').addClass("hasmenu unfold"),$(this.model.Root.el).find('[id="'+this.model.id+'"]').addClass("updating");var n=$(this.model.Root.el).find('[id="'+this.model.id+'"]');t2=setTimeout(function(){n.removeClass("updating")},1e3)}},update_el:function(e){this.model.el=e,this.model.icollection.each(function(t){t.iview.update_el(e)})},update_wrap:function(e){this.model.wrap=e,this.model.icollection.each(function(t){t.iview.update_wrap(e)})},template:""}),AppElements=new iAppElementCollection,GlobalModelForSave=Backbone.Model.extend({initialize:function(){this.set("id","GlobalSave")},sync:function(e,t,n){var r=this.list.toJSON();this.attributes=r;if(e=="create")return;e=="update"&&(n.url=this.url);if(e=="delete")return;if(e=="read")return;Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}});define("global/model",["jquery","backbone","bootstrap"],function(){}),function(){function e(e,t){$(e).live("click",t)}function t(e,t,n){$(e).live("mouseover mouseout",function(e){e.type=="mouseover"?t(e):n(e)})}typeof global=="undefined"&&(global={}),global.event={init:function(){this.onSave(),this.onActionHover(),this.onListContentClick(),this.onAdminBarAction(),this.onPreview(),this.onListPreview(),this.onListWorkflow(),this.onInteraction(),this.onCollapsebarClick()},onSave:function(){e("a.action-save,button.action-save",function(){var e=$(this);$(this).button("loading"),global.actionsave&&global.actionsave(function(){e.button("reset")})})},onActionHover:function(){$(".action-new").live("mouseover mouseout",function(e){e.type=="mouseover"?$(e.currentTarget).children("ul").show():$(e.currentTarget).children("ul").hide()})},onListContentClick:function(){$(".ui-layout-center-bd .list-content .content-item h4").live("click",function(e,t){$(".ui-layout-center-bd .list-content .content-item").removeClass("active"),$(this).parents(".content-item").first().addClass("active")}),$(".modal .list-content tr.content-item").live("click",function(e,t){$(".modal .list-content tr.content-item").removeClass("active"),$(this).addClass("active")}),$(".ui-layout-center-bd .list-content tr.content-item").live("click",function(e,t){$(".ui-layout-center-bd .list-content tr.content-item").removeClass("active"),$(this).addClass("active")}),e(".ui-layout",function(e){global.switch&&global.switch.rightpanelclear&&$(e.target).is($(".ui-layout"))&&($(".ui-layout-center-bd .list-content .content-item").removeClass("active"),$(".ui-layout-center-bd .list-content tr.content-item").removeClass("active"),$(".ui-layout-right").empty())})},onAdminBarAction:function(){t(".adminbar .menu-mod",function(e){$(e.currentTarget).children(".adminbar .menu-bd").show()},function(e){$(e.currentTarget).children(".adminbar .menu-bd").hide()}),t(".adminbar .menu-bd li",function(e){$(e.currentTarget).children("ul").show()},function(e){$(e.currentTarget).children("ul").hide()})},onPreview:function(){e(".ui-layout-center-hd .action-preview",function(){var e=context_url,t=context_type;return global.change?global.confirmPreview(function(){$(".ui-layout-center-hd .action-save").trigger("click",function(){global.change=!1,global.preview(e,t)})}):global.preview(e,t),!1})},onInteraction:function(){e(".action-interaction",function(){return global.change?global.confirmModal("请先保存再进行交互设定?",function(){$(".ui-layout-center-hd .action-save").trigger("click",function(){global.change=!1,window.open(context_url+"interaction")})}):window.open(context_url+"interaction"),!1})},onListPreview:function(){e(".list-preview",function(){var e=$(this).attr("href"),t=$(this).parents(".content-item").first().attr("data-type");return global.listpreview(e,t),!1})},onListWorkflow:function(){e(".list-retract",function(e){var t=$(this).attr("href"),n=$(this).attr("id"),e="transition="+n+"&comment=";return global.confirmModal("将收回当前发布内容，继续请点击'确定'按钮",function(){global.json.post(t+"/operatestate.json",e,function(e){e.code==200?afterworkflow&&afterworkflow(e):global.throwerror(e.msg)})}),!1}),e("div.action a.workflow",function(e){if($(this).attr("class").indexOf("retract")>0)return!1;var t=$(this).attr("href"),n=$(this).attr("id"),r=$(this).text(),i=$(this).closest(".content-item").attr("id");return $("div#workflow").length==0&&modal_create("workflow"),$("div#workflow").html(global_workflow_template({label:r,transition:n,object_url:t,object_id:i})),modal_show("div#workflow"),!1})},onTreeActions:function(){e(".wraparea .hitarea",function(){$(this).parent(".wraparea").parent("li:has(ol)").toggleClass("unfold"),$(this).parent(".wraparea").parent("li:has(ol)").children("ol").slideToggle("fast"),$(this).parent(".wraparea").parent("li:has(ul)").toggleClass("unfold"),$(this).parent(".wraparea").parent("li:has(ul)").children("ul").slideToggle("fast")})},onModEvent:function(e){$(".mod").find("select").live("change",function(){var t=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");e(n,t,r)}),$(".mod").find('input[type="checkbox"]').live("change",function(){var t=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");e(n,t,r)}),$(".mod").find('input[type="radio"]').live("change",function(){var t=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");e(n,t,r)}),$(".mod").find('input[type="text"]').live("change",function(){var t=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");e(n,t,r)}),$(".mod").find("textarea").live("change",function(){var t=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");e(n,t,r)})},onCollapsebarClick:function(){$(".collapse-bar").on("click",function(){$(".doc-layout").toggleClass("collapsed-nav"),$(".doc-layout").toggleClass("uncollapsed-nav"),$(".ui-layout").toggleClass("collapsed-nav"),$(".ui-layout").toggleClass("uncollapsed-nav")})},onCollapsebarClick:function(){$(".collapse-bar").on("click",function(){$(".doc-layout").toggleClass("collapsed-nav"),$(".doc-layout").toggleClass("uncollapsed-nav"),$(".ui-layout").toggleClass("collapsed-nav"),$(".ui-layout").toggleClass("uncollapsed-nav")})}},global.event.init()}(),define("global/event",["jquery","backbone","bootstrap"],function(){}),function(){typeof global=="undefined"&&(global={}),global=$.extend({},global,{set_click_event:function(e,t){$(e).live("click",t)},modal:{create:function(e,t,n){n||(n=""),t||(t="large-modal"),$("body").append(global.template.modal({name:e,data:n,type:t,options:{}}))},create_preview_modal:function(e,t){t||(t=""),$("body").append(global.template.modal_preview({name:e,data:t}))},show:function(e){$(e).one("shown",function(){$(e).find('input[type="text"],textarea').length>0?$(e).find('input[type="text"],textarea').first().focus():$(e).find("button.btn-cofirm").first().focus()}),$(e).modal("show")},hide:function(e){$(e).modal("hide")},openDataModal:function(modal,model,Template,attr){var templatetype=typeof Template;templatetype=="function"?$(modal).html(Template(model.toJSON())):$(modal).children(".modal-body").html(_.template(Template,model.toJSON())),$(modal).modal("show"),$(modal).find(".btn").on("click",function(){var values=global.serializeValue($(modal));console.log(values),eval(model.Root.id).update(values)})},createCustomModal:function(e){}},text2form:function(e,t){var n=e.text(),r=e.attr("id"),i=e.attr("data-type");e.hide(),e.parent().append(global.template.text_form({text:n,id:r,type:i})),e.parent().children(".editform").find("input, textarea").first().focus(),e.parent().find(".action-save").on("click",function(){var n=$(this).parents(".editform").first().find("input, textarea").first().val();n=n.replace(/\n/g,"\n<br>");var r=$(this).parents(".editform").first().find("input, textarea").first().attr("name");n==""?e.html("<em>点击添加内容</em>"):e.html(n),e.show(),$(this).parents(".editform").first().trigger("change"),$(this).parents(".editform").first().remove();var i={};i[r]=n,t&&t(i)}),e.parent().find(".action-cancel").on("click",function(){e.show(),$(this).parents(".editform").first().remove()}),e.parent().children(".editform").find("textarea").length>0},initInlineEdit:function(e,t){e.find("[data-method=inline]").each(function(){$(this).on("click",function(){global.text2form($(this),function(e){})})})},exist:function(e){if(typeof e=="undefined")return!1;!0},get_array:function(e,t){var n=[];return e.each(function(){var e=$(this).attr(t);n.push(e)}),n},get_tree:function(e,t,n,r){var i=[];return t&&e.children(t).children(n).each(function(){var e={};e.id=$(this).attr(r),e.children=global.get_tree($(this),t,n,r),i.push(e)}),i},get_tree_by_checkbox:function(e,t,n,r,i){var s=[];return t&&e.children(t).children(n).each(function(){var e=$(this).find(r).first(),o={};e.attr("checked")=="checked"?o.id=e.attr(i):o.id=null,o.children=global.get_tree_by_checkbox($(this),t,n,r,i),s.push(o)}),s},serializeForm:function(e){var t=$(e).serializeArray(),n={};return _.each(t,function(e){n[e.name]=e.value}),n},serializeValue:function(target,EmptyValueAllowed){var data={},getObj=function(name){if(name.indexOf(".")!=-1){var namesplit=name.split("."),processdata="data";for(i=0;i<namesplit.length;i++){var index=_.isNaN(Number(namesplit[i]))?'"'+namesplit[i]+'"':Number(namesplit[i]);processdata=processdata+"["+index+"]";if(!eval(processdata))return null}return eval(processdata)}return data[name]},processObj=function(name,value){if(name.indexOf(".")!=-1){var namesplit=name.split("."),processdata="data";for(i=0;i<namesplit.length;i++){var index=_.isNaN(Number(namesplit[i]))?'"'+namesplit[i]+'"':Number(namesplit[i]);processdata=processdata+"["+index+"]",eval(processdata)||(namesplit[i+1]&&!_.isNaN(Number(namesplit[i+1]))?eval(processdata+"=[]"):eval(processdata+"={}"))}eval(processdata+'="'+value+'"')}else data[name]=value};return $(target).find('input[type="text"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;var t=$(this).val();!Boolean(t)&&$(this).attr("data-type")=="boolean"&&(t=!1),processObj(e,t)}),$(target).find('input[type="hidden"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;value=$(this).val(),value=="true"&&(value=!0),value=="false"&&(value=!1),processObj(e,value)}),$(target).find('input[type="checkbox"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;var t=getObj(e);if(!t||!_.isArray(t))t=[];$(this).attr("checked")=="checked"?$(this).attr("data-type")=="boolean"?t=!0:t.push($(this).val()):$(this).attr("data-type")=="boolean"?t=!1:EmptyValueAllowed,processObj(e,t)}),$(target).find('input[type="radio"]:checked').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;value=$(this).val(),processObj(e,value)}),$(target).find("select").each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=Boolean($(this).attr("data-mutiple"));if(!e)return;var n=getObj(e);if(!t){if($(this).val()=="null")return;n=$(this).val()}else{if(!n||!_.isArray(n))n=[];n.push($(this).val())}processObj(e,n)}),$(target).find("textarea").each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;var t=$(this).val();!Boolean(t)&&$(this).attr("data-type")=="boolean"?t=!1:t=t;var n=processObj(e,t)}),data},serializeMod:function(e){var t={};return $(e).find(".mod").each(function(){var e=$(this).attr("data-name");if(e)t[e]=global.serializeValue($(this));else{var n=global.serializeValue($(this));_.each(n,function(e,n){t[n]=e})}}),t},getUniqueId:function(e,t,n){t||(t=""),n||(n="");var r=_.uniqueId(t);r+=n;var i=[];return i=global.model.getIds(e),_.include(i,r)&&(r=getUniqueId(e,t,n)),r+(new Date).getTime()},getUniqueIdByDom:function(e,t,n,r){n||(n=""),r||(r="");var i=_.uniqueId(n);return i+=r,$(e).find(t+'[id="'+i+'"]').length>0&&(i=getUniqueIdByDom(e,t,n,r)),i+(new Date).getTime()},message:function(e,t,n){$("body").find(".msg").length==0&&$("body").append('<div class="msg"></div>'),n||(n=3e3),$(".msg").html(global.template.msg({type:e,msg:t})),$(".msg").show(),setTimeout(function(){$(".msg").fadeOut("slow")},n)},getRequest:function(e){var t=location.search,n=new Object;if(t.indexOf("?")!=-1){var r=t.substr(1);strs=r.split("&");for(var i=0;i<strs.length;i++)n[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1])}return e?n[e]:n},throwerror:function(e){global.message("error",e)},confirmChange:function(e){global.change?($("#confirmModal").html(global.template.confirm({msg:"你的编辑尚未保存，是否立即保存？"})),global.modal.show("#confirmModal"),$("#confirmModal").find(".btn.btn-confirm").on("click",function(){global.modal.hide("#confirmModal"),global.save(),e()}),$("#confirmModal").find(".btn.btn-cancel").on("click",function(){global.modal.hide("#confirmModal"),e()})):e()},confirmDelete:function(e){$("#confirmModal").html(global.template.confirm({msg:"确认删除？"})),global.modal.show("#confirmModal"),$("#confirmModal").find(".btn-confirm").focus(),$("#confirmModal").find(".btn.btn-confirm").on("click",function(){global.modal.hide("#confirmModal"),e()})},confirmModal:function(e,t){$("#confirmModal").html(global.template.confirm({msg:e})),global.modal.show("#confirmModal"),$("#confirmModal").find(".btn.btn-confirm").on("click",function(){global.modal.hide("#confirmModal"),t()})},confirmPreview:function(e){$("#confirmModal").html(global.template.confirm({msg:"你还没有保存，点击确定保存后进行预览？"})),global.modal.show("#confirmModal"),$("#confirmModal").find(".btn.btn-confirm").on("click",function(){global.modal.hide("#confirmModal"),e()})},get_page:function(e,t,n){n||(n=10);var r=n/2,s=1,o=t;for(i=r;i>=0;i--){s=e-i,o=e+(n-i),o=o>t?t:o;if(s>0)break}return{start:s,end:o}},render_template:function(e,t,n,r){n||$(".ui-layout-right").empty(),_.each(t,function(t){global.template[t]&&(typeof global.template[t]=="function"?templatevalue=global.template[t](e):typeof global.template[t]=="string"&&(templatevalue=_.template(global.template[t],e)),$(".ui-layout-right").find('.mod[data-id="'+t+'"]').length>0?$(".ui-layout-right").find('.mod[data-id="'+t+'"]').replaceWith(templatevalue):$(".ui-layout-right").find(".nano").length>0?$(".ui-layout-right").find(".nano").children(".content").append(templatevalue):$(".ui-layout-right").append(templatevalue),t!="update"&&_.has(e[t],"readonly")&&$(".ui-layout-right").find('.mod[data-name="'+t+'"]').append('<input type="hidden" name="readonly" value="'+e[t].readonly+'">'),$(".ui-layout-right").find('.mod[data-id="'+t+'"]').hasClass("inline-edit")&&global.initInlineEdit($(".ui-layout-right").find('.mod[data-id="'+t+'"]')))}),r||global.setscrollnano(".ui-layout-right")},return_tree:function(e,t,n){var r="",i,s;return _.each(e,function(e){returned=n(e),i=s=$(returned);if(t){var o=document.createElement(t);i.append(o.outerHTML),s=i.children(t)}s.append(global.return_tree(e.children,t,n)),returned=i[0].outerHTML,r+=returned}),r},return_query_str:function(e){_.each(e,function(e){})}}),global.debug=!1,global.change=!1,global.list=function(e){this.defaults={list_template:global.template.list,menu:{el:".list-menu",model:{},template:_.template("")},left:{el:".list-tree",model:{},template:_.template(""),onUpdate:function(){},onClick:function(){}},right:{el:".list-content",model:{},template:_.template(""),onUpdate:function(){},onClick:function(){}},page:{el:".list-page",model:{},template:_.template("")},query:{page:1,type_categorized:null}},this.options=e,this.options=$.extend({},this.defaults,typeof e=="object"&&e)},global.list.prototype={render:function(){$(this.options.list_el).html(this.options.list_template()),this.render_menu(),this.render_left(),this.render_right(),this.render_page()},render_list:function(){var e=this;$(this.options.list_el).html(this.options.list_template()),$(this.options.list_el).parent().find("form.search").on("submit",function(){var t=$(this).find(".search-query").val();return e.options.query.SearchableText=t,e.query_filter(),!1})},render_menu:function(){var e=this;$(this.options.menu.el).html(this.options.menu.template(this.options.menu.model?this.options.menu.model.toJSON():null)),this.options.menu.model&&this.options.menu.model.query(function(t){if(t.code==200){var n=t.data;e.options.menu.model.set(n),e.options.menu.model.icollection.reset(),global.model.model2tree(e.options.menu.model,"results","children"),$(e.options.menu.model.el).find("select").on("change",function(){var t=global.serializeValue(e.options.menu.model.el);e.options.query.filter=t,e.query_filter()}),e.options.menu.callback&&e.options.menu.callback()}}),$(this.options.menu.el).find('input[type="checkbox"][value="selectall"]').on("change",function(){$(this).attr("checked")=="checked"?$(e.options.right.model.el).find('input[type="checkbox"]').attr("checked","checked"):$(e.options.right.model.el).find('input[type="checkbox"]').removeAttr("checked")}),$(this.options.menu.el).find('input[type="checkbox"][value="checked_children"]').on("change",function(){$(this).attr("checked")=="checked"?e.options.right.checked_children=!0:e.options.right.checked_children=!1})},render_left:function(){var e=this.options.left.model.el,t=this;this.options.query.type_categorized=null,$(e).find("li h4 a").each(function(){$(this).on("click",function(){$(e).find("li").removeClass("active");var n=$(this).parents("li").first().attr("id");return $(this).parents("li").first().addClass("active"),t.options.left.current=n,t.options.left.model.current=n,n?(t.options.query.type_categorized=n,opt="id="+t.options.query.type_categorized+"&",t.options.query.SearchableText=null,t.options.query.filter=null,t.query(opt),t.render_menu(),$(t.options.list_el).parent().find("form.search").find(".search-query").val(""),!1):(t.options.query.type_categorized=null,t.options.query.SearchableText=null,t.options.query.filter=null,opt="",t.query(opt),t.render_menu(),$(t.options.list_el).parent().find("form.search").find(".search-query").val(""),!1)})}),$(this.options.left.model.el).find('[rel="tooltip"]').tooltip({container:"body"}),global.setscrollnano($(this.options.left.model.el).parents(".nanoscrollbar").first())},render_right:function(){var e=this;$(this.options.right.model.el).find(".content-item h4").live("click",function(t,n){var r=$(this).parents(".content-item").first().attr("id");e.options.right.current=r,e.options.right.model.current=r,e.options.right.onClick&&e.options.right.onClick(r)}),$(this.options.right.model.el).find("tr.content-item").live("click",function(t,n){var r=$(this).attr("id");e.options.right.current=r,e.options.right.model.current=r,e.options.right.onClick&&e.options.right.onClick(r)}),$(this.options.right.model.el).find('[rel="tooltip"]').tooltip({container:"body"}),this.hasmenu_check(),global.setscrollnano($(this.options.right.model.el).parents(".nanoscrollbar").first())},refrash_right:function(e){e?this.render_right_data(e):this.query_filter()},render_page:function(){var e=this;$(this.options.page.el).html(this.options.page.template(this.options.page.model.toJSON())),$(this.options.page.el).find(".first").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=1,e.query_filter(e.options.query.page),!1)}),$(this.options.page.el).find(".last").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("numpages"),e.query_filter(e.options.query.page),!1)}),$(this.options.page.el).find(".prev").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("page")-1,e.query_filter(e.options.query.page),!1)}),$(this.options.page.el).find(".next").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("page")+1,e.query_filter(e.options.query.page),!1)}),$(this.options.page.el).find(".page").on("click",function(){return e.options.query.page=parseInt($(this).html()),e.query_filter(e.options.query.page),!1})},query_filter:function(){var e=this,t="";e.options.query.type_categorized&&(t="id="+e.options.query.type_categorized+"&"),e.options.query.filter&&_.each(e.options.query.filter,function(e,n){t=t+n+"="+e+"&"}),e.options.query.SearchableText&&(t=t+"SearchableText="+e.options.query.SearchableText+"&"),e.options.query.page&&(t=t+"page="+e.options.query.page),this.query(t)},query:function(e){var t=this;this.options.right.model.query(function(e){if(e.code==200){var n=e.data;t.render_right_data(n)}else global.throwerror(e.msg)},e)},render_right_data:function(e){var t=this;t.options.right.model.icollection.reset(),t.options.right.model.set(e),!t.options.right.type||t.options.right.type=="collection"?global.model.model2collection(t.options.right.model,"results"):global.model.model2tree(t.options.right.model,"results","children"),t.render_right(),t.render_page(),$(t.options.right.model.el).find('[rel="tooltip"]').tooltip(),t.options.afterquery&&t.options.afterquery(),t.options.left.onClick&&t.options.left.onClick(t.options.left.model.current)},hasmenu_check:function(){var e=this;$(this.options.list_el).find("li.content-item").each(function(){$(this).children("ul").length>0&&$(this).children("ul").children("li").length>0?($(this).addClass("hasmenu unfold"),$(this).find('input[type="checkbox"]').on("change",function(){e.options.right.checked_children&&($(this).attr("checked")=="checked"?$(this).parents("li.content-item").first().children("ul").find('input[type="checkbox"]').attr("checked","checked"):$(this).parents("li.content-item").first().children("ul").find('input[type="checkbox"]').removeAttr("checked"))})):$(this).removeClass("hasmenu")})},update_tooltip:function(){}},global.dict={init:function(){typeof dict=="undefined"?global.dict.data=[]:global.dict.data=dict.data},query:function(e){return global.dict.data[e]?global.dict.data[e]:e}},global.dict.init(),global.simplepreview=function(e){$("body").find("#material_preview").length>0||global.modal.create_preview_modal("material_preview"),$("#material_preview").empty(),global.modal.show("#material_preview"),$("#material_preview").html(global.template.preview({title:document.title,preview:e,description:null}))},global.preview=function(e,t){if(t=="CBT"||t=="FluidBook"){var n=e+"preview";window.bookwindow=window.open(n,"","type=fullWindow, fullscreen, scrollbars=yes")}else if(t=="ImagesTopic"||t=="FluidTopic"||t=="CBTChapter"||t=="CBTSection"){var n=e+"newcbtview";$("body").find("iframe#PreviewWindow").length>0||$("body").append('<iframe id="PreviewWindow" style="width:100%;height:100%;position:absolute;top:0;left:0;z-index:9999999999;"></iframe>'),$("iframe#PreviewWindow").attr("src",n+"?from=page")}else if(t=="PDFBook"){var n=e+"preview";window.pdfwindow=window.open(n)}else $("body").find("#material_preview").length>0||global.modal.create_preview_modal("material_preview"),$("#material_preview").empty(),global.modal.show("#material_preview"),global.html.load(e+"preview",function(e){$("#material_preview").html(global.template.preview({title:document.title,preview:e,description:null})),$(".preview-modal .slideshow").length&&$(".preview-modal .slideshow").simpleSlide({data:{},template:['<a class="left slideshow-control" href="#">‹</a> ','<a class="right slideshow-control" href="#">›</a>'].join(""),containerSelecter:"div.slideshow-inner",liSelecter:"div.slideshow-inner div.item",prevSelecter:"a.left",nextSelecter:"a.right",pagenationSelecter:".slideshow-indicators li"})})},global.listpreview=function(e,t){if(t=="CBT"||t=="FluidBook"){var n=e;window.bookwindow=window.open(n,"","type=fullWindow, fullscreen, scrollbars=yes")}else if(t=="ImagesTopic"||t=="FluidTopic"){var n=e;window.bookwindow=window.open(n,"","type=fullWindow, fullscreen, scrollbars=yes")}else if(t=="PDFBook"){var n=e;window.pdfwindow=window.open(n)}else if(t=="tdms"){$("body").find("#material_preview").length>0||global.modal.create_preview_modal("material_preview");var r=material_split_href(e),i="http://"+r.linkid;$("#material_preview").html(global.template.preview({title:document.title,preview:'<iframe class="element" src="'+i+'" class="absolute" width="1024" height="768" style="border:none"></iframe>',description:null})),global.modal.show("#material_preview")}else $("body").find("#material_preview").length>0||global.modal.create_preview_modal("material_preview"),$("#material_preview").empty(),global.modal.show("#material_preview"),global.html.load(e,function(e){$("#material_preview").html(global.template.preview({title:document.title,preview:e,description:null})),$(".preview-modal .slideshow").length&&$(".preview-modal .slideshow").simpleSlide({data:{},template:['<a class="left slideshow-control" href="#">‹</a> ','<a class="right slideshow-control" href="#">›</a>'].join(""),containerSelecter:"div.slideshow-inner",liSelecter:"div.slideshow-inner div.item",prevSelecter:"a.left",nextSelecter:"a.right",pagenationSelecter:".slideshow-indicators li"})})},global.setscrollnano=function(e){$(e).hasClass("nanoscrollbar")?$selector=$(e):$selector=$(e).find(".nanoscrollbar"),$selector.children(".nano").length==0&&$selector.wrapInner('<div class="nano"><div class="content"></div></div>'),$selector.children(".nano").nanoScroller(),$selector.children(".nano").children(".pane").css({visibility:"hidden"}),$selector.children(".nano").hover(function(){$(this).children(".pane").css({visibility:"visible"})},function(){$(this).children(".pane").css({visibility:"hidden"})})},global.fill=function(e,t){var n=function(e){return typeof e=="object"&&(e=JSON.stringify(e)),e};$(e).find(".mod").each(function(){var e=$(this).attr("data-fill");if(!Boolean(e))return;var r=$(this).attr("data-name");r?$data=t[r]:$data=t;if(!$data)return;$(this).find("input[type=text],input[type=hidden],input[type=radio],textarea,select").each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e||!$data[e])return;$(this).val(n($data[e]))}),$(this).find("input[type=checkbox]").each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-type");if(!e||!$data[e])return;if(t=="boolean")Boolean($data[e])?$(this).attr("checked","checked"):$(this).removeAttr("checked");else{var n=$(this).attr("value");_.include(n,$data[e])?$(this).attr("checked","checked"):$(this).removeAttr("checked")}}),$(this).find("input[type=checkbox]").each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e||!$data[e])return;var t=$(this).attr("value");String(t)==String($data[e])&&$(this).prop("checked",!0)})})},global.actionsave=null,global.switch={rightpanelclear:!0},global.setscrollnano(".nanoscrollbar"),window.location.href.indexOf("-debug")==-1&&(this.console={log:function(){},info:function(){}})}(window),define("global/main",["jquery","backbone","bootstrap","jquery.nanoscroller","jswait","jqwait","global/data","global/template","global/model","global/event"],function(){}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!interaction/template/element.js",[],function(){return'				<div class="element component <%=iType.toLowerCase()%>" id="<%=id%>" style="position: absolute; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; left:<%=iCommon[iPageDirection].iStartx%>px; top:<%=iCommon[iPageDirection].iStarty%>px;">\n					<div class="iContent" style="postion:absolute;width:100%;height:100%"></div>\n				</div>'}),define("text!interaction/template/animation.js",[],function(){return'     <fieldset id="<%=id%>" class="animation categories">\n       <legend>\n         <%=id%></legend>\n       <div class="action">\n         <select name="iAnimationType" class="animationtype" style="width:150px">\n           <%if(type=="object"){%>     \n           <%_.each(interaction.AnimationTypes,function(value,key){%>     \n           <option value=<%=key%>>\n             <%=value%></option>\n           <%})%>     \n           <%}%>     \n           <%if(type=="media"){%>     \n           <%_.each(interaction.MediaAnimationTypes,function(value,key){%>     \n           <option value=<%=key%>>\n             <%=value%></option>\n           <%})%>     \n           <%}%></select>\n         <button class="btn btn-small btn-primary action-addanimation">Add</button>\n       </div>\n       <ul></ul>\n     </fieldset>'}),define("text!interaction/template/action.js",[],function(){return'     <fieldset id="<%=id%>" class="actions categories">\n                <legend><%=id%></legend>\n         <div class="action">\n         <select name="iActionType" class="actiontype" style="width:150px">\n           <%if(type=="object"){%>\n           <%_.each(interaction.ActionTypes,function(value,key){%>\n             <option value=<%=key%>><%=value%></option>         \n           <%})%>\n           <%}%>\n           <%if(type=="media"){%>\n           <%_.each(interaction.MediaAnimationTypes,function(value,key){%>\n             <option value=<%=key%>><%=value%></option>         \n           <%})%>\n           <%}%>        \n           </select>\n         <button class="btn btn-small btn-primary action-addaction">Add</button>\n         </div>\n           <ul></ul>\n     </fieldset>'}),define("text!interaction/template/resources.js",[],function(){return'     <fieldset id="<%=id%>" class="resources">\n                <legend>Resources</legend>\n<a style="position: absolute; margin: 0px; padding: 3px; top: 0px; right: 50px;" data-original-title="恢复原始尺寸" type="button" rel="tooltip" title="" class="btn btn-small action-cancel"> <i style="background:url(../img/icon_undo.png) no-repeat 50% 50%; width:16px; height:16px;" class="icon--trash"></i>\n					</a>\n                    <div class="action">\n                     <a title="" rel="tooltip" class="action-file" data-type="<%=type%>" href="#material" data-original-title="添加素材">添加素材</a>\n                    </div>\n              </fieldset>'}),define("text!interaction/template/baseinfo.js",[],function(){return'         <h3 class="baseinfo"><%=iType%></h3>\n         title: <input data-attr="iDetail" name="title" type="text" value="<%=iDetail.title%>"/>'}),define("text!interaction/template/infosave.js",[],function(){return'       <div class="resources"></div>\n       <div class="animations_area"></div>\n       <div class="actions_area"></div>\n       <div class="action-save">\n         <button class="btn btn-small" type="button">SAVE</button>\n       </div>'}),define("text!interaction/template/common.js",[],function(){return'       <fieldset class="Pos">\n                    <legend>尺寸和位置</legend>\n                    <div class="item" style="height:70px;">\n                      <ul>\n                        <li>\n                          <label>L：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iWidth" type="text" data-attr="iCommon" value=<%=iCommon[iPageDirection].iWidth%>>\n                        </li>\n                        <li>\n                          <label>H：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iHeight" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iHeight%>>\n                        </li>\n                        <li>\n                          <label>X：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iStartx" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iStartx%>>\n                        </li>\n                        <li>\n                          <label>Y：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iStarty" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iStarty%>>\n                        </li>\n                      </ul>\n                    </div>\n           <div class="item" style="height:20px;clear:both;">\n             <input data-attr="iDetail" data-type="boolean" name="iHidden" type="checkbox" value="true" <%=iDetail.iHidden&&"checked=true"%>>初始隐藏\n           </div>\n                  </fieldset>'}),define("text!interaction/template/commonxy.js",[],function(){return'       <fieldset class="Pos">\n                    <legend>尺寸和位置</legend>\n                    <div class="item" style="height:70px;">\n                      <ul>\n                        <li class="hide">\n                          <label>L：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iHeight" type="text" data-attr="iCommon" value=<%=iCommon[iPageDirection].iHeight%>>\n                        </li>\n                        <li class="hide">\n                          <label>H：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iWidth" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iWidth%>>\n                        </li>\n                        <li>\n                          <label>X：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iStartx" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iStartx%>>\n                        </li>\n                        <li>\n                          <label>Y：</label>\n                          <input class="inputquarter ui-state-default ui-corner-all" name="iStarty" type="text"  data-attr="iCommon" value=<%=iCommon[iPageDirection].iStarty%>>\n                        </li>\n                      </ul>\n                    </div>\n           <div class="item" style="height:20px;clear:both;">\n             <input data-attr="iDetail" data-type="boolean" name="iHidden" type="checkbox" value="true" <%=iDetail.iHidden&&"checked=true"%>>初始隐藏\n           </div>\n                  </fieldset>'}),define("interaction/ui/detail",["underscore"],function(){var e={Image:_.template(['					<fieldset class="detail no-legend">','						<div class="item">','							<input data-attr="iDetail" data-type="boolean" name="iFullview" type="checkbox" value="true" <%=iDetail.iFullview&&"checked=true"%>>点击全屏显示',"						</div>","					</fieldset>"].join("")),VideoType:_.template(['				<fieldset class="typedetail no-legend" id="iVideotype">','					<label class="db">选择类型</label>','					<select data-attr="iDetail" name="iVideotype" class="db">','						<option <%=(iDetail.iVideotype=="mediafile")&&"selected"||""%> value="mediafile">视频文件</option>','						<option <%=(iDetail.iVideotype=="streammedia")&&"selected"||""%> value="streammedia">流媒体</option>',"					</select>","				</fieldset>"].join("")),Video:_.template(['				<fieldset class="no-legend detail">','					<div class="info_set1" class="">','						<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iAdapt" type="checkbox" value="true" <%=iDetail.iAdapt&&"checked=true"||""%>></span><span class="text1">边框适应视频比例</span>',"					</div>",'					<div class="info_set1">','						<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iFullview" type="checkbox" value="true" <%=iDetail.iFullview&&"checked=true"||""%>></span><span class="text1">点击全屏显示</span>',"					</div>",'					<div class="info_set1">','						<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iAutoplay" type="checkbox" value="true" <%=iDetail.iAutoplay&&"checked=true"||""%>></span><span class="text1">自动播放</span>',"					</div>",'					<div class="info_set1">','					<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iRepeat" type="checkbox" value="true" <%=iDetail.iRepeat&&"checked=true"||""%>></span><span class="text1">循环播放</span>',"					</div>","				</fieldset>"].join("")),Audio:_.template(['				<fieldset class="no-legend detail">','					<div class="info_set1">','						<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iAutoplay" type="checkbox" value="true" <%=iDetail.iAutoplay&&"checked=true"||""%>></span><span class="text1">自动播放</span>',"					</div>",'					<div class="info_set1">','						<span class="input1"><input data-attr="iDetail" data-type="boolean" name="iRepeat" type="checkbox" value="true" <%=iDetail.iRepeat&&"checked=true"||""%>></span><span class="text1">循环播放</span>',"					</div>","				</fieldset>"].join("")),LinkType:_.template(['				<fieldset class="no-legend typedetail">','					<span class="quarter">选择类型</span>','					<span class="threequarter">','					<select name="iLinktype" data-attr="iDetail" class="threequarter ui-state-default ui-corner-all">','						<option <%=(iDetail.iLinktype=="hyperlink")&&"selected"||""%> value="hyperlink">超链接</option>','						<option <%=(iDetail.iLinktype=="gotopage")&&"selected"||""%> value="gotopage">go to Page</option>','						<option <%=(iDetail.iLinktype=="Cortona3D")&&"selected"||""%> value="Cortona3D">Cortona3D</option>',"					</select>","					</span>","				</fieldset>"].join("")),Link:_.template(['				<%if(iDetail.iLinktype=="hyperlink"){%>','				<fieldset class="no-legend detail">','					<div class="full">',"						<span>网址:</span>",'						<span><input data-attr="iDetail" class="ui-state-default ui-corner-all" name="iUrl" type="text"  value=<%=iDetail.iUrl%>></span>',"					</div>",'					<div class="cls"></div>','					<div class="full">','						<span><input data-attr="iDetail" data-type="boolean" <%=(iDetail.iSafari)&&"checked=checked"||""%> name="iSafari" type="checkbox" value="true"></span>',"						<span>在Safari中打开</span>","					</div>","				</fieldset>","				<% }%>",'				<%if(iDetail.iLinktype=="gotopage"){%>','				<fieldset class="no-legend detail">','					<div class="full">','						<span><input data-attr="iDetail" name="iGoto" type="radio" value="page" <%=(iDetail.iGoto=="page")&&"checked=checked"||""%>>转到：</span>','						<span><input data-attr="iDetail" class="inputquarter ui-state-default ui-corner-all" name="iPage" type="text" value=<%=iDetail.iPage%>>页</span>',"					</div>",'					<div class="cls"></div>','					<span class="half"><input data-attr="iDetail" name="iGoto" type="radio" <%=(iDetail.iGoto=="prev")&&"checked=checked"||""%> value="prev">前一页</span>','					<span class="half"><input data-attr="iDetail" name="iGoto" type="radio" <%=(iDetail.iGoto=="next")&&"checked=checked"||""%> value="next">后一页</span>',"				</fieldset>","				<% }%>",'				<%if(iDetail.iLinktype=="Cortona3D"){%>','				<fieldset class="no-legend detail">','					<div id="iUpload" class="full">','						<span class="full">选择文件</span>','						<div class="cls"></div>','						<span class="quarter"><a id="iFile" data-attr="iFile" class="resources_upload"><img src="n/i_upload.png"></a></span>',"					</div>","				</fieldset>","				<% }%>"].join("")),SlideType:_.template(['				<fieldset class="no-legend typedetail">','					<label class="quarter">选择类型</label>','					<span class="threequarter"><input data-attr="iDetail" type="radio" name="iSlidetype" value="横向" <%=(iDetail.iSlidetype=="横向")&&"checked=checked"||""%>>横向<input data-attr="iDetail" type="radio" name="iSlidetype" value="纵向" <%=(iDetail.iSlidetype=="纵向")&&"checked=checked"||""%>>纵向 </span>',"				</fieldset>"].join("")),Slide:_.template(['				<fieldset class="no-legend detail">','					<div id="" class="full">','						<input data-attr="iDetail" <%=(iDetail.iAutoplay)&&"checked=checked"||""%> data-type="boolean" name="iAutoplay" type="checkbox" value="true">自动播放',"					</div>",'					<div id="" class="full">','						<span><input name="iRepeat" data-attr="iDetail" <%=(iDetail.iRepeat)&&"checked=checked"||""%> data-type="boolean" type="checkbox" data-attr="iDetail" value="true">循环</span><span> 间隔<input data-attr="iDetail" class="ui-state-default" type="text" name="iInterval" style="width:40px" value=<%=iDetail.iInterval%>>秒</span>',"					</div>",'					<div class="full">','						<span><input name="iFade" data-attr="iDetail" type="radio" value="Fade" <%=(iDetail.iFade=="Fade")&&"checked=checked"||""%>>Fade</span><span><input data-attr="iDetail" name="iFade" type="radio" value="Slip" <%=(iDetail.iFade=="Slip")&&"checked=checked"||""%>>Slip</span>',"					</div>",'					<hr class="full ui-widget-header">','					<div id="" class="full">','						<span><input name="iSlipable" data-attr="iDetail" data-type="boolean" type="checkbox" value="true" <%=(iDetail.iSlipable)&&"checked=checked"||""%>>可滑动</span><span><input data-attr="iDetail" data-type="boolean" name="iPagenumber" type="checkbox" value="true" <%=(iDetail.iPagenumber)&&"checked=checked"||""%>>显示页码</span>',"					</div>",'					<div class="full">','						<span><input name="iFullview" data-attr="iDetail" data-type="boolean" type="checkbox" value="true" <%=(iDetail.iFullview)&&"checked=checked"||""%>>全屏</span><span><input data-attr="iDetail" data-type="boolean" type="checkbox" name="iWholeswitch" value="true" <%=(iDetail.iWholeswitch)&&"checked=checked"||""%>>整幅切换</span>',"					</div>","				</fieldset>"].join("")),CycleImage:_.template(['				<fieldset class="no-legend detail">','					<div id="" class="full">','						<input data-attr="iDetail" <%=(iDetail.iAutoplay)&&"checked=checked"||""%> data-type="boolean" name="iAutoplay" type="checkbox" value="true">是否自动播放, 时间间隔<input data-attr="iDetail" class="ui-state-default" type="text" name="iInterval" style="width:40px" value=<%=iDetail.iInterval%>>秒',"					</div>","				</fieldset>"].join("")),RichText:_.template(['				<fieldset class="no-legend detail">','					<div class="half">','						<span><input data-attr="iDetail" data-type="boolean" name="iBackground" type="checkbox" value="true" <%=(iDetail.iBackground)&&"checked=checked"||""%>></span>',"						<span>背景透明</span>","					</div>",'					<div class="half">','						<span><input data-attr="iDetail" data-type="boolean" name="iScrollable" type="checkbox" value="true" <%=(iDetail.iScrollable)&&"checked=checked"||""%>></span>',"						<span>可滚动</span>","					</div>","				</fieldset>"].join("")),ShowHide:_.template(['				<fieldset class="no-legend detail">','				<div class="full">','					<input type="checkbox" name="iStatus" data-attr="iDetail" data-type="boolean" value="true" class="ui-state-default" <%=(iDetail.iStatus)&&"checked=checked"||""%>>初始状态为隐藏',"				</div>",'				<div class="full elementlist"><ul>',"				</ul></div>",'				<div id="iUpload" class="full">','					<span class="quarter tc"><a id="iIconon" data-attr="iIconon" data-type="string" class="resources_upload"><img src=<%=iDetail.iIconon&&iDetail.iIconon||"n/i_upload.png"%>></a></span>','					<span class="quarter tc"><a id="iIconoff" data-attr="iIconoff" data-type="string" class="resources_upload"><img src=<%=iDetail.iIconoff&&iDetail.iIconoff||"n/i_upload.png"%>></a></span>','					<div class="cls"></div>','					<span class="quarter tc">On</span>','					<span class="quarter tc">Off</span>',"			</div>","				</fieldset>"].join("")),WebcontentType:_.template(['				<fieldset class="no-legend typedetail">','					<span class="quarter">选择类型</span>','					<span class="threequarter"><select data-attr="iDetail" name="iWebcontenttype" class="threequarter ui-state-default ui-corner-all">','						<option <%=(iDetail.iWebcontenttype=="local")&&"selected"||""%> value="local">Html本地文件包</option>','						<option <%=(iDetail.iWebcontenttype=="external")&&"selected"||""%> value="external">外部网页</option>',"					</select>","					</span>","				</fieldset>"].join("")),Webcontent:_.template(['				<fieldset class="no-legend detail">','				<div class="full">',"					<span>地址:</span>",'					<span><input data-attr="iDetail" class="ui-state-default ui-corner-all" name="iUrl" type="text"  value=<%=iDetail.iUrl%>></span>',"				</div>",'				<div class="cls"></div>','				<hr class="full ui-widget-header">','				<%if(iDetail.iWebcontenttype=="local"){%>','				<div id="local" class="iWebcontenttype">','					<div id="iUpload" class="full">','						<span class="full">选择文件</span>','						<div class="cls"></div>','						<span class="quarter"><a id="iFile" data-attr="iFile" data-type="string" class="resources_upload"><img src="n/i_upload.png"></a></span>',"					</div>",'					<div class="cls"></div>','					<div class="half">','						<span><input data-attr="iDetail" data-type="boolean" name="iBackground" type="checkbox" value="true" <%=(iDetail.iBackground)&&"checked=checked"||""%>></span>',"						<span>背景透明</span>","					</div>",'					<div class="half">','						<span><input data-attr="iDetail" data-type="boolean" name="iScrollable" type="checkbox" value="true" <%=(iDetail.iScrollable)&&"checked=checked"||""%>></span>',"						<span>可滚动</span>","					</div>","				</div>","				<% }%>",'				<%if(iDetail.iWebcontenttype=="external"){%>','				<div id="external" class="iWebcontenttype">','					<div class="full">','						<span><input data-attr="iDetail" data-type="boolean" name="iBackground" type="checkbox" value="true" <%=(iDetail.iBackground)&&"checked=checked"||""%>></span>',"						<span>背景透明</span>","					</div>","				</div>","				<%}%>","				</fieldset>"].join("")),ElementsGroup:_.template(['				<fieldset class="no-legend detail">','				<div class="full elementlist categories"><ul>',"				</ul></div>",'				<div class="cls"></div>','				<hr class="full ui-widget-header">','               <div class="full">时间间隔（秒）<input data-attr="iDetail" class="ui-state-default" type="text" name="iInterval" style="width:40px" value=<%=iDetail.iInterval%>></div>',"				</fieldset>"].join("")),AnimationGroup:_.template(['				<fieldset class="detail">',"				<legend>Timeline</legend>",'				<div class="full animations categories"><ul>',"				</ul></div>",'				<div class="cls"></div>',"				</fieldset>"].join("")),ActionList:_.template(['				<fieldset class="detail">',"				<legend>所有事件列表</legend>",'				<div class="full actions categories"><ul>',"				</ul></div>",'				<div class="cls"></div>',"				</fieldset>"].join(""))};return e}),define("interaction/model/base",["global/main","text!interaction/template/element.js","text!interaction/template/animation.js","text!interaction/template/action.js","text!interaction/template/resources.js","text!interaction/template/baseinfo.js","text!interaction/template/infosave.js","text!interaction/template/common.js","text!interaction/template/commonxy.js","interaction/ui/detail"],function(){var animationT=require("text!interaction/template/animation.js"),actionT=require("text!interaction/template/action.js"),resourcesT=require("text!interaction/template/resources.js"),infosaveT=require("text!interaction/template/infosave.js"),commonT=require("text!interaction/template/common.js"),commonxyT=require("text!interaction/template/commonxy.js");window.iElementlist=null,window.iCurrentModel=null,window.interaction||(window.interaction={}),interaction.model||(interaction.model={}),interaction.collection||(interaction.collection={}),interaction.view||(interaction.view={}),interaction.template||(interaction.template={}),interaction.template.detail=require("interaction/ui/detail"),interaction.current=null,interaction.elementfocus=window.elementfocus=!1,interaction.iPageDirection=window.iPageDirection="landscape";var BaseModel=Backbone.Model.extend({defaults:{iType:"iBasetype",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iOptions:{iParent:null,iParentModel:null,iDraggable:!0,iResizable:!0,template:null,iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iAutofocus:!1,iKeyscontrol:!0},iParent:"",iParentModel:null,iDraggable:!0,iResizable:!0,template:null,iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iAutofocus:!1,iKeyscontrol:!0,iUrl:null,callback:null,iBackground:"",iResources:null,iResourcesType:null,iResourcesProperties:null},options:{createwait:!0},initialize:function(){this.options=this.get("iOptions");if(!this.id){this.beforecreate();var e=this;this.get("iAutoindex")?(this.set("id",this.get("iType")+"_"+this.cid+(new Date).getTime()),this.setcollection(),this.setmodel()):this.savemodel(function(t){e.set("id",t.ID.toString()),e.set("isNew",!0),e.setcollection(),e.setmodel(),e.setthumb()})}else this.setmodel()},beforecreate:function(){},savemodel:function(callback){this.save({},{wait:!0,success:function(model,response){returned=eval(response),returned.Status=="Success"?callback&&callback(returned):model_error({method:"create",status:returned.Status,msg:returned.Message,model:model})},error:function(){model_error({method:"create",status:"ServerError",msg:"server error or server is not available now,please try again!",model:model})}})},setmodel:function(){iElementlist.get(this.id)||iElementlist.add(this),this.setlist(),this.setview(),this.setsyncmodel()},setthumb:function(){if(interaction.thumblist){var e=this.toJSON();e=$.extend(!0,{},e),e.iPageid=this.get("iPageid"),interaction.thumblist.add(e)}},setlist:function(){},setresourcesmodel:function(){},validate:function(e){},setsyncmodel:function(){},setcollection:function(){},setview:function(){},url:function(){this.get("iUrl")||(this.url=this.collection.url?this.collection.url:context_url)},sync:function(e,t,n){e=="create"&&(n.url=this.get("iUrl")+"/overlaycreate.json"),e=="update"&&(n.url=this.get("iUrl")+"/overlayupdate.json?id="+t.id),e=="delete"&&(n.url=this.get("iUrl")+"/overlaydelete.json?id="+t.id),e=="read"&&(n.url=this.get("iUrl")+"/overlayget.json?id="+t.id),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,this.get("iSync")&&Backbone.sync(e,t,n)}}),BaseCollection=Backbone.Collection.extend({iSync:!1,initialize:function(){this.setonadd(),this.setonremove()},setonadd:function(){},setonremove:function(){},url:"",sync:function(e,t,n){this.iSync&&(e=="read"&&(n.url=context_url+this.url+"/overlayinit.json"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n))},parse:function(e){}});window.iElementCollection=BaseCollection.extend({});var BaseView=Backbone.View.extend({initialize:function(e){_.bindAll(this),this.model.bind("destroy",this.destroy),this.model.bind("change",this.change),this.initstart()},bindresourcesupload:function(){var e=this;this.resourcesel.find("a.action-file").on("click",function(){var t=$(this).parents("fieldset.resources").first().attr("id");e.resourcesattr=t,e.resourcestype=$(this).attr("data-type"),interaction.resources.open(e.model.get("iType"))}),this.resourcesel.find("a.action-cancel").on("click",function(){e.revert()}),this.resourcesel.find("[rel=tooltip]").tooltip()},bindinfo:function(){var e=this,t=this.model;$("#info_attributes").find("input,select,textarea").unbind("change"),$("#info_attributes").find("input,select,textarea").bind("change",function(){var t=interaction.serializeValue("#info_attributes");console.log(t),t.common&&(e.setcommon(t.common),e.updatepos(),e.updatebackground()),t.detail&&e.setdetail(t.detail),$(this).is("select")&&e.updateinfo()})},bindsavebutton:function(){var e=this;this.infoel.find(".action-save button").bind("click",function(){e.confirm()})},bindanimation:function(){var e=this;this.animationel.find(".action-addanimation").on("click",function(){var t=parseInt(e.animationel.find("select.animationtype").val()),n=new interaction.model.AnimationGroupItem({iType:t,overlay_id:e.model.id,iDetail:_.clone(interaction.model.Animation.prototype.defaults.iDetail),iTiming:_.clone(interaction.model.Animation.prototype.defaults.iTiming)});e.updateanimationgroup("add",n.id)})},bindaction:function(){var e=this;this.actionel.find(".action-addaction").on("click",function(){var t=parseInt(e.actionel.find("select.actiontype").val()),n=new interaction.model.Action({iType:t,overlay_id:e.model.id,iDetail:_.clone(interaction.model.Animation.prototype.defaults.iDetail)});interaction.iActionList.confirm()})},initstart:function(){this.render(),this.model.get("isNew")&&(this.model.unset("isNew"),this.focus(),this.afternewcreate())},afternewcreate:function(){this.resourcesel=$("#info_attributes").children(".setting-body").find("div.resources"),this.model.get("iType")!="RichText"&&this.resourcesel&&this.resourcesel.find("a.action-file").trigger("click")},events:{"mousedown .iContent":"focus","click .iContent":"focus","click button.action-done":"confirm","click button.action-del":"removemodel",mouseover:"mouseover",mouseout:"mouseout","dblclick .iContent":"setresources"},setresources:function(){this.resourcesel&&this.resourcesel.find("a.action-file").trigger("click")},options:{aspectRatio:!1},change:function(e){},changeZindex:function(){this.$el.css("z-index",interaction.elementlist.indexOf(this.model))},render:function(){var e=this.model.toJSON(),t=require("text!interaction/template/element.js"),n=_.template(t,this.model.toJSON());return $(this.model.get("iParentdiv")).append(n),this.setElement(interaction.div_find(this.model.id)),this.updatebackground(),this.model.get("iDraggable")&&this.setdraggable(),this.infoel=$("#info_attributes").children(".setting-body"),this},revert:function(){var e=this.getdetail(),t=this.model.get("iResourcesProperties");if(t&&t[0].category=="image"){var n=e[t[0].id];if(n&&_.isArray(n)&&n[0]){var r=this.getcommon();r.iWidth=n[0].width,r.iHeight=n[0].height,this.setcommon(r),this.updatepos(),this.updateinfo()}}},renderCentrolPos:function(e){var t=this.getcommon();this.$el.css("left",e.x-t.iWidth/2+"px"),this.$el.css("top",e.y-t.iHeight/2+"px")},renderbaseinfo:function(){var e=require("text!interaction/template/baseinfo.js");this.infoel.append(_.template(e,this.model.toJSON()))},renderinfosave:function(e){e?e.append(_.template(infosaveT,{})):this.infoel.append(_.template(infosaveT,{}))},renderposition:function(e){var t=e?commonxyT:commonT;this.model.get("iCommon")&&this.infoel.append(_.template(t,this.model.toJSON()))},renderinfo:function(){this.infoel=$("#info_attributes").children(".setting-body"),this.infoel.empty(),this.renderbaseinfo(),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.model.get("iElementattr")&&this.updateelementattr(),this.renderinfosave(this.infoel),this.bindinfo()},removemodel:function(){var view=this;interaction.confirmDelete(function(){jqwait_simple({modal:!1}),view.model.destroy({wait:!0,success:function(model,response){returned=eval(response),jqwait_simple_close(),returned.Status=="Success"||returned.code==200?(jqwait_simple_close(),model.iview.animation_remove(model),model.iview.action_remove(model),model.iview.afterremove(model,response),model.trigger("change:remove")):global.message("error","出错")},error:function(){jqwait_simple_close(),global.message("error","出错")}})})},animation_remove:function(e){_.each(interaction.iAnimationGroupList.where({overlay_id:e.id}),function(e){e.iview.$el.remove(),e.destroy()})},action_remove:function(e){_.each(interaction.iActionList.where({overlay_id:e.id}),function(e){e.iview.$el.remove(),e.destroy()})},afterremove:function(e,t){e.iview.$el.remove();var n=this;e.dommodel&&e.dommodel.iview.$el.remove(),interaction.current&&this.model.id==interaction.current.id&&($("div#info_attributes").children(".setting-body").empty(),$("div#info_resources").children("ul").empty(),this.infoel.empty(),elementfocus=!1,interaction.current=iCurrentModel=null,this.unsetkeyscontrol(),interaction.changeTab("info_page"))},destroy:function(e,t){},updatepos:function(){var e=this.getcommon();e&&(this.$el.css("left",e.iStartx+"px"),this.$el.css("top",e.iStarty+"px"),this.$el.width(e.iWidth),this.$el.height(e.iHeight))},updateel:function(){this.model.get("iTemplate")&&this.$el.html(this.model.get("iTemplate")(this.model.toJSON()))},updateposition:function(e){var t=e?commonxyT:commonT;this.model.get("iCommon")&&this.infoel.find(".Pos").replaceWith(_.template(commonT,this.model.toJSON()))},updateinfo:function(){interaction.current&&interaction.current.id==this.model.id&&(this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.model.get("iElementattr")&&this.updateelementattr(),this.bindinfo())},updatebackground:function(){if(this.model.get("iCommon")){var e=this.getBackGroundUrl();e?this.$el.find(".iContent").html('<img src="'+e+'" style="width:100%;height:100%">'):this.$el.find(".iContent").empty(),this.model.trigger("change:background")}},updateresources:function(){this.resourcesel=$("#info_attributes").children(".setting-body").find("div.resources");var e=this,t=this.model;interaction.iResourceslist.reset(),this.resourcesel.empty();var n=this.model.get("iResourcesProperties");if(n){var r=this.getdetail();_.each(n,function(t){e.resourcesel.append(_.template(resourcesT,{id:t.id,type:t.type}));var n=r[t.id];n&&_.isArray(n)&&_.each(n,function(e){interaction.iResourceslist.add(new interaction.model.Resources(e))})})}this.bindresourcesupload()},updateanimation:function(){var e=this.getdetail();e.animations=_.where(interaction.iAnimationGroupList.toJSON(),{overlay_id:this.model.id}),this.model.set("iDetail",e)},updateanimationgroup:function(e,t){if(e=="add"){var n=interaction.iAnimationGroupList.get(t);new interaction.model.Animation(n.toJSON()),this.updateanimation(),interaction.iAnimationGroupList.confirm()}e=="update"&&interaction.iAnimationGroupList.confirm(),e=="remove"&&interaction.iAnimationGroupList.get(t).destroy()},updateelementattr:function(){$("#info_attributes .elementlist").children("ul").empty(),interaction.iElementattrlist.reset();var e=this;interaction.elementlist.each(function(t){var n=t.toJSON();interaction.iElementattrlist.add(new interaction.model.Elementattr({id:n.id,elementid:e.model.id,iType:n.iType}))})},getBackGroundUrl:function(){var e=this.model.get("iDetail");if(!e.iImg)return!1;if(_.isString(e.iImg))return e.iImg;if(e.iImg[0])return e.iImg[0].picture},getBackGroundThumbUrl:function(){var e=this.model.get("iDetail");if(!e.iImg)return!1;if(e.iImg[0])return e.iImg[0].thumbnail},getcommon:function(){var e=null,t=this.model.toJSON();return this.model.get("iCommon")&&(e=t.iCommon[iPageDirection]),e},getdetail:function(){var e=this.model.toJSON();return e.iDetail},getCentralPos:function(){var e={},t=this.getcommon();return e.x=t.iStartx+t.iWidth/2,e.y=t.iStarty+t.iHeight/2,e},getCommonByCentralPos:function(e){var t=this.getcommon();return t.iStartx=e.x-t.iWidth/2,t.iStarty=e.y-t.iHight/2,t},setcommon:function(e){var t=this.model.toJSON(),n=t.iCommon;!_.isNaN(e.iStartx)&&!_.isNaN(e.iStarty)&&!_.isNaN(e.iWidth)&&!_.isNaN(e.iHeight)&&(n[iPageDirection]=e),this.model.set("iCommon",n),this.model.trigger("change:position")},setdetail:function(e){var t=this.model.toJSON(),n=t.iDetail;_.each(_.keys(e),function(t){n[t]=e[t]}),this.model.set("iDetail",n),this.model.dommodel&&(this.model.dommodel.set("iDetail",this.model.toJSON().iDetail),this.model.dommodel.iview.change()),this.updateinfo(),this.updatebackground()},setCentralPos:function(e){var t=this.getcommon();t.iStartx=e.x-t.iWidth/2,t.iStarty=e.y-t.iHight/2,this.setcommon(t)},otherkeyshandle:function(e){},keyshandle:function(e,t){var n=this.getcommon(),r=this.model.id,i=!1;e.shift&&(this.options.aspectRatio=!0);var s=e.keyCode?e.keyCode:e.which;s==27,s==37&&(i=!0,n.iStartx=Number(n.iStartx)-1,n.iWidth=Number(n.iWidth)+1),s==38&&(n.iStarty=Number(n.iStarty)-1,n.iHeight=Number(n.iHeight)+1,i=!0),s==39&&(n.iWidth=Number(n.iWidth)+1,i=!0),s==40&&(n.iHeight=Number(n.iHeight)+1,i=!0);if(s==46||s==8)this.removemodel(),e.preventDefault();this.otherkeyshandle(s),i==1&&(e.preventDefault(),check="ok",check=="ok"&&(this.setcommon(n),this.updatepos(),this.updateinfo(),this.updatebackground()))},setresizable:function(){if(!this.model.get("iResizable"))return!1;var e=this,t=this.model;this.$el.resizable({handles:"all",resize:function(t,n){$(this).find(".mceEditor").addClass("hide");var r=$(this).position(),i=Number(r.left),s=Number(r.top),o=Number($(this).width()),u=Number($(this).height()),a=e.getcommon();e.options.aspectRatio?e.$el.resizable("option","aspectRatio",1):e.$el.resizable("option","aspectRatio",null),a.iWidth=Number(o),a.iHeight=Number(u),a.iStartx=i,a.iStarty=s,e.setcommon(a),e.updatepos(),e.updateinfo(),e.updatebackground()},create:function(e,t){},stop:function(t,n){$(this).find(".mceEditor").removeClass("hide");var r=$(this).width(),i=$(this).height(),s=e.getcommon();s.iWidth=Number(r),s.iHeight=Number(i),e.setcommon(s),e.updatepos(),e.updateinfo(),e.updatebackground()}})},unsetresizable:function(){this.model.get("iResizable")&&this.$el.resizable("destroy")},setdraggable:function(){if(!this.model.get("iDraggable"))return!1;var e=this,t=this.model;this.$el.draggable({create:function(e,t){},drag:function(t,n){var r=$(this).position(),i=e.getcommon();i.iStartx=Number(r.left),i.iStarty=Number(r.top),e.setcommon(i),e.updatepos(),e.updateinfo()},stop:function(t,n){var r=$(this).position(),i=e.getcommon();i.iStartx=Number(r.left),i.iStarty=Number(r.top),e.setcommon(i),e.updatepos(),e.updateinfo()}})},unsetdraggable:function(){this.model.get("iDraggable")&&this.$el.draggable("destroy")},setkeyscontrol:function(){$(document).bind("keydown",this.keyshandle)},unsetkeyscontrol:function(){$(document).unbind("keydown",this.keyshandle)},setanimation:function(){this.animationel=$("#info_attributes").children(".setting-body").find(".animations_area");var e=this,t=this.model;this.animationel.find("fieldset.animation").remove(),interaction.iAnimationlist.reset();var n=this.model.get("iAnimationProperties");if(n){var r=this.getdetail();_.each(n,function(t){e.animationel.append(_.template(animationT,{id:t.id,type:t.type}));var n=interaction.iAnimationGroupList.where({overlay_id:e.model.id});e.animationel=$("#info_attributes").children(".setting-body").find("fieldset.animation"),n&&_.each(n,function(e){new interaction.model.Animation(e.toJSON())})})}this.bindanimation()},unsetanimation:function(){this.infoel.find("fieldset.animation").remove()},setaction:function(){this.actionel=$("#info_attributes").children(".setting-body").find(".actions_area");var e=this,t=this.model;this.actionel.find("fieldset.actions").remove();var n=this.model.get("iActionProperties");if(n){var r=this.getdetail();_.each(n,function(t){e.actionel.append(_.template(actionT,{id:t.id,type:t.type}));var n=interaction.iActionList.where({overlay_id:e.model.id});n&&_.each(n,function(e){new interaction.view.ActionItem({model:e})})})}this.bindaction()},animationItem_focus:function(e){interaction.iAnimationlist.get(e).iview.focus()},info_focus:function(){interaction.changeTab("info_attributes"),this.renderinfo(),this.updateresources(),this.setanimation(),this.setaction(),this.bindinfo()},div_focus:function(){this.unlock(),this.$el.addClass("selected"),this.$el.addClass("active"),this.$el.removeClass("iShadow"),this.model.get("iResizable")&&this.setresizable(),this.model.get("iKeyscontrol")&&this.setkeyscontrol()},focus:function(){var e=this;elementfocus==1&&iCurrentModel&&iCurrentModel.id==this.model.id?interaction.changeTab("info_attributes"):(elementfocus==1&&iCurrentModel&&iCurrentModel.iview.confirm(),interaction.current=iCurrentModel=this.model,this.beforefocus(),this.info_focus(),this.div_focus(),this.model.dommodel&&this.model.dommodel.iview.$el.addClass("active"),elementfocus=!0,this.bindsavebutton(),this.otherfocus())},beforefocus:function(){},otherfocus:function(){},info_confirm:function(){$("div#info_attributes").children(".setting-body").empty(),$("div#info_resources").children("ul").empty(),interaction.changeTab("info_page")},resetbutton:function(){$("div.info_window").dialog("option","buttons",{}),div_removecontrolbutton(this.model.id)},div_confirm:function(){this.model.get("iResizable")&&this.unsetresizable(),this.model.get("iKeyscontrol")&&this.unsetkeyscontrol(),this.$el.removeClass("selected"),this.$el.removeClass("active"),this.lock(),this.changeZindex()},animation_confirm:function(){if(!_.include(["Image","Link","RichText","Slide","Video","Webcontent"],this.model.get("iType")))return;interaction.elementlist.where({iType:"AnimationGroup"}).length>0&&interaction.elementlist.where({iType:"AnimationGroup"})[0].iview.confirm()},confirm:function(){this.beforeconfirm(),this.info_confirm(),this.div_confirm(),interaction.animation.current&&interaction.animation.current.iview.unfocus(),this.model.save(),this.model.dommodel&&this.model.dommodel.iview.$el.removeClass("active"),interaction.current=elementfocus=!1,this.otherconfirm()},beforeconfirm:function(){},otherconfirm:function(){},highlight:function(){this.$el.addClass("iShadow")},cancelhighlight:function(){this.$el.removeClass("iShadow")},mouseover:function(){if(interaction.current&&interaction.current.id==this.model.id)return;this.$el.addClass("iShadow")},mouseout:function(){if(interaction.current&&interaction.current.id==this.model.id)return;this.$el.removeClass("iShadow")},lock:function(){this.model.set("iLock",!0)},unlock:function(){this.model.set("iLock",!1)},showdiv:function(){this.$el.removeClass("hide"),this.model.set("iVisibility",!0)},hidediv:function(){this.$el.addClass("hide"),this.model.set("iVisibility",!1)}});interaction.model.base=BaseModel,interaction.collection.Base=BaseCollection,interaction.view.Base=BaseView,window.iElementlist=new iElementCollection}),define("text!interaction/template/actionitemdetail.js",[],function(){return'<fieldset class="actionitem" style="margin:0">\n   	<div class="item" style="margin:0 0 15px;">对象: \n   		<div style="float:right; width:140px; height:15px; margin:0 0 0 5px;">\n   			<%=interaction.elementlist.get(overlay_id).toJSON().iDetail.title||interaction.elementlist.get(overlay_id).get(\'iType\')%>\n   		</div>\n   	</div>\n	<div class="actiondetail">\n		<div style="margin:0 0 15px;" class="item">\n			Actions:\n			<select name="iAction" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.ActionExecTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iDetail.results&&iDetail.results[0]&&iDetail.results[0].iAction==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n			</select>\n		</div>\n	</div>\n	<ul class="detailitems">\n	<div class="item" style="margin:0 0 15px;">参数设置:</div>\n	<%if(iDetail&&iDetail.results[0].iAction==0){%>\n	<%_.each(interaction.iAnimationGroupList.toJSON(),function(i){%>\n		<li id="<%=i.id%>"><input type="checkbox" name="values" value="<%=i.id%>" <%=iDetail.results&&_.include(iDetail.results[0].values,i.id)&&"checked"||""%>/><%=interaction.elementlist.get(i.overlay_id).toJSON().iDetail.title||interaction.elementlist.get(i.overlay_id).toJSON().iType%>(<%=interaction.AnimationTypes[i.iType]||interaction.MediaAnimationTypes[i.iType]%>)</li>	\n	<%})%>	\n	<%}%>\n	<%if(iDetail&&iDetail.results[0].iAction==1||iDetail&&iDetail.results[0].iAction==2){%>\n	<%_.each(interaction.elementlist.toJSON(),function(i){%>\n		<li id="<%=i.id%>"><input type="checkbox" name="values" value="<%=i.id%>" <%=iDetail.results&&_.include(iDetail.results[0].values,i.id)&&"checked"||""%>/><%=interaction.elementlist.get(i.id).toJSON().iDetail.title||interaction.elementlist.get(i.id).toJSON().iType%></li>\n	<%})%>		\n	<%}%>\n	</ul>\n	<div style="text-align:center"><a class="btn btn-small btn-primary action-confirm" style="display:inline"><i class="icon-ok icon-white"></i></a></div>\n</fieldset>'}),define("text!interaction/template/actionitem.js",[],function(){return'      <li data-type="<%=iType%>" id="<%=id%>" class="action-item">\n                  <div class="wraparea">\n          <h4><%=interaction.elementlist.get(overlay_id).toJSON().iDetail.title||interaction.elementlist.get(overlay_id).get("iType")%>(<%=interaction.ActionTypes[iType]%>)</h4>\n          <div title="" rel="tooltip" class="btn-draged" data-original-title="上下拖拽"></div>\n                    <div class="action-0">\n              <a class="btn btn-link action-play" rel="tooltip" data-original-title="预览" style="bottom:0;position:absolute;right:70px"><i class="icon-play"></i></a>\n              <a class="btn btn-link action-edit" rel="tooltip" data-original-title="设定" style="bottom:0;position:absolute;right:50px"><i class="icon-edit"></i></a>\n                    <a style="right:30px;" title="" rel="tooltip" class="action-del" href="#" data-original-title="移除">移除</a>\n            </div>\n          </div>\n      </li>'}),define("interaction/model/action",["interaction/model/base","text!interaction/template/actionitemdetail.js","text!interaction/template/actionitem.js"],function(){var e=require("text!interaction/template/actionitemdetail.js"),t=require("text!interaction/template/actionitem.js"),n={};interaction.model.Action=interaction.model.base.extend({defaults:{iType:"101",iDetail:null,overlay_id:null},initialize:function(){this.id?this.setmodel():(this.set("id",this.get("iType")+"_"+this.cid+(new Date).getTime()),this.setcollection(),this.setmodel())},setmodel:function(){if(!interaction.elementlist.get(this.get("overlay_id"))){this.destroy();return}if(!this.get("iDetail")||!this.get("iDetail").results){var e={};e.results=[{iAction:0,values:[]}],this.set("iDetail",e)}interaction.iActionList.get(this.id)||interaction.iActionList.add(this),this.setlist(),this.setview(),this.setsyncmodel()},setlist:function(){},setresourcesmodel:function(){},validate:function(e){},setsyncmodel:function(){this.elementmodel=interaction.elementlist.get(this.get("overlay_id"))},setcollection:function(){},setview:function(){this.iview=new interaction.view.Action({model:this})},url:function(){},sync:function(e,t,n){}}),interaction.collection.Action=interaction.collection.Base.extend({setonremove:function(){var e=this},setonadd:function(){var e=this},confirm:function(){interaction.iActionForSave.save()}}),interaction.view.Action=interaction.view.Base.extend({events:{"dblclick div.btn-draged":"elementfocus","dblclick h4":"elementfocus","click a.action-edit":"focus","click a.action-del":"remove","mouseover .wraparea":"mouseover","mouseout .wraparea":"mouseout","click a.action-confirm":"unfocus","click a.action-play":"preview"},bindhover:function(){var e=this;this.$el.find("ul.detailitems").children("li").each(function(){$(this).on("mouseover",function(){var t=e.getdetail();actiontype=t.results[0].iAction;if(actiontype==0)var n=interaction.iAnimationGroupList.get($(this).attr("id")).toJSON().overlay_id,r=interaction.elementlist.get(n);else var r=interaction.elementlist.get($(this).attr("id"));r.iview.highlight()}),$(this).on("mouseout",function(){var t=e.getdetail();actiontype=t.results[0].iAction;if(actiontype==0)var n=interaction.iAnimationGroupList.get($(this).attr("id")).toJSON().overlay_id,r=interaction.elementlist.get(n);else var r=interaction.elementlist.get($(this).attr("id"));r.iview.cancelhighlight()})})},bindinfo:function(){var t=this;this.$el.find(".actiondetail").find("input,select,textarea").bind("change",function(){var n=interaction.serializeValueSimple(t.$el.find(".actiondetail")),r=t.getdetail();r.results=[],n.values=[],r.results.push(n),interaction.iActionList.get(t.model.id).set("iDetail",r);var i=_.template(e,t.model.toJSON());t.$el.find("fieldset.actionitem").replaceWith(i),t.bindinfo(),t.bindhover()}),this.$el.find(".detailitems").find("input,select,textarea").bind("change",function(){var e=interaction.serializeValueSimple(t.$el.find(".detailitems")),n=t.getdetail();n.results||(n.results=[{iAction:0,values:[]}]),n.results[0].values=e.values,interaction.iActionList.get(t.model.id).set("iDetail",n)})},destroy:function(){var e=this;this.$el.remove()},remove:function(){var e=this;interaction.confirmDelete(function(){e.focused&&e.close(),interaction.iActionList.get(e.model.id).destroy()})},render:function(){this.actionel=$("#info_action").children(".setting-body").find(".actions"),this.elementactionel=$("#info_attributes").find("fieldset.action");var e=this.model.toJSON(),n=_.template(t,e);return this.actionel.children("ul").append(n),interaction.current&&interaction.current.id==this.model.get("overlay_id")&&(this.elementactionview=new interaction.view.ActionItem({model:this.model})),this.setElement(this.actionel.find('li[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.get("overlay_id")),this.$el.find("[rel=tooltip]").tooltip(),this.$el.find(".btn-draged").hide(),this},mouseover:function(){this.model.elementmodel.iview.highlight()},mouseout:function(){this.model.elementmodel.iview.cancelhighlight()},change:function(){},focus:function(){var t=this;interaction.action.current&&interaction.action.current.id!=this.model.id&&interaction.action.current.iview.unfocus();if(!this.focused){this.focused=!0,this.$el.addClass("edit"),interaction.action.current=this.model;var n=this.model.toJSON(),r=_.template(e,n);this.$el.append(r),this.bindinfo(),this.bindhover()}else{this.$el.find("fieldset.actionitem").remove();var i=this.getdetail();interaction.action.current=null,this.focused=!1,this.$el.removeClass("edit")}},unfocus:function(){interaction.iActionList.confirm(),this.$el.find("fieldset.actionitem").remove();var e=this.getdetail();interaction.action.current=null,this.focused=!1,this.$el.removeClass("edit")},close:function(){this.$el.find("fieldset.actionitem").remove(),interaction.action.current=null,this.focused=!1},preview:function(){interaction_view.SinglePreview=!0;var e=this;interaction.animation.preview(),interaction_view.iAnimationlist.afterTimeLineCreated=function(){}},elementfocus:function(){interaction.current&&interaction.current.id==this.model.elementmodel.id?interaction.changeTab("info_attributes"):this.model.elementmodel.iview.focus()}}),interaction.view.ActionItem=interaction.view.Action.extend({events:{"click div.btn-draged":"focus","click a.action-edit":"focus","click a.action-del":"remove","mouseover .wraparea":"mouseover","mouseout .wraparea":"mouseout","click a.action-confirm":"unfocus","click a.action-play":"preview"},render:function(){this.actionel=$("#info_action").children(".setting-body").find(".actions"),this.elementactionel=$("#info_attributes").find("fieldset.actions");var e=this.model.toJSON(),n=_.template(t,e);return this.elementactionel.children("ul").append(n),this.setElement(this.elementactionel.find('li[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.get("overlay_id")),this.$el.find("[rel=tooltip]").tooltip(),this.$el.find(".btn-draged").hide(),this}}),interaction.model.ActionForSave=Backbone.Model.extend({initialize:function(){this.set("id","Actions")},sync:function(e,t,n){var r=interaction.iActionList.toJSON();this.attributes=r;if(e=="create")return;e=="update"&&(n.url=context_url+interaction.currentpage.id+"/setactions");if(e=="delete")return;e=="read"&&(n.url=context_url+interaction.currentpage.id+"/getactions"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}}),interaction.iActionList=new interaction.collection.Action,interaction.iActionList.on("remove",function(){interaction.iActionList.confirm()}),interaction.iActionForSave=new interaction.model.ActionForSave({id:"Actions"})}),define("text!interaction/template/animationitemdetail.js",[],function(){return'<fieldset class="animationitem" style="margin:0">\n   	<div class="item" style="margin:0 0 15px;">对象: \n   		<div style="float:right; width:140px; height:15px; margin:0 0 0 5px;">\n   			<%=interaction.elementlist.get(overlay_id).toJSON().iDetail.title||interaction.elementlist.get(overlay_id).get(\'iType\')%>\n   		</div>\n   	</div>\n	<div class="animationdetail">\n		 <div style="margin:0 0 15px;" class="item">\n			延迟(秒):<input type="text" name="delay" data-type="number" style="float:right; width:140px; height:15px; margin:0 0 0 5px;" value="<%=iTiming.delay%>">\n		</div>\n		<%if(interaction.elementlist.get(overlay_id).toJSON().iType!="Audio"&&interaction.elementlist.get(overlay_id).toJSON().iType!="Video"){ %>\n		 <div style="margin:0 0 15px;" class="item">\n			持续(秒):<input type="text" name="duration" data-type="number" style="float:right; width:140px; height:15px; margin:0 0 0 5px;" value="<%=iTiming.duration%>">\n		</div>\n		<div style="margin:0 0 15px;" class="item">\n		    重复(次):\n			<select name="repeat" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.RepeatTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iTiming.repeat==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n				    <option value="2" <%=(iTiming.repeat==2)&&"selected"||""%>>2</option>\n				    <option value="3" <%=(iTiming.repeat==3)&&"selected"||""%>>3</option>	\n			</select>\n		</div>\n		 <div style="margin:0 0 15px;" class="item">\n			<input name="rewind" data-type="boolean" type="checkbox" value="true" <%=(iTiming.rewind==true)&&"checked"||""%>>播放完返回开头\n		</div>\n		<% } %>\n		<div style="margin:0 0 15px;" class="item">\n			出现方式:\n			<select name="start" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.StartTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iTiming.start==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n			</select>\n		</div>\n		 <div style="margin:0 0 15px;" class="item">\n			<input name="waitaction" data-type="boolean" type="checkbox" value="true" <%=(iTiming.waitaction==true)&&"checked"||""%>>是否等待Action触发\n		</div>\n		<%if(interaction.elementlist.get(overlay_id).toJSON().iType!="Audio"&&interaction.elementlist.get(overlay_id).toJSON().iType!="Video"){ %>\n		<div style="margin:0 0 15px;" class="item">\n		    效果:\n			<select name="ease" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.EaseTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iTiming.ease==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n			</select>\n		</div>\n		<% } %>\n	</div>\n	<ul class="detailitems">\n	<div class="item" style="margin:0 0 15px;">参数设置:</div>\n	<%if(_.include([101,201],iType)){%>\n		<div class="item" style="margin:0 0 15px;">\n			方向:\n			<select name="direction" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.DirectionTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iDetail.direction&&iDetail.direction==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n			</select>	\n		</div>	\n	<%}%>\n	<%if(_.include([302,301],iType)){%>\n		<div class="item" style="margin:0 0 15px;">\n			<input name="autoRotate" data-type="boolean" type="checkbox" value="true" <%=(iDetail.autoRotate==true)&&"checked"||""%>>跟随路径旋转\n		</div>	\n	<%}%>\n	<%if(_.include([401],iType)){%>\n		<div class="item" style="margin:0 0 15px;">比列(倍):\n				<input type="text" name="scale" data-type="number" style="float:right; width:140px; height:15px; margin:0 0 0 5px;" value="<%=iDetail.scale%>">\n		</div>	\n	<%}%>\n	<%if(_.include([402],iType)){%>\n		<div class="item" style="margin:0 0 15px;">不透明度(0~1):\n				<input type="text" name="opacity" data-type="number" style="float:right; width:140px; height:15px; margin:0 0 0 5px;" value="<%=iDetail.opacity%>">\n		</div>	\n	<%}%>\n	<%if(_.include([403],iType)){%>\n		<div class="item" style="margin:0 0 15px;">旋转角度:\n				<input type="text" name="rotation" data-type="number" style="float:right; width:140px; height:15px; margin:0 0 0 5px;" value="<%=iDetail.rotation%>">\n		</div>	\n		<div class="item" style="margin:0 0 15px;">轴向:\n			<select name="axial" data-type="number" style="float:right; width:140px; height:24px; margin:0 0 0 5px;">\n				<%_.each(interaction.AxialTypes,function(value,key){%>\n					<option value="<%=key%>" <%=(iDetail.axial&&iDetail.axial==key)&&"selected"||""%>><%=value%></option>			\n				<%})%>\n			</select>	\n		</div>	\n	<%}%>\n	</ul>\n	<div style="text-align:center"><a class="btn btn-small btn-primary animation-confirm" style="display:inline"><i class="icon-ok icon-white"></i></a></div>\n</fieldset>'}),define("text!interaction/template/animationitem.js",[],function(){return'   <li data-type="<%=iType%>" id="<%=id%>" class="animation-item">\n               <div class="wraparea">\n       <h4><%=interaction.elementlist.get(overlay_id).toJSON().iDetail.title||interaction.elementlist.get(overlay_id).get("iType")%>(<%=interaction.getAnimationTypeName(iType)%>)</h4>\n       <div title="" rel="tooltip" class="btn-draged" data-original-title="上下拖拽"></div>\n                 <div class="action-0">\n           <a class="btn btn-link animation-play" rel="tooltip" data-original-title="预览" style="bottom:0;position:absolute;right:70px"><i class="icon-play"></i></a>\n           <a class="btn btn-link animation-edit" rel="tooltip" data-original-title="设定" style="bottom:0;position:absolute;right:50px"><i class="icon-edit"></i></a>\n                 <a style="right:30px;" title="" rel="tooltip" class="action-del" href="#" data-original-title="移除">移除</a>\n         </div>\n       </div>\n   </li>'}),(window._gsQueue||(window._gsQueue=[])).push(function(){window._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,n){var r=function(e,t,r){n.call(this,e,t,r),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0},i=function(e){return e.jquery||typeof e.each=="function"&&e[0]&&e[0].nodeType&&e[0].style},s=function(e){var t=[];return e.each(function(){t.push(this)}),t},o=r.prototype=n.to({},.1,{}),u=[];r.version="1.9.1",o.constructor=r,o.kill()._gc=!1,r.killTweensOf=r.killDelayedCallsTo=n.killTweensOf,r.getTweensOf=n.getTweensOf,r.ticker=n.ticker,o.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),n.prototype.invalidate.call(this)},o.updateTo=function(e,t){var r=this.ratio,i;t&&this.timeline&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(i in e)this.vars[i]=e[i];if(this._initted)if(t)this._initted=!1;else{this._notifyPluginsOfEnabled&&this._firstPT&&n._onPluginEvent("_onDisable",this);if(this._time/this._duration>.998){var s=this._time;this.render(0,!0,!1),this._initted=!1,this.render(s,!0,!1)}else if(this._time>0){this._initted=!1,this._init();var o=1/(1-r),u=this._firstPT,a;while(u)a=u.s+u.c,u.c*=o,u.s=a-u.c,u=u._next}}return this},o.render=function(e,t,n){var r=this._dirty?this.totalDuration():this._totalDuration,i=this._time,s=this._totalTime,o=this._cycle,a,f,l,c,h,p,d;if(e>=r)this._totalTime=r,this._cycle=this._repeat,this._yoyo&&(this._cycle&1)!==0?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(a=!0,f="onComplete"),this._duration===0&&((e===0||this._rawPrevTime<0)&&this._rawPrevTime!==e&&(n=!0),this._rawPrevTime=e);else if(e<=0){this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0;if(s!==0||this._duration===0&&this._rawPrevTime>0)f="onReverseComplete",a=this._reversed;e<0?(this._active=!1,this._duration===0&&(this._rawPrevTime>=0&&(n=!0),this._rawPrevTime=e)):this._initted||(n=!0)}else{this._totalTime=this._time=e,this._repeat!==0&&(c=this._duration+this._repeatDelay,this._cycle=this._totalTime/c>>0,this._cycle!==0&&this._cycle===this._totalTime/c&&this._cycle--,this._time=this._totalTime-this._cycle*c,this._yoyo&&(this._cycle&1)!==0&&(this._time=this._duration-this._time),this._time>this._duration?this._time=this._duration:this._time<0&&(this._time=0));if(this._easeType){h=this._time/this._duration,p=this._easeType,d=this._easePower;if(p===1||p===3&&h>=.5)h=1-h;p===3&&(h*=2),d===1?h*=h:d===2?h*=h*h:d===3?h*=h*h*h:d===4&&(h*=h*h*h*h),p===1?this.ratio=1-h:p===2?this.ratio=h:this._time/this._duration<.5?this.ratio=h/2:this.ratio=1-h/2}else this.ratio=this._ease.getRatio(this._time/this._duration)}if(i===this._time&&!n){s!==this._totalTime&&this._onUpdate&&(t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||u));return}if(!this._initted){this._init();if(!this._initted)return;this._time&&!a?this.ratio=this._ease.getRatio(this._time/this._duration):a&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}this._active||this._paused||(this._active=!0),s===0&&(this._startAt&&this._startAt.render(e,t,n),this.vars.onStart&&(this._totalTime!==0||this._duration===0)&&(t||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||u))),l=this._firstPT;while(l)l.f?l.t[l.p](l.c*this.ratio+l.s):l.t[l.p]=l.c*this.ratio+l.s,l=l._next;this._onUpdate&&(e<0&&this._startAt&&this._startAt.render(e,t,n),t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||u)),this._cycle!==o&&(t||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||u)),f&&(this._gc||(e<0&&this._startAt&&(this._onUpdate||this._startAt.render(e,t,n)),a&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),t||this.vars[f]&&this.vars[f].apply(this.vars[f+"Scope"]||this,this.vars[f+"Params"]||u)))},r.to=function(e,t,n){return new r(e,t,n)},r.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=n.immediateRender!=0,new r(e,t,n)},r.fromTo=function(e,t,n,i){return i.startAt=n,i.immediateRender=i.immediateRender!=0&&n.immediateRender!=0,new r(e,t,i)},r.staggerTo=r.allTo=function(e,t,o,a,f,l,c){a=a||0;var h=o.delay||0,p=[],d=function(){o.onComplete&&o.onComplete.apply(o.onCompleteScope||this,o.onCompleteParams||u),f.apply(c||this,l||u)},v,m,g,y;e instanceof Array||(typeof e=="string"&&(e=n.selector(e)||e),i(e)&&(e=s(e))),v=e.length;for(g=0;g<v;g++){m={};for(y in o)m[y]=o[y];m.delay=h,g===v-1&&f&&(m.onComplete=d),p[g]=new r(e[g],t,m),h+=a}return p},r.staggerFrom=r.allFrom=function(e,t,n,i,s,o,u){return n.runBackwards=!0,n.immediateRender=n.immediateRender!=0,r.staggerTo(e,t,n,i,s,o,u)},r.staggerFromTo=r.allFromTo=function(e,t,n,i,s,o,u,a){return i.startAt=n,i.immediateRender=i.immediateRender!=0&&n.immediateRender!=0,r.staggerTo(e,t,i,s,o,u,a)},r.delayedCall=function(e,t,n,i,s){return new r(t,0,{delay:e,onComplete:t,onCompleteParams:n,onCompleteScope:i,onReverseComplete:t,onReverseCompleteParams:n,onReverseCompleteScope:i,immediateRender:!1,useFrames:s,overwrite:0})},r.set=function(e,t){return new r(e,0,t)},r.isTweening=function(e){var t=n.getTweensOf(e),r=t.length,i;while(--r>-1){i=t[r];if(i._active||i._startTime===i._timeline._time&&i._timeline._active)return!0}return!1};var a=function(e,t){var r=[],i=0,s=e._first;while(s)s instanceof n?r[i++]=s:(t&&(r[i++]=s),r=r.concat(a(s,t)),i=r.length),s=s._next;return r},f=r.getAllTweens=function(t){return a(e._rootTimeline,t).concat(a(e._rootFramesTimeline,t))};r.killAll=function(e,n,r,i){n==null&&(n=!0),r==null&&(r=!0);var s=f(i!=0),o=s.length,u=n&&r&&i,a,l,c;for(c=0;c<o;c++){l=s[c];if(u||l instanceof t||(a=l.target===l.vars.onComplete)&&r||n&&!a)e?l.totalTime(l.totalDuration()):l._enabled(!1,!1)}},r.killChildTweensOf=function(e,t){if(e==null)return;var o=n._tweenLookup,u,a,f,l,c;typeof e=="string"&&(e=n.selector(e)||e),i(e)&&(e=s(e));if(e instanceof Array){l=e.length;while(--l>-1)r.killChildTweensOf(e[l],t);return}u=[];for(f in o){a=o[f].target.parentNode;while(a)a===e&&(u=u.concat(o[f].tweens)),a=a.parentNode}c=u.length;for(l=0;l<c;l++)t&&u[l].totalTime(u[l].totalDuration()),u[l]._enabled(!1,!1)};var l=function(e,n,r,i){n===undefined&&(n=!0),r===undefined&&(r=!0);var s=f(i),o=n&&r&&i,u=s.length,a,l;while(--u>-1)l=s[u],(o||l instanceof t||(a=l.target===l.vars.onComplete)&&r||n&&!a)&&l.paused(e)};return r.pauseAll=function(e,t,n){l(!0,e,t,n)},r.resumeAll=function(e,t,n){l(!1,e,t,n)},o.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&(this._cycle&1)!==0?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},o.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},o.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&(this._cycle&1)!==0?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},o.duration=function(t){return arguments.length?e.prototype.duration.call(this,t):this._duration},o.totalDuration=function(e){return arguments.length?this._repeat===-1?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},o.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},o.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},o.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},r},!0),window._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,n){var r=function(e){t.call(this,e),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var n=this.vars,r=i.length,s,o;while(--r>-1){o=n[i[r]];if(o){s=o.length;while(--s>-1)o[s]==="{self}"&&(o=n[i[r]]=o.concat(),o[s]=this)}}n.tweens instanceof Array&&this.add(n.tweens,0,n.align,n.stagger)},i=["onStartParams","onUpdateParams","onCompleteParams","onReverseCompleteParams","onRepeatParams"],s=[],o=function(e){var t={},n;for(n in e)t[n]=e[n];return t},u=r.prototype=new t;return r.version="1.9.1",u.constructor=r,u.kill()._gc=!1,u.to=function(e,t,r,i){return this.add(new n(e,t,r),i)},u.from=function(e,t,r,i){return this.add(n.from(e,t,r),i)},u.fromTo=function(e,t,r,i,s){return this.add(n.fromTo(e,t,r,i),s)},u.staggerTo=function(e,t,i,s,u,a,f,l){var c=new r({onComplete:a,onCompleteParams:f,onCompleteScope:l}),h,p;typeof e=="string"&&(e=n.selector(e)||e),!(e instanceof Array)&&typeof e.each=="function"&&e[0]&&e[0].nodeType&&e[0].style&&(p=[],e.each(function(){p.push(this)}),e=p),s=s||0;for(h=0;h<e.length;h++)i.startAt&&(i.startAt=o(i.startAt)),c.add(new n(e[h],t,o(i)),h*s);return this.add(c,u)},u.staggerFrom=function(e,t,n,r,i,s,o,u){return n.immediateRender=n.immediateRender!=0,n.runBackwards=!0,this.staggerTo(e,t,n,r,i,s,o,u)},u.staggerFromTo=function(e,t,n,r,i,s,o,u,a){return r.startAt=n,r.immediateRender=r.immediateRender!=0&&n.immediateRender!=0,this.staggerTo(e,t,r,i,s,o,u,a)},u.call=function(e,t,r,i){return this.add(n.delayedCall(0,e,t,r),i)},u.set=function(e,t,r){return r=this._parseTimeOrLabel(r,0,!0),t.immediateRender==null&&(t.immediateRender=r===this._time&&!this._paused),this.add(new n(e,0,t),r)},r.exportRoot=function(e,t){e=e||{},e.smoothChildTiming==null&&(e.smoothChildTiming=!0);var i=new r(e),s=i._timeline,o,u;t==null&&(t=!0),s._remove(i,!0),i._startTime=0,i._rawPrevTime=i._time=i._totalTime=s._time,o=s._first;while(o)u=o._next,(!t||!(o instanceof n&&o.target===o.vars.onComplete))&&i.add(o,o._startTime-o._delay),o=u;return s.add(i,0),i},u.add=function(i,s,o,u){var a,f,l,c,h;typeof s!="number"&&(s=this._parseTimeOrLabel(s,0,!0,i));if(!(i instanceof e)){if(i instanceof Array){o=o||"normal",u=u||0,a=s,f=i.length;for(l=0;l<f;l++)(c=i[l])instanceof Array&&(c=new r({tweens:c})),this.add(c,a),typeof c!="string"&&typeof c!="function"&&(o==="sequence"?a=c._startTime+c.totalDuration()/c._timeScale:o==="start"&&(c._startTime-=c.delay())),a+=u;return this._uncache(!0)}if(typeof i=="string")return this.addLabel(i,s);if(typeof i!="function")throw"Cannot add "+i+" into the timeline: it is neither a tween, timeline, function, nor a string.";i=n.delayedCall(0,i)}t.prototype.add.call(this,i,s);if(this._gc&&!this._paused&&this._time===this._duration&&this._time<this.duration()){h=this;while(h._gc&&h._timeline)h._timeline.smoothChildTiming?h.totalTime(h._totalTime,!0):h._enabled(!0,!1),h=h._timeline}return this},u.remove=function(t){if(t instanceof e)return this._remove(t,!1);if(t instanceof Array){var n=t.length;while(--n>-1)this.remove(t[n]);return this}return typeof t=="string"?this.removeLabel(t):this.kill(null,t)},u.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},u.insert=u.insertMultiple=function(e,t,n,r){return this.add(e,t||0,n,r)},u.appendMultiple=function(e,t,n,r){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),n,r)},u.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},u.removeLabel=function(e){return delete this._labels[e],this},u.getLabelTime=function(e){return this._labels[e]!=null?this._labels[e]:-1},u._parseTimeOrLabel=function(t,n,r,i){var s;if(i instanceof e&&i.timeline===this)this.remove(i);else if(i instanceof Array){s=i.length;while(--s>-1)i[s]instanceof e&&i[s].timeline===this&&this.remove(i[s])}if(typeof n=="string")return this._parseTimeOrLabel(n,r&&typeof t=="number"&&this._labels[n]==null?t-this.duration():0,r);n=n||0;if(typeof t!="string"||!isNaN(t)&&this._labels[t]==null)t==null&&(t=this.duration());else{s=t.indexOf("=");if(s===-1)return this._labels[t]==null?r?this._labels[t]=this.duration()+n:n:this._labels[t]+n;n=parseInt(t.charAt(s-1)+"1",10)*Number(t.substr(s+1)),t=s>1?this._parseTimeOrLabel(t.substr(0,s-1),0,r):this.duration()}return Number(t)+n},u.seek=function(e,t){return this.totalTime(typeof e=="number"?e:this._parseTimeOrLabel(e),t!==!1)},u.stop=function(){return this.paused(!0)},u.gotoAndPlay=function(e,t){return this.play(e,t)},u.gotoAndStop=function(e,t){return this.pause(e,t)},u.render=function(e,t,n){this._gc&&this._enabled(!0,!1),this._active=!this._paused;var r=this._dirty?this.totalDuration():this._totalDuration,i=this._time,o=this._startTime,u=this._timeScale,a=this._paused,f,l,c,h,p;if(e>=r)this._totalTime=this._time=r,this._reversed||this._hasPausedChild()||(l=!0,h="onComplete",this._duration===0&&(e===0||this._rawPrevTime<0)&&this._rawPrevTime!==e&&(p=!0)),this._rawPrevTime=e,e=r+1e-6;else if(e<=0){this._totalTime=this._time=0;if(i!==0||this._duration===0&&this._rawPrevTime>0)h="onReverseComplete",l=this._reversed;e<0?(this._active=!1,this._duration===0&&this._rawPrevTime>=0&&(p=!0)):this._initted||(p=!0),this._rawPrevTime=e,e=-0.000001}else this._totalTime=this._time=this._rawPrevTime=e;if(this._time===i&&!n&&!p)return;this._initted||(this._initted=!0),i===0&&this.vars.onStart&&this._time!==0&&(t||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||s));if(this._time>i){f=this._first;while(f){c=f._next;if(this._paused&&!a)break;if(f._active||f._startTime<=this._time&&!f._paused&&!f._gc)f._reversed?f.render((f._dirty?f.totalDuration():f._totalDuration)-(e-f._startTime)*f._timeScale,t,n):f.render((e-f._startTime)*f._timeScale,t,n);f=c}}else{f=this._last;while(f){c=f._prev;if(this._paused&&!a)break;if(f._active||f._startTime<=i&&!f._paused&&!f._gc)f._reversed?f.render((f._dirty?f.totalDuration():f._totalDuration)-(e-f._startTime)*f._timeScale,t,n):f.render((e-f._startTime)*f._timeScale,t,n);f=c}}this._onUpdate&&(t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||s)),h&&!this._gc&&(o===this._startTime||u!==this._timeScale)&&(this._time===0||r>=this.totalDuration())&&(l&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),t||this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||s))},u._hasPausedChild=function(){var e=this._first;while(e){if(e._paused||e instanceof r&&e._hasPausedChild())return!0;e=e._next}return!1},u.getChildren=function(e,t,r,i){i=i||-9999999999;var s=[],o=this._first,u=0;while(o)o._startTime<i||(o instanceof n?t!==!1&&(s[u++]=o):(r!==!1&&(s[u++]=o),e!==!1&&(s=s.concat(o.getChildren(!0,t,r)),u=s.length))),o=o._next;return s},u.getTweensOf=function(e,t){var r=n.getTweensOf(e),i=r.length,s=[],o=0;while(--i>-1)if(r[i].timeline===this||t&&this._contains(r[i]))s[o++]=r[i];return s},u._contains=function(e){var t=e.timeline;while(t){if(t===this)return!0;t=t.timeline}return!1},u.shiftChildren=function(e,t,n){n=n||0;var r=this._first,i=this._labels,s;while(r)r._startTime>=n&&(r._startTime+=e),r=r._next;if(t)for(s in i)i[s]>=n&&(i[s]+=e);return this._uncache(!0)},u._kill=function(e,t){if(!e&&!t)return this._enabled(!1,!1);var n=t?this.getTweensOf(t):this.getChildren(!0,!0,!1),r=n.length,i=!1;while(--r>-1)n[r]._kill(e,t)&&(i=!0);return i},u.clear=function(e){var t=this.getChildren(!1,!0,!0),n=t.length;this._time=this._totalTime=0;while(--n>-1)t[n]._enabled(!1,!1);return e!==!1&&(this._labels={}),this._uncache(!0)},u.invalidate=function(){var e=this._first;while(e)e.invalidate(),e=e._next;return this},u._enabled=function(e,n){if(e===this._gc){var r=this._first;while(r)r._enabled(e,!0),r=r._next}return t.prototype._enabled.call(this,e,n)},u.progress=function(e){return arguments.length?this.totalTime(this.duration()*e,!1):this._time/this.duration()},u.duration=function(e){return arguments.length?(this.duration()!==0&&e!==0&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},u.totalDuration=function(e){if(!arguments.length){if(this._dirty){var t=0,n=this._last,r=999999999999,i,s;while(n)i=n._prev,n._dirty&&n.totalDuration(),n._startTime>r&&this._sortChildren&&!n._paused?this.add(n,n._startTime-n._delay):r=n._startTime,n._startTime<0&&!n._paused&&(t-=n._startTime,this._timeline.smoothChildTiming&&(this._startTime+=n._startTime/this._timeScale),this.shiftChildren(-n._startTime,!1,-9999999999),r=0),s=n._startTime+n._totalDuration/n._timeScale,s>t&&(t=s),n=i;this._duration=this._totalDuration=t,this._dirty=!1}return this._totalDuration}return this.totalDuration()!==0&&e!==0&&this.timeScale(this._totalDuration/e),this},u.usesFrames=function(){var t=this._timeline;while(t._timeline)t=t._timeline;return t===e._rootFramesTimeline},u.rawTime=function(){return this._paused||this._totalTime!==0&&this._totalTime!==this._totalDuration?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},r},!0),window._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(e,t,n){var r=function(t){e.call(this,t),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},i=[],s=new n(null,null,1,0),o=function(e){while(e){if(e._paused)return!0;e=e._timeline}return!1},u=r.prototype=new e;return u.constructor=r,u.kill()._gc=!1,r.version="1.9.1",u.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),e.prototype.invalidate.call(this)},u.addCallback=function(e,n,r,i){return this.add(t.delayedCall(0,e,r,i),n)},u.removeCallback=function(e,t){if(t==null)this._kill(null,e);else{var n=this.getTweensOf(e,!1),r=n.length,i=this._parseTimeOrLabel(t);while(--r>-1)n[r]._startTime===i&&n[r]._enabled(!1,!1)}return this},u.tweenTo=function(e,n){n=n||{};var r={ease:s,overwrite:2,useFrames:this.usesFrames(),immediateRender:!1},o,u;for(o in n)r[o]=n[o];return r.time=this._parseTimeOrLabel(e),u=new t(this,Math.abs(Number(r.time)-this._time)/this._timeScale||.001,r),r.onStart=function(){u.target.paused(!0),u.vars.time!==u.target.time()&&u.duration(Math.abs(u.vars.time-u.target.time())/u.target._timeScale),n.onStart&&n.onStart.apply(n.onStartScope||u,n.onStartParams||i)},u},u.tweenFromTo=function(e,t,n){n=n||{},n.startAt={time:this._parseTimeOrLabel(e)};var r=this.tweenTo(t,n);return r.duration(Math.abs(r.vars.time-r.vars.startAt.time)/this._timeScale||.001)},u.render=function(e,t,n){this._gc&&this._enabled(!0,!1),this._active=!this._paused;var r=this._dirty?this.totalDuration():this._totalDuration,s=this._duration,o=this._time,u=this._totalTime,a=this._startTime,f=this._timeScale,l=this._rawPrevTime,c=this._paused,h=this._cycle,p,d,v,m,g;if(e>=r)this._locked||(this._totalTime=r,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(d=!0,m="onComplete",s===0&&(e===0||this._rawPrevTime<0)&&this._rawPrevTime!==e&&(g=!0)),this._rawPrevTime=e,this._yoyo&&(this._cycle&1)!==0?(this._time=0,e=-0.000001):(this._time=s,e=s+1e-6);else if(e<=0){this._locked||(this._totalTime=this._cycle=0),this._time=0;if(o!==0||s===0&&this._rawPrevTime>0&&!this._locked)m="onReverseComplete",d=this._reversed;e<0?(this._active=!1,s===0&&this._rawPrevTime>=0&&(g=!0)):this._initted||(g=!0),this._rawPrevTime=e,e=s===0?0:-0.000001}else{this._time=this._rawPrevTime=e;if(!this._locked){this._totalTime=e;if(this._repeat!==0){var y=s+this._repeatDelay;this._cycle=this._totalTime/y>>0,this._cycle!==0&&this._cycle===this._totalTime/y&&this._cycle--,this._time=this._totalTime-this._cycle*y,this._yoyo&&(this._cycle&1)!==0&&(this._time=s-this._time),this._time>s?(this._time=s,e=s+1e-6):this._time<0?this._time=e=0:e=this._time}}}if(this._cycle!==h&&!this._locked){var b=this._yoyo&&(h&1)!==0,w=b===(this._yoyo&&(this._cycle&1)!==0),E=this._totalTime,S=this._cycle,x=this._rawPrevTime,T=this._time;this._totalTime=h*s,this._cycle<h?b=!b:this._totalTime+=s,this._time=o,this._rawPrevTime=s===0?l-1e-5:l,this._cycle=h,this._locked=!0,o=b?0:s,this.render(o,t,s===0),t||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||i),w&&(o=b?s+1e-6:-0.000001,this.render(o,!0,!1)),this._time=T,this._totalTime=E,this._cycle=S,this._rawPrevTime=x,this._locked=!1}if(this._time===o&&!n&&!g){u!==this._totalTime&&this._onUpdate&&(t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||i));return}this._initted||(this._initted=!0),u===0&&this.vars.onStart&&this._totalTime!==0&&(t||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||i));if(this._time>o){p=this._first;while(p){v=p._next;if(this._paused&&!c)break;if(p._active||p._startTime<=this._time&&!p._paused&&!p._gc)p._reversed?p.render((p._dirty?p.totalDuration():p._totalDuration)-(e-p._startTime)*p._timeScale,t,n):p.render((e-p._startTime)*p._timeScale,t,n);p=v}}else{p=this._last;while(p){v=p._prev;if(this._paused&&!c)break;if(p._active||p._startTime<=o&&!p._paused&&!p._gc)p._reversed?p.render((p._dirty?p.totalDuration():p._totalDuration)-(e-p._startTime)*p._timeScale,t,n):p.render((e-p._startTime)*p._timeScale,t,n);p=v}}this._onUpdate&&(t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||i)),m&&(this._locked||!this._gc&&(a===this._startTime||f!==this._timeScale)&&(this._time===0||r>=this.totalDuration())&&(d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),t||this.vars[m]&&this.vars[m].apply(this.vars[m+"Scope"]||this,this.vars[m+"Params"]||i)))},u.getActive=function(e,t,n){e==null&&(e=!0),t==null&&(t=!0),n==null&&(n=!1);var r=[],i=this.getChildren(e,t,n),s=0,u=i.length,a,f;for(a=0;a<u;a++)f=i[a],f._paused||f._timeline._time>=f._startTime&&f._timeline._time<f._startTime+f._totalDuration/f._timeScale&&(o(f._timeline)||(r[s++]=f));return r},u.getLabelAfter=function(e){e||e!==0&&(e=this._time);var t=this.getLabelsArray(),n=t.length,r;for(r=0;r<n;r++)if(t[r].time>e)return t[r].name;return null},u.getLabelBefore=function(e){e==null&&(e=this._time);var t=this.getLabelsArray(),n=t.length;while(--n>-1)if(t[n].time<e)return t[n].name;return null},u.getLabelsArray=function(){var e=[],t=0,n;for(n in this._labels)e[t++]={time:this._labels[n],name:n};return e.sort(function(e,t){return e.time-t.time}),e},u.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&(this._cycle&1)!==0?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},u.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},u.totalDuration=function(t){return arguments.length?this._repeat===-1?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(e.prototype.totalDuration.call(this),this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},u.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&(this._cycle&1)!==0?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},u.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},u.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},u.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},u.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},r},!0),function(){var e=180/Math.PI,t=Math.PI/180,n=[],r=[],i=[],s={},o=function(e,t,n,r){this.a=e,this.b=t,this.c=n,this.d=r,this.da=r-e,this.ca=n-e,this.ba=t-e},u=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",a=function(e,t,n,r){var i={a:e},s={},o={},u={c:r},a=(e+t)/2,f=(t+n)/2,l=(n+r)/2,c=(a+f)/2,h=(f+l)/2,p=(h-c)/8;return i.b=a+(e-a)/4,s.b=c+p,i.c=s.a=(i.b+s.b)/2,s.c=o.a=(c+h)/2,o.b=h-p,u.b=l+(r-l)/4,o.c=u.a=(o.b+u.b)/2,[i,s,o,u]},f=function(e,t,s,o,u){var f=e.length-1,l=0,c=e[0].a,h,p,d,v,m,g,y,b,w,E,S,x,T;for(h=0;h<f;h++)m=e[l],p=m.a,d=m.d,v=e[l+1].d,u?(S=n[h],x=r[h],T=(x+S)*t*.25/(o?.5:i[h]||.5),g=d-(d-p)*(o?t*.5:T/S),y=d+(v-d)*(o?t*.5:T/x),b=d-(g+(y-g)*(S*3/(S+x)+.5)/4)):(g=d-(d-p)*t*.5,y=d+(v-d)*t*.5,b=d-(g+y)/2),g+=b,y+=b,m.c=w=g,h!==0?m.b=c:m.b=c=m.a+(m.c-m.a)*.6,m.da=d-p,m.ca=w-p,m.ba=c-p,s?(E=a(p,c,w,d),e.splice(l,1,E[0],E[1],E[2],E[3]),l+=4):l++,c=y;m=e[l],m.b=c,m.c=c+(m.d-c)*.4,m.da=m.d-m.a,m.ca=m.c-m.a,m.ba=c-m.a,s&&(E=a(m.a,c,m.c,m.d),e.splice(l,1,E[0],E[1],E[2],E[3]))},l=function(e,t,i,s){var u=[],a,f,l,c,h,p;if(s){e=[s].concat(e),f=e.length;while(--f>-1)typeof (p=e[f][t])=="string"&&p.charAt(1)==="="&&(e[f][t]=s[t]+Number(p.charAt(0)+p.substr(2)))}a=e.length-2;if(a<0)return u[0]=new o(e[0][t],0,0,e[a<-1?0:1][t]),u;for(f=0;f<a;f++)l=e[f][t],c=e[f+1][t],u[f]=new o(l,0,0,c),i&&(h=e[f+2][t],n[f]=(n[f]||0)+(c-l)*(c-l),r[f]=(r[f]||0)+(h-c)*(h-c));return u[f]=new o(e[f][t],0,0,e[f+1][t]),u},c=function(e,t,o,a,c,h){var p={},d=[],v=h||e[0],m,g,y,b,w,E,S,x;c=typeof c=="string"?","+c+",":u,t==null&&(t=1);for(g in e[0])d.push(g);if(e.length>1){x=e[e.length-1],S=!0,m=d.length;while(--m>-1){g=d[m];if(Math.abs(v[g]-x[g])>.05){S=!1;break}}S&&(e=e.concat(),h&&e.unshift(h),e.push(e[1]),h=e[e.length-3])}n.length=r.length=i.length=0,m=d.length;while(--m>-1)g=d[m],s[g]=c.indexOf(","+g+",")!==-1,p[g]=l(e,g,s[g],h);m=n.length;while(--m>-1)n[m]=Math.sqrt(n[m]),r[m]=Math.sqrt(r[m]);if(!a){m=d.length;while(--m>-1)if(s[g]){y=p[d[m]],E=y.length-1;for(b=0;b<E;b++)w=y[b+1].da/r[b]+y[b].da/n[b],i[b]=(i[b]||0)+w*w}m=i.length;while(--m>-1)i[m]=Math.sqrt(i[m])}m=d.length,b=o?4:1;while(--m>-1)g=d[m],y=p[g],f(y,t,o,a,s[g]),S&&(y.splice(0,b),y.splice(y.length-b,b));return p},h=function(e,t,n){t=t||"soft";var r={},i=t==="cubic"?3:2,s=t==="soft",u=[],a,f,l,c,h,p,d,v,m,g,y;s&&n&&(e=[n].concat(e));if(e==null||e.length<i+1)throw"invalid Bezier data";for(m in e[0])u.push(m);p=u.length;while(--p>-1){m=u[p],r[m]=h=[],g=0,v=e.length;for(d=0;d<v;d++)a=n==null?e[d][m]:typeof (y=e[d][m])=="string"&&y.charAt(1)==="="?n[m]+Number(y.charAt(0)+y.substr(2)):Number(y),s&&d>1&&d<v-1&&(h[g++]=(a+h[g-2])/2),h[g++]=a;v=g-i+1,g=0;for(d=0;d<v;d+=i)a=h[d],f=h[d+1],l=h[d+2],c=i===2?0:h[d+3],h[g++]=y=i===3?new o(a,f,l,c):new o(a,(2*f+a)/3,(2*f+l)/3,l);h.length=g}return r},p=function(e,t,n){var r=1/n,i=e.length,s,o,u,a,f,l,c,h,p,d,v;while(--i>-1){d=e[i],u=d.a,a=d.d-u,f=d.c-u,l=d.b-u,s=o=0;for(h=1;h<=n;h++)c=r*h,p=1-c,s=o-(o=(c*c*a+3*p*(c*f+p*l))*c),v=i*n+h-1,t[v]=(t[v]||0)+s*s}},d=function(e,t){t=t>>0||6;var n=[],r=[],i=0,s=0,o=t-1,u=[],a=[],f,l,c,h;for(f in e)p(e[f],n,t);c=n.length;for(l=0;l<c;l++)i+=Math.sqrt(n[l]),h=l%t,a[h]=i,h===o&&(s+=i,h=l/t>>0,u[h]=a,r[h]=s,i=0,a=[]);return{length:s,lengths:r,segments:u}},v=window._gsDefine.plugin({propName:"bezier",priority:-1,API:2,init:function(e,t,n){this._target=e,t instanceof Array&&(t={values:t}),this._func={},this._round={},this._props=[],this._timeRes=t.timeResolution==null?6:parseInt(t.timeResolution,10);var r=t.values||[],i={},s=r[0],o=t.autoRotate||n.vars.orientToBezier,u,a,f,l,p;this._autoRotate=o?o instanceof Array?o:[["x","y","rotation",o===!0?0:Number(o)||0]]:null;for(u in s)this._props.push(u);f=this._props.length;while(--f>-1)u=this._props[f],this._overwriteProps.push(u),a=this._func[u]=typeof e[u]=="function",i[u]=a?e[u.indexOf("set")||typeof e["get"+u.substr(3)]!="function"?u:"get"+u.substr(3)]():parseFloat(e[u]),p||i[u]!==r[0][u]&&(p=i);this._beziers=t.type!=="cubic"&&t.type!=="quadratic"&&t.type!=="soft"?c(r,isNaN(t.curviness)?1:t.curviness,!1,t.type==="thruBasic",t.correlate,p):h(r,t.type,i),this._segCount=this._beziers[u].length;if(this._timeRes){var v=d(this._beziers,this._timeRes);this._length=v.length,this._lengths=v.lengths,this._segments=v.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(o=this._autoRotate){o[0]instanceof Array||(this._autoRotate=o=[o]),f=o.length;while(--f>-1)for(l=0;l<3;l++)u=o[f][l],this._func[u]=typeof e[u]=="function"?e[u.indexOf("set")||typeof e["get"+u.substr(3)]!="function"?u:"get"+u.substr(3)]:!1}return!0},set:function(t){var n=this._segCount,r=this._func,i=this._target,s,o,u,a,f,l,c,h,p,d;if(!this._timeRes)s=t<0?0:t>=1?n-1:n*t>>0,l=(t-s*(1/n))*n;else{p=this._lengths,d=this._curSeg,t*=this._length,u=this._li;if(t>this._l2&&u<n-1){h=n-1;while(u<h&&(this._l2=p[++u])<=t);this._l1=p[u-1],this._li=u,this._curSeg=d=this._segments[u],this._s2=d[this._s1=this._si=0]}else if(t<this._l1&&u>0){while(u>0&&(this._l1=p[--u])>=t);u===0&&t<this._l1?this._l1=0:u++,this._l2=p[u],this._li=u,this._curSeg=d=this._segments[u],this._s1=d[(this._si=d.length-1)-1]||0,this._s2=d[this._si]}s=u,t-=this._l1,u=this._si;if(t>this._s2&&u<d.length-1){h=d.length-1;while(u<h&&(this._s2=d[++u])<=t);this._s1=d[u-1],this._si=u}else if(t<this._s1&&u>0){while(u>0&&(this._s1=d[--u])>=t);u===0&&t<this._s1?this._s1=0:u++,this._s2=d[u],this._si=u}l=(u+(t-this._s1)/(this._s2-this._s1))*this._prec}o=1-l,u=this._props.length;while(--u>-1)a=this._props[u],f=this._beziers[a][s],c=(l*l*f.da+3*o*(l*f.ca+o*f.ba))*l+f.a,this._round[a]&&(c=c+(c>0?.5:-0.5)>>0),r[a]?i[a](c):i[a]=c;if(this._autoRotate){var v=this._autoRotate,m,g,y,b,w,E,S;u=v.length;while(--u>-1)a=v[u][2],E=v[u][3]||0,S=v[u][4]===!0?1:e,f=this._beziers[v[u][0]][s],m=this._beziers[v[u][1]][s],g=f.a+(f.b-f.a)*l,b=f.b+(f.c-f.b)*l,g+=(b-g)*l,b+=(f.c+(f.d-f.c)*l-b)*l,y=m.a+(m.b-m.a)*l,w=m.b+(m.c-m.b)*l,y+=(w-y)*l,w+=(m.c+(m.d-m.c)*l-w)*l,c=Math.atan2(w-y,b-g)*S+E,r[a]?r[a].call(i,c+3.1415):i[a]=c+3.1415}}}),m=v.prototype;v.bezierThrough=c,v.cubicToQuadratic=a,v._autoCSS=!0,v.quadraticToCubic=function(e,t,n){return new o(e,(2*t+e)/3,(2*t+n)/3,n)},v._cssRegister=function(){var e=window._gsDefine.globals.CSSPlugin;if(!e)return;var n=e._internals,r=n._parseToProxy,i=n._setPluginRatio,s=n.CSSPropTween;n._registerComplexSpecialProp("bezier",{parser:function(e,n,o,u,a,f){n instanceof Array&&(n={values:n}),f=new v;var l=n.values,c=l.length-1,h=[],p={},d,m,g;if(c<0)return a;for(d=0;d<=c;d++)g=r(e,l[d],u,a,f,c!==d),h[d]=g.end;for(m in n)p[m]=n[m];return p.values=h,a=new s(e,"bezier",0,0,g.pt,2),a.data=g,a.plugin=f,a.setRatio=i,p.autoRotate===0&&(p.autoRotate=!0),p.autoRotate&&!(p.autoRotate instanceof Array)&&(d=p.autoRotate===!0?0:Number(p.autoRotate)*t,p.autoRotate=g.end.left!=null?[["left","top","rotation",d,!0]]:g.end.x!=null?[["x","y","rotation",d,!0]]:!1),p.autoRotate&&(u._transform||u._enableTransforms(!1),g.autoRotate=u._target._gsTransform),f._onInitTween(g.proxy,p,u._tween),a}})},m._roundProps=function(e,t){var n=this._overwriteProps,r=n.length;while(--r>-1)if(e[n[r]]||e.bezier||e.bezierThrough)this._round[n[r]]=t},m._kill=function(e){var t=this._props,n,r;for(n in this._beziers)if(n in e){delete this._beziers[n],delete this._func[n],r=t.length;while(--r>-1)t[r]===n&&t.splice(r,1)}return this._super._kill.call(this,e)}}(),window._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var n=function(){e.call(this,"css"),this._overwriteProps.length=0},r,i,s,o,u={},a=n.prototype=new e("css");a.constructor=n,n.version="1.9.1",n.API=2,n.defaultTransformPerspective=0,a="px",n.suffixMap={top:a,right:a,bottom:a,left:a,width:a,height:a,fontSize:a,padding:a,margin:a,perspective:a};var f=/(?:\d|\-\d|\.\d|\-\.\d)+/g,l=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,c=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,h=/[^\d\-\.]/g,p=/(?:\d|\-|\+|=|#|\.)*/g,d=/opacity *= *([^)]*)/,v=/opacity:([^;]*)/,m=/alpha\(opacity *=.+?\)/i,g=/([A-Z])/g,y=/-([a-z])/gi,b=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,w=function(e,t){return t.toUpperCase()},E=/(?:Left|Right|Width)/i,S=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,x=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,T=/,(?=[^\)]*(?:\(|$))/gi,N=Math.PI/180,C=180/Math.PI,k={},L=document,A=L.createElement("div"),O=L.createElement("img"),M=n._internals={_specialProps:u},_=navigator.userAgent,D,P,H,B,j,F,I=function(){var e=_.indexOf("Android"),t=L.createElement("div"),n;return H=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1&&(e===-1||Number(_.substr(e+8,1))>3),j=H&&Number(_.substr(_.indexOf("Version/")+8,1))<6,B=_.indexOf("Firefox")!==-1,/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(_),F=parseFloat(RegExp.$1),t.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",n=t.getElementsByTagName("a")[0],n?/^0.55/.test(n.style.opacity):!1}(),q=function(e){return d.test(typeof e=="string"?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},R=function(e){window.console&&console.log(e)},U="",z="",W=function(e,t){t=t||A;var n=t.style,r,i;if(n[e]!==undefined)return e;e=e.charAt(0).toUpperCase()+e.substr(1),r=["O","Moz","ms","Ms","Webkit"],i=5;while(--i>-1&&n[r[i]+e]===undefined);return i>=0?(z=i===3?"ms":r[i],U="-"+z.toLowerCase()+"-",z+e):null},X=L.defaultView?L.defaultView.getComputedStyle:function(){},V=n.getStyle=function(e,t,n,r,i){var s;return!I&&t==="opacity"?q(e):(!r&&e.style[t]?s=e.style[t]:(n=n||X(e,null))?(e=n.getPropertyValue(t.replace(g,"-$1").toLowerCase()),s=e||n.length?e:n[t]):e.currentStyle&&(n=e.currentStyle,s=n[t]),i==null||!!s&&s!=="none"&&s!=="auto"&&s!=="auto auto"?s:i)},$=function(e,t,n){var r={},i=e._gsOverwrittenClassNamePT,s,o;if(i&&!n){while(i)i.setRatio(0),i=i._next;e._gsOverwrittenClassNamePT=null}if(t=t||X(e,null))if(s=t.length)while(--s>-1)r[t[s].replace(y,w)]=t.getPropertyValue(t[s]);else for(s in t)r[s]=t[s];else if(t=e.currentStyle||e.style)for(s in t)r[s.replace(y,w)]=t[s];return I||(r.opacity=q(e)),o=xt(e,t,!1),r.rotation=o.rotation*C,r.skewX=o.skewX*C,r.scaleX=o.scaleX,r.scaleY=o.scaleY,r.x=o.x,r.y=o.y,St&&(r.z=o.z,r.rotationX=o.rotationX*C,r.rotationY=o.rotationY*C,r.scaleZ=o.scaleZ),r.filters&&delete r.filters,r},J=function(e,t,n,r){var i={},s=e.style,o,u,a;for(u in n)u!=="cssText"&&u!=="length"&&isNaN(u)&&t[u]!==(o=n[u])&&u.indexOf("Origin")===-1&&(typeof o=="number"||typeof o=="string")&&(i[u]=o!==""&&o!=="auto"&&o!=="none"||typeof t[u]!="string"||t[u].replace(h,"")===""?o:0,s[u]!==undefined&&(a=new lt(s,u,s[u],a)));if(r)for(u in r)u!=="className"&&(i[u]=r[u]);return{difs:i,firstMPT:a}},K={width:["Left","Right"],height:["Top","Bottom"]},Q=["marginLeft","marginRight","marginTop","marginBottom"],G=function(e,t,n){var r=parseFloat(t==="width"?e.offsetWidth:e.offsetHeight),i=K[t],s=i.length;n=n||X(e,null);while(--s>-1)r-=parseFloat(V(e,"padding"+i[s],n,!0))||0,r-=parseFloat(V(e,"border"+i[s]+"Width",n,!0))||0;return r},Y=function(e,t,n,r,i){if(r==="px"||!r)return n;if(r==="auto"||!n)return 0;var s=E.test(t),o=e,u=A.style,a=n<0,f;return a&&(n=-n),r==="%"&&t.indexOf("border")!==-1?f=n/100*(s?e.clientWidth:e.clientHeight):(u.cssText="border-style:solid; border-width:0; position:absolute; line-height:0;",r==="%"||!o.appendChild?(o=e.parentNode||L.body,u[s?"width":"height"]=n+r):u[s?"borderLeftWidth":"borderTopWidth"]=n+r,o.appendChild(A),f=parseFloat(A[s?"offsetWidth":"offsetHeight"]),o.removeChild(A),f===0&&!i&&(f=Y(e,t,n,r,!0))),a?-f:f},Z=function(e,t){if(e==null||e===""||e==="auto"||e==="auto auto")e="0 0";var n=e.split(" "),r=e.indexOf("left")!==-1?"0%":e.indexOf("right")!==-1?"100%":n[0],i=e.indexOf("top")!==-1?"0%":e.indexOf("bottom")!==-1?"100%":n[1];i==null?i="0":i==="center"&&(i="50%");if(r==="center"||isNaN(parseFloat(r)))r="50%";return t&&(t.oxp=r.indexOf("%")!==-1,t.oyp=i.indexOf("%")!==-1,t.oxr=r.charAt(1)==="=",t.oyr=i.charAt(1)==="=",t.ox=parseFloat(r.replace(h,"")),t.oy=parseFloat(i.replace(h,""))),r+" "+i+(n.length>2?" "+n[2]:"")},et=function(e,t){return typeof e=="string"&&e.charAt(1)==="="?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},tt=function(e,t){return e==null?t:typeof e=="string"&&e.charAt(1)==="="?parseInt(e.charAt(0)+"1",10)*Number(e.substr(2))+t:parseFloat(e)},nt=function(e,t,n,r){var i=1e-6,s,o,u,a,f;return e==null?f=t:typeof e=="number"?f=e*N:(s=Math.PI*2,o=e.split("_"),u=Number(o[0].replace(h,""))*(e.indexOf("rad")===-1?N:1)-(e.charAt(1)==="="?0:t),a=o[1],a&&r&&(r[n]=t+u),a==="short"?(u%=s,u!==u%(s/2)&&(u=u<0?u+s:u-s)):a==="cw"&&u<0?u=(u+s*9999999999)%s-(u/s|0)*s:a==="ccw"&&u>0&&(u=(u-s*9999999999)%s-(u/s|0)*s),f=t+u),f<i&&f>-i&&(f=0),f},rt={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},it=function(e,t,n){return e=e<0?e+1:e>1?e-1:e,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*255+.5|0},st=function(e){var t,n,r,i,s,o;return!e||e===""?rt.black:typeof e=="number"?[e>>16,e>>8&255,e&255]:(e.charAt(e.length-1)===","&&(e=e.substr(0,e.length-1)),rt[e]?rt[e]:e.charAt(0)==="#"?(e.length===4&&(t=e.charAt(1),n=e.charAt(2),r=e.charAt(3),e="#"+t+t+n+n+r+r),e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):e.substr(0,3)==="hsl"?(e=e.match(f),i=Number(e[0])%360/360,s=Number(e[1])/100,o=Number(e[2])/100,n=o<=.5?o*(s+1):o+s-o*s,t=o*2-n,e.length>3&&(e[3]=Number(e[3])),e[0]=it(i+1/3,t,n),e[1]=it(i,t,n),e[2]=it(i-1/3,t,n),e):(e=e.match(f)||rt.transparent,e[0]=Number(e[0]),e[1]=Number(e[1]),e[2]=Number(e[2]),e.length>3&&(e[3]=Number(e[3])),e))},ot="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(a in rt)ot+="|"+a+"\\b";ot=new RegExp(ot+")","gi");var ut=function(e,t,n,r){if(e==null)return function(e){return e};var i=t?(e.match(ot)||[""])[0]:"",s=e.split(i).join("").match(c)||[],o=e.substr(0,e.indexOf(s[0])),u=e.charAt(e.length-1)===")"?")":"",a=e.indexOf(" ")!==-1?" ":",",l=s.length,h=l>0?s[0].replace(f,""):"",p;return l?t?(p=function(e){var t,f,d,v;if(typeof e=="number")e+=h;else if(r&&T.test(e)){v=e.replace(T,"|").split("|");for(d=0;d<v.length;d++)v[d]=p(v[d]);return v.join(",")}t=(e.match(ot)||[i])[0],f=e.split(t).join("").match(c)||[],d=f.length;if(l>d--)while(++d<l)f[d]=n?f[(d-1)/2>>0]:s[d];return o+f.join(a)+a+t+u+(e.indexOf("inset")!==-1?" inset":"")},p):(p=function(e){var t,i,f;if(typeof e=="number")e+=h;else if(r&&T.test(e)){i=e.replace(T,"|").split("|");for(f=0;f<i.length;f++)i[f]=p(i[f]);return i.join(",")}t=e.match(c)||[],f=t.length;if(l>f--)while(++f<l)t[f]=n?t[(f-1)/2>>0]:s[f];return o+t.join(a)+u},p):function(e){return e}},at=function(e){return e=e.split(","),function(t,n,r,i,s,o,u){var a=(n+"").split(" "),f;u={};for(f=0;f<4;f++)u[e[f]]=a[f]=a[f]||a[(f-1)/2>>0];return i.parse(t,u,s,o)}},ft=M._setPluginRatio=function(e){this.plugin.setRatio(e);var t=this.data,n=t.proxy,r=t.firstMPT,i=1e-6,s,o,u,a;while(r)s=n[r.v],r.r?s=s>0?s+.5>>0:s-.5>>0:s<i&&s>-i&&(s=0),r.t[r.p]=s,r=r._next;t.autoRotate&&(t.autoRotate.rotation=n.rotation);if(e===1){r=t.firstMPT;while(r){o=r.t;if(!o.type)o.e=o.s+o.xs0;else if(o.type===1){a=o.xs0+o.s+o.xs1;for(u=1;u<o.l;u++)a+=o["xn"+u]+o["xs"+(u+1)];o.e=a}r=r._next}}},lt=function(e,t,n,r,i){this.t=e,this.p=t,this.v=n,this.r=i,r&&(r._prev=this,this._next=r)},ct=M._parseToProxy=function(e,t,n,r,i,s){var o=r,u={},a={},f=n._transform,l=k,c,h,p,d,v;n._transform=null,k=t,r=v=n.parse(e,t,r,i),k=l,s&&(n._transform=f,o&&(o._prev=null,o._prev&&(o._prev._next=null)));while(r&&r!==o){if(r.type<=1){h=r.p,a[h]=r.s+r.c,u[h]=r.s,s||(d=new lt(r,"s",h,d,r.r),r.c=0);if(r.type===1){c=r.l;while(--c>0)p="xn"+c,h=r.p+"_"+p,a[h]=r.data[p],u[h]=r[p],s||(d=new lt(r,p,h,d,r.rxp[p]))}}r=r._next}return{proxy:u,end:a,firstMPT:d,pt:v}},ht=M.CSSPropTween=function(e,t,n,i,s,u,a,f,l,c,h){this.t=e,this.p=t,this.s=n,this.c=i,this.n=a||"css_"+t,e instanceof ht||o.push(this.n),this.r=f,this.type=u||0,l&&(this.pr=l,r=!0),this.b=c===undefined?n:c,this.e=h===undefined?n+i:h,s&&(this._next=s,s._prev=this)},pt=n.parseComplex=function(e,t,n,r,i,s,o,u,a,c){o=new ht(e,t,0,0,o,c?2:1,null,!1,u,n,r),r+="";var h=n.split(", ").join(",").split(" "),p=r.split(", ").join(",").split(" "),d=h.length,v=D!==!1,m,g,y,b,w,E,S,x,N,C,k,L;if(r.indexOf(",")!==-1||n.indexOf(",")!==-1)h=h.join(" ").replace(T,", ").split(" "),p=p.join(" ").replace(T,", ").split(" "),d=h.length;d!==p.length&&(h=(s||"").split(" "),d=h.length),o.plugin=a,o.setRatio=c;for(m=0;m<d;m++){b=h[m],w=p[m],x=parseFloat(b);if(x||x===0)o.appendXtra("",x,et(w,x),w.replace(l,""),v&&w.indexOf("px")!==-1,!0);else if(i&&(b.charAt(0)==="#"||b.indexOf("rgb")===0||rt[b]||b.indexOf("hsl")===0))L=w.charAt(w.length-1)===","?"),":")",b=st(b),w=st(w),N=b.length+w.length>6,N&&!I&&w[3]===0?(o["xs"+o.l]+=o.l?" transparent":"transparent",o.e=o.e.split(p[m]).join("transparent")):(I||(N=!1),o.appendXtra(N?"rgba(":"rgb(",b[0],w[0]-b[0],",",!0,!0).appendXtra("",b[1],w[1]-b[1],",",!0).appendXtra("",b[2],w[2]-b[2],N?",":L,!0),N&&(b=b.length<4?1:b[3],o.appendXtra("",b,(w.length<4?1:w[3])-b,L,!1)));else{E=b.match(f);if(!E)o["xs"+o.l]+=o.l?" "+b:b;else{S=w.match(l);if(!S||S.length!==E.length)return o;y=0;for(g=0;g<E.length;g++)k=E[g],C=b.indexOf(k,y),o.appendXtra(b.substr(y,C-y),Number(k),et(S[g],k),"",v&&b.substr(C+k.length,2)==="px",g===0),y=C+k.length;o["xs"+o.l]+=b.substr(y)}}}if(r.indexOf("=")!==-1&&o.data){L=o.xs0+o.data.s;for(m=1;m<o.l;m++)L+=o["xs"+m]+o.data["xn"+m];o.e=L+o["xs"+m]}return o.l||(o.type=-1,o.xs0=o.e),o.xfirst||o},dt=9;a=ht.prototype,a.l=a.pr=0;while(--dt>0)a["xn"+dt]=0,a["xs"+dt]="";a.xs0="",a._next=a._prev=a.xfirst=a.data=a.plugin=a.setRatio=a.rxp=null,a.appendXtra=function(e,t,n,r,i,s){var o=this,u=o.l;return o["xs"+u]+=s&&u?" "+e:e||"",!n&&u!==0&&!o.plugin?(o["xs"+u]+=t+(r||""),o):(o.l++,o.type=o.setRatio?2:1,o["xs"+o.l]=r||"",u>0?(o.data["xn"+u]=t+n,o.rxp["xn"+u]=i,o["xn"+u]=t,o.plugin||(o.xfirst=new ht(o,"xn"+u,t,n,o.xfirst||o,0,o.n,i,o.pr),o.xfirst.xs0=0),o):(o.data={s:t+n},o.rxp={},o.s=t,o.c=n,o.r=i,o))};var vt=function(e,t){t=t||{},this.p=t.prefix?W(e)||e:e,u[e]=u[this.p]=this,this.format=t.formatter||ut(t.defaultValue,t.color,t.collapsible,t.multi),t.parser&&(this.parse=t.parser),this.clrs=t.color,this.multi=t.multi,this.keyword=t.keyword,this.dflt=t.defaultValue,this.pr=t.priority||0},mt=M._registerComplexSpecialProp=function(e,t,n){typeof t!="object"&&(t={parser:n});var r=e.split(","),i=t.defaultValue,s,o;n=n||[i];for(s=0;s<r.length;s++)t.prefix=s===0&&t.prefix,t.defaultValue=n[s]||i,o=new vt(r[s],t)},gt=function(e){if(!u[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";mt(e,{parser:function(e,n,r,i,s,o,a){var f=(window.GreenSockGlobals||window).com.greensock.plugins[t];return f?(f._cssRegister(),u[r].parse(e,n,r,i,s,o,a)):(R("Error: "+t+" js file not loaded."),s)}})}};a=vt.prototype,a.parseComplex=function(e,t,n,r,i,s){var o=this.keyword,u,a,f,l,c,h;this.multi&&(T.test(n)||T.test(t)?(a=t.replace(T,"|").split("|"),f=n.replace(T,"|").split("|")):o&&(a=[t],f=[n]));if(f){l=f.length>a.length?f.length:a.length;for(u=0;u<l;u++)t=a[u]=a[u]||this.dflt,n=f[u]=f[u]||this.dflt,o&&(c=t.indexOf(o),h=n.indexOf(o),c!==h&&(n=h===-1?f:a,n[u]+=" "+o));t=a.join(", "),n=f.join(", ")}return pt(e,this.p,t,n,this.clrs,this.dflt,r,this.pr,i,s)},a.parse=function(e,t,n,r,i,o,u){return this.parseComplex(e.style,this.format(V(e,this.p,s,!1,this.dflt)),this.format(t),i,o)},n.registerSpecialProp=function(e,t,n){mt(e,{parser:function(e,r,i,s,o,u,a){var f=new ht(e,i,0,0,o,2,i,!1,n);return f.plugin=u,f.setRatio=t(e,r,s._tween,i),f},priority:n})};var yt="scaleX,scaleY,scaleZ,x,y,z,skewX,rotation,rotationX,rotationY,perspective".split(","),bt=W("transform"),wt=U+"transform",Et=W("transformOrigin"),St=W("perspective")!==null,xt=function(e,t,r){var i=r?e._gsTransform||{skewY:0}:{skewY:0},s=i.scaleX<0,o=2e-5,u=1e5,a=-Math.PI+1e-4,f=Math.PI-1e-4,l=St?parseFloat(V(e,Et,t,!1,"0 0 0").split(" ")[2])||i.zOrigin||0:0,c,h,p,d,v,m,g,y,b,w,E,x,T;bt?c=V(e,wt,t,!0):e.currentStyle&&(c=e.currentStyle.filter.match(S),c=c&&c.length===4?c[0].substr(4)+","+Number(c[2].substr(4))+","+Number(c[1].substr(4))+","+c[3].substr(4)+","+(i?i.x:0)+","+(i?i.y:0):null),h=(c||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],p=h.length;while(--p>-1)d=Number(h[p]),h[p]=(v=d-(d|=0))?(v*u+(v<0?-0.5:.5)|0)/u+d:d;if(h.length===16){var N=h[8],C=h[9],k=h[10],L=h[12],A=h[13],O=h[14];i.zOrigin&&(O=-i.zOrigin,L=N*O-h[12],A=C*O-h[13],O=k*O+i.zOrigin-h[14]);if(!r||L!==i.x||A!==i.y||O!==i.z){var M=h[0],_=h[1],D=h[2],P=h[3],H=h[4],B=h[5],j=h[6],F=h[7],I=h[11],q=i.rotationX=Math.atan2(j,k),R=q<a||q>f,U,z,W,X,$,J,K,Q;q&&($=Math.cos(-q),J=Math.sin(-q),U=H*$+N*J,z=B*$+C*J,W=j*$+k*J,X=F*$+I*J,N=H*-J+N*$,C=B*-J+C*$,k=j*-J+k*$,I=F*-J+I*$,H=U,B=z,j=W),q=i.rotationY=Math.atan2(N,M),q&&(K=q<a||q>f,$=Math.cos(-q),J=Math.sin(-q),U=M*$-N*J,z=_*$-C*J,W=D*$-k*J,X=P*$-I*J,C=_*J+C*$,k=D*J+k*$,I=P*J+I*$,M=U,_=z,D=W),q=i.rotation=Math.atan2(_,B),q&&(Q=q<a||q>f,$=Math.cos(-q),J=Math.sin(-q),M=M*$+H*J,z=_*$+B*J,B=_*-J+B*$,j=D*-J+j*$,_=z),Q&&R?i.rotation=i.rotationX=0:Q&&K?i.rotation=i.rotationY=0:K&&R&&(i.rotationY=i.rotationX=0),i.scaleX=(Math.sqrt(M*M+_*_)*u+.5>>0)/u,i.scaleY=(Math.sqrt(B*B+C*C)*u+.5>>0)/u,i.scaleZ=(Math.sqrt(j*j+k*k)*u+.5>>0)/u,i.skewX=0,i.perspective=I?1/(I<0?-I:I):0,i.x=L,i.y=A,i.z=O}}else if(!St||h.length===0||i.x!==h[4]||i.y!==h[5]||!i.rotationX&&!i.rotationY){var G=h.length>=6,Y=G?h[0]:1,Z=h[1]||0,et=h[2]||0,tt=G?h[3]:1;i.x=h[4]||0,i.y=h[5]||0,m=Math.sqrt(Y*Y+Z*Z),g=Math.sqrt(tt*tt+et*et),y=Y||Z?Math.atan2(Z,Y):i.rotation||0,b=et||tt?Math.atan2(et,tt)+y:i.skewX||0,w=m-Math.abs(i.scaleX||0),E=g-Math.abs(i.scaleY||0),Math.abs(b)>Math.PI/2&&Math.abs(b)<Math.PI*1.5&&(s?(m*=-1,b+=y<=0?Math.PI:-Math.PI,y+=y<=0?Math.PI:-Math.PI):(g*=-1,b+=b<=0?Math.PI:-Math.PI)),x=(y-i.rotation)%Math.PI,T=(b-i.skewX)%Math.PI;if(i.skewX===undefined||w>o||w<-o||E>o||E<-o||x>a&&x<f&&x*u>>0!==0||T>a&&T<f&&T*u>>0!==0)i.scaleX=m,i.scaleY=g,i.rotation=y,i.skewX=b;St&&(i.rotationX=i.rotationY=i.z=0,i.perspective=parseFloat(n.defaultTransformPerspective)||0,i.scaleZ=1)}i.zOrigin=l;for(p in i)i[p]<o&&i[p]>-o&&(i[p]=0);return r&&(e._gsTransform=i),i},Tt=function(e){var t=this.data,n=-t.rotation,r=n+t.skewX,i=1e5,s=(Math.cos(n)*t.scaleX*i>>0)/i,o=(Math.sin(n)*t.scaleX*i>>0)/i,u=(Math.sin(r)*-t.scaleY*i>>0)/i,a=(Math.cos(r)*t.scaleY*i>>0)/i,f=this.t.style,l=this.t.currentStyle,c,h;if(!l)return;h=o,o=-u,u=-h,c=l.filter,f.filter="";var v=this.t.offsetWidth,m=this.t.offsetHeight,g=l.position!=="absolute",y="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+o+", M21="+u+", M22="+a,b=t.x,w=t.y,E,S;t.ox!=null&&(E=(t.oxp?v*t.ox*.01:t.ox)-v/2,S=(t.oyp?m*t.oy*.01:t.oy)-m/2,b+=E-(E*s+S*o),w+=S-(E*u+S*a));if(!g){var T=F<8?1:-1,N,C,k;E=t.ieOffsetX||0,S=t.ieOffsetY||0,t.ieOffsetX=Math.round((v-((s<0?-s:s)*v+(o<0?-o:o)*m))/2+b),t.ieOffsetY=Math.round((m-((a<0?-a:a)*m+(u<0?-u:u)*v))/2+w);for(dt=0;dt<4;dt++)C=Q[dt],N=l[C],h=N.indexOf("px")!==-1?parseFloat(N):Y(this.t,C,parseFloat(N),N.replace(p,""))||0,h!==t[C]?k=dt<2?-t.ieOffsetX:-t.ieOffsetY:k=dt<2?E-t.ieOffsetX:S-t.ieOffsetY,f[C]=(t[C]=Math.round(h-k*(dt===0||dt===2?1:T)))+"px";y+=", sizingMethod='auto expand')"}else E=v/2,S=m/2,y+=", Dx="+(E-(E*s+S*o)+b)+", Dy="+(S-(E*u+S*a)+w)+")";c.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1?f.filter=c.replace(x,y):f.filter=y+" "+c,(e===0||e===1)&&s===1&&o===0&&u===0&&a===1&&(!g||y.indexOf("Dx=0, Dy=0")!==-1)&&(!d.test(c)||parseFloat(RegExp.$1)===100)&&c.indexOf("gradient(")===-1&&f.removeAttribute("filter")},Nt=function(e){var t=this.data,n=this.t.style,r=t.perspective,i=t.scaleX,s=0,o=0,u=0,a=0,f=t.scaleY,l=0,c=0,h=0,p=0,d=t.scaleZ,v=0,m=0,g=0,y=r?-1/r:0,b=t.rotation,w=t.zOrigin,E=",",S=1e5,x,T,N,C,k,L,A,O,M;B&&(A=V(this.t,"top",null,!1,"0"),O=parseFloat(A)||0,M=A.substr((O+"").length),t._ffFix=!t._ffFix,n.top=(t._ffFix?O+.05:O-.05)+(M===""?"px":M));if(b||t.skewX)N=i*Math.cos(b),C=f*Math.sin(b),b-=t.skewX,s=i*-Math.sin(b),f*=Math.cos(b),i=N,a=C;b=t.rotationY,b&&(x=Math.cos(b),T=Math.sin(b),N=i*x,C=a*x,k=d*-T,L=y*-T,o=i*T,l=a*T,d*=x,y*=x,i=N,a=C,h=k,m=L),b=t.rotationX,b&&(x=Math.cos(b),T=Math.sin(b),N=s*x+o*T,C=f*x+l*T,k=p*x+d*T,L=g*x+y*T,o=s*-T+o*x,l=f*-T+l*x,d=p*-T+d*x,y=g*-T+y*x,s=N,f=C,p=k,g=L),w&&(v-=w,u=o*v,c=l*v,v=d*v+w),u=(N=(u+=t.x)-(u|=0))?(N*S+(N<0?-0.5:.5)|0)/S+u:u,c=(N=(c+=t.y)-(c|=0))?(N*S+(N<0?-0.5:.5)|0)/S+c:c,v=(N=(v+=t.z)-(v|=0))?(N*S+(N<0?-0.5:.5)|0)/S+v:v,n[bt]="matrix3d("+(i*S>>0)/S+E+(a*S>>0)/S+E+(h*S>>0)/S+E+(m*S>>0)/S+E+(s*S>>0)/S+E+(f*S>>0)/S+E+(p*S>>0)/S+E+(g*S>>0)/S+E+(o*S>>0)/S+E+(l*S>>0)/S+E+(d*S>>0)/S+E+(y*S>>0)/S+E+u+E+c+E+v+E+(r?1+ -v/r:1)+")"},Ct=function(e){var t=this.data,n=this.t,r,i,s,o,u,a,f,l;B&&(r=V(n,"top",null,!1,"0"),i=parseFloat(r)||0,s=r.substr((i+"").length),t._ffFix=!t._ffFix,n.style.top=(t._ffFix?i+.05:i-.05)+(s===""?"px":s)),!t.rotation&&!t.skewX?n.style[bt]="matrix("+t.scaleX+",0,0,"+t.scaleY+","+t.x+","+t.y+")":(o=t.rotation,u=o-t.skewX,a=1e5,f=t.scaleX*a,l=t.scaleY*a,n.style[bt]="matrix("+(Math.cos(o)*f>>0)/a+","+(Math.sin(o)*f>>0)/a+","+(Math.sin(u)*-l>>0)/a+","+(Math.cos(u)*l>>0)/a+","+t.x+","+t.y+")")};mt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation",{parser:function(e,t,n,r,i,o,u){if(r._transform)return i;var a=r._transform=xt(e,s,!0),f=e.style,l=1e-6,c=yt.length,h=u,p={},d,v,m,g,y,b,w;if(typeof h.transform=="string"&&bt)m=f.cssText,f[bt]=h.transform,f.display="block",d=xt(e,null,!1),f.cssText=m;else if(typeof h=="object"){d={scaleX:tt(h.scaleX!=null?h.scaleX:h.scale,a.scaleX),scaleY:tt(h.scaleY!=null?h.scaleY:h.scale,a.scaleY),scaleZ:tt(h.scaleZ!=null?h.scaleZ:h.scale,a.scaleZ),x:tt(h.x,a.x),y:tt(h.y,a.y),z:tt(h.z,a.z),perspective:tt(h.transformPerspective,a.perspective)},w=h.directionalRotation;if(w!=null)if(typeof w=="object")for(m in w)h[m]=w[m];else h.rotation=w;d.rotation=nt("rotation"in h?h.rotation:"shortRotation"in h?h.shortRotation+"_short":"rotationZ"in h?h.rotationZ:a.rotation*C,a.rotation,"rotation",p),St&&(d.rotationX=nt("rotationX"in h?h.rotationX:"shortRotationX"in h?h.shortRotationX+"_short":a.rotationX*C||0,a.rotationX,"rotationX",p),d.rotationY=nt("rotationY"in h?h.rotationY:"shortRotationY"in h?h.shortRotationY+"_short":a.rotationY*C||0,a.rotationY,"rotationY",p)),d.skewX=h.skewX==null?a.skewX:nt(h.skewX,a.skewX),d.skewY=h.skewY==null?a.skewY:nt(h.skewY,a.skewY);if(v=d.skewY-a.skewY)d.skewX+=v,d.rotation+=v}y=a.z||a.rotationX||a.rotationY||d.z||d.rotationX||d.rotationY||d.perspective,!y&&h.scale!=null&&(d.scaleZ=1);while(--c>-1){n=yt[c],g=d[n]-a[n];if(g>l||g<-l||k[n]!=null)b=!0,i=new ht(a,n,a[n],g,i),n in p&&(i.e=p[n]),i.xs0=0,i.plugin=o,r._overwriteProps.push(i.n)}g=h.transformOrigin;if(g||St&&y&&a.zOrigin)bt?(b=!0,g=(g||V(e,n,s,!1,"50% 50%"))+"",n=Et,i=new ht(f,n,0,0,i,-1,"css_transformOrigin"),i.b=f[n],i.plugin=o,St?(m=a.zOrigin,g=g.split(" "),a.zOrigin=(g.length>2?parseFloat(g[2]):m)||0,i.xs0=i.e=f[n]=g[0]+" "+(g[1]||"50%")+" 0px",i=new ht(a,"zOrigin",0,0,i,-1,i.n),i.b=m,i.xs0=i.e=a.zOrigin):i.xs0=i.e=f[n]=g):Z(g+"",a);return b&&(r._transformType=y||this._transformType===3?3:2),i},prefix:!0}),mt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),mt("borderRadius",{defaultValue:"0px",parser:function(e,t,n,r,o,u){t=this.format(t);var a=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],f=e.style,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;y=parseFloat(e.offsetWidth),b=parseFloat(e.offsetHeight),l=t.split(" ");for(c=0;c<a.length;c++)this.p.indexOf("border")&&(a[c]=W(a[c])),d=p=V(e,a[c],s,!1,"0px"),d.indexOf(" ")!==-1&&(p=d.split(" "),d=p[0],p=p[1]),v=h=l[c],m=parseFloat(d),E=d.substr((m+"").length),S=v.charAt(1)==="=",S?(g=parseInt(v.charAt(0)+"1",10),v=v.substr(2),g*=parseFloat(v),w=v.substr((g+"").length-(g<0?1:0))||""):(g=parseFloat(v),w=v.substr((g+"").length)),w===""&&(w=i[n]||E),w!==E&&(x=Y(e,"borderLeft",m,E),T=Y(e,"borderTop",m,E),w==="%"?(d=x/y*100+"%",p=T/b*100+"%"):w==="em"?(N=Y(e,"borderLeft",1,"em"),d=x/N+"em",p=T/N+"em"):(d=x+"px",p=T+"px"),S&&(v=parseFloat(d)+g+w,h=parseFloat(p)+g+w)),o=pt(f,a[c],d+" "+p,v+" "+h,!1,"0px",o);return o},prefix:!0,formatter:ut("0px 0px 0px 0px",!1,!0)}),mt("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,n,r,i,o){var u="background-position",a=s||X(e,null),f=this.format((a?F?a.getPropertyValue(u+"-x")+" "+a.getPropertyValue(u+"-y"):a.getPropertyValue(u):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),l=this.format(t),c,h,p,d,v,m;if(f.indexOf("%")!==-1!=(l.indexOf("%")!==-1)){m=V(e,"backgroundImage").replace(b,"");if(m&&m!=="none"){c=f.split(" "),h=l.split(" "),O.setAttribute("src",m),p=2;while(--p>-1)f=c[p],d=f.indexOf("%")!==-1,d!==(h[p].indexOf("%")!==-1)&&(v=p===0?e.offsetWidth-O.width:e.offsetHeight-O.height,c[p]=d?parseFloat(f)/100*v+"px":parseFloat(f)/v*100+"%");f=c.join(" ")}}return this.parseComplex(e.style,f,l,i,o)},formatter:Z}),mt("backgroundSize",{defaultValue:"0 0",formatter:Z}),mt("perspective",{defaultValue:"0px",prefix:!0}),mt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),mt("transformStyle",{prefix:!0}),mt("backfaceVisibility",{prefix:!0}),mt("margin",{parser:at("marginTop,marginRight,marginBottom,marginLeft")}),mt("padding",{parser:at("paddingTop,paddingRight,paddingBottom,paddingLeft")}),mt("clip",{defaultValue:"rect(0px,0px,0px,0px)"}),mt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),mt("autoRound,strictUnits",{parser:function(e,t,n,r,i){return i}}),mt("border",{defaultValue:"0px solid #000",parser:function(e,t,n,r,i,o){return this.parseComplex(e.style,this.format(V(e,"borderTopWidth",s,!1,"0px")+" "+V(e,"borderTopStyle",s,!1,"solid")+" "+V(e,"borderTopColor",s,!1,"#000")),this.format(t),i,o)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(ot)||["#000"])[0]}}),mt("float,cssFloat,styleFloat",{parser:function(e,t,n,r,i,s){var o=e.style,u="cssFloat"in o?"cssFloat":"styleFloat";return new ht(o,u,0,0,i,-1,n,!1,0,o[u],t)}});var kt=function(e){var t=this.t,n=t.filter,r=this.s+this.c*e>>0,i;r===100&&(n.indexOf("atrix(")===-1&&n.indexOf("radient(")===-1?(t.removeAttribute("filter"),i=!V(this.data,"filter")):(t.filter=n.replace(m,""),i=!0)),i||(this.xn1&&(t.filter=n=n||"alpha(opacity=100)"),n.indexOf("opacity")===-1?t.filter+=" alpha(opacity="+r+")":t.filter=n.replace(d,"opacity="+r))};mt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,n,r,i,o){var u=parseFloat(V(e,"opacity",s,!1,"1")),a=e.style,f;return t=parseFloat(t),n==="autoAlpha"&&(f=V(e,"visibility",s),u===1&&f==="hidden"&&t!==0&&(u=0),i=new ht(a,"visibility",0,0,i,-1,null,!1,0,u!==0?"visible":"hidden",t===0?"hidden":"visible"),i.xs0="visible",r._overwriteProps.push(i.n)),I?i=new ht(a,"opacity",u,t-u,i):(i=new ht(a,"opacity",u*100,(t-u)*100,i),i.xn1=n==="autoAlpha"?1:0,a.zoom=1,i.type=2,i.b="alpha(opacity="+i.s+")",i.e="alpha(opacity="+(i.s+i.c)+")",i.data=e,i.plugin=o,i.setRatio=kt),i}});var Lt=function(e){if(e===1||e===0){this.t.className=e===1?this.e:this.b;var t=this.data,n=this.t.style,r=n.removeProperty?"removeProperty":"removeAttribute";while(t)t.v?n[t.p]=t.v:n[r](t.p.replace(g,"-$1").toLowerCase()),t=t._next}else this.t.className!==this.b&&(this.t.className=this.b)};mt("className",{parser:function(e,t,n,i,o,u,a){var f=e.className,l=e.style.cssText,c,h;return o=i._classNamePT=new ht(e,n,0,0,o,2),o.setRatio=Lt,o.pr=-11,r=!0,o.b=f,o.e=t.charAt(1)!=="="?t:t.charAt(0)==="+"?f+" "+t.substr(2):f.split(t.substr(2)).join(""),i._tween._duration&&(h=$(e,s,!0),e.className=o.e,c=J(e,h,$(e),a),e.className=f,o.data=c.firstMPT,e.style.cssText=l,o=o.xfirst=i.parse(e,c.difs,o,u)),o}});var At=function(e){if(e===1||e===0)if(this.data._totalTime===this.data._totalDuration){var t=this.e==="all",n=this.t.style,r=t?n.cssText.split(";"):this.e.split(","),i=n.removeProperty?"removeProperty":"removeAttribute",s=r.length,o=u.transform.parse,a;while(--s>-1)a=r[s],t&&(a=a.substr(0,a.indexOf(":")).split(" ").join("")),u[a]&&(a=u[a].parse===o?bt:u[a].p),a&&n[i](a.replace(g,"-$1").toLowerCase())}};mt("clearProps",{parser:function(e,t,n,i,s){return s=new ht(e,n,0,0,s,2),s.setRatio=At,s.e=t,s.pr=-10,s.data=i._tween,r=!0,s}}),a="bezier,throwProps,physicsProps,physics2D".split(","),dt=a.length;while(dt--)gt(a[dt]);return a=n.prototype,a._firstPT=null,a._onInitTween=function(e,t,u){if(!e.nodeType)return!1;this._target=e,this._tween=u,this._vars=t,D=t.autoRound,r=!1,i=t.suffixMap||n.suffixMap,s=X(e,""),o=this._overwriteProps;var a=e.style,f,l,c,h,p,d,m,g,y;if(P&&a.zIndex===""){f=V(e,"zIndex",s);if(f==="auto"||f==="")a.zIndex=0}typeof t=="string"&&(h=a.cssText,f=$(e,s),a.cssText=h+";"+t,f=J(e,f,$(e)).difs,!I&&v.test(t)&&(f.opacity=parseFloat(RegExp.$1)),t=f,a.cssText=h),this._firstPT=l=this.parse(e,t,null);if(this._transformType){y=this._transformType===3;if(!bt)a.zoom=1;else if(H){P=!0;if(a.zIndex===""){m=V(e,"zIndex",s);if(m==="auto"||m==="")a.zIndex=0}j&&(a.WebkitBackfaceVisibility=this._vars.WebkitBackfaceVisibility||(y?"visible":"hidden"))}c=l;while(c&&c._next)c=c._next;g=new ht(e,"transform",0,0,null,2),this._linkCSSP(g,null,c),g.setRatio=y&&St?Nt:bt?Ct:Tt,g.data=this._transform||xt(e,s,!0),o.pop()}if(r){while(l){d=l._next,c=h;while(c&&c.pr>l.pr)c=c._next;(l._prev=c?c._prev:p)?l._prev._next=l:h=l,(l._next=c)?c._prev=l:p=l,l=d}this._firstPT=h}return!0},a.parse=function(e,t,n,r){var o=e.style,a,f,l,c,h,d,v,m,g,y;for(a in t){d=t[a],f=u[a];if(f)n=f.parse(e,d,a,this,n,r,t);else{h=V(e,a,s)+"",g=typeof d=="string";if(a==="color"||a==="fill"||a==="stroke"||a.indexOf("Color")!==-1||g&&!d.indexOf("rgb"))g||(d=st(d),d=(d.length>3?"rgba(":"rgb(")+d.join(",")+")"),n=pt(o,a,h,d,!0,"transparent",n,0,r);else if(!g||d.indexOf(" ")===-1&&d.indexOf(",")===-1){l=parseFloat(h),v=l||l===0?h.substr((l+"").length):"";if(h===""||h==="auto")a==="width"||a==="height"?(l=G(e,a,s),v="px"):(l=a!=="opacity"?0:1,v="");y=g&&d.charAt(1)==="=",y?(c=parseInt(d.charAt(0)+"1",10),d=d.substr(2),c*=parseFloat(d),m=d.replace(p,"")):(c=parseFloat(d),m=g?d.substr((c+"").length)||"":""),m===""&&(m=i[a]||v),d=c||c===0?(y?c+l:c)+m:t[a],v!==m&&m!==""&&(c||c===0)&&(l||l===0)&&(l=Y(e,a,l,v),m==="%"?(l/=Y(e,a,100,"%")/100,l>100&&(l=100),t.strictUnits!==!0&&(h=l+"%")):m==="em"?l/=Y(e,a,1,"em"):(c=Y(e,a,c,m),m="px"),y&&(c||c===0)&&(d=c+l+m)),y&&(c+=l),!l&&l!==0||!c&&c!==0?!!d||d+""!="NaN"&&d!=null?(n=new ht(o,a,c||l||0,0,n,-1,"css_"+a,!1,0,h,d),n.xs0=a==="display"&&d==="none"?h:d):R("invalid "+a+" tween value: "+t[a]):(n=new ht(o,a,l,c-l,n,0,"css_"+a,D!==!1&&(m==="px"||a==="zIndex"),0,h,d),n.xs0=m)}else n=pt(o,a,h,d,!0,null,n,0,r)}r&&n&&!n.plugin&&(n.plugin=r)}return n},a.setRatio=function(e){var t=this._firstPT,n=1e-6,r,i,s;if(e!==1||this._tween._time!==this._tween._duration&&this._tween._time!==0)if(e||this._tween._time!==this._tween._duration&&this._tween._time!==0||this._tween._rawPrevTime===-0.000001)while(t){r=t.c*e+t.s,t.r?r=r>0?r+.5>>0:r-.5>>0:r<n&&r>-n&&(r=0);if(!t.type)t.t[t.p]=r+t.xs0;else if(t.type===1){s=t.l;if(s===2)t.t[t.p]=t.xs0+r+t.xs1+t.xn1+t.xs2;else if(s===3)t.t[t.p]=t.xs0+r+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3;else if(s===4)t.t[t.p]=t.xs0+r+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4;else if(s===5)t.t[t.p]=t.xs0+r+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4+t.xn4+t.xs5;else{i=t.xs0+r+t.xs1;for(s=1;s<t.l;s++)i+=t["xn"+s]+t["xs"+(s+1)];t.t[t.p]=i}}else t.type===-1?t.t[t.p]=t.xs0:t.setRatio&&t.setRatio(e);t=t._next}else while(t)t.type!==2?t.t[t.p]=t.b:t.setRatio(e),t=t._next;else while(t)t.type!==2?t.t[t.p]=t.e:t.setRatio(e),t=t._next},a._enableTransforms=function(e){this._transformType=e||this._transformType===3?3:2},a._linkCSSP=function(e,t,n,r){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),n?n._next=e:!r&&this._firstPT===null&&(this._firstPT=e),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next),e._next=t,e._prev=n),e},a._kill=function(t){var n=t,r=!1,i,s,o;if(t.css_autoAlpha||t.css_alpha){n={};for(s in t)n[s]=t[s];n.css_opacity=1,n.css_autoAlpha&&(n.css_visibility=1)}return t.css_className&&(i=this._classNamePT)&&(o=i.xfirst,o&&o._prev?this._linkCSSP(o._prev,i._next,o._prev._prev):o===this._firstPT&&(this._firstPT=null),i._next&&this._linkCSSP(i._next,i._next._next,o._prev),this._target._gsOverwrittenClassNamePT=this._linkCSSP(i,this._target._gsOverwrittenClassNamePT),this._classNamePT=null,r=!0),e.prototype._kill.call(this,n)||r},e.activate([n]),n},!0),function(){var e=window._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(e,t,n){return this._tween=n,!0}}),t=e.prototype;t._onInitAllProps=function(){var e=this._tween,t=e.vars.roundProps instanceof Array?e.vars.roundProps:e.vars.roundProps.split(","),n=t.length,r={},i=e._propLookup.roundProps,s,o,u;while(--n>-1)r[t[n]]=1;n=t.length;while(--n>-1){s=t[n],o=e._firstPT;while(o)u=o._next,o.pg?o.t._roundProps(r,!0):o.n===s&&(this._add(o.t,s,o.s,o.c),u&&(u._prev=o._prev),o._prev?o._prev._next=u:e._firstPT===o&&(e._firstPT=u),o._next=o._prev=null,e._propLookup[s]=i),o=u}return!1},t._add=function(e,t,n,r){this._addTween(e,t,n,n+r,t,!0),this._overwriteProps.push(t)}}(),window._gsDefine.plugin({propName:"attr",API:2,init:function(e,t,n){var r;if(typeof e.setAttribute!="function")return!1;this._target=e,this._proxy={};for(r in t)this._addTween(this._proxy,r,parseFloat(e.getAttribute(r)),t[r],r),this._overwriteProps.push(r);return!0},set:function(e){this._super.setRatio.call(this,e);var t=this._overwriteProps,n=t.length,r;while(--n>-1)r=t[n],this._target.setAttribute(r,this._proxy[r]+"")}}),window._gsDefine.plugin({propName:"directionalRotation",API:2,init:function(e,t,n){typeof t!="object"&&(t={rotation:t}),this.finals={},this._tween=n;var r=t.useRadians===!0?Math.PI*2:360,i,s,o,u,a,f,l;for(i in t)i!=="useRadians"&&(f=(t[i]+"").split("_"),s=f[0],l=f[1],o=parseFloat(typeof e[i]!="function"?e[i]:e[i.indexOf("set")||typeof e["get"+i.substr(3)]!="function"?i:"get"+i.substr(3)]()),u=this.finals[i]=typeof s=="string"&&s.charAt(1)==="="?o+parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)):Number(s)||0,a=u-o,l==="short"?(a%=r,a!==a%(r/2)&&(a=a<0?a+r:a-r)):l==="cw"&&a<0?a=(a+r*9999999999)%r-(a/r|0)*r:l==="ccw"&&a>0&&(a=(a-r*9999999999)%r-(a/r|0)*r),this._addTween(e,i,o,o+a,i),this._overwriteProps.push(i));return!0},set:function(e){var t;if(e!==1)this._super.setRatio.call(this,e);else{t=this._firstPT;while(t)t.f?t.t[t.p](this.finals[t.p]):t.t[t.p]=this.finals[t.p],t=t._next}}})._autoCSS=!0,window._gsDefine("easing.Back",["easing.Ease"],function(e){var t=window.GreenSockGlobals||window,n=t.com.greensock,r=Math.PI*2,i=Math.PI/2,s=n._class,o=function(t,n){var r=s("easing."+t,function(){},!0),i=r.prototype=new e;return i.constructor=r,i.getRatio=n,r},u=e.register||function(){},a=function(e,t,n,r,i){var o=s("easing."+e,{easeOut:new t,easeIn:new n,easeInOut:new r},!0);return u(o,e),o},f=function(t,n){var r=s("easing."+t,function(e){this._p1=e||e===0?e:1.70158,this._p2=this._p1*1.525},!0),i=r.prototype=new e;return i.constructor=r,i.getRatio=n,i.config=function(e){return new r(e)},r},l=a("Back",f("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),f("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),f("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),c=s("easing.SlowMo",function(e,t,n){t=t||t===0?t:.7,e==null?e=.7:e>1&&(e=1),this._p=e!==1?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=n===!0},!0),h=c.prototype=new e,p,d;return h.constructor=c,h.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},c.ease=new c(.7,.7),h.config=c.config=function(e,t,n){return new c(e,t,n)},p=s("easing.SteppedEase",function(e){e=e||1,this._p1=1/e,this._p2=e+1},!0),h=p.prototype=new e,h.constructor=p,h.getRatio=function(e){return e<0?e=0:e>=1&&(e=.999999999),(this._p2*e>>0)*this._p1},h.config=p.config=function(e){return new p(e)},a("Bounce",o("BounceOut",function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),o("BounceIn",function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),o("BounceInOut",function(e){var t=e<.5;return t?e=1-e*2:e=e*2-1,e<1/2.75?e=7.5625*e*e:e<2/2.75?e=7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?e=7.5625*(e-=2.25/2.75)*e+.9375:e=7.5625*(e-=2.625/2.75)*e+.984375,t?(1-e)*.5:e*.5+.5})),a("Circ",o("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),o("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),o("CircInOut",function(e){return(e*=2)<1?-0.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),d=function(t,n,i){var o=s("easing."+t,function(e,t){this._p1=e||1,this._p2=t||i,this._p3=this._p2/r*(Math.asin(1/this._p1)||0)},!0),u=o.prototype=new e;return u.constructor=o,u.getRatio=n,u.config=function(e,t){return new o(e,t)},o},a("Elastic",d("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*r/this._p2)+1},.3),d("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*r/this._p2))},.3),d("ElasticInOut",function(e){return(e*=2)<1?-0.5*this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*r/this._p2):this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*r/this._p2)*.5+1},.45)),a("Expo",o("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),o("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),o("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),a("Sine",o("SineOut",function(e){return Math.sin(e*i)}),o("SineIn",function(e){return-Math.cos(e*i)+1}),o("SineInOut",function(e){return-0.5*(Math.cos(Math.PI*e)-1)})),s("easing.EaseLookup",{find:function(t){return e.map[t]}},!0),u(t.SlowMo,"SlowMo","ease,"),u(p,"SteppedEase","ease,"),l},!0)}),function(e){var t=e.GreenSockGlobals||e,n=function(e){var n=e.split("."),r=t,i;for(i=0;i<n.length;i++)r[n[i]]=r=r[n[i]]||{};return r},r=n("com.greensock"),i=function(){},s,o,u,a,f,l={},c=function(r,i,s,o){this.sc=l[r]?l[r].sc:[],l[r]=this,this.gsClass=null,this.func=s;var u=[];this.check=function(a){var f=i.length,h=f,p,d,v,m;while(--f>-1)(p=l[i[f]]||new c(i[f],[])).gsClass?(u[f]=p.gsClass,h--):a&&p.sc.push(this);if(h===0&&s){d=("com.greensock."+r).split("."),v=d.pop(),m=n(d.join("."))[v]=this.gsClass=s.apply(s,u),o&&(t[v]=m,typeof define=="function"&&define.amd?define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+r.split(".").join("/"),[],function(){return m}):typeof module!="undefined"&&module.exports&&(module.exports=m));for(f=0;f<this.sc.length;f++)this.sc[f].check()}},this.check(!0)},h=e._gsDefine=function(e,t,n,r){return new c(e,t,n,r)},p=r._class=function(e,t,n){return t=t||function(){},h(e,[],function(){return t},n),t};h.globals=t;var d=[0,0,1,1],v=[],m=p("easing.Ease",function(e,t,n,r){this._func=e,this._type=n||0,this._power=r||0,this._params=t?d.concat(t):d},!0),g=m.map={},y=m.register=function(e,t,n,i){var s=t.split(","),o=s.length,u=(n||"easeIn,easeOut,easeInOut").split(","),a,f,l,c;while(--o>-1){f=s[o],a=i?p("easing."+f,null,!0):r.easing[f]||{},l=u.length;while(--l>-1)c=u[l],g[f+"."+c]=g[c+f]=a[c]=e.getRatio?e:e[c]||new e}};u=m.prototype,u._calcEnd=!1,u.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,n=this._power,r=t===1?1-e:t===2?e:e<.5?e*2:(1-e)*2;return n===1?r*=r:n===2?r*=r*r:n===3?r*=r*r*r:n===4&&(r*=r*r*r*r),t===1?1-r:t===2?r:e<.5?r/2:1-r/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],o=s.length;while(--o>-1)u=s[o]+",Power"+o,y(new m(null,null,1,o),u,"easeOut",!0),y(new m(null,null,2,o),u,"easeIn"+(o===0?",easeNone":"")),y(new m(null,null,3,o),u,"easeInOut");g.linear=r.easing.Linear.easeIn,g.swing=r.easing.Quad.easeInOut;var b=p("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});u=b.prototype,u.addEventListener=function(e,t,n,r,i){i=i||0;var s=this._listeners[e],o=0,u,l;s==null&&(this._listeners[e]=s=[]),l=s.length;while(--l>-1)u=s[l],u.c===t&&u.s===n?s.splice(l,1):o===0&&u.pr<i&&(o=l+1);s.splice(o,0,{c:t,s:n,up:r,pr:i}),this===a&&!f&&a.wake()},u.removeEventListener=function(e,t){var n=this._listeners[e],r;if(n){r=n.length;while(--r>-1)if(n[r].c===t){n.splice(r,1);return}}},u.dispatchEvent=function(e){var t=this._listeners[e],n,r,i;if(t){n=t.length,r=this._eventTarget;while(--n>-1)i=t[n],i.up?i.c.call(i.s||r,{type:e,target:r}):i.c.call(i.s||r)}};var w=e.requestAnimationFrame,E=e.cancelAnimationFrame,S=Date.now||function(){return(new Date).getTime()};s=["ms","moz","webkit","o"],o=s.length;while(--o>-1&&!w)w=e[s[o]+"RequestAnimationFrame"],E=e[s[o]+"CancelAnimationFrame"]||e[s[o]+"CancelRequestAnimationFrame"];p("Ticker",function(e,t){var n=this,r=S(),s=t!==!1&&w,o,u,l,c,h,p=function(e){n.time=(S()-r)/1e3;if(!o||n.time>=h||e===!0)n.frame++,h=n.time+c,n.dispatchEvent("tick");e!==!0&&(l=u(p))};b.call(n),this.time=this.frame=0,this.tick=function(){p(!0)},this.sleep=function(){if(l==null)return;!s||!E?clearTimeout(l):E(l),u=i,l=null,n===a&&(f=!1)},this.wake=function(){l&&n.sleep(),u=o===0?i:!s||!w?function(e){return setTimeout(e,c*1e3)}:w,n===a&&(f=!0),p()},this.fps=function(e){if(!arguments.length)return o;o=e,c=1/(o||60),h=this.time+c,n.wake()},this.useRAF=function(e){if(!arguments.length)return s;s=e,n.fps(o)},n.fps(e),setTimeout(function(){s&&!l&&n.useRAF(!1)},1e3)}),u=r.Ticker.prototype=new r.events.EventDispatcher,u.constructor=r.Ticker;var x=p("core.Animation",function(e,t){this.vars=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(this.vars.delay)||0,this._timeScale=1,this._active=this.vars.immediateRender===!0,this.data=this.vars.data,this._reversed=this.vars.reversed===!0;if(!H)return;f||a.wake();var n=this.vars.useFrames?P:H;n.add(this,n._time),this.vars.paused&&this.paused(!0)});a=x.ticker=new r.Ticker,u=x.prototype,u._dirty=u._gc=u._initted=u._paused=!1,u._totalTime=u._time=0,u._rawPrevTime=-1,u._next=u._last=u._onUpdate=u._timeline=u.timeline=null,u._paused=!1,u.play=function(e,t){return arguments.length&&this.seek(e,t),this.reversed(!1),this.paused(!1)},u.pause=function(e,t){return arguments.length&&this.seek(e,t),this.paused(!0)},u.resume=function(e,t){return arguments.length&&this.seek(e,t),this.paused(!1)},u.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},u.restart=function(e,t){return this.reversed(!1),this.paused(!1),this.totalTime(e?-this._delay:0,t!==!1)},u.reverse=function(e,t){return arguments.length&&this.seek(e||this.totalDuration(),t),this.reversed(!0),this.paused(!1)},u.render=function(){},u.invalidate=function(){return this},u._enabled=function(e,t){return f||a.wake(),this._gc=!e,this._active=e&&!this._paused&&this._totalTime>0&&this._totalTime<this._totalDuration,t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},u._kill=function(e,t){return this._enabled(!1,!1)},u.kill=function(e,t){return this._kill(e,t),this},u._uncache=function(e){var t=e?this:this.timeline;while(t)t._dirty=!0,t=t.timeline;return this},u.eventCallback=function(e,t,n,r){if(e==null)return null;if(e.substr(0,2)==="on"){var i=this.vars,s;if(arguments.length===1)return i[e];if(t==null)delete i[e];else{i[e]=t,i[e+"Params"]=n,i[e+"Scope"]=r;if(n){s=n.length;while(--s>-1)n[s]==="{self}"&&(n=i[e+"Params"]=n.concat(),n[s]=this)}}e==="onUpdate"&&(this._onUpdate=t)}return this},u.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},u.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&e!==0&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},u.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},u.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this.totalTime(e,t)):this._time},u.totalTime=function(e,t){f||a.wake();if(!arguments.length)return this._totalTime;if(this._timeline){e<0&&(e+=this.totalDuration());if(this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var n=this._totalDuration,r=this._timeline;e>n&&(e=n),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?n-e:e)/this._timeScale,r._dirty||this._uncache(!1);if(!r._active)while(r._timeline)r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),this._totalTime!==e&&this.render(e,t,!1)}return this},u.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},u.timeScale=function(e){if(!arguments.length)return this._timeScale;e=e||1e-6;if(this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime||this._pauseTime===0?this._pauseTime:this._timeline.totalTime();this._startTime=t-(t-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},u.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._totalTime,!0)),this):this._reversed},u.paused=function(e){return arguments.length?(e!=this._paused&&this._timeline&&(!f&&!e&&a.wake(),!e&&this._timeline.smoothChildTiming&&(this._startTime+=this._timeline.rawTime()-this._pauseTime,this._uncache(!1)),this._pauseTime=e?this._timeline.rawTime():null,this._paused=e,this._active=!this._paused&&this._totalTime>0&&this._totalTime<this._totalDuration),this._gc&&!e&&this._enabled(!0,!1),this):this._paused};var T=p("core.SimpleTimeline",function(e){x.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});u=T.prototype=new x,u.constructor=T,u.kill()._gc=!1,u._first=u._last=null,u._sortChildren=!1,u.add=function(e,t,n,r){var i,s;e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),i=this._last;if(this._sortChildren){s=e._startTime;while(i&&i._startTime>s)i=i._prev}return i?(e._next=i._next,i._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=i,this._timeline&&this._uncache(!0),this},u.insert=u.add,u._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e.timeline=null,e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),this._timeline&&this._uncache(!0)),this},u.render=function(e,t,n){var r=this._first,i;this._totalTime=this._time=this._rawPrevTime=e;while(r){i=r._next;if(r._active||e>=r._startTime&&!r._paused)r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(e-r._startTime)*r._timeScale,t,n):r.render((e-r._startTime)*r._timeScale,t,n);r=i}},u.rawTime=function(){return f||a.wake(),this._totalTime};var N=p("TweenLite",function(e,t,n){x.call(this,t,n);if(e==null)throw"Cannot tween a null target.";this.target=e=typeof e!="string"?e:N.selector(e)||e;var r=e.jquery||typeof e.each=="function"&&e[0]&&e[0].nodeType&&e[0].style,i=this.vars.overwrite,s,o,u;this._overwrite=i=i==null?D[N.defaultOverwrite]:typeof i=="number"?i>>0:D[i];if((r||e instanceof Array)&&typeof e[0]!="number"){this._targets=u=r&&!e.slice?k(e):e.slice(0),this._propLookup=[],this._siblings=[];for(s=0;s<u.length;s++){o=u[s];if(!o){u.splice(s--,1);continue}if(typeof o=="string"){o=u[s--]=N.selector(o),typeof o=="string"&&u.splice(s+1,1);continue}if(typeof o.each=="function"&&o[0]&&o[0].nodeType&&o[0].style){u.splice(s--,1),this._targets=u=u.concat(k(o));continue}this._siblings[s]=B(o,this,!1),i===1&&this._siblings[s].length>1&&j(o,this,null,1,this._siblings[s])}}else this._propLookup={},this._siblings=B(e,this,!1),i===1&&this._siblings.length>1&&j(e,this,null,1,this._siblings);(this.vars.immediateRender||t===0&&this._delay===0&&this.vars.immediateRender!==!1)&&this.render(-this._delay,!1,!0)},!0),C=function(e){return typeof e.each=="function"&&e[0]&&e[0].nodeType&&e[0].style},k=function(e){var t=[];return e.each(function(){t.push(this)}),t},L=function(e,t){var n={},r;for(r in e)!_[r]&&(!(r in t)||r==="x"||r==="y"||r==="width"||r==="height"||r==="className")&&(!A[r]||A[r]&&A[r]._autoCSS)&&(n[r]=e[r],delete e[r]);e.css=n};u=N.prototype=new x,u.constructor=N,u.kill()._gc=!1,u.ratio=0,u._firstPT=u._targets=u._overwrittenProps=u._startAt=null,u._notifyPluginsOfEnabled=!1,N.version="1.9.1",N.defaultEase=u._ease=new m(null,null,1,1),N.defaultOverwrite="auto",N.ticker=a,N.autoSleep=!0,N.selector=e.$||e.jQuery||function(t){return e.$?(N.selector=e.$,e.$(t)):e.document?e.document.getElementById(t.charAt(0)==="#"?t.substr(1):t):t};var A=N._plugins={},O=N._tweenLookup={},M=0,_={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,orientToBezier:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1},D={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},P=x._rootFramesTimeline=new T,H=x._rootTimeline=new T;H._startTime=a.time,P._startTime=a.frame,H._active=P._active=!0,x._updateRoot=function(){H.render((a.time-H._startTime)*H._timeScale,!1,!1),P.render((a.frame-P._startTime)*P._timeScale,!1,!1);if(!(a.frame%120)){var e,t,n;for(n in O){t=O[n].tweens,e=t.length;while(--e>-1)t[e]._gc&&t.splice(e,1);t.length===0&&delete O[n]}n=H._first;if(!n||n._paused)if(N.autoSleep&&!P._first&&a._listeners.tick.length===1){while(n&&n._paused)n=n._next;n||a.sleep()}}},a.addEventListener("tick",x._updateRoot);var B=function(e,t,n){var r=e._gsTweenID,i,s;O[r||(e._gsTweenID=r="t"+M++)]||(O[r]={target:e,tweens:[]});if(t){i=O[r].tweens,i[s=i.length]=t;if(n)while(--s>-1)i[s]===t&&i.splice(s,1)}return O[r].tweens},j=function(e,t,n,r,i){var s,o,u,a;if(r===1||r>=4){a=i.length;for(s=0;s<a;s++)if((u=i[s])!==t)u._gc||u._enabled(!1,!1)&&(o=!0);else if(r===5)break;return o}var f=t._startTime+1e-10,l=[],c=0,h=t._duration===0,p;s=i.length;while(--s>-1)(u=i[s])!==t&&!u._gc&&!u._paused&&(u._timeline!==t._timeline?(p=p||F(t,0,h),F(u,p,h)===0&&(l[c++]=u)):u._startTime<=f&&u._startTime+u.totalDuration()/u._timeScale+1e-10>f&&((h||!u._initted)&&f-u._startTime<=2e-10||(l[c++]=u)));s=c;while(--s>-1)u=l[s],r===2&&u._kill(n,e)&&(o=!0),(r!==2||!u._firstPT&&u._initted)&&u._enabled(!1,!1)&&(o=!0);return o},F=function(e,t,n){var r=e._timeline,i=r._timeScale,s=e._startTime;while(r._timeline){s+=r._startTime,i*=r._timeScale;if(r._paused)return-100;r=r._timeline}return s/=i,s>t?s-t:n&&s===t||!e._initted&&s-t<2e-10?1e-10:(s+=e.totalDuration()/e._timeScale/i)>t?0:s-t-1e-10};u._init=function(){var e=this.vars,t=this._overwrittenProps,n=this._duration,r=e.ease,i,s,o;if(e.startAt){e.startAt.overwrite=0,e.startAt.immediateRender=!0,this._startAt=N.to(this.target,0,e.startAt);if(e.immediateRender){this._startAt=null;if(this._time===0&&n!==0)return}}else if(e.runBackwards&&e.immediateRender&&n!==0){if(this._time===0){e.overwrite=e.delay=0,e.runBackwards=!1,this._startAt=N.to(this.target,0,e),e.overwrite=this._overwrite,e.runBackwards=!0,e.delay=this._delay;return}this._startAt&&(this._startAt.render(-1,!0),this._startAt=null)}r?r instanceof m?this._ease=e.easeParams instanceof Array?r.config.apply(r,e.easeParams):r:this._ease=typeof r=="function"?new m(r,e.easeParams):g[r]||N.defaultEase:this._ease=N.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null;if(this._targets){i=this._targets.length;while(--i>-1)this._initProps(this._targets[i],this._propLookup[i]={},this._siblings[i],t?t[i]:null)&&(s=!0)}else s=this._initProps(this.target,this._propLookup,this._siblings,t);s&&N._onPluginEvent("_onInitAllProps",this),t&&(this._firstPT||typeof this.target!="function"&&this._enabled(!1,!1));if(e.runBackwards){o=this._firstPT;while(o)o.s+=o.c,o.c=-o.c,o=o._next}this._onUpdate=e.onUpdate,this._initted=!0},u._initProps=function(e,t,n,r){var i,s,o,u,a,f,l;if(e==null)return!1;this.vars.css||e.style&&e.nodeType&&A.css&&this.vars.autoCSS!==!1&&L(this.vars,e);for(i in this.vars){if(_[i]){if(i==="onStartParams"||i==="onUpdateParams"||i==="onCompleteParams"||i==="onReverseCompleteParams"||i==="onRepeatParams")if(a=this.vars[i]){s=a.length;while(--s>-1)a[s]==="{self}"&&(a=this.vars[i]=a.concat(),a[s]=this)}}else if(A[i]&&(u=new A[i])._onInitTween(e,this.vars[i],this)){this._firstPT=f={_next:this._firstPT,t:u,p:"setRatio",s:0,c:1,f:!0,n:i,pg:!0,pr:u._priority},s=u._overwriteProps.length;while(--s>-1)t[u._overwriteProps[s]]=this._firstPT;if(u._priority||u._onInitAllProps)o=!0;if(u._onDisable||u._onEnable)this._notifyPluginsOfEnabled=!0}else this._firstPT=t[i]=f={_next:this._firstPT,t:e,p:i,f:typeof e[i]=="function",n:i,pg:!1,pr:0},f.s=f.f?e[i.indexOf("set")||typeof e["get"+i.substr(3)]!="function"?i:"get"+i.substr(3)]():parseFloat(e[i]),l=this.vars[i],f.c=typeof l=="string"&&l.charAt(1)==="="?parseInt(l.charAt(0)+"1",10)*Number(l.substr(2)):Number(l)-f.s||0;f&&f._next&&(f._next._prev=f)}return r&&this._kill(r,e)?this._initProps(e,t,n,r):this._overwrite>1&&this._firstPT&&n.length>1&&j(e,this,t,this._overwrite,n)?(this._kill(t,e),this._initProps(e,t,n,r)):o},u.render=function(e,t,n){var r=this._time,i,s,o;if(e>=this._duration)this._totalTime=this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(i=!0,s="onComplete"),this._duration===0&&((e===0||this._rawPrevTime<0)&&this._rawPrevTime!==e&&(n=!0),this._rawPrevTime=e);else if(e<=0){this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0;if(r!==0||this._duration===0&&this._rawPrevTime>0)s="onReverseComplete",i=this._reversed;e<0?(this._active=!1,this._duration===0&&(this._rawPrevTime>=0&&(n=!0),this._rawPrevTime=e)):this._initted||(n=!0)}else{this._totalTime=this._time=e;if(this._easeType){var u=e/this._duration,a=this._easeType,f=this._easePower;if(a===1||a===3&&u>=.5)u=1-u;a===3&&(u*=2),f===1?u*=u:f===2?u*=u*u:f===3?u*=u*u*u:f===4&&(u*=u*u*u*u),a===1?this.ratio=1-u:a===2?this.ratio=u:e/this._duration<.5?this.ratio=u/2:this.ratio=1-u/2}else this.ratio=this._ease.getRatio(e/this._duration)}if(this._time===r&&!n)return;if(!this._initted){this._init();if(!this._initted)return;this._time&&!i?this.ratio=this._ease.getRatio(this._time/this._duration):i&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}this._active||this._paused||(this._active=!0),r===0&&(this._startAt&&this._startAt.render(e,t,n),this.vars.onStart&&(this._time!==0||this._duration===0)&&(t||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||v))),o=this._firstPT;while(o)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(e<0&&this._startAt&&this._startAt.render(e,t,n),t||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||v)),s&&(this._gc||(e<0&&this._startAt&&(this._onUpdate||this._startAt.render(e,t,n)),i&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),t||this.vars[s]&&this.vars[s].apply(this.vars[s+"Scope"]||this,this.vars[s+"Params"]||v)))},u._kill=function(e,t){e==="all"&&(e=null);if(e==null)if(t==null||t===this.target)return this._enabled(!1,!1);t=typeof t!="string"?t||this._targets||this.target:N.selector(t)||t;var n,r,i,s,o,u,a,f;if((t instanceof Array||C(t))&&typeof t[0]!="number"){n=t.length;while(--n>-1)this._kill(e,t[n])&&(u=!0)}else{if(this._targets){n=this._targets.length;while(--n>-1)if(t===this._targets[n]){o=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[n]=e?this._overwrittenProps[n]||{}:"all";break}}else{if(t!==this.target)return!1;o=this._propLookup,r=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(o){a=e||o,f=e!==r&&r!=="all"&&e!==o&&(e==null||e._tempKill!==!0);for(i in a){if(s=o[i]){s.pg&&s.t._kill(a)&&(u=!0);if(!s.pg||s.t._overwriteProps.length===0)s._prev?s._prev._next=s._next:s===this._firstPT&&(this._firstPT=s._next),s._next&&(s._next._prev=s._prev),s._next=s._prev=null;delete o[i]}f&&(r[i]=1)}this._firstPT||this._enabled(!1,!1)}}return u},u.invalidate=function(){return this._notifyPluginsOfEnabled&&N._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},u._enabled=function(e,t){f||a.wake();if(e&&this._gc){var n=this._targets,r;if(n){r=n.length;while(--r>-1)this._siblings[r]=B(n[r],this,!0)}else this._siblings=B(this.target,this,!0)}return x.prototype._enabled.call(this,e,t),this._notifyPluginsOfEnabled&&this._firstPT?N._onPluginEvent(e?"_onEnable":"_onDisable",this):!1},N.to=function(e,t,n){return new N(e,t,n)},N.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=n.immediateRender!=0,new N(e,t,n)},N.fromTo=function(e,t,n,r){return r.startAt=n,r.immediateRender=r.immediateRender!=0&&n.immediateRender!=0,new N(e,t,r)},N.delayedCall=function(e,t,n,r,i){return new N(t,0,{delay:e,onComplete:t,onCompleteParams:n,onCompleteScope:r,onReverseComplete:t,onReverseCompleteParams:n,onReverseCompleteScope:r,immediateRender:!1,useFrames:i,overwrite:0})},N.set=function(e,t){return new N(e,0,t)},N.killTweensOf=N.killDelayedCallsTo=function(e,t){var n=N.getTweensOf(e),r=n.length;while(--r>-1)n[r]._kill(t,e)},N.getTweensOf=function(e){if(e==null)return;e=typeof e!="string"?e:N.selector(e)||e;var t,n,r,i;if((e instanceof Array||C(e))&&typeof e[0]!="number"){t=e.length,n=[];while(--t>-1)n=n.concat(N.getTweensOf(e[t]));t=n.length;while(--t>-1){i=n[t],r=t;while(--r>-1)i===n[r]&&n.splice(t,1)}}else{n=B(e).concat(),t=n.length;while(--t>-1)n[t]._gc&&n.splice(t,1)}return n};var I=p("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=I.prototype},!0);u=I.prototype,I.version="1.9.1",I.API=2,u._firstPT=null,u._addTween=function(e,t,n,r,i,s){var o,u;r!=null&&(o=typeof r=="number"||r.charAt(1)!=="="?Number(r)-n:parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)))&&(this._firstPT=u={_next:this._firstPT,t:e,p:t,s:n,c:o,f:typeof e[t]=="function",n:i||t,r:s},u._next&&(u._next._prev=u))},u.setRatio=function(e){var t=this._firstPT,n=1e-6,r;while(t)r=t.c*e+t.s,t.r?r=r+(r>0?.5:-0.5)>>0:r<n&&r>-n&&(r=0),t.f?t.t[t.p](r):t.t[t.p]=r,t=t._next},u._kill=function(e){var t=this._overwriteProps,n=this._firstPT,r;if(e[this._propName]!=null)this._overwriteProps=[];else{r=t.length;while(--r>-1)e[t[r]]!=null&&t.splice(r,1)}while(n)e[n.n]!=null&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},u._roundProps=function(e,t){var n=this._firstPT;while(n){if(e[this._propName]||n.n!=null&&e[n.n.split(this._propName+"_").join("")])n.r=t;n=n._next}},N._onPluginEvent=function(e,t){var n=t._firstPT,r,i,s,o,u;if(e==="_onInitAllProps"){while(n){u=n._next,i=s;while(i&&i.pr>n.pr)i=i._next;(n._prev=i?i._prev:o)?n._prev._next=n:s=n,(n._next=i)?i._prev=n:o=n,n=u}n=t._firstPT=s}while(n)n.pg&&typeof n.t[e]=="function"&&n.t[e]()&&(r=!0),n=n._next;return r},I.activate=function(e){var t=e.length;while(--t>-1)e[t].API===I.API&&(A[(new e[t])._propName]=e[t]);return!0},h.plugin=function(e){if(!e||!e.propName||!e.init||!e.API)throw"illegal plugin definition.";var t=e.propName,n=e.priority||0,r=e.overwriteProps,i={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},s=p("plugins."+t.charAt(0).toUpperCase()+t.substr(1)+"Plugin",function(){I.call(this,t,n),this._overwriteProps=r||[]},e.global===!0),o=s.prototype=new I(t),u;o.constructor=s,s.API=e.API;for(u in i)typeof e[u]=="function"&&(o[i[u]]=e[u]);return s.version=e.version,I.activate([s]),s},s=e._gsQueue;if(s){for(o=0;o<s.length;o++)s[o]();for(u in l)l[u].func||e.console.log("GSAP encountered missing dependency: com.greensock."+u)}f=!1}(window),define("greensock/TweenMax",function(){}),function(window,undefined){function returnTrue(){return!0}function returnFalse(){return!1}var document=window.document;document.createElement("video"),document.createElement("audio");var VideoJS=function(e,t,n){var r;if(typeof e=="string"){e.indexOf("#")===0&&(e=e.slice(1));if(_V_.players[e])return _V_.players[e];r=_V_.el(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (VideoJS)");return r.player||new _V_.Player(r,t,n)},_V_=VideoJS,CDN_VERSION="3.2";VideoJS.players={},VideoJS.options={techOrder:["html5","flash"],html5:{},flash:{swf:"http://vjs.zencdn.net/c/video-js.swf"},width:"auto",height:"auto",defaultVolume:0,components:{posterImage:{},textTrackDisplay:{},loadingSpinner:{},bigPlayButton:{},controlBar:{}}},CDN_VERSION!="GENERATED_CDN_VSN"&&(_V_.options.flash.swf="http://vjs.zencdn.net/"+CDN_VERSION+"/video-js.swf"),_V_.merge=function(e,t,n){t||(t={});for(var r in t)t.hasOwnProperty(r)&&(!n||!e.hasOwnProperty(r))&&(e[r]=t[r]);return e},_V_.extend=function(e){this.merge(this,e,!0)},_V_.extend({tech:{},controlSets:{},isIE:function(){return!1},isFF:function(){return!!_V_.ua.match("Firefox")},isIPad:function(){return navigator.userAgent.match(/iPad/i)!==null},isIPhone:function(){return navigator.userAgent.match(/iPhone/i)!==null},isIOS:function(){return VideoJS.isIPhone()||VideoJS.isIPad()},iOSVersion:function(){var e=navigator.userAgent.match(/OS (\d+)_/i);if(e&&e[1])return e[1]},isAndroid:function(){return navigator.userAgent.match(/Android.*AppleWebKit/i)!==null},androidVersion:function(){var e=navigator.userAgent.match(/Android (\d+)\./i);if(e&&e[1])return e[1]},testVid:document.createElement("video"),ua:navigator.userAgent,support:{},each:function(e,t){if(!e||e.length===0)return;for(var n=0,r=e.length;n<r;n++)t.call(this,e[n],n)},eachProp:function(e,t){if(!e)return;for(var n in e)e.hasOwnProperty(n)&&t.call(this,n,e[n])},el:function(e){return document.getElementById(e)},createElement:function(e,t){var n=document.createElement(e),r;for(r in t)t.hasOwnProperty(r)&&(r.indexOf("-")!==-1?n.setAttribute(r,t[r]):n[r]=t[r]);return n},insertFirst:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},addClass:function(e,t){(" "+e.className+" ").indexOf(" "+t+" ")==-1&&(e.className=e.className===""?t:e.className+" "+t)},removeClass:function(e,t){if(e.className.indexOf(t)==-1)return;var n=e.className.split(" ");n.splice(n.indexOf(t),1),e.className=n.join(" ")},remove:function(e,t){if(!t)return;var n=t.indexOf(e);if(n!=-1)return t.splice(n,1)},blockTextSelection:function(){document.body.focus(),document.onselectstart=function(){return!1}},unblockTextSelection:function(){document.onselectstart=function(){return!0}},formatTime:function(e,t){t=t||e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),s=Math.floor(t/60%60),o=Math.floor(t/3600);return i=i>0||o>0?i+":":"",r=((i||s>=10)&&r<10?"0"+r:r)+":",n=n<10?"0"+n:n,i+r+n},uc:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},getRelativePosition:function(e,t){return Math.max(0,Math.min(1,(e-_V_.findPosX(t))/t.offsetWidth))},getComputedStyleValue:function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)},trim:function(e){return e.toString().replace(/^\s+/,"").replace(/\s+$/,"")},round:function(e,t){return t||(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},isEmpty:function(e){for(var t in e)return!1;return!0},createTimeRange:function(e,t){return{length:1,start:function(){return e},end:function(){return t}}},cache:{},guid:1,expando:"vdata"+(new Date).getTime(),getData:function(e){var t=e[_V_.expando];return t||(t=e[_V_.expando]=_V_.guid++,_V_.cache[t]={}),_V_.cache[t]},removeData:function(e){var t=e[_V_.expando];if(!t)return;delete _V_.cache[t];try{delete e[_V_.expando]}catch(n){e.removeAttribute?e.removeAttribute(_V_.expando):e[_V_.expando]=null}},proxy:function(e,t,n){t.guid||(t.guid=_V_.guid++);var r=function(){return t.apply(e,arguments)};return r.guid=n?n+"_"+t.guid:t.guid,r},get:function(e,t,n){var r=e.indexOf("file:")==0||window.location.href.indexOf("file:")==0&&e.indexOf("http:")==-1;typeof XMLHttpRequest=="undefined"&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(n){}throw new Error("This browser does not support XMLHttpRequest.")});var i=new XMLHttpRequest;try{i.open("GET",e)}catch(s){return _V_.log("VideoJS XMLHttpRequest (open)",s),!1}i.onreadystatechange=_V_.proxy(this,function(){i.readyState==4&&(i.status==200||r&&i.status==0?t(i.responseText):n&&n())});try{i.send()}catch(s){_V_.log("VideoJS XMLHttpRequest (send)",s),n&&n(s)}},setLocalStorage:function(e,t){var n=window.localStorage||!1;if(!n)return;try{n[e]=t}catch(r){r.code==22||r.code==1014?_V_.log("LocalStorage Full (VideoJS)",r):_V_.log("LocalStorage Error (VideoJS)",r)}},getAbsoluteURL:function(e){return e.match(/^https?:\/\//)||(e=_V_.createElement("div",{innerHTML:'<a href="'+e+'">x</a>'}).firstChild.href),e}}),_V_.log=function(){_V_.log.history=_V_.log.history||[],_V_.log.history.push(arguments);if(window.console){arguments.callee=arguments.callee.caller;var e=[].slice.call(arguments);typeof console.log=="object"?_V_.log.apply.call(console.log,console,e):console.log.apply(console,e)}},function(e){function t(){}for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,timeStamp,profile,profileEnd,time,timeEnd,trace,warn".split(","),r;r=n.pop();)e[r]=e[r]||t}(function(){try{return console.log(),window.console}catch(e){return window.console={}}}()),"getBoundingClientRect"in document.documentElement?_V_.findPosX=function(e){var t;try{t=e.getBoundingClientRect()}catch(n){}if(!t)return 0;var r=document.documentElement,i=document.body,s=r.clientLeft||i.clientLeft||0,o=window.pageXOffset||i.scrollLeft,u=t.left+o-s;return u}:_V_.findPosX=function(e){var t=e.offsetLeft;while(e=obj.offsetParent)e.className.indexOf("video-js")==-1,t+=e.offsetLeft;return t},function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;_V_.Class=function(){},_V_.Class.extend=function(n){function o(){if(!e&&this.init)return this.init.apply(this,arguments);if(!e)return arguments.callee.prototype.init()}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s in n)i[s]=typeof n[s]=="function"&&typeof r[s]=="function"&&t.test(n[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,n[s]):n[s];return o.prototype=i,o.constructor=o,o.extend=arguments.callee,o}}(),_V_.Component=_V_.Class.extend({init:function(e,t){this.player=e,t=this.options=_V_.merge(this.options||{},t),t.el?this.el=t.el:this.el=this.createElement(),this.initComponents()},destroy:function(){},createElement:function(e,t){return _V_.createElement(e||"div",t)},buildCSSClass:function(){return""},initComponents:function(){var e=this.options;e&&e.components&&this.eachProp(e.components,function(e,t){var n=this.proxy(function(){this[e]=this.addComponent(e,t)});t.loadEvent?this.one(t.loadEvent,n):n()})},addComponent:function(e,t){var n,r;return typeof e=="string"?(t=t||{},r=t.componentClass||_V_.uc(e),n=new _V_[r](this.player||this,t)):n=e,this.el.appendChild(n.el),n},removeComponent:function(e){this.el.removeChild(e.el)},show:function(){this.el.style.display="block"},hide:function(){this.el.style.display="none"},fadeIn:function(){this.removeClass("vjs-fade-out"),this.addClass("vjs-fade-in")},fadeOut:function(){this.removeClass("vjs-fade-in"),this.addClass("vjs-fade-out")},lockShowing:function(){var e=this.el.style;e.display="block",e.opacity=1,e.visiblity="visible"},unlockShowing:function(){var e=this.el.style;e.display="",e.opacity="",e.visiblity=""},addClass:function(e){_V_.addClass(this.el,e)},removeClass:function(e){_V_.removeClass(this.el,e)},addEvent:function(e,t,n){return _V_.addEvent(this.el,e,_V_.proxy(this,t))},removeEvent:function(e,t){return _V_.removeEvent(this.el,e,t)},triggerEvent:function(e,t){return _V_.triggerEvent(this.el,e,t)},one:function(e,t){_V_.one(this.el,e,_V_.proxy(this,t))},ready:function(e){return e?(this.isReady?e.call(this):(this.readyQueue===undefined&&(this.readyQueue=[]),this.readyQueue.push(e)),this):this},triggerReady:function(){this.isReady=!0,this.readyQueue&&this.readyQueue.length>0&&(this.each(this.readyQueue,function(e){e.call(this)}),this.readyQueue=[],this.triggerEvent("ready"))},each:function(e,t){_V_.each.call(this,e,t)},eachProp:function(e,t){_V_.eachProp.call(this,e,t)},extend:function(e){_V_.merge(this,e)},proxy:function(e,t){return _V_.proxy(this,e,t)}}),_V_.Control=_V_.Component.extend({buildCSSClass:function(){return"vjs-control "+this._super()}}),_V_.ControlBar=_V_.Component.extend({options:{loadEvent:"play",components:{playToggle:{},fullscreenToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},progressControl:{},volumeControl:{},muteToggle:{}}},init:function(e,t){this._super(e,t),e.addEvent("play",this.proxy(function(){this.fadeIn(),this.player.addEvent("mouseover",this.proxy(this.fadeIn)),this.player.addEvent("mouseout",this.proxy(this.fadeOut))}))},createElement:function(){return _V_.createElement("div",{className:"vjs-controls"})},fadeIn:function(){this._super(),this.player.triggerEvent("controlsvisible")},fadeOut:function(){this._super(),this.player.triggerEvent("controlshidden")},lockShowing:function(){this.el.style.opacity="1"}}),_V_.Button=_V_.Control.extend({init:function(e,t){this._super(e,t),this.addEvent("click",this.onClick),this.addEvent("focus",this.onFocus),this.addEvent("blur",this.onBlur)},createElement:function(e,t){return t=_V_.merge({className:this.buildCSSClass(),innerHTML:'<div><span class="vjs-control-text">'+(this.buttonText||"Need Text")+"</span></div>",role:"button",tabIndex:0},t),this._super(e,t)},onClick:function(){},onFocus:function(){_V_.addEvent(document,"keyup",_V_.proxy(this,this.onKeyPress))},onKeyPress:function(e){if(e.which==32||e.which==13)e.preventDefault(),this.onClick()},onBlur:function(){_V_.removeEvent(document,"keyup",_V_.proxy(this,this.onKeyPress))}}),_V_.PlayButton=_V_.Button.extend({buttonText:"Play",buildCSSClass:function(){return"vjs-play-button "+this._super()},onClick:function(){this.player.play()}}),_V_.PauseButton=_V_.Button.extend({buttonText:"Pause",buildCSSClass:function(){return"vjs-pause-button "+this._super()},onClick:function(){this.player.pause()}}),_V_.PlayToggle=_V_.Button.extend({buttonText:"Play",init:function(e,t){this._super(e,t),e.addEvent("play",_V_.proxy(this,this.onPlay)),e.addEvent("pause",_V_.proxy(this,this.onPause))},buildCSSClass:function(){return"vjs-play-control "+this._super()},onClick:function(){this.player.paused()?this.player.play():this.player.pause()},onPlay:function(){_V_.removeClass(this.el,"vjs-paused"),_V_.addClass(this.el,"vjs-playing")},onPause:function(){_V_.removeClass(this.el,"vjs-playing"),_V_.addClass(this.el,"vjs-paused")}}),_V_.FullscreenToggle=_V_.Button.extend({buttonText:"Fullscreen",buildCSSClass:function(){return"vjs-fullscreen-control "+this._super()},onClick:function(){this.player.isFullScreen?this.player.cancelFullScreen():this.player.requestFullScreen()}}),_V_.BigPlayButton=_V_.Button.extend({init:function(e,t){this._super(e,t),e.addEvent("play",_V_.proxy(this,this.hide)),e.addEvent("ended",_V_.proxy(this,this.show))},createElement:function(){return this._super("div",{className:"vjs-big-play-button",innerHTML:"<span></span>"})},onClick:function(){this.player.currentTime()&&this.player.currentTime(0),this.player.play()}}),_V_.LoadingSpinner=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent("canplay",_V_.proxy(this,this.hide)),e.addEvent("canplaythrough",_V_.proxy(this,this.hide)),e.addEvent("playing",_V_.proxy(this,this.hide)),e.addEvent("seeking",_V_.proxy(this,this.show)),e.addEvent("error",_V_.proxy(this,this.show)),e.addEvent("waiting",_V_.proxy(this,this.show))},createElement:function(){var e,t;return typeof this.player.el.style.WebkitBorderRadius=="string"||typeof this.player.el.style.MozBorderRadius=="string"||typeof this.player.el.style.KhtmlBorderRadius=="string"||typeof this.player.el.style.borderRadius=="string"?(e="vjs-loading-spinner",t="<div class='ball1'></div><div class='ball2'></div><div class='ball3'></div><div class='ball4'></div><div class='ball5'></div><div class='ball6'></div><div class='ball7'></div><div class='ball8'></div>"):(e="vjs-loading-spinner-fallback",t=""),this._super("div",{className:e,innerHTML:t})}}),_V_.CurrentTimeDisplay=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent("timeupdate",_V_.proxy(this,this.updateContent))},createElement:function(){var e=this._super("div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.content=_V_.createElement("div",{className:"vjs-current-time-display",innerHTML:"0:00"}),e.appendChild(_V_.createElement("div").appendChild(this.content)),e},updateContent:function(){var e=this.player.scrubbing?this.player.values.currentTime:this.player.currentTime();this.content.innerHTML=_V_.formatTime(e,this.player.duration())}}),_V_.DurationDisplay=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent("timeupdate",_V_.proxy(this,this.updateContent))},createElement:function(){var e=this._super("div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.content=_V_.createElement("div",{className:"vjs-duration-display",innerHTML:"0:00"}),e.appendChild(_V_.createElement("div").appendChild(this.content)),e},updateContent:function(){this.player.duration()&&(this.content.innerHTML=_V_.formatTime(this.player.duration()))}}),_V_.TimeDivider=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})}}),_V_.RemainingTimeDisplay=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent("timeupdate",_V_.proxy(this,this.updateContent))},createElement:function(){var e=this._super("div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.content=_V_.createElement("div",{className:"vjs-remaining-time-display",innerHTML:"-0:00"}),e.appendChild(_V_.createElement("div").appendChild(this.content)),e},updateContent:function(){this.player.duration()&&(this.content.innerHTML="-"+_V_.formatTime(this.player.remainingTime()))}}),_V_.Slider=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent(this.playerEvent,_V_.proxy(this,this.update)),this.addEvent("mousedown",this.onMouseDown),this.addEvent("focus",this.onFocus),this.addEvent("blur",this.onBlur),this.player.addEvent("controlsvisible",this.proxy(this.update)),this.update()},createElement:function(e,t){return t=_V_.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},t),this._super(e,t)},onMouseDown:function(e){e.preventDefault(),_V_.blockTextSelection(),_V_.addEvent(document,"mousemove",_V_.proxy(this,this.onMouseMove)),_V_.addEvent(document,"mouseup",_V_.proxy(this,this.onMouseUp)),this.onMouseMove(e)},onMouseUp:function(e){_V_.unblockTextSelection(),_V_.removeEvent(document,"mousemove",this.onMouseMove,!1),_V_.removeEvent(document,"mouseup",this.onMouseUp,!1),this.update()},update:function(){var e,t=this.getPercent();handle=this.handle,bar=this.bar,isNaN(t)&&(t=0),e=t;if(handle){var n=this.el,r=n.offsetWidth,i=handle.el.offsetWidth,s=i?i/r:0,o=1-s;adjustedProgress=t*o,e=adjustedProgress+s/2,handle.el.style.left=_V_.round(adjustedProgress*100,2)+"%"}bar.el.style.width=_V_.round(e*100,2)+"%"},calculateDistance:function(e){var t=this.el,n=_V_.findPosX(t),r=t.offsetWidth,i=this.handle;if(i){var s=i.el.offsetWidth;n+=s/2,r-=s}return Math.max(0,Math.min(1,(e.pageX-n)/r))},onFocus:function(e){_V_.addEvent(document,"keyup",_V_.proxy(this,this.onKeyPress))},onKeyPress:function(e){e.which==37?(e.preventDefault(),this.stepBack()):e.which==39&&(e.preventDefault(),this.stepForward())},onBlur:function(e){_V_.removeEvent(document,"keyup",_V_.proxy(this,this.onKeyPress))}}),_V_.ProgressControl=_V_.Component.extend({options:{components:{seekBar:{}}},createElement:function(){return this._super("div",{className:"vjs-progress-control vjs-control"})}}),_V_.SeekBar=_V_.Slider.extend({options:{components:{loadProgressBar:{},bar:{componentClass:"PlayProgressBar"},handle:{componentClass:"SeekHandle"}}},playerEvent:"timeupdate",init:function(e,t){this._super(e,t)},createElement:function(){return this._super("div",{className:"vjs-progress-holder"})},getPercent:function(){return this.player.currentTime()/this.player.duration()},onMouseDown:function(e){this._super(e),this.player.scrubbing=!0,this.videoWasPlaying=!this.player.paused(),this.player.pause()},onMouseMove:function(e){var t=this.calculateDistance(e)*this.player.duration();t==this.player.duration()&&(t-=.1),this.player.currentTime(t)},onMouseUp:function(e){this._super(e),this.player.scrubbing=!1,this.videoWasPlaying&&this.player.play()},stepForward:function(){this.player.currentTime(this.player.currentTime()+1)},stepBack:function(){this.player.currentTime(this.player.currentTime()-1)}}),_V_.LoadProgressBar=_V_.Component.extend({init:function(e,t){this._super(e,t),e.addEvent("progress",_V_.proxy(this,this.update))},createElement:function(){return this._super("div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text">Loaded: 0%</span>'})},update:function(){this.el.style&&(this.el.style.width=_V_.round(this.player.bufferedPercent()*100,2)+"%")}}),_V_.PlayProgressBar=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text">Progress: 0%</span>'})}}),_V_.SeekHandle=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-seek-handle",innerHTML:'<span class="vjs-control-text">00:00</span>'})}}),_V_.VolumeControl=_V_.Component.extend({options:{components:{volumeBar:{}}},createElement:function(){return this._super("div",{className:"vjs-volume-control vjs-control"})}}),_V_.VolumeBar=_V_.Slider.extend({options:{components:{bar:{componentClass:"VolumeLevel"},handle:{componentClass:"VolumeHandle"}}},playerEvent:"volumechange",createElement:function(){return this._super("div",{className:"vjs-volume-bar"})},onMouseMove:function(e){this.player.volume(this.calculateDistance(e))},getPercent:function(){return this.player.volume()},stepForward:function(){this.player.volume(this.player.volume()+.1)},stepBack:function(){this.player.volume(this.player.volume()-.1)}}),_V_.VolumeLevel=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})}}),_V_.VolumeHandle=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-volume-handle",innerHTML:'<span class="vjs-control-text"></span>'})}}),_V_.MuteToggle=_V_.Button.extend({init:function(e,t){this._super(e,t),e.addEvent("volumechange",_V_.proxy(this,this.update))},createElement:function(){return this._super("div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'})},onClick:function(e){this.player.muted(this.player.muted()?!1:!0)},update:function(e){var t=this.player.volume(),n=3;t==0||this.player.muted()?n=0:t<.33?n=1:t<.67&&(n=2),_V_.each.call(this,[0,1,2,3],function(e){_V_.removeClass(this.el,"vjs-vol-"+e)}),_V_.addClass(this.el,"vjs-vol-"+n)}}),_V_.PosterImage=_V_.Button.extend({init:function(e,t){this._super(e,t),this.player.options.poster||this.hide(),e.addEvent("play",_V_.proxy(this,this.hide))},createElement:function(){return _V_.createElement("img",{className:"vjs-poster",src:this.player.options.poster,tabIndex:-1})},onClick:function(){this.player.play()}}),_V_.Menu=_V_.Component.extend({init:function(e,t){this._super(e,t)},addItem:function(e){this.addComponent(e),e.addEvent("click",this.proxy(function(){this.unlockShowing()}))},createElement:function(){return this._super("ul",{className:"vjs-menu"})}}),_V_.MenuItem=_V_.Button.extend({init:function(e,t){this._super(e,t),t.selected&&this.addClass("vjs-selected")},createElement:function(e,t){return this._super("li",_V_.merge({className:"vjs-menu-item",innerHTML:this.options.label},t))},onClick:function(){this.selected(!0)},selected:function(e){e?this.addClass("vjs-selected"):this.removeClass("vjs-selected")}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this===void 0||this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:r!==0&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),_V_.extend({addEvent:function(e,t,n){var r=_V_.getData(e),i;r&&!r.handler&&(r.handler=function(t){t=_V_.fixEvent(t);var n=_V_.getData(e).events[t.type];if(n){var r=[];_V_.each(n,function(e,t){r[t]=e});for(var i=0,s=r.length;i<s;i++)r[i].call(e,t)}}),r.events||(r.events={}),i=r.events[t],i||(i=r.events[t]=[],document.addEventListener?e.addEventListener(t,r.handler,!1):document.attachEvent&&e.attachEvent("on"+t,r.handler)),n.guid||(n.guid=_V_.guid++),i.push(n)},removeEvent:function(e,t,n){var r=_V_.getData(e),i;if(!r.events)return;if(!t){for(t in r.events)_V_.cleanUpEvents(e,t);return}i=r.events[t];if(!i)return;if(n&&n.guid)for(var s=0;s<i.length;s++)i[s].guid===n.guid&&i.splice(s--,1);_V_.cleanUpEvents(e,t)},cleanUpEvents:function(e,t){var n=_V_.getData(e);n.events[t].length===0&&(delete n.events[t],document.removeEventListener?e.removeEventListener(t,n.handler,!1):document.detachEvent&&e.detachEvent("on"+t,n.handler)),_V_.isEmpty(n.events)&&(delete n.events,delete n.handler),_V_.isEmpty(n)&&_V_.removeData(e)},fixEvent:function(e){if(e[_V_.expando])return e;var t=e;e=new _V_.Event(t);for(var n=_V_.Event.props.length,r;n;)r=_V_.Event.props[--n],e[r]=t[r];e.target||(e.target=e.srcElement||document),e.target.nodeType===3&&(e.target=e.target.parentNode),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement);if(e.pageX==null&&e.clientX!=null){var i=e.target.ownerDocument||document,s=i.documentElement,o=i.body;e.pageX=e.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)}return e.which==null&&(e.charCode!=null||e.keyCode!=null)&&(e.which=e.charCode!=null?e.charCode:e.keyCode),!e.metaKey&&e.ctrlKey&&(e.metaKey=e.ctrlKey),!e.which&&e.button!==undefined&&(e.which=e.button&1?1:e.button&2?3:e.button&4?2:0),e},triggerEvent:function(e,t){var n=_V_.getData(e),r=e.parentNode||e.ownerDocument,i=t.type||t,s;n&&(s=n.handler),t=typeof t=="object"?t[_V_.expando]?t:new _V_.Event(i,t):new _V_.Event(i),t.type=i,s&&s.call(e,t),t.result=undefined,t.target=e},one:function(e,t,n){_V_.addEvent(e,t,function(){_V_.removeEvent(e,t,arguments.callee),n.apply(this,arguments)})}}),_V_.Event=function(e,t){e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?returnTrue:returnFalse):this.type=e,t&&_V_.merge(this,t),this.timeStamp=(new Date).getTime(),this[_V_.expando]=!0},_V_.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse},_V_.Event.props="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");var JSON;JSON||(JSON={}),function(){var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),_V_.Player=_V_.Component.extend({init:function(e,t,n){this.tag=e;var r=this.el=_V_.createElement("div"),i=this.options={},s=i.width=e.getAttribute("width"),o=i.height=e.getAttribute("height"),u=s||300,a=o||150;e.player=r.player=this,this.ready(n),e.parentNode.insertBefore(r,e),r.appendChild(e),r.id=this.id=e.id,r.className=e.className,e.id+="_html5_api",e.className="vjs-tech",_V_.players[r.id]=this,r.setAttribute("width",u),r.setAttribute("height",a),r.style.width=u+"px",r.style.height=a+"px",e.removeAttribute("width"),e.removeAttribute("height"),_V_.merge(i,_V_.options),_V_.merge(i,this.getVideoTagSettings()),_V_.merge(i,t),e.removeAttribute("controls"),e.removeAttribute("poster");if(e.hasChildNodes())for(var f=0,l=e.childNodes;f<l.length;f++)(l[f].nodeName=="SOURCE"||l[f].nodeName=="TRACK")&&e.removeChild(l[f]);this.values={},this.addClass("vjs-paused"),this.addEvent("ended",this.onEnded),this.addEvent("play",this.onPlay),this.addEvent("pause",this.onPause),this.addEvent("progress",this.onProgress),this.addEvent("error",this.onError),i.controls&&this.ready(function(){this.initComponents()}),this.textTracks=[],i.tracks&&i.tracks.length>0&&this.addTextTracks(i.tracks);if(!i.sources||i.sources.length==0)for(var f=0,l=i.techOrder;f<l.length;f++){var c=l[f],h=_V_[c];if(h.isSupported()){this.loadTech(c);break}}else this.src(i.sources)},values:{},destroy:function(){this.stopTrackingProgress(),this.stopTrackingCurrentTime(),_V_.players[this.id]=null,delete _V_.players[this.id],this.tech.destroy(),this.el.parentNode.removeChild(this.el)},createElement:function(e,t){},getVideoTagSettings:function(){var e={sources:[],tracks:[]};e.src=this.tag.getAttribute("src"),e.controls=this.tag.getAttribute("controls")!==null,e.poster=this.tag.getAttribute("poster"),e.preload=this.tag.getAttribute("preload"),e.autoplay=this.tag.getAttribute("autoplay")!==null,e.loop=this.tag.getAttribute("loop")!==null,e.muted=this.tag.getAttribute("muted")!==null;if(this.tag.hasChildNodes())for(var t,n=0,r=this.tag.childNodes;n<r.length;n++)t=r[n],t.nodeName=="SOURCE"&&e.sources.push({src:t.getAttribute("src"),type:t.getAttribute("type"),media:t.getAttribute("media"),title:t.getAttribute("title")}),t.nodeName=="TRACK"&&e.tracks.push({src:t.getAttribute("src"),kind:t.getAttribute("kind"),srclang:t.getAttribute("srclang"),label:t.getAttribute("label"),"default":t.getAttribute("default")!==null,title:t.getAttribute("title")});return e},loadTech:function(e,t){this.tech?this.unloadTech():e!="html5"&&this.tag&&(this.el.removeChild(this.tag),this.tag=!1),this.techName=e,this.isReady=!1;var n=function(){this.player.triggerReady(),this.support.progressEvent||this.player.manualProgressOn(),this.support.timeupdateEvent||this.player.manualTimeUpdatesOn()},r=_V_.merge({source:t,parentEl:this.el},this.options[e]);t&&(t.src==this.values.src&&this.values.currentTime>0&&(r.startTime=this.values.currentTime),this.values.src=t.src),this.tech=new _V_[e](this,r),this.tech.ready(n)},unloadTech:function(){this.tech.destroy(),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),this.tech=!1},manualProgressOn:function(){this.manualProgress=!0,this.trackProgress(),this.tech.addEvent("progress",function(){this.removeEvent("progress",arguments.callee),this.support.progressEvent=!0,this.player.manualProgressOff()})},manualProgressOff:function(){this.manualProgress=!1,this.stopTrackingProgress()},trackProgress:function(){this.progressInterval=setInterval(_V_.proxy(this,function(){this.values.bufferEnd<this.buffered().end(0)?this.triggerEvent("progress"):this.bufferedPercent()==1&&(this.stopTrackingProgress(),this.triggerEvent("progress"))}),500)},stopTrackingProgress:function(){clearInterval(this.progressInterval)},manualTimeUpdatesOn:function(){this.manualTimeUpdates=!0,this.addEvent("play",this.trackCurrentTime),this.addEvent("pause",this.stopTrackingCurrentTime),this.tech.addEvent("timeupdate",function(){this.removeEvent("timeupdate",arguments.callee),this.support.timeupdateEvent=!0,this.player.manualTimeUpdatesOff()})},manualTimeUpdatesOff:function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.removeEvent("play",this.trackCurrentTime),this.removeEvent("pause",this.stopTrackingCurrentTime)},trackCurrentTime:function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=setInterval(_V_.proxy(this,function(){this.triggerEvent("timeupdate")}),250)},stopTrackingCurrentTime:function(){clearInterval(this.currentTimeInterval)},onEnded:function(){this.options.loop?(this.currentTime(0),this.play()):(this.pause(),this.currentTime(0),this.pause())},onPlay:function(){_V_.removeClass(this.el,"vjs-paused"),_V_.addClass(this.el,"vjs-playing")},onPause:function(){_V_.removeClass(this.el,"vjs-playing"),_V_.addClass(this.el,"vjs-paused")},onProgress:function(){this.bufferedPercent()==1&&this.triggerEvent("loadedalldata")},onError:function(e){_V_.log("Video Error",e)},techCall:function(e,t){if(!this.tech.isReady)this.tech.ready(function(){this[e](t)});else try{this.tech[e](t)}catch(n){_V_.log(n)}},techGet:function(e){if(this.tech.isReady)try{return this.tech[e]()}catch(t){this.tech[e]===undefined?_V_.log("Video.js: "+e+" method not defined for "+this.techName+" playback technology.",t):t.name=="TypeError"?(_V_.log("Video.js: "+e+" unavailable on "+this.techName+" playback technology element.",t),this.tech.isReady=!1):_V_.log(t)}return},play:function(){return this.techCall("play"),this},pause:function(){return this.techCall("pause"),this},paused:function(){return this.techGet("paused")===!1?!1:!0},currentTime:function(e){return e!==undefined?(this.values.lastSetCurrentTime=e,this.techCall("setCurrentTime",e),this.manualTimeUpdates&&this.triggerEvent("timeupdate"),this):this.values.currentTime=this.techGet("currentTime")||0},duration:function(){return parseFloat(this.techGet("duration"))},remainingTime:function(){return this.duration()-this.currentTime()},buffered:function(){var e=this.techGet("buffered"),t=0,n=this.values.bufferEnd=this.values.bufferEnd||0,r;return e&&e.length>0&&e.end(0)!==n&&(n=e.end(0),this.values.bufferEnd=n),_V_.createTimeRange(t,n)},bufferedPercent:function(){return this.duration()?this.buffered().end(0)/this.duration():0},volume:function(e){var t;return e!==undefined?(t=Math.max(0,Math.min(1,parseFloat(e))),this.values.volume=t,this.techCall("setVolume",t),_V_.setLocalStorage("volume",t),this):(t=parseFloat(this.techGet("volume")),isNaN(t)?1:t)},muted:function(e){return e!==undefined?(this.techCall("setMuted",e),this):this.techGet("muted")||!1},width:function(e,t){return e!==undefined?(this.el.width=e,this.el.style.width=e+"px",t||this.triggerEvent("resize"),this):parseInt(this.el.getAttribute("width"))},height:function(e){return e!==undefined?(this.el.height=e,this.el.style.height=e+"px",this.triggerEvent("resize"),this):parseInt(this.el.getAttribute("height"))},size:function(e,t){return this.width(e,!0).height(t)},supportsFullScreen:function(){return this.techGet("supportsFullScreen")||!1},requestFullScreen:function(){var e=_V_.support.requestFullScreen;return this.isFullScreen=!0,e?(_V_.addEvent(document,e.eventName,this.proxy(function(){this.isFullScreen=document[e.isFullScreen],this.isFullScreen==0&&_V_.removeEvent(document,e.eventName,arguments.callee),this.triggerEvent("fullscreenchange")})),this.tech.support.fullscreenResize===!1&&this.options.flash.iFrameMode!=1?(this.pause(),this.unloadTech(),_V_.addEvent(document,e.eventName,this.proxy(function(){_V_.removeEvent(document,e.eventName,arguments.callee),this.loadTech(this.techName,{src:this.values.src})})),this.el[e.requestFn]()):this.el[e.requestFn]()):this.tech.supportsFullScreen()?(this.triggerEvent("fullscreenchange"),this.techCall("enterFullScreen")):(this.triggerEvent("fullscreenchange"),this.enterFullWindow()),this},cancelFullScreen:function(){var e=_V_.support.requestFullScreen;return this.isFullScreen=!1,e?this.tech.support.fullscreenResize===!1&&this.options.flash.iFrameMode!=1?(this.pause(),this.unloadTech(),_V_.addEvent(document,e.eventName,this.proxy(function(){_V_.removeEvent(document,e.eventName,arguments.callee),this.loadTech(this.techName,{src:this.values.src})})),document[e.cancelFn]()):document[e.cancelFn]():this.tech.supportsFullScreen()?(this.techCall("exitFullScreen"),this.triggerEvent("fullscreenchange")):(this.exitFullWindow(),this.triggerEvent("fullscreenchange")),this},enterFullWindow:function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,_V_.addEvent(document,"keydown",_V_.proxy(this,this.fullWindowOnEscKey)),document.documentElement.style.overflow="hidden",_V_.addClass(document.body,"vjs-full-window"),_V_.addClass(this.el,"vjs-fullscreen"),this.triggerEvent("enterFullWindow")},fullWindowOnEscKey:function(e){e.keyCode==27&&(this.isFullScreen==1?this.cancelFullScreen():this.exitFullWindow())},exitFullWindow:function(){this.isFullWindow=!1,_V_.removeEvent(document,"keydown",this.fullWindowOnEscKey),document.documentElement.style.overflow=this.docOrigOverflow,_V_.removeClass(document.body,"vjs-full-window"),_V_.removeClass(this.el,"vjs-fullscreen"),this.triggerEvent("exitFullWindow")},selectSource:function(e){for(var t=0,n=this.options.techOrder;t<n.length;t++){var r=n[t],i=_V_[r];if(i.isSupported())for(var s=0,o=e;s<o.length;s++){var u=o[s];if(i.canPlaySource.call(this,u))return{source:u,tech:r}}}return!1},src:function(e){if(e instanceof Array){var t=this.selectSource(e),e,n;t?(e=t.source,n=t.tech,n==this.techName?this.src(e):this.loadTech(n,e)):_V_.log("No compatible source and playback technology were found.")}else e instanceof Object?_V_[this.techName].canPlaySource(e)?this.src(e.src):this.src([e]):(this.values.src=e,this.isReady?(this.techCall("src",e),this.options.preload=="auto"&&this.load(),this.options.autoplay&&this.play()):this.ready(function(){this.src(e)}));return this},load:function(){return this.techCall("load"),this},currentSrc:function(){return this.techGet("currentSrc")||this.values.src||""},preload:function(e){return e!==undefined?(this.techCall("setPreload",e),this.options.preload=e,this):this.techGet("preload")},autoplay:function(e){return e!==undefined?(this.techCall("setAutoplay",e),this.options.autoplay=e,this):this.techGet("autoplay",e)},loop:function(e){return e!==undefined?(this.techCall("setLoop",e),this.options.loop=e,this):this.techGet("loop")},controls:function(){return this.options.controls},poster:function(){return this.techGet("poster")},error:function(){return this.techGet("error")},ended:function(){return this.techGet("ended")}}),function(){var e,t,n,r,i=_V_.Player.prototype;document.cancelFullscreen!==undefined?(e="requestFullscreen",t="exitFullscreen",n="fullscreenchange",r="fullScreen"):_V_.each(["moz","webkit"],function(i){(i!="moz"||document.mozFullScreenEnabled)&&document[i+"CancelFullScreen"]!==undefined&&(e=i+"RequestFullScreen",t=i+"CancelFullScreen",n=i+"fullscreenchange",i=="webkit"?r=i+"IsFullScreen":r=i+"FullScreen")}),e&&(_V_.support.requestFullScreen={requestFn:e,cancelFn:t,eventName:n,isFullScreen:r})}(),_V_.PlaybackTech=_V_.Component.extend({init:function(e,t){},onClick:function(){this.player.options.controls&&_V_.PlayToggle.prototype.onClick.call(this)}}),_V_.apiMethods="play,pause,paused,currentTime,setCurrentTime,duration,buffered,volume,setVolume,muted,setMuted,width,height,supportsFullScreen,enterFullScreen,src,load,currentSrc,preload,setPreload,autoplay,setAutoplay,loop,setLoop,error,networkState,readyState,seeking,initialTime,startOffsetTime,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks,defaultPlaybackRate,playbackRate,mediaGroup,controller,controls,defaultMuted".split(","),_V_.each(_V_.apiMethods,function(e){_V_.PlaybackTech.prototype[e]=function(){throw new Error("The '"+e+"' method is not available on the playback technology's API")}}),_V_.html5=_V_.PlaybackTech.extend({init:function(e,t,n){this.player=e,this.el=this.createElement(),this.ready(n),this.addEvent("click",this.proxy(this.onClick));var r=t.source;r&&this.el.currentSrc==r.src?e.triggerEvent("loadstart"):r&&(this.el.src=r.src),e.ready(function(){this.options.autoplay&&this.paused()&&(this.tag.poster=null,this.play())}),this.setupTriggers(),this.triggerReady()},destroy:function(){this.player.tag=!1,this.removeTriggers(),this.el.parentNode.removeChild(this.el)},createElement:function(){var e=_V_.html5,t=this.player,n=t.tag,r;if(!n||this.support.movingElementInDOM===!1)n&&t.el.removeChild(n),r=_V_.createElement("video",{id:n.id||t.el.id+"_html5_api",className:n.className||"vjs-tech"}),n=r,_V_.insertFirst(n,t.el);return _V_.each(["autoplay","preload","loop","muted"],function(e){t.options[e]!==null&&(n[e]=t.options[e])},this),n},setupTriggers:function(){_V_.each.call(this,_V_.html5.events,function(e){_V_.addEvent(this.el,e,_V_.proxy(this.player,this.eventHandler))})},removeTriggers:function(){_V_.each.call(this,_V_.html5.events,function(e){_V_.removeEvent(this.el,e,_V_.proxy(this.player,this.eventHandler))})},eventHandler:function(e){e.stopPropagation(),this.triggerEvent(e)},play:function(){this.el.play()},pause:function(){this.el.pause()},paused:function(){return this.el.paused},currentTime:function(){return this.el.currentTime},setCurrentTime:function(e){try{this.el.currentTime=e}catch(t){_V_.log(t,"Video isn't ready. (VideoJS)")}},duration:function(){return this.el.duration||0},buffered:function(){return this.el.buffered},volume:function(){return this.el.volume},setVolume:function(e){this.el.volume=e},muted:function(){return this.el.muted},setMuted:function(e){this.el.muted=e},width:function(){return this.el.offsetWidth},height:function(){return this.el.offsetHeight},supportsFullScreen:function(){return typeof this.el.webkitEnterFullScreen=="function"&&!navigator.userAgent.match("Chrome")&&!navigator.userAgent.match("Mac OS X 10.5")?!0:!1},enterFullScreen:function(){try{this.el.webkitEnterFullScreen()}catch(e){e.code==11&&_V_.log("VideoJS: Video not ready.")}},src:function(e){this.el.src=e},load:function(){this.el.load()},currentSrc:function(){return this.el.currentSrc},preload:function(){return this.el.preload},setPreload:function(e){this.el.preload=e},autoplay:function(){return this.el.autoplay},setAutoplay:function(e){this.el.autoplay=e},loop:function(){return this.el.loop},setLoop:function(e){this.el.loop=e},error:function(){return this.el.error},seeking:function(){return this.el.seeking},ended:function(){return this.el.ended},controls:function(){return this.player.options.controls},defaultMuted:function(){return this.el.defaultMuted}}),_V_.html5.isSupported=function(){return!!document.createElement("video").canPlayType},_V_.html5.canPlaySource=function(e){return!!document.createElement("video").canPlayType(e.type)},_V_.html5.events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),_V_.html5.prototype.support={fullscreen:typeof _V_.testVid.webkitEnterFullScreen!==undefined?!_V_.ua.match("Chrome")&&!_V_.ua.match("Mac OS X 10.5")?!0:!1:!1,movingElementInDOM:!_V_.isIOS()},_V_.isAndroid()&&_V_.androidVersion()<3&&(document.createElement("video").constructor.prototype.canPlayType=function(e){return e&&e.toLowerCase().indexOf("video/mp4")!=-1?"maybe":""}),_V_.flash=_V_.PlaybackTech.extend({init:function(e,t){this.player=e;var n=t.source,r=t.parentEl,i=this.el=_V_.createElement("div",{id:r.id+"_temp_flash"}),s=e.el.id+"_flash_api",o=e.options,u=_V_.merge({readyFunction:"_V_.flash.onReady",eventProxyFunction:"_V_.flash.onEvent",errorEventProxyFunction:"_V_.flash.onError",autoplay:o.autoplay,preload:o.preload,loop:o.loop,muted:o.muted},t.flashVars),a=_V_.merge({wmode:"opaque",bgcolor:"#000000"},t.params),f=_V_.merge({id:s,name:s,"class":"vjs-tech"},t.attributes);n&&(u.src=encodeURIComponent(_V_.getAbsoluteURL(n.src))),_V_.insertFirst(i,r),t.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(t.startTime)});if(t.iFrameMode==1&&!_V_.isFF){var l=_V_.createElement("iframe",{id:s+"_iframe",name:s+"_iframe",className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0});u.readyFunction="ready",u.eventProxyFunction="events",u.errorEventProxyFunction="errors",_V_.addEvent(l,"load",_V_.proxy(this,function(){var e,n,r,i=l.contentWindow,s="";e=l.contentDocument?l.contentDocument:l.contentWindow.document,e.write(_V_.flash.getEmbedCode(t.swf,u,a,f)),i.player=this.player,i.ready=_V_.proxy(this.player,function(t){var n=e.getElementById(t),r=this,i=r.tech;i.el=n,_V_.addEvent(n,"click",i.proxy(i.onClick)),_V_.flash.checkReady(i)}),i.events=_V_.proxy(this.player,function(e,t,n){var r=this;r&&r.techName=="flash"&&r.triggerEvent(t)}),i.errors=_V_.proxy(this.player,function(e,t){_V_.log("Flash Error",t)})})),i.parentNode.replaceChild(l,i)}else _V_.flash.embed(t.swf,i,u,a,f)},destroy:function(){this.el.parentNode.removeChild(this.el)},play:function(){this.el.vjs_play()},pause:function(){this.el.vjs_pause()},src:function(e){e=_V_.getAbsoluteURL(e),this.el.vjs_src(e);if(this.player.autoplay()){var t=this;setTimeout(function(){t.play()},0)}},load:function(){this.el.vjs_load()},poster:function(){this.el.vjs_getProperty("poster")},buffered:function(){return _V_.createTimeRange(0,this.el.vjs_getProperty("buffered"))},supportsFullScreen:function(){return!1},enterFullScreen:function(){return!1}}),function(){var e=_V_.flash.prototype,t="preload,currentTime,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),n="error,currentSrc,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),r="load,play,pause".split(",");createSetter=function(t){var n=t.charAt(0).toUpperCase()+t.slice(1);e["set"+n]=function(e){return this.el.vjs_setProperty(t,e)}},createGetter=function(t){e[t]=function(){return this.el.vjs_getProperty(t)}},_V_.each(t,function(e){createGetter(e),createSetter(e)}),_V_.each(n,function(e){createGetter(e)})}(),_V_.flash.isSupported=function(){return _V_.flash.version()[0]>=10},_V_.flash.canPlaySource=function(e){if(e.type in _V_.flash.prototype.support.formats)return"maybe"},_V_.flash.prototype.support={formats:{"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},progressEvent:!1,timeupdateEvent:!1,fullscreenResize:!1,parentResize:!_V_.ua.match("Firefox")},_V_.flash.onReady=function(e){var t=_V_.el(e),n=t.player||t.parentNode.player,r=n.tech;t.player=n,r.el=t,r.addEvent("click",r.onClick),_V_.flash.checkReady(r)},_V_.flash.checkReady=function(e){e.el.vjs_getProperty?e.triggerReady():setTimeout(function(){_V_.flash.checkReady(e)},50)},_V_.flash.onEvent=function(e,t){var n=_V_.el(e).player;n.triggerEvent(t)},_V_.flash.onError=function(e,t){var n=_V_.el(e).player;n.triggerEvent("error"),_V_.log("Flash Error",t,e)},_V_.flash.version=function(){var e="0,0,0";try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(t){}}return e.split(",")},_V_.flash.embed=function(e,t,n,r,i){var s=_V_.flash.getEmbedCode(e,n,r,i),o=_V_.createElement("div",{innerHTML:s}).childNodes[0],u=t.parentNode;t.parentNode.replaceChild(o,t);if(_V_.isIE()){var a=u.childNodes[0];setTimeout(function(){a.style.display="block"},1e3)}return o},_V_.flash.getEmbedCode=function(e,t,n,r){var i='<object type="application/x-shockwave-flash"',s="",o="";return attrsString="",t&&_V_.eachProp(t,function(e,t){s+=e+"="+t+"&amp;"}),n=_V_.merge({movie:e,flashvars:s,allowScriptAccess:"always",allowNetworking:"all"},n),_V_.eachProp(n,function(e,t){o+='<param name="'+e+'" value="'+t+'" />'}),r=_V_.merge({data:e,width:"100%",height:"100%"},r),_V_.eachProp(r,function(e,t){attrsString+=e+'="'+t+'" '}),i+attrsString+">"+o+"</object>"},_V_.merge(_V_.Player.prototype,{addTextTracks:function(e){var t=this.textTracks=this.textTracks?this.textTracks:[],n=0,r=e.length,i,s;for(;n<r;n++)s=_V_.uc(e[n].kind||"subtitles"),i=new _V_[s+"Track"](this,e[n]),t.push(i),i["default"]&&this.ready(_V_.proxy(i,i.show));return this},showTextTrack:function(e,t){var n=this.textTracks,r=0,i=n.length,s,o,u;for(;r<i;r++)s=n[r],s.id===e?(s.show(),o=s):t&&s.kind==t&&s.mode>0&&s.disable();return u=o?o.kind:t?t:!1,u&&this.triggerEvent(u+"trackchange"),this}}),_V_.Track=_V_.Component.extend({init:function(e,t){this._super(e,t),_V_.merge(this,{id:t.id||"vjs_"+t.kind+"_"+t.language+"_"+_V_.guid++,src:t.src,"default":t["default"],title:t.title,language:t.srclang,label:t.label,cues:[],activeCues:[],readyState:0,mode:0})},createElement:function(){return this._super("div",{className:"vjs-"+this.kind+" vjs-text-track"})},show:function(){this.activate(),this.mode=2,this._super()},hide:function(){this.activate(),this.mode=1,this._super()},disable:function(){this.mode==2&&this.hide(),this.deactivate(),this.mode=0},activate:function(){this.readyState==0&&this.load(),this.mode==0&&(this.player.addEvent("timeupdate",this.proxy(this.update,this.id)),this.player.addEvent("ended",this.proxy(this.reset,this.id)),(this.kind=="captions"||this.kind=="subtitles")&&this.player.textTrackDisplay.addComponent(this))},deactivate:function(){this.player.removeEvent("timeupdate",this.proxy(this.update,this.id)),this.player.removeEvent("ended",this.proxy(this.reset,this.id)),this.reset(),this.player.textTrackDisplay.removeComponent(this)},load:function(){this.readyState==0&&(this.readyState=1,_V_.get(this.src,this.proxy(this.parseCues),this.proxy(this.onError)))},onError:function(e){this.error=e,this.readyState=3,this.triggerEvent("error")},parseCues:function(e){var t,n,r,i=e.split("\n"),s="",o;for(var u=1,a=i.length;u<a;u++){s=_V_.trim(i[u]);if(s){s.indexOf("-->")==-1?(o=s,s=_V_.trim(i[++u])):o=this.cues.length,t={id:o,index:this.cues.length},n=s.split(" --> "),t.startTime=this.parseCueTime(n[0]),t.endTime=this.parseCueTime(n[1]),r=[];while(i[++u]&&(s=_V_.trim(i[u])))r.push(s);t.text=r.join("<br/>"),this.cues.push(t)}}this.readyState=2,this.triggerEvent("loaded")},parseCueTime:function(e){var t=e.split(":"),n=0,r,i,s,o,u,a;return t.length==3?(r=t[0],i=t[1],s=t[2]):(r=0,i=t[0],s=t[1]),s=s.split(/\s+/),o=s.splice(0,1)[0],o=o.split(/\.|,/),u=parseFloat(o[1]),o=o[0],n+=parseFloat(r)*3600,n+=parseFloat(i)*60,n+=parseFloat(o),u&&(n+=u/1e3),n},update:function(){if(this.cues.length>0){var e=this.player.currentTime();if(this.prevChange===undefined||e<this.prevChange||this.nextChange<=e){var t=this.cues,n=this.player.duration(),r=0,i=!1,s=[],o,u,a="",f,l,c;e>=this.nextChange||this.nextChange===undefined?l=this.firstActiveIndex!==undefined?this.firstActiveIndex:0:(i=!0,l=this.lastActiveIndex!==undefined?this.lastActiveIndex:t.length-1);for(;;){f=t[l];if(f.endTime<=e)r=Math.max(r,f.endTime),f.active&&(f.active=!1);else if(e<f.startTime){n=Math.min(n,f.startTime),f.active&&(f.active=!1);if(!i)break}else i?(s.splice(0,0,f),u===undefined&&(u=l),o=l):(s.push(f),o===undefined&&(o=l),u=l),n=Math.min(n,f.endTime),r=Math.max(r,f.startTime),f.active=!0;if(i){if(l===0)break;l--}else{if(l===t.length-1)break;l++}}this.activeCues=s,this.nextChange=n,this.prevChange=r,this.firstActiveIndex=o,this.lastActiveIndex=u,this.updateDisplay(),this.triggerEvent("cuechange")}}},updateDisplay:function(){var e=this.activeCues,t="",n=0,r=e.length;for(;n<r;n++)t+="<span class='vjs-tt-cue'>"+e[n].text+"</span>";this.el.innerHTML=t},reset:function(){this.nextChange=0,this.prevChange=this.player.duration(),this.firstActiveIndex=0,this.lastActiveIndex=0}}),_V_.CaptionsTrack=_V_.Track.extend({kind:"captions"}),_V_.SubtitlesTrack=_V_.Track.extend({kind:"subtitles"}),_V_.ChaptersTrack=_V_.Track.extend({kind:"chapters"}),_V_.TextTrackDisplay=_V_.Component.extend({createElement:function(){return this._super("div",{className:"vjs-text-track-display"})}}),_V_.TextTrackMenuItem=_V_.MenuItem.extend({init:function(e,t){var n=this.track=t.track;t.label=n.label,t.selected=n["default"],this._super(e,t),this.player.addEvent(n.kind+"trackchange",_V_.proxy(this,this.update))},onClick:function(){this._super(),this.player.showTextTrack(this.track.id,this.track.kind)},update:function(){this.track.mode==2?this.selected(!0):this.selected(!1)}}),_V_.OffTextTrackMenuItem=_V_.TextTrackMenuItem.extend({init:function(e,t){t.track={kind:t.kind,player:e,label:"Off"},this._super(e,t)},onClick:function(){this._super(),this.player.showTextTrack(this.track.id,this.track.kind)},update:function(){var e=this.player.textTracks,t=0,n=e.length,r,i=!0;for(;t<n;t++)r=e[t],r.kind==this.track.kind&&r.mode==2&&(i=!1);i?this.selected(!0):this.selected(!1)}}),_V_.TextTrackButton=_V_.Button.extend({init:function(e,t){this._super(e,t),this.menu=this.createMenu(),this.items.length===0&&this.hide()},createMenu:function(){var e=new _V_.Menu(this.player);return e.el.appendChild(_V_.createElement("li",{className:"vjs-menu-title",innerHTML:_V_.uc(this.kind)})),e.addItem(new _V_.OffTextTrackMenuItem(this.player,{kind:this.kind})),this.items=this.createItems(),this.each(this.items,function(t){e.addItem(t)}),this.addComponent(e),e},createItems:function(){var e=[];return this.each(this.player.textTracks,function(t){t.kind===this.kind&&e.push(new _V_.TextTrackMenuItem(this.player,{track:t}))}),e},buildCSSClass:function(){return this.className+" vjs-menu-button "+this._super()},onFocus:function(){this.menu.lockShowing(),_V_.one(this.menu.el.childNodes[this.menu.el.childNodes.length-1],"blur",this.proxy(function(){this.menu.unlockShowing()}))},onBlur:function(){},onClick:function(){this.one("mouseout",this.proxy(function(){this.menu.unlockShowing(),this.el.blur()}))}}),_V_.CaptionsButton=_V_.TextTrackButton.extend({kind:"captions",buttonText:"Captions",className:"vjs-captions-button"}),_V_.SubtitlesButton=_V_.TextTrackButton.extend({kind:"subtitles",buttonText:"Subtitles",className:"vjs-subtitles-button"}),_V_.ChaptersButton=_V_.TextTrackButton.extend({kind:"chapters",buttonText:"Chapters",className:"vjs-chapters-button",createItems:function(e){var t=[];return this.each(this.player.textTracks,function(e){e.kind===this.kind&&t.push(new _V_.TextTrackMenuItem(this.player,{track:e}))}),t},createMenu:function(){var e=this.player.textTracks,t=0,n=e.length,r,i,s=this.items=[];for(;t<n;t++){r=e[t];if(r.kind==this.kind&&r["default"]){if(r.readyState<2){this.chaptersTrack=r,r.addEvent("loaded",this.proxy(this.createMenu));return}i=r;break}}var o=this.menu=new _V_.Menu(this.player);o.el.appendChild(_V_.createElement("li",{className:"vjs-menu-title",innerHTML:_V_.uc(this.kind)}));if(i){var u=i.cues,t=0,n=u.length,a,f;for(;t<n;t++)a=u[t],f=new _V_.ChaptersTrackMenuItem(this.player,{track:i,cue:a}),s.push(f),o.addComponent(f)}return this.addComponent(o),this.items.length>0&&this.show(),o}}),_V_.ChaptersTrackMenuItem=_V_.MenuItem.extend({init:function(e,t){var n=this.track=t.track,r=this.cue=t.cue,i=e.currentTime();t.label=r.text,t.selected=r.startTime<=i&&i<r.endTime,this._super(e,t),n.addEvent("cuechange",_V_.proxy(this,this.update))},onClick:function(){this._super(),this.player.currentTime(this.cue.startTime),this.update(this.cue.startTime)},update:function(e){var t=this.cue,n=this.player.currentTime();t.startTime<=n&&n<t.endTime?this.selected(!0):this.selected(!1)}}),_V_.merge(_V_.ControlBar.prototype.options.components,{subtitlesButton:{},captionsButton:{},chaptersButton:{}}),_V_.autoSetup=function(){var e,t,n,r=document.getElementsByTagName("video");if(r&&r.length>0)for(var i=0,s=r.length;i<s;i++){t=r[i];if(!t||!t.getAttribute){_V_.autoSetupTimeout(1);break}t.player===undefined&&(e=t.getAttribute("data-setup"),e!==null&&(e=JSON.parse(e||"{}"),n=_V_(t,e)))}else _V_.windowLoaded||_V_.autoSetupTimeout(1)},_V_.autoSetupTimeout=function(e){setTimeout(_V_.autoSetup,e)},_V_.addEvent(window,"load",function(){_V_.windowLoaded=!0}),_V_.autoSetup(),window.VideoJS=window._V_=VideoJS}(window),define("videojs",function(){});var buzz={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(e,t){function o(e){var t=[],n=e.length-1;for(var r=0;r<=n;r++)t.push({start:e.start(n),end:e.end(n)});return t}function u(e){return e.split(".").pop()}function a(e,t){var n=document.createElement("source");n.src=t,buzz.types[u(t)]&&(n.type=buzz.types[u(t)]),e.appendChild(n)}t=t||{};var n=0,r=[],i={},s=buzz.isSupported();this.load=function(){return s?(this.sound.load(),this):this},this.play=function(){return s?(this.sound.play(),this):this},this.togglePlay=function(){return s?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return s?(this.sound.pause(),this):this},this.isPaused=function(){return s?this.sound.paused:null},this.stop=function(){return s?(this.setTime(0),this.sound.pause(),this):this},this.isEnded=function(){return s?this.sound.ended:null},this.loop=function(){return s?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return s?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return s?(this.sound.muted=!0,this):this},this.unmute=function(){return s?(this.sound.muted=!1,this):this},this.toggleMute=function(){return s?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return s?this.sound.muted:null},this.setVolume=function(e){return s?(e<0&&(e=0),e>100&&(e=100),this.volume=e,this.sound.volume=e/100,this):this},this.getVolume=function(){return s?this.volume:this},this.increaseVolume=function(e){return this.setVolume(this.volume+(e||1))},this.decreaseVolume=function(e){return this.setVolume(this.volume-(e||1))},this.setTime=function(e){return s?(this.whenReady(function(){this.sound.currentTime=e}),this):this},this.getTime=function(){if(!s)return null;var e=Math.round(this.sound.currentTime*100)/100;return isNaN(e)?buzz.defaults.placeholder:e},this.setPercent=function(e){return s?this.setTime(buzz.fromPercent(e,this.sound.duration)):this},this.getPercent=function(){if(!s)return null;var e=Math.round(buzz.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(e)?buzz.defaults.placeholder:e},this.setSpeed=function(e){if(!s)return this;this.sound.playbackRate=e},this.getSpeed=function(){return s?this.sound.playbackRate:null},this.getDuration=function(){if(!s)return null;var e=Math.round(this.sound.duration*100)/100;return isNaN(e)?buzz.defaults.placeholder:e},this.getPlayed=function(){return s?o(this.sound.played):null},this.getBuffered=function(){return s?o(this.sound.buffered):null},this.getSeekable=function(){return s?o(this.sound.seekable):null},this.getErrorCode=function(){return s&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!s)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return s?this.sound.readyState:null},this.getStateMessage=function(){if(!s)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return s?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!s)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(e,t){return s?(this.sound[e]=t,this):this},this.get=function(e){return s?e?this.sound[e]:this.sound:null},this.bind=function(e,t){if(!s)return this;e=e.split(" ");var n=this,i=function(e){t.call(n,e)};for(var o=0;o<e.length;o++){var u=e[o],a=u;u=a.split(".")[0],r.push({idx:a,func:i}),this.sound.addEventListener(u,i,!0)}return this},this.unbind=function(e){if(!s)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t],i=n.split(".")[0];for(var o=0;o<r.length;o++){var u=r[o].idx.split(".");if(r[o].idx==n||u[1]&&u[1]==n.replace(".",""))this.sound.removeEventListener(i,r[o].func,!0),r.splice(o,1)}}return this},this.bindOnce=function(e,t){if(!s)return this;var r=this;i[n++]=!1,this.bind(e+"."+n,function(){i[n]||(i[n]=!0,t.call(r)),r.unbind(e+"."+n)})},this.trigger=function(e){if(!s)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t];for(var i=0;i<r.length;i++){var o=r[i].idx.split(".");if(r[i].idx==n||o[0]&&o[0]==n.replace(".","")){var u=document.createEvent("HTMLEvents");u.initEvent(o[0],!1,!0),this.sound.dispatchEvent(u)}}}return this},this.fadeTo=function(e,t,n){function u(){setTimeout(function(){r<e&&o.volume<e?(o.setVolume(o.volume+=1),u()):r>e&&o.volume>e?(o.setVolume(o.volume-=1),u()):n instanceof Function&&n.apply(o)},i)}if(!s)return this;t instanceof Function?(n=t,t=buzz.defaults.duration):t=t||buzz.defaults.duration;var r=this.volume,i=t/Math.abs(r-e),o=this;return this.play(),this.whenReady(function(){u()}),this},this.fadeIn=function(e,t){return s?this.setVolume(0).fadeTo(100,e,t):this},this.fadeOut=function(e,t){return s?this.fadeTo(0,e,t):this},this.fadeWith=function(e,t){return s?(this.fadeOut(t,function(){this.stop()}),e.play().fadeIn(t),this):this},this.whenReady=function(e){if(!s)return null;var t=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){e.call(t)}):e.call(t)};if(s&&e){for(var f in buzz.defaults)buzz.defaults.hasOwnProperty(f)&&(t[f]=t[f]||buzz.defaults[f]);this.sound=document.createElement("audio");if(e instanceof Array)for(var l in e)e.hasOwnProperty(l)&&a(this.sound,e[l]);else if(t.formats.length)for(var c in t.formats)t.formats.hasOwnProperty(c)&&a(this.sound,e+"."+t.formats[c]);else a(this.sound,e);t.loop&&this.loop(),t.autoplay&&(this.sound.autoplay="autoplay"),t.preload===!0?this.sound.preload="auto":t.preload===!1?this.sound.preload="none":this.sound.preload=t.preload,this.setVolume(t.volume),buzz.sounds.push(this)}},group:function(e){function t(){var t=n(null,arguments),r=t.shift();for(var i=0;i<e.length;i++)e[i][r].apply(e[i],t)}function n(e,t){return e instanceof Array?e:Array.prototype.slice.call(t)}e=n(e,arguments),this.getSounds=function(){return e},this.add=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)e.push(t[r])},this.remove=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(e[i]==t[r]){e.splice(i,1);break}},this.load=function(){return t("load"),this},this.play=function(){return t("play"),this},this.togglePlay=function(){return t("togglePlay"),this},this.pause=function(e){return t("pause",e),this},this.stop=function(){return t("stop"),this},this.mute=function(){return t("mute"),this},this.unmute=function(){return t("unmute"),this},this.toggleMute=function(){return t("toggleMute"),this},this.setVolume=function(e){return t("setVolume",e),this},this.increaseVolume=function(e){return t("increaseVolume",e),this},this.decreaseVolume=function(e){return t("decreaseVolume",e),this},this.loop=function(){return t("loop"),this},this.unloop=function(){return t("unloop"),this},this.setTime=function(e){return t("setTime",e),this},this.set=function(e,n){return t("set",e,n),this},this.bind=function(e,n){return t("bind",e,n),this},this.unbind=function(e){return t("unbind",e),this},this.bindOnce=function(e,n){return t("bindOnce",e,n),this},this.trigger=function(e){return t("trigger",e),this},this.fade=function(e,n,r,i){return t("fade",e,n,r,i),this},this.fadeIn=function(e,n){return t("fadeIn",e,n),this},this.fadeOut=function(e,n){return t("fadeOut",e,n),this}},all:function(){return new buzz.group(buzz.sounds)},isSupported:function(){return!!buzz.el.canPlayType},isOGGSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!buzz.el.canPlayType&&(buzz.el.canPlayType("audio/x-m4a;")||buzz.el.canPlayType("audio/aac;"))},toTimer:function(e,t){var n,r,i;return n=Math.floor(e/3600),n=isNaN(n)?"--":n>=10?n:"0"+n,r=t?Math.floor(e/60%60):Math.floor(e/60),r=isNaN(r)?"--":r>=10?r:"0"+r,i=Math.floor(e%60),i=isNaN(i)?"--":i>=10?i:"0"+i,t?n+":"+r+":"+i:r+":"+i},fromTimer:function(e){var t=e.toString().split(":");return t&&t.length==3&&(e=parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseInt(t[2],10)),t&&t.length==2&&(e=parseInt(t[0],10)*60+parseInt(t[1],10)),e},toPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(e*100/t*r)/r},fromPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(t/100*e*r)/r}};define("buzz",function(){}),define("text!interaction_view/template/animateitem_view.js",[],function(){return'<div class="iView dynamic hide" data-type="<%=iType%>" id="<%=id%>" style="position: absolute; width: 1px; height: 1px; background-color:transparent;backgroud-repeat:no-repeat;background-postion:center;">\n	<%if(iType=="RichText"){%>\n					<div class="iText nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">\n						<%=iDetail.iText%>\n					</div>		\n	<%}%>\n	<%if(iType==\'Image\'){%>\n		<div class="iImage Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">\n			<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n				<img class="Context" src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:100%;">\n			<%}%>\n		</div>\n	<%}%>\n	<%if(iType==\'Slide\'){%>\n		<div class="iSlide Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">\n			<div class="slidecontent" style="position:absolute;width:100%;height:100%;">\n				<%if(iDetail.iImg){%>\n					<%_.each(iDetail.iImg,function(i){%>\n						<img class="Context hide" src="<%=i.picture%>" style="width:100%;height:100%;position:absolute;">\n					<%})%>\n				<%}%>\n			</div>\n		</div>\n	<%}%>\n	<%if(iType==\'CycleImage\'){%>\n		<div class="iCycleImage Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">\n			<div class="CycleImagecontent" style="position:absolute;width:100%;height:100%;">\n				<%if(iDetail.iImg){%>\n					<%_.each(iDetail.iImg,function(i){%>\n						<img class="Context" src="<%=i.picture%>" style="opacity:0;width:100%;height:100%;position:absolute;">\n					<%})%>\n				<%}%>\n			</div>\n		</div>\n	<%}%>\n	<%if(iType==\'Video\'){%>\n		<div class="iVideo Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">\n			<%if(iDetail.iFile&&iDetail.iFile[0]){%>\n			<video id="Video_<%=id%>" class="video-js vjs-default-skin" style="position:absolute;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;" preload="auto">\n			  <source src="<%=iDetail.iFile[0].file||iDetail.iFile[0].content%>" type="video/x-m4v" />\n			</video>\n			<%}%>\n		</div>\n	<%}%>\n</div>'}),define("text!interaction_view/template/message.js",[],function(){return'<div class="status <%=type%>">\n<p><%=msg%></p>\n<a href="#" class="close">Close</a>\n</div>'}),define("interaction_view/model/base",["jquery","backbone","greensock/TweenMax","videojs","buzz","text!interaction_view/template/animateitem_view.js","text!interaction_view/template/message.js"],function(){var AnimateElementTemplate=require("text!interaction_view/template/animateitem_view.js"),MessageTemplate=require("text!interaction_view/template/message.js");window.interaction_view={model:{Base:Backbone.Model.extend({defaults:{iType:"iBasetype",iLock:!0,iVisibility:!0,iCommon:null,iDetail:null,iOptions:{iParent:null,iParentModel:null,iDraggable:!0,iResizable:!0,template:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iKeyscontrol:!0},iPage:null,iParent:"",iParentModel:null,iDraggable:!0,iResizable:!0,template:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iAutofocus:!1,iKeyscontrol:!0,iUrl:null,callback:null,iBackground:"",iResources:null,iResourcesType:null,iResourcesProperties:null},options:{createwait:!0},initialize:function(){this.options=this.get("iOptions");if(!this.id){this.beforecreate();var e=this;this.get("iAutoindex")?(this.set("id",this.get("iType")+"_"+this.cid+(new Date).getTime()),this.setcollection(),this.setmodel()):(this.options.createwait&&jqwait_simple(),this.savemodel(function(t){e.set("id",t.ID.toString()),e.setcollection(),e.setmodel()}))}else this.setcollection(),this.setmodel()},beforecreate:function(){},savemodel:function(callback){this.save({},{wait:!0,success:function(model,response){returned=eval(response),returned.Status=="Success"?(jqwait_simple_close(),callback&&callback(returned)):model_error({method:"create",status:returned.Status,msg:returned.Message,model:model})},error:function(){model_error({method:"create",status:"ServerError",msg:"server error or server is not available now,please try again!",model:model})}})},setmodel:function(){this.page=interaction_view.ipagelist.get(this.get("pageid")),this.setlist(),this.setview(),this.setsyncmodel()},setlist:function(){},setresourcesmodel:function(){},validate:function(e){},setsyncmodel:function(){},setcollection:function(){},setview:function(){},url:function(){},sync:function(e,t,n){}})},collection:{Base:Backbone.Collection.extend({iSync:!1,initialize:function(){this.setonadd(),this.setonremove()},setonadd:function(){},setonremove:function(){},url:"",sync:function(e,t,n){},parse:function(e){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),list:Backbone.Collection.extend({iSync:!0,url:"",setonadd:function(){this.on("add",function(e){})},setonremove:function(){},sync:function(e,t,n){e=="read"&&(n.url=context_url+"/overlayinit.json"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)},parse:function(e){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})}})},view:{Base:Backbone.View.extend({initialize:function(e){_.bindAll(this),this.model.bind("destroy",this.destroy),this.model.bind("change",this.change),this.initstart()},initstart:function(){this.preload(),this.renderDynamicElement(),this.render()},events:{},options:{},change:function(e){},renderStaticElement:function(){},renderDynamicElement:function(){this.model.get("pageid")?this.container=$('.Presentation[id="'+this.model.get("pageid")+'"]').find(".interaction-view"):this.container=$(".interaction-view"),this.container.append(_.template(AnimateElementTemplate,this.model.toJSON())),this.setElement(this.container.find('div.iView.dynamic[id="'+this.model.id+'"]'));var e=this.getcommon();this.x=e.iStartx+e.iWidth/2,this.y=e.iStarty+e.iHeight/2,TweenMax.to(this.$el[0],0,{x:e.iStartx+e.iWidth/2,y:e.iStarty+e.iHeight/2})},preload:function(){},afterpreload:function(){this.setZindex(),this.setElementDisplay()},setElementDisplay:function(){this.$el.length>0,this.$el.find(".Element").length>0&&TweenMax.to(this.$el.find(".Element")[0],0,{scale:1});var e=this.model.toJSON().iDetail.iHidden||!1,t=this.model.page.iAnimationlist.where({overlay_id:this.model.id});if(t&&t[0]&&_.include([101,102,103],t[0].toJSON().iType)){var n=-9999,r=-9999;t[0]._animation&&t[0]._animation.css&&(n=t[0]._animation.css.x,r=t[0]._animation.css.y),t[0].toJSON().iType==101&&TweenMax.to(this.$el[0],0,{x:n,y:r}),t[0].toJSON().iType==102&&TweenMax.to(this.$el.find(".Element")[0],0,{scale:0}),t[0].toJSON().iType==103&&TweenMax.to(this.$el[0],0,{opacity:0})}else e||this.$el.removeClass("hide");this.Clone=this.$el.clone()},setZindex:function(){this.$el&&this.$el.css("z-index",this.model.page.iViewlist.indexOf(this.model))},render:function(){var e=this.model.toJSON(),t=interaction.template.element(this.model.toJSON()),n=interaction.template.element(this.model.toJSON());return $(this.model.get("iParentdiv")).append(n),this.setElement(div_find(this.model.id)),this.updatebackground(),this.infoel=$("#info_attributes").children(".setting-body"),this},renderCentrolPos:function(e){document.getElementById(this.model.id).style.left=e.x-100+"px",document.getElementById(this.model.id).style.top=e.x-100+"px"},destroy:function(e,t){},updateposition:function(){var e=this.getcommon();e&&(this.$el.css("left",e.iStartx+"px"),this.$el.css("top",e.iStarty+"px"),this.$el.width(e.iWidth),this.$el.height(e.iHeight))},updateel:function(){this.model.get("iTemplate")&&this.$el.html(this.model.get("iTemplate")(this.model.toJSON()))},getcommon:function(){var e=null,t=this.model.toJSON();return this.model.get("iCommon")&&(e=t.iCommon[iPageDirection]),e},getdetail:function(){var e=this.model.toJSON();return e.iDetail},getCentralPos:function(){var e={},t=this.getcommon();return e.x=t.iStartx+t.iWidth/2,e.y=t.iStarty+t.iHeight/2,e},getCommonByCentralPos:function(e){var t=this.getcommon();return t.iStartx=e.x-t.iWidth/2,t.iStarty=e.y-t.iHight/2,t},getAnimation:function(){var e=this.getdetail(),t=e.animations;return t},setcommon:function(e){var t=this.model.toJSON(),n=t.iCommon;!_.isNaN(e.iStartx)&&!_.isNaN(e.iStarty)&&!_.isNaN(e.iWidth)&&!_.isNaN(e.iHeight)&&(n[iPageDirection]=e),this.model.set("iCommon",n)},setdetail:function(e){var t=this.model.toJSON(),n=t.iDetail;_.each(_.keys(e),function(t){n[t]=e[t]}),this.model.set("iDetail",n),this.updateinfo(),this.updatebackground(),this.updateresources()},settext:function(){var e=tinyMCE.getInstanceById("tEditor_"+this.model.id).getBody().innerHTML;this.setdetail({iText:e}),tinyMCE.getInstanceById("tEditor_"+this.model.id)&&(tinyMCE.execCommand("mceFocus",!1,"tEditor_"+this.model.id),tinyMCE.execCommand("mceRemoveControl",!1,"tEditor_"+this.model.id))},setCentralPos:function(e){var t=this.getcommon();t.iStartx=e.x-t.iWidth/2,t.iStarty=e.y-t.iHight/2,this.setcommon(t)},renderpath:function(){var e=this,t=this.model,n=this.getdetail(),r=this.getcommon();e.path=new paper.Path,e.path.strokeColor="black",e.path.visible=!0,e.path.selected=!0,$("canvas").removeClass("hide");var i=n.animations;console.info(n.animations[0].iDetail.path),_.each(i[0].iDetail.path,function(t){e.path.add(t)}),e.currentFrame=0,e.countTime=0},showdiv:function(){this.$el.removeClass("hide"),this.model.set("iVisibility",!0)},hidediv:function(){this.$el.addClass("hide"),this.model.set("iVisibility",!1)},resetStatus:function(){if(this.model.get("iType")=="Video")return;this.$el.remove(),this.renderDynamicElement(),this.afterpreload()},resetVideoStatus:function(){this.$el.remove(),this.renderDynamicElement(),this.afterpreload(),this.loadagain()},loadagain:function(){var e=this.model,t=String((new Date).getTime());$("#Video_"+this.model.id).attr("id","Video_"+t+this.model.id),_V_("Video_"+t+this.model.id).ready(function(){console.info("Video init"),e.media=this,e.media.size(e.iview.$el.find(".Element").width(),e.iview.$el.find(".Element").height()),e.videoloaded=!1;var t=function(t){e.videoloaded=!0},n=function(t){e.videoloaded=!0,e.media.removeEvent("loadedmetadata",n),console.info("video loaded"),e.loaded=!0};e.media.addEvent("loadedmetadata",n),e.media.addEvent("error",function(t){e.loaded=!1})})}})}},window.iViewlist=new interaction_view.collection.Base,interaction_view.iViewlist=new interaction_view.collection.list,interaction_view.currentPage=null}),define("interaction_view/ui/animation",["jquery","backbone"],function(){window.animation=function(e){this.defaults={countTime:0,currentFrame:0,path:null,raster:null,animation:null},this.options=e,this.options=$.extend(!0,{},this.defaults,typeof e=="object"&&e),this.page=interaction_view.ipagelist.get(this.options.collection.pageid),this.init()},window.animation.prototype={init:function(){_.bindAll(this),this.setparam()},cssTovalue:function(e){var t=e;return t=Number(e.split("px")[0]),t},EaseTypes:{0:"Linear.easeNone",1:"Power0.easeIn",2:"Power0.easeInOut",3:"Power0.easeOut",4:"Power1.easeIn",5:"Power1.easeInOut",6:"Power1.easeOut",7:"Power2.easeIn",8:"Power2.easeInOut",9:"Power2.easeOut",10:"Power3.easeIn",11:"Power3.easeInOut",12:"Power3.easeOut",13:"Power4.easeIn",14:"Power4.easeInOut",15:"Power4.easeOut",16:"Quad.easeIn",17:"Quad.easeInOut",18:"Quad.easeOut",19:"Cubic.easeIn",20:"Cubic.easeInOut",21:"Cubic.easeOut",22:"Quart.easeIn",23:"Quart.easeInOut",24:"Quart.easeOut",25:"Quint.easeIn",26:"Quint.easeInOut",27:"Quint.easeOut",28:"Strong.easeIn",29:"Strong.easeInOut",30:"Strong.easeOut",31:"Back.easeIn",32:"Back.easeInOut",33:"Back.easeOut",34:"Bounce.easeIn",35:"Bounce.easeInOut",36:"Bounce.easeOut",37:"Circ.easeIn",38:"Circ.easeInOut",39:"Circ.easeOut",40:"Elastic.easeIn",41:"Elastic.easeInOut",42:"Elastic.easeOut",43:"Expo.easeIn",44:"Expo.easeInOut",45:"Expo.easeOut",46:"Sine.easeIn",47:"Sine.easeInOut",48:"Sine.easeOut",49:"SlowMo.ease"},getTypeName:function(e){switch(e){case 100:return"出现动画";case 101:return"飞入";case 102:return"放大";case 103:return"渐现";case 200:return"消失动画";case 201:return"飞出";case 202:return"缩小";case 203:return"渐隐";case 300:return"运动路径";case 301:return"直线运动";case 302:return"曲线运动";case 400:return"强调动画";case 401:return"放大缩小";case 402:return"透明";case 403:return"旋转";case 500:return"媒体动画";case 501:return"播放";case 502:return"暂停";case 503:return"结束"}},play:function(){var e=this.page.iViewlist.get(this.options.animation.overlay_id);this.overlay_type=e.get("iType"),this.overlay_type=="Audio"?this.playmedia(this.options.animation.iType):_.include([501,502,503],this.options.animation.iType)?(console.info(this.options.animation.iType),this.playmedia(this.options.animation.iType)):_.include([101,102,103],this.options.animation.iType)?(console.info(this.param),this.tween=TweenMax.from(this.obj,this.options.animation.iTiming.duration,this.param)):this.tween=TweenMax.to(this.obj,this.options.animation.iTiming.duration,this.param)},playmedia:function(e){var t=this.page.iViewlist.get(this.options.animation.overlay_id);e==501&&t.loaded&&(t.get("iType")=="Audio"&&t.media&&console.log(t.media.getDuration()),t.get("iType")=="Video"&&t.iview.$el.removeClass("hide"),t.media.play()),e==502&&t.loaded&&t.media.pause(),e==503&&t.loaded&&(t.get("iType")=="Video"?(t.iview.$el.addClass("hide"),t.media.pause()):t.media.stop()),this.options.collection.onComplete(this.options.animation.id)},setpathparam:function(e){var t=this;this.pathoriginalpoint={},this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0];var n=this.options.animation.iDetail.autoRotate||!1;if(n){var r=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element")[0];this.param.onStart=function(){}}if(e==302){var s=[];_.each(this.options.animation.iDetail.path,function(e){if(e.handleIn){var t={};t.x=e.handleIn.x+e.point.x,t.y=e.handleIn.y+e.point.y,s.push(t)}s.push({x:e.point.x,y:e.point.y});if(e.handleOut){var n={};n.x=e.handleOut.x+e.point.x,n.y=e.handleOut.y+e.point.y,s.push(n)}}),this.param.bezier={values:s,type:"cubic",autoRotate:n}}if(e==301){var s=[];for(i in this.options.animation.iDetail.path){if(i!=0){var o=this.options.animation.iDetail.path[i-1],u=this.options.animation.iDetail.path[i],a={x:(o.point.x+u.point.x)/2,y:(o.point.y+u.point.y)/2};s.push(a)}s.push({x:this.options.animation.iDetail.path[i].point.x,y:this.options.animation.iDetail.path[i].point.y})}this.param.bezier={values:s,type:"quadratic",autoRotate:n}}},setappearparam:function(e){this.fromparam={},this.fromparam.onStart=this.showelement,this.fromparam.immediateRender=!1,this.toparam={},this.toparam.onComplete=this.param.onComplete,this.toparam.delay=this.param.delay,this.toparam.repeat=this.param.repeat,this.toparam.ease=this.param.ease;if(e==101){var t=this.options.animation.iDetail.direction||0,n=this.page.iViewlist.get(this.options.animation.overlay_id).iview.x,r=this.page.iViewlist.get(this.options.animation.overlay_id).iview.y,i=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element").width()*2,s=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element").height()*2,o={};switch(t){case 0:o.y="-"+s,o.x=n;break;case 1:o.x=1024+i,o.y=r;break;case 2:o.y=768+s,o.x=n;break;case 3:o.x="-"+i,o.y=r}this.param.css=o,this.fromparam.css={x:Number(o.x),y:Number(o.y)},this.toparam.css={x:Number(n),y:Number(r)},this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0]}if(e==102){var t=this.options.animation.iDetail.direction||0,u={},o={},a=this.page.iViewlist.get(this.options.animation.overlay_id);u.scale=0,this.param.css=u,this.fromparam.css={scale:0},this.toparam.css={scale:1},this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element")[0]}if(e==103){var t=this.options.animation.iDetail.direction||0,u={};this.param.css={opacity:0},this.fromparam.css={opacity:0},this.toparam.css={opacity:1},this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0]}},setdisappearparam:function(e){if(e==201){var t=this.options.animation.iDetail.direction||0;this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0];var n=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element").width()*2,r=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element").height()*2,i={};switch(t){case 0:i.y="-"+r;break;case 1:i.x=1024+n;break;case 2:i.y=768+r;break;case 3:i.x="-"+n}this.param.css=i}if(e==202){var s=this.page.iViewlist.get(this.options.animation.overlay_id),i={};i.scale=0,this.param.css=i,this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element")[0]}e==203&&(this.param.css={opacity:0},this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0]),this.param.onComplete=this.hideelement},setstrongparam:function(e){if(e==401){var t=this.page.iViewlist.get(this.options.animation.overlay_id),n={};this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.find(".Element")[0],n.scale=this.options.animation.iDetail.scale||2,this.param.css=n}if(e==402){this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0];var r=this.options.animation.iDetail.opacity||0;this.param.css={opacity:r}}if(e==403){this.obj=this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el[0];var i=this.options.animation.iDetail.rotation||180,s=this.options.animation.iDetail.axial||0,o="_cw",u="+";i<0&&(o="_ccw"),i<0&&(u="-");var n={};s==0&&(n.rotation=u+"="+Math.abs(i)+o),s==1&&(n.rotationX=u+"="+Math.abs(i)+o),s==2&&(n.rotationY=u+"="+Math.abs(i)+o),this.param.css=n}},setparam:function(){var e=this;this.param={},this.param.data=this.options.animation;var t=this.page.iViewlist.get(this.options.animation.overlay_id);this.param.onComplete=this.stop,this.param.onCompleteParams=["{self}"],this.param.ease=this.EaseTypes[this.options.animation.iTiming.ease||0];var n=this.options.animation.iTiming.repeat||0;n==0||n==-1?this.param.repeat=n:n==-2?this.param.repeat=-1:this.param.repeat=n;switch(this.options.animation.iType){case 100:return"出现动画";case 101:this.setappearparam(101);break;case 102:this.setappearparam(102);break;case 103:this.setappearparam(103);break;case 200:return"消失动画";case 201:this.setdisappearparam(201);break;case 202:this.setdisappearparam(202);break;case 203:this.setdisappearparam(203);break;case 300:return"运动路径";case 301:this.setpathparam(301);break;case 302:this.setpathparam(302);break;case 400:return"强调动画";case 401:this.setstrongparam(401);break;case 402:this.setstrongparam(402);break;case 403:this.setstrongparam(403);break;case 500:return"媒体动画";case 501:this.setmedia(501);break;case 502:this.setmedia(502);break;case 503:this.setmedia(503)}},setmedia:function(e){},pathstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&this.options.animation.iTiming.repeat!=-1&&this.options.animation.iTiming.repeat!=-2&&this.options.animation.iDetail.path&&this.options.animation.iDetail.path[0]&&e.pause(0)},animationstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&this.options.animation.iTiming.repeat!=-1&&this.options.animation.iTiming.repeat!=-2&&e.pause(0)},stop:function(e){this.animationstop(e),this.options.collection.onComplete(this.options.animation.id)},forcestop:function(e){var t=this.options.animation.iTiming.rewind||!1;t?e.pause(0):e.pause(this.options.animation.iTiming.duration),this.options.collection.onComplete(this.options.animation.id)},addclickcontrol:function(){this.options.collection.addclickstop(this.options.animation.id)},showelement:function(){console.log("on start show"),this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.removeClass("hide")},hideelement:function(){this.page.iViewlist.get(this.options.animation.overlay_id).iview.$el.addClass("hide")}}}),define("interaction_view/model/action",["interaction_view/model/base","interaction_view/ui/animation"],function(){interaction_view.model.Action=interaction_view.model.Base.extend({defaults:{},setcollection:function(){},setview:function(e){this.page=interaction_view.ipagelist.get(this.get("pageid")),this.iview=new interaction_view.view.Action({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Action=interaction_view.collection.Base.extend({initialize:function(){this.setonadd(),this.setonremove()},model:interaction_view.model.Action,setonadd:function(){this.on("add",function(e){})},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},resetStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),interaction_view.view.Action=interaction_view.view.Base.extend({initstart:function(){},renderanimations:function(){var e=this,t=this.model.toJSON();if(!this.model.page.iViewlist.get(t.overlay_id))return;this.overlaymodel=this.model.page.iViewlist.get(t.overlay_id),this.timeline=new TimelineMax({paused:!0}),this.timeline.addLabel("Start"),this.TotalDuration=0;var n=this.values;n&&(_.each(n,function(t){var r=e.model.page.iAnimationlist.get(t);if(!r)return;var i=r.toJSON(),s=r._animation.obj,o=r._animation.param,u=r.toJSON().iTiming.duration||0,a=r.toJSON().iTiming.repeat||0,f=i.iTiming.delay||0;e.TotalDuration+=f,u=u;var l=n.indexOf(r.id);if(i.iTiming.start==0)e.timeline.addLabel(r+"_start",e.TotalDuration),e.timeline.call(e.model.page.iAnimationlist.AddClickTween,[e],this,e.TotalDuration-f);else if(i.iTiming.start==2)if(l!=0){var c=e.timeline.getLabelTime(n[l-1].id+"_start");e.timeline.addLabel(r.id+"_start",c+f),e.TotalDuration=e.timeline.getLabelTime(r.id+"_start")}else e.timeline.addLabel(r.id+"_start",e.TotalDuration);else e.timeline.addLabel(r.id+"_start",e.TotalDuration);if(_.include([501,502,503],r.get("iType"))){var h=e.model.page.iAnimationlist.getMediaTime(r);r.get("iType")==502||r.get("iType")==503?u=0:u=h,e.timeline.call(e.model.page.iAnimationlist.AddMediaTween,[r],this,e.TotalDuration)}else i.iTiming.repeat!=0?e.timeline.call(e.model.page.iAnimationlist.AddRepeatTween,[r],this,e.TotalDuration):_.include([101,102,103],r.get("iType"))?(console.log(r._animation),e.timeline.add(TweenMax.fromTo(s,u,r._animation.fromparam,r._animation.toparam),e.TotalDuration)):(console.log(r._animation),e.timeline.add(TweenMax.to(s,u,r._animation.param),e.TotalDuration));e.TotalDuration+=u,e.timeline.addLabel(r.id+"_end",e.TotalDuration)}),e.timeline.play(0))},onComplete:function(){},events:{},renderDynamicElement:function(){},render:function(){var e=this.model.toJSON().iDetail;if(!e||!e.results)return;var t=this;this.actiontype=e.results[0].iAction,this.values=e.results[0].values;var n=this.model.toJSON();if(!this.model.page.iViewlist.get(n.overlay_id))return;this.overlaymodel=this.model.page.iViewlist.get(n.overlay_id),this.TotalDuration=0,this.overlaymodel.iview.$el.css("cursor","pointer"),this.overlaymodel.iview.$el.addClass("hasaction"),this.overlaymodel.iview.$el.on("click",function(){t.actiontype==0&&t.renderanimations(),t.actiontype==1&&t.rendershow(),t.actiontype==2&&t.renderhide()})},renderclick:function(){},rendershow:function(){var e=this,t=this.values;t&&_.each(t,function(t){var n=e.model.page.iViewlist.get(t);n&&n.iview&&n.iview.$el&&n.iview.$el.removeClass("hide")})},renderhide:function(){var e=this,t=this.values;t&&_.each(t,function(t){var n=e.model.page.iViewlist.get(t);n&&n.iview&&n.iview.$el&&n.iview.$el.addClass("hide")})},resetStatus:function(){this.overlaymodel.iview.$el.off("click")}}),interaction_view.iActionlist=new interaction_view.collection.Action}),define("interaction_view/model/animation_view",["interaction_view/model/base","interaction_view/ui/animation"],function(){interaction_view.model.Animation=interaction_view.model.Base.extend({defaults:{},setcollection:function(){},setview:function(e){this.iview=new interaction_view.view.Animation({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Animation=interaction_view.collection.Base.extend({initialize:function(){this.setonadd(),this.setonremove()},model:interaction_view.model.Animation,setonadd:function(){this.on("add",function(e){})},setParams:function(e){if(this.length==0)return;var t=this;this.page=interaction_view.ipagelist.get(this.pageid),this.each(function(e){e.tween=null;var n=e.toJSON();if(!t.page.iViewlist.get(n.overlay_id))return;e._animation=new animation({collection:t,animation:e.toJSON()})})},setPlay:function(e){if(this.length==0)return;var t=this,n=function(){};this.timeline=new TimelineMax({paused:!0,onStart:n}),this.timeline.addLabel("Start"),this.TotalDuration=0,this.each(function(e){var n=e.toJSON();if(!t.page.iViewlist.get(n.overlay_id))return;if(n.iTiming.waitaction&&!interaction_view.SinglePreview)return;var r=e._animation.obj,i=e._animation.param,s=e.toJSON().iTiming.duration||0,o=e.toJSON().iTiming.delay||0;t.TotalDuration+=o,s=s;var u=t.indexOf(e);if(n.iTiming.start==0)t.timeline.addLabel(e.id+"_start",t.TotalDuration),t.timeline.call(t.AddClickTween,[t],this,t.TotalDuration-o);else if(n.iTiming.start==2)if(u!=0){var a=t.timeline.getLabelTime(t.at(u-1).id+"_start");t.timeline.addLabel(e.id+"_start",a+o),t.TotalDuration=t.timeline.getLabelTime(e.id+"_start")}else t.timeline.addLabel(e.id+"_start",t.TotalDuration);else t.timeline.addLabel(e.id+"_start",t.TotalDuration);if(_.include([501,502,503],e.get("iType"))){var f=t.getMediaTime(e);e.get("iType")==502||e.get("iType")==503?s=0:s=f,t.timeline.call(t.AddMediaTween,[e],this,t.TotalDuration)}else n.iTiming.repeat!=0?t.timeline.call(t.AddRepeatTween,[e],this,t.TotalDuration):_.include([101,102,103],e.get("iType"))?t.timeline.add(e.tween=TweenMax.fromTo(r,s,e._animation.fromparam,e._animation.toparam),t.TotalDuration):t.timeline.add(e.tween=TweenMax.to(r,s,i),t.TotalDuration);t.TotalDuration+=s,t.timeline.addLabel(e.id+"_end",t.TotalDuration)})},play:function(){if(this.length==0)return;this.setPlay(),this.timeline.play(0)},playMain:function(){if(this.length==0)return;this.setParams(),this.setPlay(),this.timeline.play(0),this.afterTimeLineCreated&&this.afterTimeLineCreated()},AddClickTween:function(e){if(interaction_view.SinglePreview)return;e.timeline.pause(),$(".interaction-view").css("cursor","pointer"),$(".interaction-view").one("click",function(){$(".interaction-view").css("cursor","auto"),e.timeline.resume()})},AddRepeatTween:function(e){var t=e._animation.obj,n=e._animation.param,r=e.toJSON().iTiming.duration||0,i=e.toJSON().iTiming.repeat||0;console.log(n),_.include([101,102,103],e.get("iType"))?e.tween=TweenMax.fromTo(t,r,e._animation.fromparam,e._animation.toparam):e.tween=TweenMax.to(t,r,n),i==-2&&$(".interaction-view").one("click",function(){e._animation.forcestop(e.tween)})},AddMediaTween:function(e){var t=interaction_view.ipagelist.get(e.get("pageid"));if(interaction_view.SinglePreview){var n=t.iAnimationlist.timeline.getLabelTime(interaction_view.PreviewItemId+"_start"),r=t.iAnimationlist.timeline.getLabelTime(e.id+"_start");if(n>r)return}var i=t.iViewlist.get(e.get("overlay_id")),s=e.get("iType");if(s==501&&i.loaded){i.get("iType")=="Audio"&&(console.log(i.media),i.media.isEnded()?i.media.play():i.media.play());if(i.get("iType")=="Video"){i.iview.$el.removeClass("hide");if(i.videoloaded)i.media.play();else{var o=function(e){i.videoloaded=!0,i.media.removeEvent("loadedmetadata",o),i.media.play()};i.media.addEvent("loadedmetadata",o)}}}s==502&&i.loaded&&i.media.pause(),s==503&&i.loaded&&(i.get("iType")=="Video"?(i.iview.$el.addClass("hide"),i.media.pause()):i.media.stop()),t.iAnimationlist.onComplete(e.id)},getMediaTime:function(e){var t=0,n=this.page.iViewlist.get(e.toJSON().overlay_id);return n.media&&(n.get("iType")=="Audio"&&(t=n.media.getDuration()),n.get("iType")=="Video"&&(t=n.media.duration())),t},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},playnext:function(){var e=this;if(this.CurrentPlay==this.length)return;var t=this.at(this.CurrentPlay).toJSON();if(t.iTiming.start==2){this.at(this.CurrentPlay)._animation=new animation({collection:e,animation:t});var n=this.CurrentPlay;this.CurrentPlay+=1,this.at(n)._animation.play(),this.playnext()}t.iTiming.start==0&&this.waitclick()},playclick:function(){var e=this;if(this.CurrentPlay==this.length)return;var t=this.at(this.CurrentPlay).toJSON();if(t.iTiming.start==0){this.at(this.CurrentPlay)._animation=new animation({collection:e,animation:t});var n=this.CurrentPlay;this.CurrentPlay+=1,this.at(n)._animation.play(),this.playnext()}},onComplete:function(e){var t=this;console.info(e)},waitclick:function(){var e=this;$(".interaction-view").one("click",function(){e.playclick()})},addclickstop:function(e){var t=this;$(".interaction-view").one("click",function(){t.get(e)._animation.forcestop()})}}),interaction_view.view.Animation=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){},render:function(e){}}),interaction_view.iAnimationlist=new interaction_view.collection.Animation}),define("interaction_view/model/audio",["interaction_view/model/base"],function(){interaction_view.model.Audio=interaction_view.model.Base.extend({defaults:{iType:"Audio",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.Audio({model:this})},setsyncmodel:function(){}}),interaction_view.view.Audio=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){},render:function(e){},preload:function(){var e=this.getdetail();this.model.played=!1,this.model.time=0;if(e.iFile&&e.iFile[0])var t=e.iFile[0].file||e.iFile[0].content,n=new interaction_view.model.Preload({file:t,overlay_id:this.model.id,elementtype:this.model.get("iType"),pageid:this.model.get("pageid")})},afterpreload:function(){}})}),define("interaction_view/model/chapter",["interaction_view/model/base"],function(){interaction_view.model.Chapter=interaction_view.model.Base.extend({defaults:{},setcollection:function(){},setmodel:function(){this.setview()},setview:function(e){this.icollection=new interaction_view.collection.Chapter,this.iview=new interaction_view.view.Chapter({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Chapter=interaction_view.collection.Base.extend({initialize:function(){},model:interaction_view.model.Chapter}),interaction_view.view.Chapter=interaction_view.view.Base.extend({initstart:function(){},events:{},renderDynamicElement:function(){},render:function(e){}}),interaction_view.iChapter=new interaction_view.model.Chapter({id:"chapter"})}),define("interaction_view/model/cycleimage",["interaction_view/model/base","interaction_view/ui/animation"],function(){interaction_view.model.CycleImage=interaction_view.model.Base.extend({defaults:{iType:"CycleImage",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.CycleImage({model:this})},setsyncmodel:function(){}}),interaction_view.view.CycleImage=interaction_view.view.Base.extend({events:{},render:function(e){},preload:function(){var e=this,t=this.getdetail();t.iImg&&_.each(t.iImg,function(t){var n=new interaction_view.model.Preload({file:t.picture,overlay_id:e.model.id,elementtype:e.model.get("iType"),pageid:e.model.get("pageid")})})},afterpreload:function(){this.playAnimation(),this.setZindex(),this.setElementDisplay(),this.control()},playAnimation:function(){var e=this;this.timeline=new TimelineMax({paused:!0,repeat:-1});var t=0,n={},r=this.getdetail(),s=Number(r.iInterval)||.01;n.ease="Linear.easeNone",n.opacity=1;var o=function(){console.log("start")};if(!r.iImg||r.iImg.length<2)return;for(i=0;i<r.iImg.length;i++){var u=this.$el.find(".Element").find(".CycleImagecontent").children()[i];this.timeline.add(TweenMax.to(u,1e-5,{css:{opacity:1}})),this.timeline.add(TweenMax.to(u,s,{css:{opacity:1}})),this.timeline.add(TweenMax.to(u,1e-5,{css:{opacity:0}}))}this.$el.find(".Element").find(".CycleImagecontent").children()[0].style.opacity=1},play:function(){var e=this,t=function(){},n=function(){this.target.style.opacity=0;if(s<i.iImg.length){var t=e.$el.find(".Element").find(".CycleImagecontent").children()[s];t.style.opacity=1,s+=1,TweenMax.to(t,u,r)}else{s=0;var t=e.$el.find(".Element").find(".CycleImagecontent").children()[s];t.style.opacity=1,s+=1,TweenMax.to(t,u,r)}},r={},i=this.getdetail();if(!i.iImg||i.iImg.length<2)return;var s=0,o=e.$el.find(".Element").find(".CycleImagecontent").children()[s],u=Number(i.iInterval)||.01;r.onStart=t,r.onComplete=n,r.ease="Linear.easeNone",r.opacity=1,o.style.opacity=1,s+=1,TweenMax.to(o,u,r)},control:function(){var e=this.getdetail();if(!e.iImg||e.iImg.length==0)return;this.timeline.play(0);if(e.iAutoplay)return;this.timeline.pause(0);var t=0,n=0,r=this,i=!1,s=null,o=null,u=this.$el.find(".Element").width(),a=this.timeline.duration()+2e-5*e.iImg.length;console.log(u),console.log(this.timeline.duration()),this.$el.find(".Element").on("mousedown",function(e){return n=0,s=e.pageX,i=!0,console.log("control start"),!1}),this.$el.find(".Element").on("mousemove",function(e){if(i&&s){var o=e.pageX-s;n=t-o/u*a,n>a&&(n-=a),n<0&&(n=a+n),r.timeline.seek(n)}return!1}),this.$el.find(".Element").on("mouseup",function(e){return t=n,i=!1,console.log("control stop"),!1})}})}),define("interaction_view/model/image",["interaction_view/model/base"],function(){interaction_view.model.Image=interaction_view.model.Base.extend({defaults:{iType:"Image",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.Image({model:this})},setsyncmodel:function(){}}),interaction_view.view.Image=interaction_view.view.Base.extend({events:{},render:function(e){},preload:function(){var e=this.getdetail();if(e.iImg&&e.iImg[0])var t=new interaction_view.model.Preload({file:e.iImg[0].picture,overlay_id:this.model.id,elementtype:this.model.get("iType"),pageid:this.model.get("pageid")})}})}),define("interaction_view/model/page",["interaction_view/model/base"],function(){interaction_view.model.Page=interaction_view.model.Base.extend({defaults:{iType:"Page",loaded:!1},setcollection:function(){interaction_view.ipagelist.get(this.id)||interaction_view.ipagelist.add(this)},setview:function(){this.iview=new interaction_view.view.Page({model:this})},setlist:function(){this.iViewlist=new interaction_view.collection.list,this.iAnimationlist=new interaction_view.collection.Animation,this.iActionlist=new interaction_view.collection.Action,this.ipreloadlist=new interaction_view.collection.Preload,this.ipreloadlist.pageid=this.iViewlist.pageid=this.iAnimationlist.pageid=this.iActionlist.pageid=this.id},setsyncmodel:function(){}}),interaction_view.collection.Page=interaction_view.collection.Base.extend({}),interaction_view.view.Page=interaction_view.view.Base.extend({events:{},initstart:function(){},load:function(){var e=this,t=context_url+this.model.id+"/";$.when(overlays=$.getJSON(t+"/overlayinit.json"),$.getJSON(t+"/getanimations"),$.getJSON(t+"/getactions")).done(function(t,n,r){e.overlays=t[0],e.animations=n[0],e.actions=r[0],e.afterload()})},afterload:function(){var e=this;e.animations=_.map(e.animations,function(t){return t.pageid=e.model.id,t}),e.model.iAnimationlist.reset(e.animations),overlays=_.filter(e.overlays,function(t){return t.pageid=e.model.id,interaction_view.model[t.iType]}),overlays=_.map(overlays,function(e){return new interaction_view.model[e.iType](e)}),e.model.iViewlist.reset(overlays),e.model.iViewlist.each(function(e){e.iview.setZindex()}),e.actions=_.map(e.actions,function(t){return t.pageid=e.model.id,t}),e.model.iActionlist.reset(e.actions),interaction_view.checkPageLoad(e.model.id)},afterpreload:function(){this.model.iViewlist.each(function(e){e.iview.afterpreload()})},renderDynamicElement:function(){},render:function(){}}),interaction_view.ipagelist=new interaction_view.collection.Page,interaction_view.currentPage=!0}),define("text!interaction_view/template/preload.js",[],function(){return'<img src="<%=file%>" width="1" height="1" id="<%=id%>"/>'}),define("interaction_view/model/preload",["interaction_view/model/base","text!interaction_view/template/preload.js"],function(){var e=require("text!interaction_view/template/preload.js");interaction_view.model.Preload=interaction_view.model.Base.extend({defaults:{iType:"Preload",iLock:!0,iVisibility:!0,iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,loaded:!1},setcollection:function(){this.pageid=this.get("pageid"),this.page=interaction_view.ipagelist.get(this.pageid),this.page.ipreloadlist.get(this.id)||this.page.ipreloadlist.add(this)},setview:function(e){this.elementmodel=iViewlist.get(this.get("overlay_id")),this.iview=new interaction_view.view.Preload({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Preload=interaction_view.collection.Base.extend({preloadcheck:function(e,t){var n=this.where({loaded:!0});t==0&&interaction_view.message("alert","图像或媒体资源加载失败，可能会影响动画效果"),this.where({loaded:false}).length==0&&interaction_view.finishPagePreload(this.pageid)},preload:function(){this.each(function(e){e.iview.render()})}}),interaction_view.view.Preload=interaction_view.view.Base.extend({events:{},initstart:function(){$("div#preloader").append(_.template(e,{id:this.model.id,file:null}))},renderDynamicElement:function(){},render:function(){var e=this;if(this.model.get("elementtype")=="Audio"){console.info("Audio");var t=this.elementmodel=e.model.page.iViewlist.get(this.model.get("overlay_id")),n=this.elementmodel.iview.getdetail();this.elementmodel.media=new buzz.sound(this.model.toJSON().file,{autoplay:!1}),this.elementmodel.media&&this.elementmodel.media.pause();var r=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;r?(t.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0)):this.elementmodel.media.bind("canplay",function(n){t.media.unbind("canplay"),console.info("Audio loaded"),t.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0)}).bind("error",function(n){t.loaded=!1,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!1)}).bind("ended",function(e){console.log("audio ended"),t.media.load(),t.media.pause()})}else if(this.model.get("elementtype")=="Video"){var t=this.elementmodel=this.model.page.iViewlist.get(this.model.get("overlay_id")),n=this.elementmodel.iview.getdetail();$("#Video_"+this.elementmodel.id).attr("id","Video_"+e.model.id+this.elementmodel.id),console.log(e.model.id+this.elementmodel.id);var i=!!document.createElement("video").canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');if(!i){t.loaded=!1,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!1);return}_V_("Video_"+e.model.id+this.elementmodel.id).ready(function(){console.info("Video init"),t.media=this,t.media.size(t.iview.$el.find(".Element").width(),t.iview.$el.find(".Element").height());if(this.bufferedPercent()>0){console.info("video has already loaded"),t.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0);return}t.videoloaded=!1;var n=function(e){t.videoloaded=!0},r=function(n){t.videoloaded=!0,t.media.removeEvent("loadedmetadata",r),console.info("video loaded"),t.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0)};t.media.addEvent("loadedmetadata",r),t.media.addEvent("error",function(n){t.loaded=!1,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!1)}),t.media.addEvent("ended",function(e){t.videoloaded=!1,t.media.load(),t.media.pause()})})}else $('img[id="'+this.model.id+'"]').load(function(){e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0)}).error(function(){e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!1)}).attr("src",e.model.toJSON().file)}}),interaction_view.ipreloadlist=new interaction_view.collection.Preload}),define("interaction_view/model/richtext",["interaction_view/model/base"],function(){interaction_view.model.RichText=interaction_view.model.Base.extend({defaults:{iType:"RichText",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.RichText({model:this})},setsyncmodel:function(){}}),interaction_view.view.RichText=interaction_view.view.Base.extend({events:{},render:function(e){interaction_view.setscrollnano(this.$el)}})}),define("interaction_view/model/slide",["interaction_view/model/base"],function(){interaction_view.model.Slide=interaction_view.model.Base.extend({defaults:{iType:"Slide",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.Slide({model:this})},setsyncmodel:function(){}}),interaction_view.view.Slide=interaction_view.view.Base.extend({events:{},render:function(e){},preload:function(){var e=this,t=this.getdetail();t.iImg&&_.each(t.iImg,function(t){var n=new interaction_view.model.Preload({file:t.picture,overlay_id:e.model.id,elementtype:e.model.get("iType"),pageid:e.model.get("pageid")})})},afterpreload:function(){this.play(),this.setZindex(),this.setElementDisplay()},play:function(){var e=this,t=function(){$(this.target).css("left",0),$(this.target).removeClass("hide")},n=function(){$(this.target).removeClass("hide")},r=function(){$(this.target).addClass("hide")},i=function(){if(c<o.iImg.length){var t=e.$el.find(".Element").find(".slidecontent").children()[c-1];$(t).css("left","0px"),$(t).css("top","0px"),TweenMax.to(t,1,s);var n=e.$el.find(".Element").find(".slidecontent").children()[c];u=="横向"?$(n).css("left",e.$el.find(".Element").css("width")):$(n).css("top",e.$el.find(".Element").css("height")),TweenMax.to(n,1,f),c+=1}else if(a==-1){var t=e.$el.find(".Element").find(".slidecontent").children()[c-1];$(t).css("left","0px"),$(t).css("top","0px"),TweenMax.to(t,1,s);var n=e.$el.find(".Element").find(".slidecontent").children()[0];u=="横向"?$(n).css("left",e.$el.find(".Element").css("width")):$(n).css("top",e.$el.find(".Element").css("height")),TweenMax.to(n,1,f),c=1}},s={},o=this.getdetail();if(!o.iImg||o.iImg.length<2)return;var u=o.iSlidetype;s.delay=parseInt(o.iInterval)||2;var a=o.iRepeat?-1:0;u=="横向"?s.left="-"+this.$el.find(".Element").css("width"):s.top="-"+this.$el.find(".Element").css("height"),s.repeat=0,s.onStart=t,s.onComplete=r,s.ease="Linear.easeNone";var f=_.clone(s);f.left="0px",f.top="0px",f.onStart=n,f.onComplete=i;var l=new TimelineMax,c=1,h=this.$el.find(".Element").find(".slidecontent").children()[c-1];$(h).removeClass("hide"),TweenMax.to(h,1,s);var p=this.$el.find(".Element").find(".slidecontent").children()[c];u=="横向"?$(p).css("left",e.$el.find(".Element").css("width")):$(p).css("top",e.$el.find(".Element").css("height")),TweenMax.to(p,1,f),c+=1}})}),define("interaction_view/model/video",["interaction_view/model/base"],function(){interaction_view.model.Video=interaction_view.model.Base.extend({defaults:{iType:"Video",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iViewlist.get(this.id)||iViewlist.add(this)},setview:function(e){this.iview=new interaction_view.view.Video({model:this})},setsyncmodel:function(){}}),interaction_view.view.Video=interaction_view.view.Base.extend({events:{},render:function(e){},preload:function(){var e=this.getdetail();if(e.iFile&&e.iFile[0])var t=e.iFile[0].file||e.iFile[0].content,n=new interaction_view.model.Preload({file:t,overlay_id:this.model.id,elementtype:this.model.get("iType"),pageid:this.model.get("pageid")})}})}),define("interaction_view/model/main",["interaction_view/model/action","interaction_view/model/animation_view","interaction_view/model/audio","interaction_view/model/chapter","interaction_view/model/cycleimage","interaction_view/model/image","interaction_view/model/page","interaction_view/model/preload","interaction_view/model/richtext","interaction_view/model/slide","interaction_view/model/video"],function(){}),define("interaction_view/ui/main",["jquery","backbone","jquery.nanoscroller","text!interaction_view/template/message.js"],function(){var e=require("text!interaction_view/template/message.js");return{message:function(t,n,r){$("body").find(".msg").length==0&&$("body").append('<div class="msg"></div>'),r||(r=3e3),$(".msg").html(_.template(e,{type:t,msg:n})),$(".msg").fadeIn(),setTimeout(function(){$(".msg").fadeOut("slow"),$(".msg").remove()},r)},getRequest:function(e){var t=location.search,n=new Object;if(t.indexOf("?")!=-1){var r=t.substr(1);strs=r.split("&");for(var i=0;i<strs.length;i++)n[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1])}return e?n[e]:n},setscrollnano:function(e){$(e).hasClass("nanoscrollbar")?$selector=$(e):$selector=$(e).find(".nanoscrollbar"),$selector.children(".nano").length==0&&$selector.wrapInner('<div class="nano"><div class="content"></div></div>'),$selector.children(".nano").nanoScroller(),$selector.children(".nano").children(".pane").css({visibility:"hidden"}),$selector.children(".nano").hover(function(){$(this).children(".pane").css({visibility:"visible"})},function(){$(this).children(".pane").css({visibility:"hidden"})})},deviceType:function(){return navigator.userAgent.match(/iPad/i)=="iPad"?"iPad":navigator.userAgent.match(/iPhone/i)=="iPhone"?"iPhone":navigator.userAgent.match(/Android/i)=="Android"?"Android":navigator.userAgent.match(/BlackBerry/i)=="BlackBerry"?"BlackBerry":"null"},getModelById:function(e,t){var n=null;return e.icollection.each(function(e){e.id==t&&(n=e);var r=interaction_view.getModelById(e,t);r&&(n=r)}),n},model2collection:function(e,t){e.has(t)&&e.icollection.add(e.get(t))},model2tree:function(e,t,n){e.has(t)&&(e.icollection.add(e.get(t)),e.icollection.each(function(e){e.has(n)&&interaction_view.model2tree(e,n,n)}))},getPageIds:function(){var e=[];return $(".reveal").find("section").each(function(){e.push($(this).attr("id"))}),e}}}),define("interaction_view/ui/presentation",["interaction_view/main","jswait"],function(){var e={foredit:function(){$("button.action-preview").on("click",function(){interaction_view.iAnimationlist.afterTimeLineCreated=null,interaction_view.SinglePreview=!1,interaction.animation.preview()}),interaction.modal.create("animation_preview",null,{header:!0,body:!0}),$("#animation_preview").children(".modal-body").addClass("Presentation"),$("#animation_preview").children(".modal-body").append('<div class="interaction-view typo"></div>'),$("body").append('<div id="preloader"></div>'),$("#animation_preview").draggable({handle:".modal-header"}),$("#animation_preview").on("hide",function(){interaction.animation.stop(interaction.currentpage.id)}),interaction_view.finishPagePreload=function(e){var t=interaction_view.ipagelist.get(e);t.iViewlist.each(function(e){e.iview.afterpreload()}),$(".loading").remove(),$(".interaction-view").jswait("close"),t.iAnimationlist.playMain(),t.iActionlist.each(function(e){e.iview.render()})},interaction_view.pagePreloadCheck=function(){},interaction_view.checkPageLoad=function(e){interaction_view.doPreload(e)},interaction_view.doPreload=function(e){var t=interaction_view.ipagelist.get(e);t.ipreloadlist.length==0?interaction_view.finishPagePreload(e):t.ipreloadlist.each(function(e){e.iview.render()})}},forpreview:function(){$("body").append('<div id="preloader"></div>'),$("body").prepend('<div class="loading progress progress-striped active"><div class="bar" style="width: 0%;"></div></div>'),$(".reveal").find("section .interaction-area").append('<div class="interaction-view"></div>'),$("body").jswait(),interaction_view.checkPageLoad=function(e){interaction_view.pagecheck||(interaction_view.pagecheck=interaction_view.ipagelist.pluck("id")),interaction_view.pagecheck=_.reject(interaction_view.pagecheck,function(t){return t==e}),interaction_view.pagecheck.length==0&&interaction_view.doPreload()},interaction_view.finishPagePreload=function(e){interaction_view.pagepreloadcheck||(interaction_view.pagepreloadcheck=interaction_view.ipagelist.pluck("id")),interaction_view.pagepreloadcheck=_.reject(interaction_view.pagepreloadcheck,function(t){return t==e});var t=interaction_view.ipagelist.get(e);t.set("loaded",!0),interaction_view.donext(t.id),(interaction_view.ipagelist.where({loaded:!0}).length>3||interaction_view.pagepreloadcheck.length==0)&&!interaction_view.preloadended&&(interaction_view.preloadended=!0);if(interaction_view.playstatus=="wait"&&interaction_view.preloadended){var n=interaction_view.ipagelist.get(interaction_view.currentPage);n.get("loaded")&&(console.log("start play:"+n.id),interaction_view.playstatus="play",$("body").jswait("close"),interaction_view.play(interaction_view.currentPage))}$(".loading").children("div").css("width",(1-interaction_view.pagepreloadcheck.length/interaction_view.ipagelist.length)*100+"%"),interaction_view.pagepreloadcheck.length==0&&$(".loading").remove()},interaction_view.pagePreloadCheck=function(){var e=_.filter(interaction_view.ipreloadlist.toJSON(),function(e){return e.loaded==0}),t=_.pluck(e,"overlay_id");interaction_view.ipagelist.each(function(e){var n=e.iViewlist.pluck("id"),r=_.filter(n,function(e){return _.include(t,e)});r.length==0?e.loaded=!0:e.loaded=!1})},interaction_view.preparePlay=function(){interaction_view.ipagelist.each(function(e){})},interaction_view.doPreload=function(){interaction_view.ipagelist.each(function(e){e.ipreloadlist.length==0?interaction_view.finishPagePreload(e.id):e.ipreloadlist.preload()})},interaction_view.donext=function(e){interaction_view.ipagelist.get(e).iview.afterpreload()},interaction_view.play=function(e){var t=interaction_view.ipagelist.get(e);t.iViewlist.resetViewStatus(),t.iAnimationlist.setParams(),t.iAnimationlist.play(),t.iActionlist.each(function(e){e.iview.render()})},interaction_view.stopPlay=function(e){var t=interaction_view.ipagelist.get(e);if(t.iAnimationlist.timeline){TweenMax.killAll(),t.iViewlist.each(function(e){e.media&&(e.get("iType")=="Audio"&&(e.media.load(),e.media.stop()),e.get("iType")=="Video"&&(e.videoloaded=!1,e.media.load(),e.media.pause()))}),$(".interaction-view").css("cursor","auto"),t.iActionlist.resetStatus();var n=t.iViewlist.where({iType:"Video"});_.each(n,function(e){e.iview.resetVideoStatus()}),interaction_view.bezierPatch(e)}},interaction_view.bezierPatch=function(e){var t=interaction_view.ipagelist.get(e);t.iAnimationlist.each(function(e){_.include([301,302],e.get("iType"))&&e.toJSON().iDetail.autoRotate&&TweenMax.to(e._animation.obj,0,{rotation:"0_cw"})})},interaction_view.repeatPatch=function(e){var t=interaction_view.ipagelist.get(e);t.iAnimationlist.each(function(e){e.toJSON().iTiming.repeat!=0})},interaction_view.slidePatch=function(e){var t=interaction_view.ipagelist.get(e);t.iViewlist.each(function(e){(e.get("iType")=="CycleImage"||e.get("iType")=="Slide")&&e.iview.play()})},interaction_view.slideChange=function(e){if(!Reveal)return;typeof e=="number"&&Reveal.slide(e);if(typeof e=="string"){var t=interaction_view.getModelById(interaction_view.iChapter,e);Reveal.slide(t.get("index"))}},interaction_view.firstPlay=!0}};window.presentation=e}),typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(e){var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(t==="")throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n],l.item=function(e){return this[e]||null},l.contains=function(e){return e+="",a(this,e)!==-1},l.add=function(e){e+="",a(this,e)===-1&&(this.push(e),this._updateClassName())},l.remove=function(e){e+="";var t=a(this,e);t!==-1&&(this.splice(t,1),this._updateClassName())},l.toggle=function(e){e+="",a(this,e)===-1?this.add(e):this.remove(e)},l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,h)}catch(p){p.number===-2146823252&&(h.enumerable=!1,i.defineProperty(r,t,h))}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}(self),define("classList",function(){});var Reveal=function(){function S(e){if(!d&&!p){document.body.setAttribute("class","no-transforms");return}window.addEventListener("load",F,!1),O(i,e),T(),N()}function x(){h.theme=document.querySelector("#theme"),h.wrapper=document.querySelector(".reveal"),h.slides=document.querySelector(".reveal .slides");if(!h.wrapper.querySelector(".progress")&&i.progress){var e=document.createElement("div");e.classList.add("progress"),e.innerHTML="<span></span>",h.wrapper.appendChild(e)}if(!h.wrapper.querySelector(".controls")&&i.controls){var t=document.createElement("aside");t.classList.add("controls"),t.innerHTML='<div class="navigate-left"></div><div class="navigate-right"></div><div class="navigate-up"></div><div class="navigate-down"></div>',h.wrapper.appendChild(t)}if(!h.wrapper.querySelector(".state-background")){var n=document.createElement("div");n.classList.add("state-background"),h.wrapper.appendChild(n)}if(!h.wrapper.querySelector(".pause-overlay")){var r=document.createElement("div");r.classList.add("pause-overlay"),h.wrapper.appendChild(r)}h.progress=document.querySelector(".reveal .progress"),h.progressbar=document.querySelector(".reveal .progress span"),i.controls&&(h.controls=document.querySelector(".reveal .controls"),h.controlsLeft=M(document.querySelectorAll(".navigate-left")),h.controlsRight=M(document.querySelectorAll(".navigate-right")),h.controlsUp=M(document.querySelectorAll(".navigate-up")),h.controlsDown=M(document.querySelectorAll(".navigate-down")),h.controlsPrev=M(document.querySelectorAll(".navigate-prev")),h.controlsNext=M(document.querySelectorAll(".navigate-next")))}function T(){/iphone|ipod|android/gi.test(navigator.userAgent)&&!/crios/gi.test(navigator.userAgent)&&(window.addEventListener("load",D,!1),window.addEventListener("orientationchange",D,!1))}function N(){function o(){t.length&&head.js.apply(null,t),C()}var e=[],t=[];for(var n=0,r=i.dependencies.length;n<r;n++){var s=i.dependencies[n];if(!s.condition||s.condition())s.async?t.push(s.src):e.push(s.src),typeof s.callback=="function"&&head.ready(s.src.match(/([\w\d_\-]*)\.?js$|[^\\\/]*$/i)[0],s.callback)}e.length?(head.ready(o),head.js.apply(null,e)):o()}function C(){x(),L(),k(),tt(),setTimeout(function(){P("ready",{indexh:o,indexv:u,currentSlide:f})},1)}function k(e){h.wrapper.classList.remove(i.transition),typeof e=="object"&&O(i,e),p===!1&&(i.transition="linear"),h.wrapper.classList.add(i.transition),h.controls&&(h.controls.style.display=i.controls&&h.controls?"block":"none"),h.progress&&(h.progress.style.display=i.progress&&h.progress?"block":"none"),i.rtl?h.wrapper.classList.add("rtl"):h.wrapper.classList.remove("rtl"),i.center?h.wrapper.classList.add("center"):h.wrapper.classList.remove("center"),i.mouseWheel?(document.addEventListener("DOMMouseScroll",Et,!1),document.addEventListener("mousewheel",Et,!1)):(document.removeEventListener("DOMMouseScroll",Et,!1),document.removeEventListener("mousewheel",Et,!1)),i.rollingLinks?H():B();if(i.theme&&h.theme){var t=h.theme.getAttribute("href"),n=/[^\/]*?(?=\.css)/,r=t.match(n)[0];i.theme!==r&&(t=t.replace(n,i.theme),h.theme.setAttribute("href",t))}F(),s=i.autoSlide,ot()}function L(){w=!0,window.addEventListener("hashchange",At,!1),window.addEventListener("resize",Ot,!1),i.touch&&(h.wrapper.addEventListener("touchstart",vt,!1),h.wrapper.addEventListener("touchmove",mt,!1),h.wrapper.addEventListener("touchend",gt,!1),window.navigator.msPointerEnabled&&(h.wrapper.addEventListener("MSPointerDown",yt,!1),h.wrapper.addEventListener("MSPointerMove",bt,!1),h.wrapper.addEventListener("MSPointerUp",wt,!1))),i.keyboard&&document.addEventListener("keydown",dt,!1),i.progress&&h.progress&&h.progress.addEventListener("click",St,!1),i.controls&&h.controls&&["touchstart","click"].forEach(function(e){h.controlsLeft.forEach(function(t){t.addEventListener(e,xt,!1)}),h.controlsRight.forEach(function(t){t.addEventListener(e,Tt,!1)}),h.controlsUp.forEach(function(t){t.addEventListener(e,Nt,!1)}),h.controlsDown.forEach(function(t){t.addEventListener(e,Ct,!1)}),h.controlsPrev.forEach(function(t){t.addEventListener(e,kt,!1)}),h.controlsNext.forEach(function(t){t.addEventListener(e,Lt,!1)})})}function A(){w=!1,document.removeEventListener("keydown",dt,!1),window.removeEventListener("hashchange",At,!1),window.removeEventListener("resize",Ot,!1),i.touch&&(h.wrapper.removeEventListener("touchstart",vt,!1),h.wrapper.removeEventListener("touchmove",mt,!1),h.wrapper.removeEventListener("touchend",gt,!1),window.navigator.msPointerEnabled&&(h.wrapper.removeEventListener("MSPointerDown",yt,!1),h.wrapper.removeEventListener("MSPointerMove",bt,!1),h.wrapper.removeEventListener("MSPointerUp",wt,!1))),i.progress&&h.progress&&h.progress.removeEventListener("click",St,!1),i.controls&&h.controls&&["touchstart","click"].forEach(function(e){h.controlsLeft.forEach(function(t){t.removeEventListener(e,xt,!1)}),h.controlsRight.forEach(function(t){t.removeEventListener(e,Tt,!1)}),h.controlsUp.forEach(function(t){t.removeEventListener(e,Nt,!1)}),h.controlsDown.forEach(function(t){t.removeEventListener(e,Ct,!1)}),h.controlsPrev.forEach(function(t){t.removeEventListener(e,kt,!1)}),h.controlsNext.forEach(function(t){t.removeEventListener(e,Lt,!1)})})}function O(e,t){for(var n in t)e[n]=t[n]}function M(e){return Array.prototype.slice.call(e)}function _(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function D(){window.orientation===0?(document.documentElement.style.overflow="scroll",document.body.style.height="120%"):(document.documentElement.style.overflow="",document.body.style.height="100%"),setTimeout(function(){window.scrollTo(0,1)},10)}function P(e,t){var n=document.createEvent("HTMLEvents",1,2);n.initEvent(e,!0,!0),O(n,t),h.wrapper.dispatchEvent(n)}function H(){if(p&&!("msPerspective"in document.body.style)){var t=document.querySelectorAll(e+" a:not(.image)");for(var n=0,r=t.length;n<r;n++){var i=t[n];if(i.textContent&&!i.querySelector("*")&&(!i.className||!i.classList.contains(i,"roll"))){var s=document.createElement("span");s.setAttribute("data-title",i.text),s.innerHTML=i.innerHTML,i.classList.add("roll"),i.innerHTML="",i.appendChild(s)}}}}function B(){var t=document.querySelectorAll(e+" a.roll");for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i.querySelector("span");s&&(i.classList.remove("roll"),i.innerHTML=s.innerHTML)}}function j(e){var t=M(e);return t.forEach(function(e,t){e.hasAttribute("data-fragment-index")||e.setAttribute("data-fragment-index",t)}),t.sort(function(e,t){return e.getAttribute("data-fragment-index")-t.getAttribute("data-fragment-index")}),t}function F(){if(h.wrapper){var t=h.wrapper.offsetWidth,n=h.wrapper.offsetHeight;t-=n*i.margin,n-=n*i.margin;var r=i.width,s=i.height;typeof r=="string"&&/%$/.test(r)&&(r=parseInt(r,10)/100*t),typeof s=="string"&&/%$/.test(s)&&(s=parseInt(s,10)/100*n),h.slides.style.width=r+"px",h.slides.style.height=s+"px",c=Math.min(t/r,n/s),c=Math.max(c,i.minScale),c=Math.min(c,i.maxScale);if(typeof h.slides.style.zoom!="undefined"&&!navigator.userAgent.match(/(iphone|ipod|ipad|android)/gi))h.slides.style.zoom=c;else{var o="translate(-50%, -50%) scale("+c+") translate(50%, 50%)";h.slides.style.WebkitTransform=o,h.slides.style.MozTransform=o,h.slides.style.msTransform=o,h.slides.style.OTransform=o,h.slides.style.transform=o}var u=M(document.querySelectorAll(e));for(var a=0,f=u.length;a<f;a++){var l=u[a];if(l.style.display==="none")continue;i.center?l.classList.contains("stack")?l.style.top=0:l.style.top=Math.max(-(l.offsetHeight/2)-20,-s/2)+"px":l.style.top=""}}}function I(e,t){typeof e=="object"&&typeof e.setAttribute=="function"&&e.setAttribute("data-previous-indexv",t||0)}function q(e){return typeof e=="object"&&typeof e.setAttribute=="function"&&e.classList.contains("stack")?parseInt(e.getAttribute("data-previous-indexv")||0,10):0}function R(){if(i.overview){ut();var e=h.wrapper.classList.contains("overview");h.wrapper.classList.add("overview"),h.wrapper.classList.remove("exit-overview"),clearTimeout(y),clearTimeout(b),y=setTimeout(function(){var n=document.querySelectorAll(t);for(var r=0,i=n.length;r<i;r++){var s=n[r],a="translateZ(-2500px) translate("+(r-o)*105+"%, 0%)";s.setAttribute("data-index-h",r),s.style.display="block",s.style.WebkitTransform=a,s.style.MozTransform=a,s.style.msTransform=a,s.style.OTransform=a,s.style.transform=a;if(s.classList.contains("stack")){var l=s.querySelectorAll("section");for(var c=0,h=l.length;c<h;c++){var p=r===o?u:q(s),d=l[c],v="translate(0%, "+(c-p)*105+"%)";d.setAttribute("data-index-h",r),d.setAttribute("data-index-v",c),d.style.display="block",d.style.WebkitTransform=v,d.style.MozTransform=v,d.style.msTransform=v,d.style.OTransform=v,d.style.transform=v,d.addEventListener("click",Mt,!0)}}else s.addEventListener("click",Mt,!0)}F(),e||P("overviewshown",{indexh:o,indexv:u,currentSlide:f})},10)}}function U(){if(i.overview){clearTimeout(y),clearTimeout(b),h.wrapper.classList.remove("overview"),h.wrapper.classList.add("exit-overview"),b=setTimeout(function(){h.wrapper.classList.remove("exit-overview")},10);var t=M(document.querySelectorAll(e));for(var n=0,r=t.length;n<r;n++){var s=t[n];s.style.display="",s.style.WebkitTransform="",s.style.MozTransform="",s.style.msTransform="",s.style.OTransform="",s.style.transform="",s.removeEventListener("click",Mt,!0)}Q(o,u),ot(),P("overviewhidden",{indexh:o,indexv:u,currentSlide:f})}}function z(e){typeof e=="boolean"?e?R():U():W()?U():R()}function W(){return h.wrapper.classList.contains("overview")}function X(){var e=document.body,t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;t&&t.apply(e)}function V(){var e=h.wrapper.classList.contains("paused");ut(),h.wrapper.classList.add("paused"),e===!1&&P("paused")}function $(){var e=h.wrapper.classList.contains("paused");ot(),h.wrapper.classList.remove("paused"),e&&P("resumed")}function J(){K()?$():V()}function K(){return h.wrapper.classList.contains("paused")}function Q(e,i,s,c){a=f;var h=document.querySelectorAll(t);i===undefined&&(i=q(h[e])),a&&a.parentNode&&a.parentNode.classList.contains("stack")&&I(a.parentNode,u);var p=l.concat();l.length=0;var d=o,v=u;o=G(t,e===undefined?o:e),u=G(n,i===undefined?u:i),F();e:for(var m=0,g=l.length;m<g;m++){for(var y=0;y<p.length;y++)if(p[y]===l[m]){p.splice(y,1);continue e}document.documentElement.classList.add(l[m]),P(l[m])}while(p.length)document.documentElement.classList.remove(p.pop());W()&&R(),nt(1500);var b=h[o],w=b.querySelectorAll("section");f=w[u]||b;if(typeof s!="undefined"){var E=j(f.querySelectorAll(".fragment"));M(E).forEach(function(e,t){t<s?e.classList.add("visible"):e.classList.remove("visible")})}o!==d||u!==v?P("slidechanged",{indexh:o,indexv:u,previousSlide:a,currentSlide:f,origin:c}):a=null,a&&(a.classList.remove("present"),document.querySelector(r).classList.contains("present")&&setTimeout(function(){var e=M(document.querySelectorAll(t+".stack")),n;for(n in e)e[n]&&I(e[n],0)},0)),Z(),Y()}function G(e,t){var n=M(document.querySelectorAll(e)),r=n.length;if(r){i.loop&&(t%=r,t<0&&(t=r+t)),t=Math.max(Math.min(t,r-1),0);for(var o=0;o<r;o++){var u=n[o];if(W()===!1){var a=Math.abs((t-o)%(r-3))||0;u.style.display=a>3?"none":"block"}n[o].classList.remove("past"),n[o].classList.remove("present"),n[o].classList.remove("future"),o<t?n[o].classList.add("past"):o>t&&n[o].classList.add("future"),u.querySelector("section")&&n[o].classList.add("stack")}n[t].classList.add("present");var f=n[t].getAttribute("data-state");f&&(l=l.concat(f.split(" ")));var c=n[t].getAttribute("data-autoslide");c?s=parseInt(c,10):s=i.autoSlide}else t=0;return t}function Y(){if(i.progress&&h.progress){var n=M(document.querySelectorAll(t)),r=document.querySelectorAll(e+":not(.stack)").length,s=0;e:for(var o=0;o<n.length;o++){var u=n[o],a=M(u.querySelectorAll("section"));for(var f=0;f<a.length;f++){if(a[f].classList.contains("present"))break e;s++}if(u.classList.contains("present"))break;u.classList.contains("stack")===!1&&s++}h.progressbar.style.width=s/(r-1)*window.innerWidth+"px"}}function Z(){if(i.controls&&h.controls){var e=et();h.controlsLeft.concat(h.controlsRight).concat(h.controlsUp).concat(h.controlsDown).concat(h.controlsPrev).concat(h.controlsNext).forEach(function(e){e.classList.remove("enabled")}),e.left&&h.controlsLeft.forEach(function(e){e.classList.add("enabled")}),e.right&&h.controlsRight.forEach(function(e){e.classList.add("enabled")}),e.up&&h.controlsUp.forEach(function(e){e.classList.add("enabled")}),e.down&&h.controlsDown.forEach(function(e){e.classList.add("enabled")}),(e.left||e.up)&&h.controlsPrev.forEach(function(e){e.classList.add("enabled")}),(e.right||e.down)&&h.controlsNext.forEach(function(e){e.classList.add("enabled")})}}function et(){var e=document.querySelectorAll(t),r=document.querySelectorAll(n);return{left:o>0||i.loop,right:o<e.length-1||i.loop,up:u>0,down:u<r.length-1}}function tt(){var e=window.location.hash,t=e.slice(2).split("/"),n=e.replace(/#|\//gi,"");if(isNaN(parseInt(t[0],10))&&n.length){var r=document.querySelector('[id="'+n+'"]');if(r){var i=Reveal.getIndices(r);Q(i.h,i.v)}else Q(o,u)}else{var s=parseInt(t[0],10)||0,a=parseInt(t[1],10)||0;Q(s,a)}}function nt(e){if(i.history){clearTimeout(g);if(typeof e=="number")g=setTimeout(nt,e);else{var t="/";if(f&&typeof f.getAttribute("id")=="string")t="/"+f.getAttribute("id");else{if(o>0||u>0)t+=o;u>0&&(t+="/"+u)}window.location.hash=t}}}function rt(e){var n=o,r=u;if(e){var i=!!e.parentNode.nodeName.match(/section/gi),s=i?e.parentNode:e,a=M(document.querySelectorAll(t));n=Math.max(a.indexOf(s),0),i&&(r=Math.max(M(e.parentNode.querySelectorAll("section")).indexOf(e),0))}return{h:n,v:r}}function it(){if(document.querySelector(n+".present")){var e=j(document.querySelectorAll(n+".present .fragment:not(.visible)"));if(e.length)return e[0].classList.add("visible"),P("fragmentshown",{fragment:e[0]}),!0}else{var r=j(document.querySelectorAll(t+".present .fragment:not(.visible)"));if(r.length)return r[0].classList.add("visible"),P("fragmentshown",{fragment:r[0]}),!0}return!1}function st(){if(document.querySelector(n+".present")){var e=j(document.querySelectorAll(n+".present .fragment.visible"));if(e.length)return e[e.length-1].classList.remove("visible"),P("fragmenthidden",{fragment:e[e.length-1]}),!0}else{var r=j(document.querySelectorAll(t+".present .fragment.visible"));if(r.length)return r[r.length-1].classList.remove("visible"),P("fragmenthidden",{fragment:r[r.length-1]}),!0}return!1}function ot(){clearTimeout(m),s&&!K()&&!W()&&(m=setTimeout(pt,s))}function ut(){clearTimeout(m)}function at(){et().left&&(W()||st()===!1)&&Q(o-1)}function ft(){et().right&&(W()||it()===!1)&&Q(o+1)}function lt(){(et().up&&W()||st()===!1)&&Q(o,u-1)}function ct(){(et().down&&W()||it()===!1)&&Q(o,u+1)}function ht(){if(st()===!1)if(et().up)lt();else{var e=document.querySelector(t+".past:nth-child("+o+")");e&&(u=e.querySelectorAll("section").length+1||undefined,o--,Q())}}function pt(){it()===!1&&(et().down?ct():ft()),ot()}function dt(e){var t=document.activeElement,n=!(!document.activeElement||!document.activeElement.type&&!document.activeElement.href&&document.activeElement.contentEditable==="inherit");if(n||e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)return;var r=!0;if(K()&&[66,190,191].indexOf(e.keyCode)===-1)return!1;switch(e.keyCode){case 80:case 33:ht();break;case 78:case 34:pt();break;case 72:case 37:at();break;case 76:case 39:ft();break;case 75:case 38:lt();break;case 74:case 40:ct();break;case 36:Q(0);break;case 35:Q(Number.MAX_VALUE);break;case 32:W()?U():pt();break;case 13:W()?U():r=!1;break;case 66:case 190:case 191:J();break;case 70:X();break;default:r=!1}r?e.preventDefault():e.keyCode===27&&p&&(z(),e.preventDefault()),ot()}function vt(e){E.startX=e.touches[0].clientX,E.startY=e.touches[0].clientY,E.startCount=e.touches.length,e.touches.length===2&&i.overview&&(E.startSpan=_({x:e.touches[1].clientX,y:e.touches[1].clientY},{x:E.startX,y:E.startY}))}function mt(e){if(!E.handled){var t=e.touches[0].clientX,n=e.touches[0].clientY;if(e.touches.length===2&&E.startCount===2&&i.overview){var r=_({x:e.touches[1].clientX,y:e.touches[1].clientY},{x:E.startX,y:E.startY});Math.abs(E.startSpan-r)>E.threshold&&(E.handled=!0,r<E.startSpan?R():U()),e.preventDefault()}else if(e.touches.length===1&&E.startCount!==2){var s=t-E.startX,o=n-E.startY;s>E.threshold&&Math.abs(s)>Math.abs(o)?(E.handled=!0,at()):s<-E.threshold&&Math.abs(s)>Math.abs(o)?(E.handled=!0,ft()):o>E.threshold?(E.handled=!0,lt()):o<-E.threshold&&(E.handled=!0,ct()),e.preventDefault()}}else navigator.userAgent.match(/android/gi)&&e.preventDefault()}function gt(e){E.handled=!1}function yt(e){e.pointerType===e.MSPOINTER_TYPE_TOUCH&&(e.touches=[{clientX:e.clientX,clientY:e.clientY}],vt(e))}function bt(e){e.pointerType===e.MSPOINTER_TYPE_TOUCH&&(e.touches=[{clientX:e.clientX,clientY:e.clientY}],mt(e))}function wt(e){e.pointerType===e.MSPOINTER_TYPE_TOUCH&&(e.touches=[{clientX:e.clientX,clientY:e.clientY}],gt(e))}function Et(e){clearTimeout(v),v=setTimeout(function(){var t=e.detail||-e.wheelDelta;t>0?pt():ht()},100)}function St(e){e.preventDefault();var n=M(document.querySelectorAll(t)).length,r=Math.floor(e.clientX/h.wrapper.offsetWidth*n);Q(r)}function xt(e){e.preventDefault(),at()}function Tt(e){e.preventDefault(),ft()}function Nt(e){e.preventDefault(),lt()}function Ct(e){e.preventDefault(),ct()}function kt(e){e.preventDefault(),ht()}function Lt(e){e.preventDefault(),pt()}function At(e){tt()}function Ot(e){F()}function Mt(e){if(w&&W()){e.preventDefault();var t=e.target;while(t&&!t.nodeName.match(/section/gi))t=t.parentNode;if(t&&!t.classList.contains("disabled")){U();if(t.nodeName.match(/section/gi)){var n=parseInt(t.getAttribute("data-index-h"),10),r=parseInt(t.getAttribute("data-index-v"),10);Q(n,r)}}}}var e=".reveal .slides section",t=".reveal .slides>section",n=".reveal .slides>section.present>section",r=".reveal .slides>section:first-child",i={width:960,height:700,margin:.1,minScale:.2,maxScale:1,controls:!0,progress:!0,history:!1,keyboard:!0,overview:!0,center:!0,touch:!0,loop:!1,rtl:!1,autoSlide:0,mouseWheel:!1,rollingLinks:!0,theme:null,transition:"default",dependencies:[]},s=0,o=0,u=0,a,f,l=[],c=1,h={},p="WebkitPerspective"in document.body.style||"MozPerspective"in document.body.style||"msPerspective"in document.body.style||"OPerspective"in document.body.style||"perspective"in document.body.style,d="WebkitTransform"in document.body.style||"MozTransform"in document.body.style||"msTransform"in document.body.style||"OTransform"in document.body.style||"transform"in document.body.style,v=0,m=0,g=0,y=0,b=0,w=!1,E={startX:0,startY:0,startSpan:0,startCount:0,handled:!1,threshold:80};return{initialize:S,configure:k,slide:Q,left:at,right:ft,up:lt,down:ct,prev:ht,next:pt,prevFragment:st,nextFragment:it,navigateTo:Q,navigateLeft:at,navigateRight:ft,navigateUp:lt,navigateDown:ct,navigatePrev:ht,navigateNext:pt,layout:F,toggleOverview:z,togglePause:J,isOverview:W,isPaused:K,addEventListeners:L,removeEventListeners:A,getIndices:rt,getSlide:function(e,n){var r=document.querySelectorAll(t)[e],i=r&&r.querySelectorAll("section");return typeof n!="undefined"?i?i[n]:undefined:r},getPreviousSlide:function(){return a},getCurrentSlide:function(){return f},getScale:function(){return c},getConfig:function(){return i},getQueryHash:function(){var e={};return location.search.replace(/[A-Z0-9]+?=(\w*)/gi,function(t){e[t.split("=").shift()]=t.split("=").pop()}),e},isFirstSlide:function(){return document.querySelector(e+".past")==null?!0:!1},isLastSlide:function(){return f&&f.classList.contains(".stack")?f.querySelector(e+".future")==null?!0:!1:document.querySelector(e+".future")==null?!0:!1},addEventListener:function(e,t,n){"addEventListener"in window&&(h.wrapper||document.querySelector(".reveal")).addEventListener(e,t,n)},removeEventListener:function(e,t,n){"addEventListener"in window&&(h.wrapper||document.querySelector(".reveal")).removeEventListener(e,t,n)}}}();define("revealJS",["jquery","classList"],function(){}),define("interaction_view/main",["interaction_view/model/main","interaction_view/ui/main","interaction_view/ui/presentation","revealJS"],function(){var e=require("interaction_view/ui/main");interaction_view=$.extend({},interaction_view,e),interaction_view.init=function(){presentation.forpreview(),window.iPageDirection="landscape",Reveal.initialize({progress:!0,history:!0,center:!0,width:1024,height:768,minScale:1,maxScale:1,theme:Reveal.getQueryHash().theme,transition:Reveal.getQueryHash().transition||"none"}),Reveal.addEventListener("ready",function(e){interaction_view.playstatus="wait",section=e.currentSlide,interaction_view.currentPage=$(section).attr("id"),console.log("init page:"+interaction_view.currentPage);var t=interaction_view.getPageIds();if(t.length==0)return;_.each(t,function(e){var t=new interaction_view.model.Page({id:e})});if(typeof cbt_data!="undefined"&&cbt_data){var n=cbt_data.data.chapter;_.each(n,function(e){var t=interaction_view.ipagelist.get(e.id);t.iview.overlays=e.overlays,t.iview.animations=e.animations,t.iview.actions=e.actions,t.iview.afterload()})}else $.getJSON(context_url+"index.json?source=web",function(e){if(e.code==200){var t=e.data.chapter;_.each(t,function(e){var t=interaction_view.ipagelist.get(e.id);t.set(e),t.iview.overlays=e.overlays,t.iview.animations=e.animations,t.iview.actions=e.actions,t.iview.afterload()});var n=e.data;interaction_view.iChapter.set(n),interaction_view.model2tree(interaction_view.iChapter,"catalog","pages")}else interaction_view.message("error",e.msg)})}),Reveal.addEventListener("slidechanged",function(e){section=e.currentSlide,current_id=$(section).attr("id"),interaction_view.currentPage=current_id,console.log("switch to page:"+interaction_view.currentPage),pre_id=$(e.previousSlide).attr("id"),interaction_view.stopPlay(pre_id);var t=interaction_view.ipagelist.get(interaction_view.currentPage);t.get("loaded")?(interaction_view.playstatus="play",$("body").jswait("close"),interaction_view.play(current_id)):(interaction_view.playstatus="wait",$("body").jswait())})}}),define("interaction/model/animation",["interaction/model/base","text!interaction/template/animationitemdetail.js","text!interaction/template/animationitem.js","interaction_view/main"],function(){var e=require("text!interaction/template/animationitemdetail.js"),t=require("text!interaction/template/animationitem.js");interaction.model.Animation=interaction.model.base.extend({defaults:{iType:"101",iDetail:{},overlay_id:null,iTiming:{start:1,delay:0,duration:5,repeat:0,rewind:!1,ease:0}},initialize:function(){this.id?this.setmodel():(this.set("id",this.get("iType")+"_"+this.cid+(new Date).getTime()),this.setcollection(),this.setmodel())},setmodel:function(){interaction.iAnimationlist.get(this.id)||interaction.iAnimationlist.add(this),this.setlist(),this.setview(),this.setsyncmodel()},setlist:function(){},setresourcesmodel:function(){},validate:function(e){},setsyncmodel:function(){this.elementmodel=interaction.elementlist.get(this.get("overlay_id"))},setcollection:function(){},setview:function(){this.iview=new interaction.view.Animation({model:this})},url:function(){},sync:function(e,t,n){}}),interaction.collection.Animation=interaction.collection.Base.extend({setonremove:function(){var e=this},confirm:function(){interaction.iAnimationGroupForSave.save()}}),interaction.view.Animation=interaction.view.Base.extend({events:{"click div.btn-draged":"focus","click a.animation-edit":"focus","click a.action-del":"remove",mouseover:"mouseover",mouseout:"mouseout","click a.animation-confirm":"unfocus","click a.animation-play":"preview"},bindinfo:function(){var e=this;this.$el.find(".animationdetail").find("input,select,textarea").bind("change",function(){var t=interaction.serializeValueSimple(e.$el.find(".animationdetail"));interaction.iAnimationGroupList.get(e.model.id).set("iTiming",t),t.waitaction?(interaction.iAnimationGroupList.get(e.model.id).iview.$el.addClass("waitaction"),e.$el.addClass("waitaction")):(interaction.iAnimationGroupList.get(e.model.id).iview.$el.removeClass("waitaction"),e.$el.removeClass("waitaction"))}),this.$el.find(".detailitems").find("input,select,textarea").bind("change",function(){var t=interaction.serializeValueSimple(e.$el.find(".detailitems"));interaction.iAnimationGroupList.get(e.model.id).set("iDetail",t)})},destroy:function(){var e=this;this.$el.remove()},remove:function(){var e=this;interaction.confirmDelete(function(){e.focused&&e.close(),interaction.iAnimationGroupList.get(e.model.id).destroy()})},render:function(){this.animationel=$("#info_attributes").find("fieldset.animation");var e=interaction.iAnimationGroupList.get(this.model.id).toJSON(),n=_.template(t,e);this.animationel.children("ul").append(n),this.setElement(this.animationel.find('li[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.get("overlay_id"));var r=this.model.toJSON().iTiming;return r.waitaction&&this.$el.addClass("waitaction"),this.$el.find("[rel=tooltip]").tooltip(),this.$el.find(".btn-draged").hide(),this},mouseover:function(){this.model.elementmodel.iview.highlight()},mouseout:function(){this.model.elementmodel.iview.cancelhighlight()},change:function(){},focus:function(){var t=this;interaction.animation.current&&interaction.animation.current.id!=this.model.id&&interaction.animation.current.iview.unfocus();if(!this.focused){this.focused=!0,this.$el.addClass("edit"),interaction.animation.current=this.model;var n=interaction.iAnimationGroupList.get(this.model.id).toJSON(),r=_.template(e,n);this.$el.append(r),interaction.animation.set(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),this.bindinfo()}else{this.$el.find("fieldset.animationitem").remove();var i=this.getdetail();interaction.animation.close(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),interaction.animation.current=null,this.focused=!1,this.$el.removeClass("edit")}},unfocus:function(){interaction.animation.save(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),interaction.iAnimationGroupList.confirm(),this.$el.find("fieldset.animationitem").remove();var e=this.getdetail();interaction.animation.current=null,this.focused=!1,this.$el.removeClass("edit")},close:function(){this.$el.find("fieldset.animationitem").remove(),interaction.animation.save(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),interaction.animation.current=null,this.focused=!1},preview:function(){interaction_view.SinglePreview=!0,interaction_view.PreviewItemId=this.model.id;var e=this;interaction.animation.preview();var t=interaction_view.ipagelist.get(interaction.currentpage.id);t.iAnimationlist.afterTimeLineCreated=function(){var n=t.iAnimationlist.timeline.getLabelTime(e.model.id+"_start");n!=0&&(n-=.01),t.iAnimationlist.timeline.seek(n,!1)}}}),interaction.model.AnimationGroupItem=interaction.model.Animation.extend({setmodel:function(){interaction.iAnimationGroupList.get(this.id)||interaction.iAnimationGroupList.add(this),this.setlist(),this.setview(),this.setsyncmodel()},setview:function(){this.iview=new interaction.view.AnimationGroupItem({model:this})}}),interaction.view.AnimationGroupItem=interaction.view.Animation.extend({bindinfo:function(){var e=this;this.$el.find(".animationdetail").find("input,select,textarea").bind("change",function(){var t=interaction.serializeValueSimple(e.$el.find(".animationdetail"));e.model.set("iTiming",t),t.waitaction?e.$el.addClass("waitaction"):e.$el.removeClass("waitaction")}),this.$el.find(".detailitems").find("input,select,textarea").bind("change",function(){var t=interaction.serializeValueSimple(e.$el.find(".detailitems"));console.info(t),e.model.set("iDetail",t)})},events:{"dblclick div.btn-draged":"focus","dblclick h4":"focus","click a.animation-edit":"edit","click a.action-del":"remove","click a.animation-play":"preview",mouseover:"mouseover",mouseout:"mouseout","click a.animation-confirm":"unfocus"},destroy:function(){var e=this,t=this.model.id;this.focused&&this.close(),interaction.iAnimationlist.get(this.model.id)&&interaction.iAnimationlist.get(this.model.id).iview.destroy(),this.$el.remove()},remove:function(){var e=this;interaction.confirmDelete(function(){e.model.destroy()})},render:function(){this.animationgroupel=$("#info_conf").children(".setting-body").find(".animations").children("ul"),this.elementel=interaction.div_find(this.model.get("overlay_id"));var e=this.model.toJSON(),n=_.template(t,this.model.toJSON());this.animationgroupel.append(n),this.setElement(this.animationgroupel.find('li[id="'+this.model.id+'"]'));var r=this.model.toJSON().iTiming;return r.waitaction&&this.$el.addClass("waitaction"),this.$el.find("[rel=tooltip]").tooltip(),this},focus:function(){interaction.current&&interaction.current.id==this.model.elementmodel.id?interaction.changeTab("info_attributes"):(this.model.elementmodel.iview.focus(),this.model.elementmodel.iview.animationItem_focus(this.model.id))},edit:function(){var t=this;interaction.animation.current&&interaction.animation.current.id!=this.model.id&&interaction.animation.current.iview.unfocus();if(!this.focused){this.focused=!0,this.$el.addClass("edit");var n=interaction.elementlist.get(this.model.get("overlay_id"));interaction.animation.current=this.model;var r=_.template(e,this.model.toJSON());this.$el.append(r),interaction.animation.set(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),this.bindinfo()}else interaction.animation.close(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),this.$el.find("fieldset.animationitem").remove(),interaction.animation.current=null,this.focused=!1,this.$el.removeClass("edit")},unfocus:function(){this.$el.find("fieldset.animationitem").remove(),interaction.animation.save(this.model.id,this.model.get("overlay_id"),this.model.get("iType")),interaction.iAnimationGroupList.confirm(),interaction.animation.current=null,this.focused=!1,this.$el.removeClass("edit")},mouseover:function(){this.model.elementmodel||(this.model.elementmodel=interaction.elementlist.get(this.model.get("overlay_id"))),this.model.elementmodel.iview.highlight()},mouseout:function(){this.model.elementmodel||(this.model.elementmodel=interaction.elementlist.get(this.model.get("overlay_id"))),this.model.elementmodel.iview.cancelhighlight()}}),interaction.iAnimationGroupList=new interaction.collection.Animation,interaction.iAnimationlist=new interaction.collection.Animation,interaction.iAnimationGroupList.on("remove",function(){interaction.iAnimationGroupList.confirm()})}),define("interaction/model/animationgroup",["interaction/model/base"],function(){interaction.model.AnimationGroup=interaction.model.base.extend({defaults:{iType:"AnimationGroup",iLock:!0,iVisibility:!0,iCommon:null,iDetail:{animations:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!0,iKeyscontrol:!1,callback:null,iBackground:null,iResources:null,iElementattr:null,iResourcesProperties:null,iTree:null},initialize:function(){this.options=this.get("iOptions");if(!this.id){if(interaction.elementlist.where({iType:"AnimationGroup"}).length>0)return this.destroy(),interaction.elementlist.where({iType:"AnimationGroup"})[0].iview.focus(),!1;var e=this;this.get("iAutoindex")?(this.set("id",this.get("iType")+"_"+this.cid),this.setcollection(),this.setmodel()):this.savemodel(function(t){e.set("id",t.ID.toString()),e.setcollection();var n={};n.animations=e.getAnimations(),e.set("iDetail",{animations:n.animations}),e.setmodel(),e.save()})}else this.setmodel()},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.AnimationGroup({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)},getAnimations:function(){var e=[];return interaction.elementlist.each(function(t){if(t.get("iType")=="AnimationGroup")return;var n=t.iview.getdetail();n.animations&&_.each(n.animations,function(t){e.push(t)})}),e}}),interaction.view.AnimationGroup=interaction.view.Base.extend({bindsavebutton:function(){var e=this;this.animationel.find(".action-save button").bind("click",function(){e.confirm()})},bindsort:function(){var e=this;this.animationel.find(".animations").sortable({handle:".btn-draged",items:"li.animation-item",update:function(t,n){var r=interaction.get_array(e.animationel.find(".animations li.animation-item"),"id"),i=e.getdetail();i.animations=_.map(r,function(e){return interaction.iAnimationGroupList.get(e).toJSON()}),interaction.iAnimationGroupList.reset(_.map(r,function(e){return interaction.iAnimationGroupList.get(e)})),e.model.set("iDetail",i)}})},afterremove:function(e,t){var n=this;e.dommodel&&e.dommodel.iview.$el.remove(),interaction.elementlist.where({iType:"AnimationGroup"}).length==0&&new interaction.model.AnimationGroup({iParent:interaction.elementlist.url,iUrl:context_url+interaction.elementlist.url})},render:function(){this.infoel=$("#info_attributes").children(".setting-body"),this.animationel=$("#info_conf").children(".setting-body")},updateinfo:function(){},renderinfo:function(){var e=this.getdetail();this.animationel.empty(),this.renderbaseinfo(),this.animationel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderanimationsinfo(),this.renderinfosave(this.animationel)},renderanimationsinfo:function(){interaction.iAnimationGroupList.reset();var e=this.getdetail();_.each(e.animations,function(e){new interaction.model.AnimationGroupItem(e)}),this.bindsort()},display:function(){var e=this;this.beforefocus(),this.renderinfo(),this.bindsavebutton(),this.otherfocus()},focus:function(){interaction.changeTab("info_conf")},confirm:function(){this.model.save(),this.otherconfirm()},otherconfirm:function(){interaction.iAnimationGroupForSave.save()}}),interaction.model.AnimationGroupForSave=Backbone.Model.extend({initialize:function(){this.set("id","AnimationGroup")},sync:function(e,t,n){var r=interaction.iAnimationGroupList.toJSON();this.attributes=r;if(e=="create")return;e=="update"&&(n.url=context_url+interaction.currentpage.id+"/setanimations");if(e=="delete")return;e=="read"&&(n.url=context_url+interaction.currentpage.id+"/getanimations"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}}),interaction.iAnimationGroupForSave=new interaction.model.AnimationGroupForSave({id:"AnimationGroup"})}),define("interaction/model/audio",["interaction/model/base"],function(){interaction.model.Audio=interaction.model.base.extend({defaults:{iType:"Audio",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:50,iHeight:50},landscape:{iStartx:400,iStarty:200,iWidth:50,iHeight:50}},iDetail:{iAutoplay:!1,iRepeat:!1,iImg:null,iFile:null},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(219,238,49,0.5)",iResourcesProperties:[{id:"iFile",type:"single",category:"audio"}],iAnimationProperties:[{id:"animations",type:"media"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.Audio({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Audio=interaction.view.Base.extend({})}),define("interaction/model/cycleimage",["interaction/model/base"],function(){interaction.model.CycleImage=interaction.model.base.extend({defaults:{iType:"CycleImage",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAutoplay:!1,iInterval:1,iImg:null},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(23,57,228,0.5)",iResourcesProperties:[{id:"iImg",type:"mutiple",category:"image"}],iAnimationProperties:[{id:"animations",type:"object"}],iActionProperties:[{id:"actions",type:"object"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.CycleImage({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.CycleImage=interaction.view.Base.extend({getBackGroundUrl:function(){var e=this.model.get("iDetail");return e.iImg&&!_.isEmpty(e.iImg)?_.isString(e.iImg[0])?e.iImg[0]:e.iImg[0].picture:!1}})}),define("text!interaction/template/dom.js",[],function(){return'      <li class="<%=iType%> Dom" id="<%=id%>">\n                  <div class="wraparea">\n          <h4><%=iDetail.title||iType%>(<img title="<%=iType%>" width="20px" src="img/type/material_<%=iType.toLowerCase()%>.png">)</h4>\n          <div title="" rel="tooltip" class="btn-draged" data-original-title="上下拖拽"></div>\n                    <div class="action-0">\n                    <a title="" rel="tooltip" class="action-showhide active" href="#" style="right:60px;" data-original-title="是否可见">是否可见</a>\n                    <a style="right:30px;" title="" rel="tooltip" class="action-del" href="#" data-original-title="移除">移除</a>\n            </div>\n          </div>\n      </li>'}),define("interaction/model/dom",["interaction/model/base","text!interaction/template/dom.js"],function(){interaction.model.Dom=interaction.model.base.extend({defaults:{iType:"Dom",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iAutoindex:!1,iSync:!1,iZindex:"-1",iAutofocus:!1},initialize:function(){e.get(this.id)||e.add(this),this.setview(this.get("iType")),this.elementmodel=iElementlist.get(this.id)},setview:function(e){this.iview=new interaction.view.Dom({model:this})},setfocus:function(e){}}),interaction.collection.Dom=interaction.collection.Base.extend({}),interaction.view.Dom=interaction.view.Base.extend({events:{mouseover:"mouseover",mouseout:"mouseout","click a.action-showhide":"setelementvisibility","dblclick .btn-draged":"elementfocus","dblclick h4":"elementfocus","click a.action-del":"elementremove"},elementfocus:function(){return this.model.elementmodel.iview.focus(),!1},elementremove:function(){var e=this.model;return e.elementmodel.iview.removemodel(),!1},setelementvisibility:function(){return this.model.elementmodel.get("iVisibility")==1?(this.model.elementmodel.iview.hidediv(),this.$el.find("a.action-showhide").removeClass("active")):(this.model.elementmodel.iview.showdiv(),this.$el.find("a.action-showhide").addClass("active")),!1},mouseover:function(e,t){return this.model.elementmodel.iview.highlight(),!1},mouseout:function(){return this.model.elementmodel.iview.cancelhighlight(),!1},render:function(){var e=this.model.toJSON(),t=require("text!interaction/template/dom.js"),n=_.template(t,this.model.toJSON());return $("#info_dom").find(".categories").children("ul").prepend(n),this.setElement($("#info_dom").find('li[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.id),this.$el.find('[rel="tooltip"]').tooltip(),this},change:function(){var e=require("text!interaction/template/dom.js"),t=_.template(e,this.model.toJSON());this.$el.replaceWith(t),this.setElement($("#info_dom").find('li[id="'+this.model.id+'"]')),this.$el.find('[rel="tooltip"]').tooltip()}});var e=new interaction.collection.Dom}),define("interaction/model/element",["interaction/model/base"],function(){interaction.collection.element=interaction.collection.Base.extend({iSync:!0,url:"",setonadd:function(){this.on("add",function(e){})},setonremove:function(){},sync:function(e,t,n){e=="read"&&(n.url=context_url+this.url+"/overlayinit.json"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)},parse:function(e){var t=this;return _.map(e,function(e){return e.iUrl=context_url+t.url,e.iParent=t.url,new interaction.model[e.iType](e)})},confirm:function(){interaction.iElementListForSave.save()},changeZindex:function(){this.each(function(e){e.iview.changeZindex()})}}),interaction.model.ElementListForSave=Backbone.Model.extend({initialize:function(){this.set("id","ElementGroup")},sync:function(e,t,n){var r=interaction.elementlist.toJSON();this.attributes=r;if(e=="create")return;e=="update"&&(n.url=context_url+interaction.currentpage.id+"/setoverlays");if(e=="delete")return;e=="read"&&(n.url=context_url+interaction.currentpage.id+"/getoverlays"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}}),interaction.iElementListForSave=new interaction.model.ElementListForSave({id:"Elementlist"}),interaction.elementlist=new interaction.collection.element}),define("text!interaction/template/elementattr.js",[],function(){return'       <li class="db clear" id="<%=id%>">\n         <span class="fl">\n           <% var iItemlist=interaction.elementlist.get(elementid).iview.getdetail().iItemlist %>\n           <input type="checkbox" value=<%=id%> name="iItemlist" data-attr="iDetail" <%=(_.include(iItemlist,id))&&"checked=checked"||""%>>\n         </span>\n         <span class="fl">\n           <a class="dom_move" id="<%=id%>">\n             <img class="vm" src="n/i_move.png">\n           </a>                \n         </span>\n         <span class="fl dom_name"><%=iType%></span>\n       </li>'}),define("interaction/model/elementattr",["interaction/model/base","text!interaction/template/elementattr.js"],function(){interaction.model.Elementattr=interaction.model.base.extend({defaults:{iType:"Elementattr",iLock:!0,iVisibility:!0,iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:require("text!interaction/template/elementattr.js"),iAutoindex:!0,iSync:!1,iZindex:"-1",iAutofocus:!1,elementid:null,attr:null},setsyncmodel:function(){this.elementmodel=iElementlist.get(this.get("elementid"))},setview:function(){this.iview=new interaction.view.Elementattr({model:this})},setfocus:function(e){}}),interaction.collection.Elementattr=interaction.collection.Base.extend({setonremove:function(){var e=this;this.on("remove",function(t){var n=e.pluck("picture");n.length==0&&(n=null);var r={};r[t.elementmodel.get("iElementattr")]=n,t.elementmodel.iview.setdetail(r)})}}),interaction.view.Elementattr=interaction.view.Base.extend({events:{},destroy:function(){this.$el.remove()},remove:function(){if(!removeconfirm())return!1;this.model.destroy()},render:function(){var e=this.model.toJSON(),t=this.model.get("iTemplate"),n=_.template(t,this.model.toJSON());return $("#info_attributes .elementlist").children("ul").append(n),this.setElement($("#info_attributes .elementlist").find('li[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.get("elementid")),this},change:function(){}}),interaction.iElementattrlist=new interaction.collection.Elementattr}),define("interaction/model/image",["interaction/model/base"],function(){interaction.model.Image=interaction.model.base.extend({defaults:{iType:"Image",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single",category:"image"}],iAnimationProperties:[{id:"animations",type:"object"}],iActionProperties:[{id:"actions",type:"object"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.Image({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Image=interaction.view.Base.extend({})}),define("interaction/model/link",["interaction/model/base"],function(){interaction.model.Link=interaction.model.base.extend({defaults:{iType:"Link",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iLinktype:"hyperlink",iShowicon:!1,iUrl:"",iGoto:"page",iPage:"",iFile:null,iSafari:!1},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(193,56,2,0.5)",iResourcesProperties:[{id:"iImg",type:"single",category:"image"}]},setcollection:function(){},setview:function(e){this.iview=new interaction.view.Link({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Link=interaction.view.Base.extend({renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.infoel.append(interaction.template.detail[this.model.get("iType")+"Type"](this.model.toJSON())),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderinfosave(),this.bindinfo()},updateinfo:function(){this.infoel.find(".typedetail").replaceWith(interaction.template.detail.LinkType(this.model.toJSON())),this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.bindinfo()}})}),define("text!interaction/template/ipage.js",[],function(){return'				<li id="<%=id%>" data-position=<%=position%>>\n					<a href="" class="img">\n						<img src="<%=thumbnail||""%>"></a>\n					<div class="sn">\n						<%=position%></div>\n				</li>'}),define("text!interaction/template/page_info.js",[],function(){return'<form>\n   <h3>页面设定</h3>\n   <fieldset>\n      <legend>背景图片</legend>\n        <div class="action"><a href="#" class="action-file change-background" rel="tooltip" data-original-title="设定背景图片">设定</a>\n    </div>\n    <div class="item">\n      <figure class="image"> <%=preview%>\n        <figcaption><%=title%></figcaption>\n      </figure>\n      <a href="javascript:void(0)" class="action-showhide action-backgroundpreview active" rel="tooltip" data-original-title="预览">预览</a> <a href="#confirmModal" class="action-del" rel="tooltip" data-original-title="删除背景图">删除</a> </div>\n  </fieldset>\n</form>'}),define("text!interaction/template/thumbitem.js",[],function(){return'<div class="interaction_thumbitem" data-type="<%=iType%>" data-id="<%=id%>" style="position: absolute; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; left:<%=iCommon[iPageDirection].iStartx%>px; top:<%=iCommon[iPageDirection].iStarty%>px;overflow:hidden;">\n	<%if(iType=="RichText"){%>\n		<div class="typo">\n			<%=iDetail.iText%>\n		</div>		\n	<%}%>\n	<%if(iType==\'Image\'){%>\n			<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n				<img class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:100%;height:100%;">\n			<%}%>\n	<%}%>\n	<%if(iType==\'Slide\'){%>\n				<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n						<img class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:100%;height:100%;position:absolute;">\n				<%}%>\n	<%}%>\n	<%if(iType==\'CycleImage\'){%>\n				<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n						<img class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:100%;height:100%;position:absolute;">\n				<%}%>\n	<%}%>\n	<%if(iType==\'Video\'){%>\n		<div style="width:100%;height:100%;position:absolute;background:#ccc;">\n		</div>\n	<%}%>\n</div>'}),define("interaction/model/thumb",["interaction/model/base","text!interaction/template/thumbitem.js"],function(){interaction.model.Thumb=interaction.model.base.extend({defaults:{iType:"thumb",iLock:!0,iVisibility:!0,iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!1},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:require("text!interaction/template/thumbitem.js"),iParentdiv:"",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!1,callback:null,iBackground:"rgba(62,189,255,0.5)",iPageid:null},setcollection:function(){},setview:function(e){this.iview=new interaction.view.Thumb({model:this})},setmodel:function(){this.setview()}}),interaction.collection.Thumb=interaction.collection.Base.extend({model:interaction.model.Thumb}),interaction.view.Thumb=interaction.view.Base.extend({events:{},bindelementchange:function(){this.model.elementmodel=interaction.elementlist.get(this.model.id);if(!this.model.elementmodel)return;this.model.elementmodel.on("change:position",this.positionchange),this.model.elementmodel.on("change:background",this.backgroundchange),this.model.elementmodel.on("change:text",this.textchange),this.model.elementmodel.on("change:remove",this.elementremove)},bindtextchange:function(){},elementremove:function(){this.$el.remove(),this.model.destroy()},positionchange:function(){var e={},t=this.model.elementmodel.iview.getcommon();e.iStartx=t.iStartx*120/1024,e.iStarty=t.iStarty*90/768,this.model.get("iType")!="RichText"?e.iWidth=Number(t.iWidth)*120/1024:e.iWidth=t.iWidth,this.model.get("iType")!="RichText"?e.iHeight=Number(t.iHeight)*90/768:e.iHeight=t.iHeight,this.model.get("iType")=="RichText"&&(e=this.adjustTextPosition(e)),this.setcommon(e),this.updatepos()},backgroundchange:function(){var e=this.model.elementmodel.iview.getBackGroundThumbUrl();e?(this.$el.find("img").length==0&&this.$el.append('<img style="width:100%;height:100%;"></img>'),this.$el.find("img").attr("src",e)):this.$el.find("img").remove()},textchange:function(){var e=this.model.elementmodel.iview.gettext();e&&this.$el.html(e)},render:function(){if(!this.model.get("iPageid"))return;this.parseCommon();var e=this.model.get("iPageid"),t=$(".thumbs").find('li[id="'+e+'"]'),n=this.model.toJSON(),r=require("text!interaction/template/thumbitem.js"),i=_.template(r,this.model.toJSON());return t.append(i),this.setElement(t.find('[data-id="'+this.model.id+'"]')),this.model.get("iType")=="RichText"&&this.parseText(),this.bindelementchange(),this},parseCommon:function(){var e=this.getcommon();if(!e)return;e.iStartx=Number(e.iStartx)*120/1024,e.iStarty=Number(e.iStarty)*90/768,this.model.get("iType")!="RichText"&&(e.iWidth=Number(e.iWidth)*120/1024),this.model.get("iType")!="RichText"&&(e.iHeight=Number(e.iHeight)*90/768),this.setcommon(e)},parseText:function(){var e=this.getcommon(),t=this.$el[0],n=.1171875,r=e.iStartx-(e.iWidth-e.iWidth*120/1024)/2,i=e.iStarty-(e.iHeight-e.iHeight*90/768)/2;TweenMax.to(t,0,{css:{scale:.1171875}}),TweenMax.to(t,0,{css:{left:r,top:i}})},adjustTextPosition:function(e){return e.iStartx=e.iStartx-(e.iWidth-e.iWidth*120/1024)/2,e.iStarty=e.iStarty-(e.iHeight-e.iHeight*90/768)/2,e}}),interaction.thumblist=new interaction.collection.Thumb}),define("interaction/ui/thumb",["interaction/model/thumb"],function(){thumb={init:function(e){var t=iPagelist.get(e);interaction.elementlist.each(function(e){var n=e.toJSON();n.iPageid=t.id,n=$.extend(!0,{},n),interaction.thumblist.add(n)})},load:function(){iPagelist.each(function(e){e.overlaylist=new interaction.collection.Base,e.thumblist=new interaction.collection.Thumb,global.json.load(context_url+e.id+"/getoverlays",function(t){_.each(t,function(t){t.iPageid=e.id,e.thumblist.add(t)})})})}},interaction.thumb=thumb}),define("interaction/model/page",["interaction/model/base","text!interaction/template/ipage.js","text!interaction/template/page_info.js","interaction/ui/thumb"],function(){var e=require("text!interaction/template/page_info.js");interaction.model.Page=interaction.model.base.extend({defaults:{iType:"Page",iLock:!0,iVisibility:!0,iCommon:null,iDetail:{},iParent:"iRoot",iChild:null,iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iParentdiv:"body",iSync:!0,iZindex:"-1",iAutofocus:!1,iKeyscontrol:!1,callback:null,iBackground:"transparent"},setcollection:function(){},setview:function(e){this.iview=new interaction.view.Page({model:this}),this.get("isNew")&&this.iview.focus()},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1},sync:function(e,t,n){e=="create"&&(n.url=context_url+"/addpage.json"),e=="update"&&(n.url=context_url+"updateimage"),e=="delete"&&(n.url=context_url+"/deletepage.json?id="+t.id);if(e=="read")return!1;Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,this.get("iSync")&&Backbone.sync(e,t,n)}}),interaction.collection.Page=interaction.collection.Base.extend({model:interaction.model.Page,setonremove:function(){var e=this;this.on("remove",function(t){interaction.currentpage.id==t.id&&($(".interaction-area").children(".element").remove(),interaction.currentpage=null),e.length==0?e.addpage():e.at(0).iview.focus()})},addpage:function(){var e="addpage.json";jqwait_simple(),$.getJSON(e,function(e){if(e.code==200){var e=e.data;e.iType="Page",iPagelist.add(e),jqwait_simple_close()}})}}),interaction.view.Page=interaction.view.Base.extend({bindanimationsave:function(){var e=this;this.animationel.find(".action-save button").bind("click",function(){return interaction.iAnimationGroupList.confirm(),!1})},bindoverlaysave:function(){this.overlayel.find(".action-save button").bind("click",function(){return interaction.elementlist.confirm(),!1})},bindactionsave:function(){this.actionel.find(".action-save button").bind("click",function(){return interaction.iActionList.confirm(),!1})},bindanimationsort:function(){var e=this;this.animationel.find(".animations").sortable({handle:".btn-draged",items:"li.animation-item",update:function(t,n){var r=interaction.get_array(e.animationel.find(".animations li.animation-item"),"id");interaction.iAnimationGroupList.reset(_.map(r,function(e){return interaction.iAnimationGroupList.get(e)}))}})},bindoverlaysort:function(){var e=this;this.domel=$("#info_dom"),this.domel.find(".categories").sortable({handle:".btn-draged",items:"li.Dom",update:function(t,n){var r=interaction.get_array(e.overlayel.find(".categories li.Dom"),"id"),s=[];for(i=0;i<r.length;i++)s.push(r[r.length-i-1]);interaction.elementlist.reset(_.map(s,function(e){return interaction.elementlist.get(e)})),interaction.elementlist.each(function(e){e.iview.changeZindex()})}})},bindpageinfo:function(){var e=this;this.pageinfoel.find(".change-background").on("click",function(){return interaction.resources.openforchange(),!1}),this.pageinfoel.find(".action-save button").bind("click",function(){return interaction.save(e.model,{},function(e){e.code==200&&interaction.message("success",e.msg)}),!1}),this.pageinfoel.find(".action-backgroundpreview").bind("click",function(){return e.previewbackground(),!1}),this.pageinfoel.find(".action-del").on("click",function(){return global.confirmDelete(function(){e.clearbackground()}),!1}),this.pageinfoel.find("[rel=tooltip]").tooltip()},events:{click:"focus"},render:function(){if($(".doc-layout-left .thumbs").children("ul").children('li[id="'+this.model.id+'"]').length>0)this.setElement($(".doc-layout-left .thumbs").children("ul").children('li[id="'+this.model.id+'"]'));else{var e=require("text!interaction/template/ipage.js");$(".doc-layout-left .thumbs").children("ul").append(_.template(e,this.model.toJSON())),this.setElement($(".doc-layout-left .thumbs").children("ul").children('li[id="'+this.model.id+'"]'))}},focus:function(){var e=this;return interaction.current&&interaction.current.iview.confirm(),interaction.currentpage=this.model,$(".interaction-area").children(".element").remove(),this.overlayel=$("#info_dom").children(".setting-body"),this.overlayel.html('<form><h3>Layers</h3><fieldset><legend>交互组件顺序</legend><div class="categories"><ul></ul></div>'),this.renderinfosave(this.overlayel),interaction.current=null,elementfocus=!1,this.updatebackground(),this.updateanimationinfo(),this.updateactioninfo(),this.updatepageinfo(),interaction.elementlist.url=this.model.id,$.when(overlays=$.getJSON(context_url+this.model.id+"/getoverlays"),animations=$.getJSON(context_url+this.model.id+"/getanimations"),$.getJSON(context_url+this.model.id+"/getactions")).done(function(t,n,r){overlays=t[0],animations=n[0],actions=r[0],overlays=_.reject(overlays,function(e){return e.iType=="AnimationGroup"}),interaction.elementlist.reset([]),interaction.iActionList.reset([]),_.each(overlays,function(t){t.iUrl=context_url+e.model.id,t.iParent=e.model.id,interaction.elementlist.add(new interaction.model[t.iType](t))}),animations=_.filter(animations,function(e){return _.include(interaction.elementlist.pluck("id"),e.overlay_id)}),animations=_.map(animations,function(e){return new interaction.model.AnimationGroupItem(e)}),interaction.elementlist.each(function(e){e.iview.changeZindex()}),e.bindoverlaysave(),interaction.iAnimationGroupList.reset(animations),_.each(actions,function(e){new interaction.model.Action(e)}),e.updatethumb()}),this.$el.addClass("ui-selected").siblings().removeClass("ui-selected"),this.$el.addClass("active").siblings().removeClass("active"),$(".interaction-area").width(1024),$(".interaction-area").height(768),interaction.changeTab("info_page"),this.updateanimationpreviewbackground(),this.bindoverlaysort(),this.bindanimationsort(),!1},updatebackground:function(){var e=this.getBackGroundUrl();if(!e||e=="null"||e=="Null"){$(".interaction-area").find("div.animationbk").empty();return}$(".interaction-area").find("div.animationbk").length>0?$(".interaction-area").find("div.animationbk").replaceWith('<div class="animationbk" id="animationbk" style="text-align:center;position:absolute;width:100%;height:100%"><img src="'+e+'" style="width:100%;height:100%" class="animationbackground"></div>'):$(".interaction-area").prepend('<div class="animationbk" id="animationbk" style="text-align:center;position:absolute;width:100%;height:100%"><img src="'+e+'" style="width:100%;height:100%" class="animationbackground"></div>')},updateanimationinfo:function(){this.animationel=$("#info_conf").children(".setting-body"),this.animationel.empty(),this.animationel.append('<h3 class="baseinfo">动画序列</h3>'),this.animationel.append(interaction.template.detail.AnimationGroup()),this.renderinfosave(this.animationel),this.bindanimationsave()},updateactioninfo:function(){this.actionel=$("#info_action").children(".setting-body"),this.actionel.empty(),this.actionel.append('<h3 class="baseinfo">动作事件</h3>'),this.actionel.append(interaction.template.detail.ActionList()),this.renderinfosave(this.actionel),this.bindactionsave()},updatepageinfo:function(){this.pageinfoel=$("#info_page").children(".setting-body"),this.pageinfoel.empty(),this.pageinfoel.append(_.template(e,this.model.toJSON())),this.renderinfosave(this.pageinfoel),this.bindpageinfo()},updateanimationpreviewbackground:function(){var e=this.getBackGroundUrl();$(".interaction-view").find("div.animationbk").remove();if(!e||e=="null"||e=="Null")return;$(".interaction-view").append('<div class="animationbk" style="text-align:center;position:absolute;width:100%;height:100%"><img src="'+e+'" style="width:100%;height:100%" class="animationbackground"></div>')},getBackGroundUrl:function(){return this.model.get("picture")},afterremove:function(){this.$el.remove(),$("#info_dom").children(".setting-body").empty()},setimageplus:function(){return""},getimagename:function(e){return"iImg"},previewbackground:function(){var e=this.model.get("preview");e&&this.model.get("picture")&&global.simplepreview(e)},clearbackground:function(){var e={};e.width=null,e.height=null,e.preview='<img src="/img/thumb.png">',e.thumbnail=null,e.thumb_height=null,e.thumb_width=null,e.picture=null,e.uid=null,interaction.currentpage.set(e),interaction.currentpage.iview.updatepageinfo(),interaction.currentpage.iview.updatebackground(),interaction.currentpage.iview.$el.children("a").html("<img src/>")},updatethumb:function(){this.$el.find(".interaction_thumbitem").remove(),interaction.thumblist.reset(),interaction.thumb.init(this.model.id)}}),window.iPagelist=new interaction.collection.Page,interaction.currentpage=null}),define("text!interaction/template/resourcesitem.js",[],function(){return'             <div class="item" id="<%=id%>">\n                  <figure> <%=preview%>\n                      <figcaption><%=title%></figcaption>\n                  </figure>\n                  <a title="" rel="tooltip" class="action-showhide active action-backgroundpreview" href="javascript:void(0)" data-original-title="预览">预览</a>\n                  <a title="" rel="tooltip" class="action-del" href="#confirmModal" data-original-title="移除">移除</a> \n              </div>'}),define("interaction/model/resources",["interaction/model/base","text!interaction/template/resourcesitem.js"],function(){var e=require("text!interaction/template/resourcesitem.js");interaction.model.Resources=interaction.model.base.extend({defaults:{iType:"Resources",iLock:!0,iVisibility:!0,iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iAutoindex:!0,iSync:!1,iZindex:"-1",iAutofocus:!1,picture:null,elementid:null},setsyncmodel:function(){this.elementmodel=iElementlist.get(this.get("elementid"))},setview:function(){this.iview=new interaction.view.Resources({model:this})},setfocus:function(e){}}),interaction.collection.Resources=interaction.collection.Base.extend({setonremove:function(){var e=this;this.on("remove",function(t){var n={},r=t.get("resourceattr"),i=e.where({resourceattr:r});i=_.map(i,function(e){return e.toJSON()}),n[r]=i,t.elementmodel.iview.setdetail(n)})}}),interaction.view.Resources=interaction.view.Base.extend({events:{"click a.action-del":"remove","click a.action-backgroundpreview":"previewbackground"},destroy:function(){this.$el.remove()},remove:function(){var e=this;interaction.confirmDelete(function(){e.model.destroy()})},render:function(){var t=this.model.toJSON(),n=_.template(e,this.model.toJSON()),r=this.model.get("resourceattr");return $("#info_attributes").find('fieldset.resources[id="'+r+'"]').append(n),this.setElement($("#info_attributes").find('fieldset.resources[id="'+r+'"]').find('div[id="'+this.model.id+'"]')),this.elementel=interaction.div_find(this.model.get("elementid")),this.$el.find("[rel=tooltip]").tooltip(),this},change:function(){},previewbackground:function(){var e=this.model.get("preview");e&&this.model.get("picture")&&global.simplepreview(e)}}),interaction.iResourceslist=new interaction.collection.Resources}),define("text!interaction/template/richtext.js",[],function(){return'       <div class="element component <%=iType.toLowerCase()%>" id="<%=id%>" style="position: absolute; width: <%=iCommon[iPageDirection].iWidth%>px; height: <%=iCommon[iPageDirection].iHeight%>px; left: <%=iCommon[iPageDirection].iStartx%>px; top: <%=iCommon[iPageDirection].iStarty%>px;">\n         <div class="iText nanoscrollbar" id=<%="tEditor_"+id%>>\n         <% if(iDetail.iText&&iDetail.iText!=""){ %>\n         <%=iDetail.iText%>\n         <% } else{%>\n         <p style="text-align: center;" data-mce-style="text-align: center;">\n   			<span style="font-size: x-large; color: #888888;" data-mce-style="font-size: x-large; color: #888888;">文本</span>\n		</p>\n         <% } %>\n         </div>\n         <div class="iContent" style="postion:absolute;width:100%;height:100%"></div>\n       </div>'}),function(){function e(e,t){this.setOptions(e,t)}e.prototype={setOptions:function(t,n){this.opt=$.extend(!0,{},e.defaults,n||{}),this.$obj=$(t),this.page=1,this.pages={},this.init()},init:function(){this.articleSelecterClass="PageEdit_article",this.regionClass="PageEdit_region",this.pageBreakClass="PageEdit_break";var e=["."+this.articleSelecterClass+"{","   -webkit-flow-into: article;","}","."+this.regionClass+"{","  -webkit-flow-from: article;","   -webkit-region-overflow: break;","   overflow: hidden;","}","."+this.pageBreakClass+"{","   page-break-before:always;","}"].join("");this.creatStyle(e),this.$articleSelecter=this.$obj,this.$editSelecter=$(this.opt.editSelecter),this.$editSelecter.length<1&&(this.$editSelecter=$('<div class="PageEdit_edit"></div>'),$(this.opt.regionContainer)[0].appendChild(this.$editSelecter[0]));var t=+(new Date),n=this.$articleSelecter.attr("id");n||(n="article_"+t,this.$articleSelecter.attr("id",n)),this.articleSelecterId=n,this.$articleSelecter.addClass(this.articleSelecterClass),this.$template=$("<div></div>"),this.$template[0].innerHTML=this.opt.templates.page,this.$template.find(this.opt.regionSelecter).addClass(this.regionClass),this.$previewSelecter=$('<div class="PageEdit_preview"></div>').hide(),this.$editSelecter[0].parentNode.appendChild(this.$previewSelecter[0]);var r=this.$editSelecter[0],i=this.$previewSelecter[0];r.parentNode.insertBefore(i,r.nextSibling);var s=document.webkitGetNamedFlows();this.namedFlow=s.namedItem("article"),this.bindEvent(),this.render()},creatStyle:function(e){if(document.all)window.style=e,document.createStyleSheet("javascript:style");else{var t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.getElementsByTagName("HEAD").item(0).appendChild(t)}},bindEvent:function(){this.namedFlow.addEventListener("webkitregionlayoutupdate",this.updateLayout.bind(this))},render:function(){var e=this.namedFlow,t=0;while(e.firstEmptyRegionIndex==-1){this.addPage(),++t;if(t==40)break}this.updateLayout({target:e})},updateLayout:function(e){var t,n,r,i=e.target,s=i.getRegions();i.firstEmptyRegionIndex!==-1&&(r=s[i.firstEmptyRegionIndex],this.delPage(r)),i.overset&&this.addPage()},addPage:function(){var e=this.$template.clone();e.find(this.opt.regionSelecter).attr("id","page_"+this.page),this.pages["page_"+this.page]=e,this.$editSelecter.append(e),this.page++},delPage:function(e){$(this.pages[$(e).attr("id")]).remove()},save:function(){var e=this,t=this.$previewSelecter.html(""),n={};$(e.opt.regionSelecter,this.$editSelecter[0]).each(function(r,i){var s=$(i)[0].webkitGetRegionFlowRanges();n[r]={};var o=e.$template.clone();s.forEach(function(e){n[r].startContainer||(n[r].startContainer=e.startContainer),n[r].startOffset||(n[r].startOffset=e.startOffset),n[r].range||(n[r].range=e.cloneRange()),n[r].endContainer=e.endContainer,n[r].endOffset=e.endOffset});var u=n[r].range,a=n[r].startContainer,f=n[r].startOffset,l=n[r].endContainer,c=n[r].endOffset;a.nodeType==3&&a.parentNode.tagName=="TD"&&(a=a.parentNode,f=0),u.setStart(a,f),u.setEnd(l,c),n[r].newRange=u;var h=e.insertSpan(u);o.attr("data-rangeTop",$(h).offset().top);var p=$(h).parent().offset().top;p>$(h).offset().top&&o.attr("data-rangeTop",$(this).offset().top),u.setStart(a,f),u.setEnd(l,c);var d=u.commonAncestorContainer;if($(d).attr("id")==e.articleSelecterId||$(d).parents("#"+e.articleSelecterId).length){var v=e.execContentsAction(d,function(e){e.appendChild(n[r].newRange.cloneContents())});n[r].cloneContents=v.firstChild}else n[r].cloneContents=n[r].newRange.cloneContents();o.find(e.opt.regionSelecter)[0].appendChild(n[r].cloneContents),o.attr("data-regionTop",$(this).offset().top),o.find("."+e.articleSelecterClass).removeClass(e.articleSelecterClass).removeClass("mce-content-body").attr("contenteditable",!1).removeAttr("id").parent().css("overflow","visible"),o.find(e.opt.regionSelecter).removeClass(e.regionClass),$(t).append(o)})},getPageContent:function(e){this.save();var t=this.$previewSelecter.html();e=e||$.noop,e(t)},preview:function(){this.save(),this.$articleSelecter.hide(),this.$editSelecter.hide(),this.$previewSelecter.show(),this.$previewSelecter.find(".region").each(function(){var e=$(this),t=e.find(".PageEdit_endContainer");e.parent().parent().parent().attr("data-rangetop_1",t.offset().top),e.parent().parent().parent().attr("data-regiontop_1",e.offset().top);var n=e.parent().parent().parent().attr("data-rangetop"),r=e.parent().parent().parent().attr("data-regiontop"),i=e.parent().parent().parent().attr("data-rangetop_1"),s=e.parent().parent().parent().attr("data-regiontop_1"),o=n-r-(i-s);e.parent().parent().parent().attr("data-sub",o),e.find(".flowed ").css("margin-top",e.parent().parent().parent().attr("data-sub")+"px")}),this.clearSpan()},getPreviewContent:function(e){this.$previewSelecter.css("display")=="none"&&this.preview();var t=$("html").clone(!0);t.addClass("inited"),t.find("script").remove(),t.find(".navbar").remove(),t.find(this.opt.editSelecter).remove(),t.find("#"+this.$articleSelecter.attr("id")).remove(),e&&e.call(window,t);var n=t[0].outerHTML;return this.edit(),console.log(n),n},previewOpenWindow:function(){var e=this.getPreviewContent(),t=["<!DOCTYPE HTML>",e].join(""),n=open("","运行html代码预览功能","");n.document.open(),n.document.write(t),n.document.close()},edit:function(){this.$previewSelecter.html(""),this.$previewSelecter.hide(),this.$articleSelecter.show(),this.$editSelecter.show()},isBody:function(e){return e&&e.nodeType==1&&e.tagName.toLowerCase()=="body"},findParent:function(e,t,n){var r=this;if(e&&!r.isBody(e)){e=n?e:e.parentNode;while(e){if(!t||t(e)||r.isBody(e))return t&&!t(e)&&r.isBody(e)?null:e;e=e.parentNode}}return null},findParents:function(e,t,n,r){var i=this,s=t&&(n&&n(e)||!n)?[e]:[];while(e=i.findParent(e,n))s.push(e);return r?s:s.reverse()},execContentsAction:function(e,t){var n=this,r=document.createElement("div"),i=n.findParents(e,!0);for(var s=0;$(i[s]).attr("id")!=n.articleSelecterId;)s++;var o=r,u;for(var a=s,f;f=i[a];a++)u=f.cloneNode(!1),o.appendChild(u),o=u;return t&&t(o),r},pageBreak:function(){this.$previewSelecter.css("display")!="none"&&this.edit();var e=this.getBlockNodeForSelection();$(e).toggleClass(this.pageBreakClass)},insertSpan:function(e){var t=1,n=3,e=e,r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,u=e.commonAncestorContainer;if(r.nodeType!=n){var a=r.childNodes.length;i>a-1&&(i=a-1),e.setStart(r.childNodes[i],0)}e.collapse(!0);var f=document.createElement("span");return f.style["background-color"]="red",f.style.color="red",f.style.width="1px",f.style.height="1px",f.className="PageEdit_endContainer",e.insertNode(f),f},clearSpan:function(){$(".PageEdit_endContainer").remove()},getRange:function(){var e=window.getSelection();if(e.rangeCount)return e.getRangeAt(0)},getBlockNodeForSelection:function(){var e,t=this.getRange();if(!t)return null;e=t.commonAncestorContainer;var n=null;while(e){if(e.nodeType==1){n=e;break}n=e,e=e.parentNode}return n},canvas:function(){var e=this.getPreviewContent(),t=["<script src='jquery-1.9.1.min.js'></script>","<script src='../html2canvas/html2canvas.js'></script>","<script>","html2canvas(document.body, {","    allowTaint: true,","    taintTest: false,","    onrendered: function(canvas) {","       document.body.appendChild(canvas);","       $('.preview').remove();","    }","})","</script>"].join(""),n=["<!DOCTYPE HTML>",e,t].join(""),r=open("","运行html代码预览功能","");r.document.open(),r.document.write(n),r.document.close()},pdf:function(){var e=this.getPreviewContent(),t=["<script src='jquery-1.9.1.min.js'></script>","<script src='../html2canvas/html2canvas.js'></script>","<script src='../jsPDF/jspdf.js'></script>","<script src='../jsPDF/libs/Deflate/adler32cs.js'></script>","<script src='../css3Regions/FileSaverjs/FileSaver.js'></script>","<script src='../css3Regions/Blobjs/BlobBuilder.js'></script>","<script src='../jsPDF/jspdf.plugin.addimage.js'></script>","<script src='../jsPDF/jspdf.plugin.standard_fonts_metrics.js'></script>","<script src='../jsPDF/jspdf.plugin.split_text_to_size.js'></script>","<script src='../jsPDF/jspdf.plugin.from_html.js'></script>","<script>","html2canvas(document.body, {","    allowTaint: true,","    taintTest: false,","    onrendered: function(canvas) {","       document.body.appendChild(canvas);","       $('.preview').remove();","       data = canvas.toDataURL('image/jpeg').slice('data:image/jpeg;base64,'.length);","       data = atob(data);","       doc = new jsPDF();","       doc.addImage(data, 'JPEG',0, 0, 200,906);","       doc.save('output.pdf');","    }","})","</script>"].join(""),n=["<!DOCTYPE HTML>",e,t].join(""),r=open("","运行html代码预览功能","");r.document.open(),r.document.write(n),r.document.close()}},e.defaults={templates:{page:['<center style="display:block;">','    <div  style="text-align:left;background-color:white;width:14.5cm; height:23.97cm; padding-top:96px; padding-right:120px; padding-bottom:96px; padding-left:120px;">','        <div  class="region" style="border:dotted 2px #cccccc;width:100%;height:100%;overflow:hidden;">',"       </div>","   </div>","</center>"].join("")},editSelecter:".edit",regionSelecter:".region",regionContainer:".body"},$.fn.pageEdit=function(t){var t=t||{},n=typeof t;switch(n){case"string":var r=Array.prototype.slice.call(arguments,1);this.each(function(){var e=$.data(this,"pageEdit");if(!e)return!1;if(!$.isFunction(e[t])||t.charAt(0)==="_")return!1;e[t].apply(e,r)});break;case"object":this.each(function(){var n=$.data(this,"pageEdit");n?n.update(t):(n=new e(this,t),n.failed||$.data(this,"pageEdit",n))})}return this}}(),define("iEditor/pageEdit",["jquery"],function(){}),define("iEditor/main",["iEditor/pageEdit","global/main"],function(){window.iEditor={event:{init:function(){this.onClick()},onClick:function(){$("section > article").live("click",function(){var e=$(this).parent("section").attr("id");window.iCurrentModel=e})}},insert:function(e){if(e.length==0)return;var t="";_.each(e,function(e){t+=e.content}),t+="<p><br/></p>",global.change=!0,tinymce.activeEditor.execCommand("mceInsertContent",!1,t)},init:function(){tinymce.init({selector:"section > article",language:"zh_CN",plugins:[["textcolor advlist autolink link autolink image lists charmap print preview hr anchor pagebreak spellchecker"],["searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking"],["save table contextmenu directionality emoticons template paste spaltenListBox statusListBox fmath_formula custom_autosave formatPainter"]],extended_valid_elements:"img[id|data-math|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name]",add_unload_trigger:!1,valid_children:"+div[p],+div[div],+figure[audio],+figure[video]",schema:"html5",inline:!0,menubar:!1,paste_auto_cleanup_on_paste:!0,toolbar:"undo redo | styleselect | forecolor backcolor | blockquote bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | hr | table | link | spaltenListBox | statusListBox | formatPainter |  fmath_formula",statusbar:!1})},addCssRegion:function(){$("body").css("overflow","visible");var e=$(".doc-layout-center .left-column").html();$(".doc-layout-center .left-column").empty(),$(".page-container").pageEdit({templates:{page:e},editSelecter:".doc-layout-center .left-column",regionSelecter:".doc-body",regionContainer:".doc-container"})},initForInteraction:function(){tinymce.init({selector:".iText > span",language:"zh_CN",plugins:[["textcolor advlist autolink link autolink image lists charmap print preview hr anchor pagebreak spellchecker"],["searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking"],["save table contextmenu directionality emoticons template paste custom_autosave"]],extended_valid_elements:"img[id|data-math|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name]",add_unload_trigger:!1,valid_children:"+div[p],+div[div],+figure[audio],+figure[video]",schema:"html5",inline:!0,menubar:!1,fixed_toolbar_container:".doc-layout-center",paste_auto_cleanup_on_paste:!0,toolbar:"undo redo | styleselect | fontsizeselect forecolor backcolor | bullist numlist outdent indent | link | hr | table | ",statusbar:!1,setup:function(e){e.on("change setcontent paste keyup",function(e){interaction.current.trigger("change:text")})}})},initForRichtext:function(e){tinymce.init({selector:"section > article",language:"zh_CN",plugins:[["textcolor advlist autolink link autolink image lists charmap print preview hr anchor pagebreak spellchecker"],["searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking"],["save table contextmenu directionality emoticons template paste custom_autosave"]],extended_valid_elements:"img[id|data-math|class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name]",add_unload_trigger:!1,valid_children:"+div[p],+div[div],+figure[audio],+figure[video]",schema:"html5",inline:!0,menubar:!1,paste_auto_cleanup_on_paste:!0,toolbar:"undo redo | styleselect | fontsizeselect forecolor backcolor | blockquote bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | hr | table | link | spaltenListBox | statusListBox | formatPainter |  fmath_formula",statusbar:!1})}}}),define("interaction/model/richtext",["interaction/model/base","text!interaction/template/richtext.js","iEditor/main"],function(){interaction.model.RichText=interaction.model.base.extend({defaults:{iType:"RichText",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:500,iHeight:40},landscape:{iStartx:400,iStarty:200,iWidth:500,iHeight:40}},iDetail:{iTitle:"",iText:"",iBackground:!1,iScrollable:!1},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(0,105,114,0.5)",iResources:null,iAnimationProperties:[{id:"animations",type:"object"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.RichText({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.RichText=interaction.view.Base.extend({events:{"mousedown .iText":"focus","click .iText":"focus","click button.action-done":"confirm","click button.action-del":"removemodel","click button.action-cancel":"revert",mouseover:"mouseover",mouseout:"mouseout","dblclick .iText":"seteditor"},renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderinfosave(),this.bindinfo(),this.$el.find("iframe").css("height",this.getcommon().iHeight+"px")},updateinfo:function(){this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.bindinfo(),this.$el.find("iframe").css("height",this.getcommon().iHeight+"px")},render:function(){this.activeEditor=!1;var e=this.model.toJSON(),t=require("text!interaction/template/richtext.js"),n=_.template(t,this.model.toJSON());return $(this.model.get("iParentdiv")).append(n),this.setElement(interaction.div_find(this.model.id)),this.updatebackground(),this.updatetext(),this.model.get("iDraggable")&&this.setdraggable(),this.infoel=$("#info_attributes").children(".setting-body"),this},seteditor:function(){if(!interaction.current||interaction.current.id!=this.model.id)return;var e="tEditor_"+this.model.id;return this.activeEditor||(tinymce.execCommand("mceAddEditor",!1,e),this.activeEditor=!0,this.$el.draggable("disable"),this.$el.resizable("disable")),!1},beforeconfirm:function(){var e="tEditor_"+this.model.id;this.activeEditor&&tinymce.execCommand("mceRemoveEditor",!1,e),$("#"+e).blur(),this.activeEditor=!1,this.$el.draggable("enable"),this.settext()},gettext:function(){var e=this.$el.find(".iText").html();return e},settext:function(){var e=this.$el.find(".iText").html();this.setdetail({iText:e}),this.model.trigger("change:text")},updatetext:function(){},setdraggable:function(){if(!this.model.get("iDraggable"))return!1;var e=this,t=this.model;this.$el.draggable({create:function(e,t){},drag:function(t,n){var r=$(this).position(),i=e.getcommon();i.iStartx=Number(r.left),i.iStarty=Number(r.top),e.setcommon(i),e.updatepos(),e.updateinfo()},stop:function(t,n){var r=$(this).position(),i=e.getcommon();i.iStartx=Number(r.left),i.iStarty=Number(r.top),e.setcommon(i),e.updatepos(),e.updateinfo()}})},keyshandle:function(e,t){var n=e.keyCode?e.keyCode:e.which;if(this.activeEditor){if(n==27){var r="tEditor_"+this.model.id;$("#"+r).blur(),tinymce.execCommand("mceRemoveEditor",!1,r),this.activeEditor=!1,this.$el.draggable("enable"),this.$el.resizable("enable")}return}var i=this.getcommon(),s=this.model.id,o=!1;e.shift&&(this.options.aspectRatio=!0),n==27,n==37&&(o=!0,i.iStartx=Number(i.iStartx)-1,i.iWidth=Number(i.iWidth)+1),n==38&&(i.iStarty=Number(i.iStarty)-1,i.iHeight=Number(i.iHeight)+1,o=!0),n==39&&(i.iWidth=Number(i.iWidth)+1,o=!0),n==40&&(i.iHeight=Number(i.iHeight)+1,o=!0);if(n==46||n==8)this.removemodel(),e.preventDefault();this.otherkeyshandle(n),o==1&&(e.preventDefault(),check="ok",check=="ok"&&(this.setcommon(i),this.updatepos(),this.updateinfo(),this.updatebackground()))}})}),define("interaction/model/root",["interaction/model/base"],function(){interaction.model.Root=interaction.model.base.extend({defaults:{iType:"Root",iLock:!0,iVisibility:!0,iCommon:null,iDetail:{},iParent:null,iChild:null,iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iParentdiv:"body",iSync:!1,iZindex:"-1",iAutofocus:!1,iKeyscontrol:!1,callback:null},setdominfo:function(e){},setdomfield:function(e){},reseturl:function(){},setcollection:function(e){},setview:function(e){this.iview=new interaction.view.Root({model:this})}}),interaction.view.Root=interaction.view.Base.extend({setimageplus:function(){return""},getimagename:function(e){return"iImg"}})}),define("interaction/model/slide",["interaction/model/base"],function(){interaction.model.Slide=interaction.model.base.extend({defaults:{iType:"Slide",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iSlidetype:"横向",iAutoplay:!1,iRepeat:!1,iInterval:"",iFade:"Fade",iSlipable:!1,iPagenumber:!1,iFullview:!1,iWholeswitch:!1,iImglist:null},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(1,115,9,0.5)",iResourcesProperties:[{id:"iImg",type:"mutiple",category:"image"}],iAnimationProperties:[{id:"animations",type:"object"}],iActionProperties:[{id:"actions",type:"object"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.Slide({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Slide=interaction.view.Base.extend({renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.infoel.append(interaction.template.detail[this.model.get("iType")+"Type"](this.model.toJSON())),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderinfosave(),this.bindinfo()},updateinfo:function(){this.infoel.find(".typedetail").replaceWith(interaction.template.detail.SlideType(this.model.toJSON())),this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.bindinfo()},getBackGroundUrl:function(){var e=this.model.get("iDetail");return e.iImg&&!_.isEmpty(e.iImg)?_.isString(e.iImg[0])?e.iImg[0]:e.iImg[0].picture:!1}})}),define("interaction/model/showhide",["interaction/model/base"],function(){interaction.model.ShowHide=interaction.model.base.extend({defaults:{iType:"ShowHide",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:31,iHeight:31},landscape:{iStartx:400,iStarty:200,iWidth:31,iHeight:31}},iDetail:{iStatus:!1,iDisplaylist:[],iIconon:"",iIconoff:"",iElementlist:[],iItemlist:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!1,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(193,56,2,0.5)",iResources:null,iElementattr:!0,iIconon:null,iIconoff:null,iResourcesProperties:[{id:"iIconon",type:"single",category:"other"},{id:"iIconoff",type:"single",category:"other"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.ShowHide({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.ShowHide=interaction.view.Base.extend({renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.renderposition(!0),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.updateelementattr(),this.renderinfosave(),this.bindinfo()},updateinfo:function(){this.updateposition(!0),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.updateelementattr(),this.bindinfo()},updatebackground:function(){var e="n/i_tagicon.png";e?(this.$el.css("background-color","transparent"),this.$el.css("background-image","url("+e+")"),this.$el.css("background-repeat","no-repeat"),this.$el.css("background-position","center"),this.$el.css("background-size",this.$el.css("width")+" "+this.$el.css("height"))):(this.$el.css("background-image","none"),this.$el.css("background-color",this.model.get("iBackground")))},info_focus:function(){interaction.changeTab("info_attributes");var e=this.getdetail(),t=interaction.elementlist.pluck("id");e.iItemlist=_.filter(e.iItemlist,function(e){return _.include(t,e)}),this.updateinfo(),this.updateresources(),this.setdetail({iItemlist:e.iItemlist}),this.bindinfo()}})}),define("interaction/model/video",["interaction/model/base"],function(){interaction.model.Video=interaction.model.base.extend({defaults:{iType:"Video",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iVideotype:"mediafile",iAdapt:!1,iFullview:!1,iAutoplay:!1,iRepeat:!1,iImg:null,iFile:null},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(255,75,75,0.5)",iResourcesProperties:[{id:"iFile",type:"single",category:"video"}],iAnimationProperties:[{id:"animations",type:"media"}]},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.Video({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Video=interaction.view.Base.extend({renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.infoel.append(interaction.template.detail[this.model.get("iType")+"Type"](this.model.toJSON())),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderinfosave(),this.bindinfo()},updateinfo:function(){this.infoel.find(".typedetail").replaceWith(interaction.template.detail.VideoType(this.model.toJSON())),this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.bindinfo()}})}),define("interaction/model/webcontent",["interaction/model/base"],function(){interaction.model.Webcontent=interaction.model.base.extend({defaults:{iType:"Webcontent",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iWebcontenttype:"local",iBackground:!1,iScrollable:!1,iUrl:"",iFile:null},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:require("text!interaction/template/element.js"),iParentdiv:".interaction-area",iAutoindex:!1,iSync:!0,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(144,163,12,0.5)",iResources:null},setcollection:function(){interaction.elementlist.get(this.id)||interaction.elementlist.add(this)},setview:function(e){this.iview=new interaction.view.Webcontent({model:this})},setsyncmodel:function(){var e=this.toJSON();e.iSync=!1,this.dommodel=new interaction.model.Dom(e)}}),interaction.view.Webcontent=interaction.view.Base.extend({renderinfo:function(){this.infoel.empty(),this.renderbaseinfo(),this.infoel.append(interaction.template.detail[this.model.get("iType")+"Type"](this.model.toJSON())),this.renderposition(),this.infoel.append(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.renderinfosave(),this.bindinfo()},updateinfo:function(){this.infoel.find(".typedetail").replaceWith(interaction.template.detail.WebcontentType(this.model.toJSON())),this.updateposition(),this.infoel.find(".detail").replaceWith(interaction.template.detail[this.model.get("iType")](this.model.toJSON())),this.bindinfo()}})}),define("interaction/model/main",["interaction/model/action","interaction/model/animation","interaction/model/animationgroup","interaction/model/audio","interaction/model/cycleimage","interaction/model/dom","interaction/model/element","interaction/model/elementattr","interaction/model/image","interaction/model/link","interaction/model/page","interaction/model/resources","interaction/model/richtext","interaction/model/root","interaction/model/slide","interaction/model/showhide","interaction/model/video","interaction/model/webcontent"],function(){return});var paper=new function(){var Base=new function(){function e(e,t,n){if(p)try{return delete e[t],p(e,t,n)}catch(r){}return(n.get||n.set)&&e.__defineGetter__?(n.get&&e.__defineGetter__(t,n.get),n.set&&e.__defineSetter__(t,n.set)):e[t]=n.value,e}function t(e,t){if(d)try{return d(e,t)}catch(n){}var r=e.__lookupGetter__&&e.__lookupGetter__(t);return r?{get:r,set:e.__lookupSetter__(t),enumerable:!0,configurable:!0}:e.hasOwnProperty(t)?{value:e[t],enumerable:!0,configurable:!0,writable:!0}:null}function n(n,r,i,o,u,a){function l(s,a,l,p){var a=a||(a=t(r,s))&&(a.get?a:a.value),d=typeof a=="function",v=a,m=u||d?a&&a.get?s in n:n[s]:null;if((l||a!==undefined&&r.hasOwnProperty(s))&&(!u||!m)){if(d){if(m&&/\bthis\.base\b/.test(a)){var g=o&&o[s]==m;v=function(){var n=t(this,"base");e(this,"base",{value:g?o[s]:m,configurable:!0});try{return a.apply(this,arguments)}finally{n?e(this,"base",n):delete this.base}},v.toString=function(){return a.toString()},v.valueOf=function(){return a.valueOf()}}c&&a.length===0&&(h=s.match(/^(get|is)(([A-Z])(.*))$/))&&c.push([h[3].toLowerCase()+h[4],h[2]])}if(!v||d||!v.get)v={value:v,writable:!0};(t(n,s)||{configurable:!0}).configurable&&(v.configurable=!0,v.enumerable=i),e(n,s,v)}p&&d&&(!u||!p[s])&&(p[s]=function(e){return e&&n[s].apply(e,f.call(arguments,1))})}var c,h;if(r){c=[];for(var p in r)r.hasOwnProperty(p)&&!s.test(p)&&l(p,null,!0,a);l("toString"),l("valueOf");for(var d=0,v=c&&c.length;d<v;d++)try{var h=c[d],m=h[1];l(h[0],{get:n["get"+m]||n["is"+m],set:n["set"+m]},!0)}catch(g){}}return n}function r(e,t,n,r){try{e&&(r||r===undefined&&a(e)?l:c).call(e,t,n=n||e)}catch(i){if(i!==Base.stop)throw i}return n}function i(e){return r(e,function(e,t){this[t]=e},new e.constructor)}var s=/^(statics|generics|preserve|enumerable|prototype|toString|valueOf)$/,o=Object.prototype,u=o.toString,o=Array.prototype,a=Array.isArray=Array.isArray||function(e){return u.call(e)==="[object Array]"},f=o.slice,l=o.forEach||function(e,t){for(var n=0,r=this.length;n<r;n++)e.call(t,this[n],n,this)},c=function(e,t){for(var n in this)this.hasOwnProperty(n)&&e.call(t,this[n],n,this)},h=Object.create||function(e){return{__proto__:e}},p=Object.defineProperty,d=Object.getOwnPropertyDescriptor;return n(function(){},{inject:function(e){if(e){var t=this.prototype,r=Object.getPrototypeOf(t).constructor,i=e.statics===!0?e:e.statics;i!=e&&n(t,e,e.enumerable,r&&r.prototype,e.preserve,e.generics&&this),n(this,i,!0,r,e.preserve)}for(var s=1,o=arguments.length;s<o;s++)this.inject(arguments[s]);return this},extend:function(t){var r=function(){if(this.initialize)return this.initialize.apply(this,arguments)};return r.prototype=h(this.prototype),r.toString=function(){return(this.prototype.initialize||function(){}).toString()},e(r.prototype,"constructor",{value:r,writable:!0,configurable:!0}),n(r,this,!0),arguments.length?this.inject.apply(r,arguments):r}},!0).inject({inject:function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e],arguments[e].enumerable);return this},extend:function(){var e=h(this);return e.inject.apply(e,arguments)},each:function(e,t){return r(this,e,t)},clone:function(){return i(this)},statics:{each:r,clone:i,define:e,describe:t,create:function(e){return h(e.prototype)},isPlainObject:function(e){var t=e!==null&&typeof e=="object"&&Object.getPrototypeOf(e);return t&&(t===Object.prototype||t===Base.prototype)},check:function(e){return!!e||e===0},pick:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!==undefined)return arguments[e];return null},stop:{}}})};this.Base=Base.inject({generics:!0,clone:function(){return new this.constructor(this)},toString:function(){return this._id!=null?(this._type||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+Base.each(this,function(e,t){if(!/^_/.test(t)){var n=typeof e;this.push(t+": "+(n==="number"?Format.number(e):n==="string"?"'"+e+"'":e))}},[]).join(", ")+" }"},exportJson:function(e){return Base.exportJson(this,e)},toJSON:function(){return Base.serialize(this)},_set:function(e){if(Base.isPlainObject(e)){for(var t in e)e.hasOwnProperty(t)&&t in this&&(this[t]=e[t]);return!0}},statics:{_types:{},_uid:0,extend:function(e){var t=this.base.apply(this,arguments);return e._type&&(Base._types[e._type]=t),t},equals:function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&typeof t[n]=="undefined")return!1;return!0}if(e==t)return!0;if(e&&e.equals)return e.equals(t);if(t&&t.equals)return t.equals(e);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!Base.equals(e[r],t[r]))return!1;return!0}if(e&&typeof e=="object"&&t&&typeof t=="object"){if(!n(e,t)||!n(t,e))return!1;for(var r in e)if(e.hasOwnProperty(r)&&!Base.equals(e[r],t[r]))return!1;return!0}return!1},read:function(e,t,n,r,i){if(this===Base){var s=this.peek(e,t);return e._index++,e._read=1,s}var o=this.prototype,u=o._readIndex,a=t||u&&e._index||0;n||(n=e.length-a);var f=e[a];return f instanceof this||(o._readNull||i)&&f==null&&n<=1?(u&&(e._index=a+1),f&&r?f.clone():f):(f=Base.create(this),u&&(f._read=!0),f=f.initialize.apply(f,a>0||n<e.length?Array.prototype.slice.call(e,a,a+n):e)||f,u&&(e._index=a+f._read,e._read=f._read,delete f._read),f)},peek:function(e,t){return e[e._index=t||e._index||0]},readAll:function(e,t,n){var r=[],i;for(var s=t||0,o=e.length;s<o;s++)r.push(Array.isArray(i=e[s])?this.read(i,0,0,n):this.read(e,s,1,n));return r},readNamed:function(e,t){var n=this.getNamed(e,t);return this.read(n!=null?[n]:e)},getNamed:function(e,t){var n=e[0];e._hasObject===undefined&&(e._hasObject=e.length===1&&Base.isPlainObject(n));if(e._hasObject)return t?n[t]:n},hasNamed:function(e,t){return!!this.getNamed(e,t)},serialize:function(e,t,n,r){t=t||{};var i=!r,s;i&&(r={length:0,definitions:{},references:{},add:function(e,t){var n="#"+e._id,r=this.references[n];return r||(this.length++,this.definitions[n]=t.call(e),r=this.references[n]=[n]),r}});if(e&&e._serialize)s=e._serialize(t,r),e._type&&!n&&s[0]!==e._type&&s.unshift(e._type);else if(Array.isArray(e)){s=[];for(var o=0,u=e.length;o<u;o++)s[o]=Base.serialize(e[o],t,n,r)}else if(Base.isPlainObject(e)){s={};for(var o in e)e.hasOwnProperty(o)&&(s[o]=Base.serialize(e[o],t,n,r))}else typeof e=="number"?s=Format.number(e,t.precision):s=e;return i&&r.length>0?[["dictionary",r.definitions],s]:s},deserialize:function(e,t){var n=e;t=t||{};if(Array.isArray(e)){var r=e[0],i=r==="dictionary";if(!i){if(t.dictionary&&e.length==1&&/^#/.test(r))return t.dictionary[r];r=Base._types[r]}n=[];for(var s=r?1:0,o=e.length;s<o;s++)n.push(Base.deserialize(e[s],t));if(i)t.dictionary=n[0];else if(r){var u=n;n=Base.create(r),n.initialize.apply(n,u)}}else if(Base.isPlainObject(e)){n={};for(var a in e)n[a]=Base.deserialize(e[a],t)}return n},exportJson:function(e,t){return JSON.stringify(Base.serialize(e,t))},importJson:function(e){return Base.deserialize(JSON.parse(e))},splice:function(e,t,n,r){var i=t&&t.length,s=n===undefined;n=s?e.length:n,n>e.length&&(n=e.length);for(var o=0;o<i;o++)t[o]._index=n+o;if(s)return e.push.apply(e,t),[];var u=[n,r];t&&u.push.apply(u,t);var a=e.splice.apply(e,u);for(var o=0,f=a.length;o<f;o++)delete a[o]._index;for(var o=n+i,f=e.length;o<f;o++)e[o]._index=o;return a},merge:function(){return Base.each(arguments,function(e){Base.each(e,function(e,t){this[t]=e},this)},new Base,!0)},capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Callback={attach:function(e,t){if(typeof e!="string"){Base.each(e,function(e,t){this.attach(t,e)},this);return}var n=this._eventTypes[e];if(n){var r=this._handlers=this._handlers||{};r=r[e]=r[e]||[],r.indexOf(t)==-1&&(r.push(t),n.install&&r.length==1&&n.install.call(this,e))}},detach:function(e,t){if(typeof e!="string"){Base.each(e,function(e,t){this.detach(t,e)},this);return}var n=this._eventTypes[e],r=this._handlers&&this._handlers[e],i;n&&r&&(!t||(i=r.indexOf(t))!=-1&&r.length==1?(n.uninstall&&n.uninstall.call(this,e),delete this._handlers[e]):i!=-1&&r.splice(i,1))},fire:function(e,t){var n=this._handlers&&this._handlers[e];if(!n)return!1;var r=[].slice.call(arguments,1);return Base.each(n,function(e){e.apply(this,r)===!1&&t&&t.stop&&t.stop()},this),!0},responds:function(e){return!!this._handlers&&!!this._handlers[e]},statics:{inject:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e],r=n._events;if(r){var i={};Base.each(r,function(e,t){var r=typeof e=="string",s=r?e:t,o=Base.capitalize(s),u=s.substring(2).toLowerCase();i[u]=r?{}:e,s="_"+s,n["get"+o]=function(){return this[s]},n["set"+o]=function(e){e?this.attach(u,e):this[s]&&this.detach(u,this[s]),this[s]=e}}),n._eventTypes=i}this.base(n)}return this}}},PaperScope=this.PaperScope=Base.extend({initialize:function(e){paper=this,this.project=null,this.projects=[],this.tools=[],this.palettes=[],this._id=e&&(e.getAttribute("id")||e.src)||"paperscope-"+PaperScope._id++,e&&e.setAttribute("id",this._id),PaperScope._scopes[this._id]=this;if(!this.support){var t=CanvasProvider.getContext(1,1);PaperScope.prototype.support={nativeDash:"setLineDash"in t||"mozDash"in t},CanvasProvider.release(t)}},version:.8,getView:function(){return this.project&&this.project.view},getTool:function(){return this._tool||(this._tool=new Tool),this._tool},evaluate:function(e){var t=PaperScript.evaluate(e,this);return View.updateFocus(),t},install:function(e){var t=this;Base.each(["project","view","tool"],function(n){Base.define(e,n,{configurable:!0,writable:!0,get:function(){return t[n]}})});for(var n in this)!/^(version|_id)/.test(n)&&!(n in e)&&(e[n]=this[n])},setup:function(e){return paper=this,this.project=new Project(e),this},clear:function(){for(var e=this.projects.length-1;e>=0;e--)this.projects[e].remove();for(var e=this.tools.length-1;e>=0;e--)this.tools[e].remove();for(var e=this.palettes.length-1;e>=0;e--)this.palettes[e].remove()},remove:function(){this.clear(),delete PaperScope._scopes[this._id]},statics:{_scopes:{},_id:0,get:function(e){return typeof e=="object"&&(e=e.getAttribute("id")),this._scopes[e]||null}}}),PaperScopeItem=Base.extend(Callback,{initialize:function(e){this._scope=paper,this._index=this._scope[this._list].push(this)-1,(e||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var e=this._scope[this._reference];return e&&e!=this&&e.fire("deactivate"),this._scope[this._reference]=this,this.fire("activate",e),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(Base.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)}}),Point=this.Point=Base.extend({_type:"Point",_readIndex:!0,initialize:function(e,t){var n=typeof e;if(n==="number"){var r=typeof t=="number";this.x=e,this.y=r?t:e,this._read&&(this._read=r?2:1)}else n==="undefined"||e===null?(this.x=this.y=0,this._read&&(this._read=e===null?1:0)):(Array.isArray(e)?(this.x=e[0],this.y=e.length>1?e[1]:e[0]):e.x!=null?(this.x=e.x,this.y=e.y):e.width!=null?(this.x=e.width,this.y=e.height):e.angle!=null?(this.x=e.length,this.y=0,this.setAngle(e.angle)):(this.x=this.y=0,this._read&&(this._read=0)),this._read&&(this._read=1))},set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return e=Point.read(arguments),this.x==e.x&&this.y==e.y},clone:function(){return Point.create(this.x,this.y)},toString:function(){var e=Format.number;return"{ x: "+e(this.x)+", y: "+e(this.y)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.x,n),t(this.y,n)]},add:function(e){return e=Point.read(arguments),Point.create(this.x+e.x,this.y+e.y)},subtract:function(e){return e=Point.read(arguments),Point.create(this.x-e.x,this.y-e.y)},multiply:function(e){return e=Point.read(arguments),Point.create(this.x*e.x,this.y*e.y)},divide:function(e){return e=Point.read(arguments),Point.create(this.x/e.x,this.y/e.y)},modulo:function(e){return e=Point.read(arguments),Point.create(this.x%e.x,this.y%e.y)},negate:function(){return Point.create(-this.x,-this.y)},transform:function(e){return e?e._transformPoint(this):this},getDistance:function(e,t){e=Point.read(arguments);var n=e.x-this.x,r=e.y-this.y,i=n*n+r*r;return t?i:Math.sqrt(i)},getLength:function(){var e=this.x*this.x+this.y*this.y;return arguments.length&&arguments[0]?e:Math.sqrt(e)},setLength:function(e){if(this.isZero()){var t=this._angle||0;this.set(Math.cos(t)*e,Math.sin(t)*e)}else{var n=e/this.getLength();n==0&&this.getAngle(),this.set(this.x*n,this.y*n)}return this},normalize:function(e){e===undefined&&(e=1);var t=this.getLength(),n=t!=0?e/t:0,r=Point.create(this.x*n,this.y*n);return r._angle=this._angle,r},getAngle:function(){return this.getAngleInRadians(arguments[0])*180/Math.PI},setAngle:function(e){e=this._angle=e*Math.PI/180;if(!this.isZero()){var t=this.getLength();this.set(Math.cos(e)*t,Math.sin(e)*t)}return this},getAngleInRadians:function(){if(arguments[0]===undefined)return this._angle==null&&(this._angle=Math.atan2(this.y,this.x)),this._angle;var e=Point.read(arguments),t=this.getLength()*e.getLength();return Numerical.isZero(t)?NaN:Math.acos(this.dot(e)/t)},getAngleInDegrees:function(){return this.getAngle(arguments[0])},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3},getDirectedAngle:function(e){return e=Point.read(arguments),Math.atan2(this.cross(e),this.dot(e))*180/Math.PI},rotate:function(e,t){if(e===0)return this.clone();e=e*Math.PI/180;var n=t?this.subtract(t):this,r=Math.sin(e),i=Math.cos(e);return n=Point.create(n.x*i-n.y*r,n.y*i+n.x*r),t?n.add(t):n},isInside:function(e){return e.contains(this)},isClose:function(e,t){return this.getDistance(e)<t},isColinear:function(e){return this.cross(e)<1e-5},isOrthogonal:function(e){return this.dot(e)<1e-5},isZero:function(){return Numerical.isZero(this.x)&&Numerical.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(e){return e=Point.read(arguments),this.x*e.x+this.y*e.y},cross:function(e){return e=Point.read(arguments),this.x*e.y-this.y*e.x},project:function(e){e=Point.read(arguments);if(e.isZero())return Point.create(0,0);var t=this.dot(e)/e.dot(e);return Point.create(e.x*t,e.y*t)},statics:{create:function(e,t){var n=Base.create(Point);return n.x=e,n.y=t,n},min:function(e,t){var n=Point.read(arguments);return _point2=Point.read(arguments),Point.create(Math.min(n.x,_point2.x),Math.min(n.y,_point2.y))},max:function(e,t){var n=Point.read(arguments);return _point2=Point.read(arguments),Point.create(Math.max(n.x,_point2.x),Math.max(n.y,_point2.y))},random:function(){return Point.create(Math.random(),Math.random())}}},new function(){return Base.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return Point.create(t(this.x),t(this.y))}},{})}),LinkedPoint=Point.extend({set:function(e,t,n){return this._x=e,this._y=t,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner[this._setter](this)},statics:{create:function(e,t,n,r,i){if(i)return Point.create(n,r);var s=Base.create(LinkedPoint);return s._x=n,s._y=r,s._owner=e,s._setter=t,s}}}),Size=this.Size=Base.extend({_type:"Size",_readIndex:!0,initialize:function(e,t){var n=typeof e;if(n==="number"){var r=typeof t=="number";this.width=e,this.height=r?t:e,this._read&&(this._read=r?2:1)}else n==="undefined"||e===null?(this.width=this.height=0,this._read&&(this._read=e===null?1:0)):(Array.isArray(e)?(this.width=e[0],this.height=e.length>1?e[1]:e[0]):e.width!=null?(this.width=e.width,this.height=e.height):e.x!=null?(this.width=e.x,this.height=e.y):(this.width=this.height=0,this._read&&(this._read=0)),this._read&&(this._read=1))},set:function(e,t){return this.width=e,this.height=t,this},equals:function(e){return e=Size.read(arguments),this.width==e.width&&this.height==e.height},clone:function(){return Size.create(this.width,this.height)},toString:function(){var e=Format.number;return"{ width: "+e(this.width)+", height: "+e(this.height)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.width,n),t(this.height,n)]},add:function(e){return e=Size.read(arguments),Size.create(this.width+e.width,this.height+e.height)},subtract:function(e){return e=Size.read(arguments),Size.create(this.width-e.width,this.height-e.height)},multiply:function(e){return e=Size.read(arguments),Size.create(this.width*e.width,this.height*e.height)},divide:function(e){return e=Size.read(arguments),Size.create(this.width/e.width,this.height/e.height)},modulo:function(e){return e=Size.read(arguments),Size.create(this.width%e.width,this.height%e.height)},negate:function(){return Size.create(-this.width,-this.height)},isZero:function(){return Numerical.isZero(this.width)&&Numerical.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{create:function(e,t){return Base.create(Size).set(e,t)},min:function(e,t){return Size.create(Math.min(e.width,t.width),Math.min(e.height,t.height))},max:function(e,t){return Size.create(Math.max(e.width,t.width),Math.max(e.height,t.height))},random:function(){return Size.create(Math.random(),Math.random())}}},new function(){return Base.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return Size.create(t(this.width),t(this.height))}},{})}),LinkedSize=Size.extend({set:function(e,t,n){return this._width=e,this._height=t,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(e){this._width=e,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e,this._owner[this._setter](this)},statics:{create:function(e,t,n,r,i){if(i)return Size.create(n,r);var s=Base.create(LinkedSize);return s._width=n,s._height=r,s._owner=e,s._setter=t,s}}}),Rectangle=this.Rectangle=Base.extend({_type:"Rectangle",_readIndex:!0,initialize:function(e,t,n,r){var i=typeof e,s=0;i==="number"?(this.x=e,this.y=t,this.width=n,this.height=r,s=4):i==="undefined"||e===null?(this.x=this.y=this.width=this.height=0,s=e===null?1:0):arguments.length===1&&(Array.isArray(e)?(this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3],s=1):e.x!==undefined||e.width!==undefined?(this.x=e.x||0,this.y=e.y||0,this.width=e.width||0,this.height=e.height||0,s=1):e.from===undefined&&e.to===undefined&&(this.x=this.y=this.width=this.height=0,this._set(e),s=1));if(!s){var o=Point.readNamed(arguments,"from"),u=Base.peek(arguments);this.x=o.x,this.y=o.y;if(u&&u.x!==undefined||Base.hasNamed(arguments,"to")){var a=Point.readNamed(arguments,"to");this.width=a.x-o.x,this.height=a.y-o.y,this.width<0&&(this.x=a.x,this.width=-this.width),this.height<0&&(this.y=a.y,this.height=-this.height)}else{var f=Size.read(arguments);this.width=f.width,this.height=f.height}s=arguments._index}this._read&&(this._read=s)},set:function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this},clone:function(){return Rectangle.create(this.x,this.y,this.width,this.height)},equals:function(e){return e=Rectangle.read(arguments),this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},toString:function(){var e=Format.number;return"{ x: "+e(this.x)+", y: "+e(this.y)+", width: "+e(this.width)+", height: "+e(this.height)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.x,n),t(this.y,n),t(this.width,n),t(this.height,n)]},getPoint:function(){return LinkedPoint.create(this,"setPoint",this.x,this.y,arguments[0])},setPoint:function(e){e=Point.read(arguments),this.x=e.x,this.y=e.y},getSize:function(){return LinkedSize.create(this,"setSize",this.width,this.height,arguments[0])},setSize:function(e){e=Size.read(arguments),this.width=e.width,this.height=e.height},getLeft:function(){return this.x},setLeft:function(e){this.width-=e-this.x,this.x=e},getTop:function(){return this.y},setTop:function(e){this.height-=e-this.y,this.y=e},getRight:function(){return this.x+this.width},setRight:function(e){this.width=e-this.x},getBottom:function(){return this.y+this.height},setBottom:function(e){this.height=e-this.y},getCenterX:function(){return this.x+this.width*.5},setCenterX:function(e){this.x=e-this.width*.5},getCenterY:function(){return this.y+this.height*.5},setCenterY:function(e){this.y=e-this.height*.5},getCenter:function(){return LinkedPoint.create(this,"setCenter",this.getCenterX(),this.getCenterY(),arguments[0])},setCenter:function(e){return e=Point.read(arguments),this.setCenterX(e.x),this.setCenterY(e.y),this},isEmpty:function(){return this.width==0||this.height==0},contains:function(e){return e&&e.width!==undefined||(Array.isArray(e)?e:arguments).length==4?this._containsRectangle(Rectangle.read(arguments)):this._containsPoint(Point.read(arguments))},_containsPoint:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t+e.width<=this.x+this.width&&n+e.height<=this.y+this.height},intersects:function(e){return e=Rectangle.read(arguments),e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x+this.width&&e.y<this.y+this.height},intersect:function(e){e=Rectangle.read(arguments);var t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),r=Math.min(this.x+this.width,e.x+e.width),i=Math.min(this.y+this.height,e.y+e.height);return Rectangle.create(t,n,r-t,i-n)},unite:function(e){e=Rectangle.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x+e.width),i=Math.max(this.y+this.height,e.y+e.height);return Rectangle.create(t,n,r-t,i-n)},include:function(e){e=Point.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x),i=Math.max(this.y+this.height,e.y);return Rectangle.create(t,n,r-t,i-n)},expand:function(e,t){return t===undefined&&(t=e),Rectangle.create(this.x-e/2,this.y-t/2,this.width+e,this.height+t)},scale:function(e,t){return this.expand(this.width*e-this.width,this.height*(t===undefined?e:t)-this.height)},statics:{create:function(e,t,n,r){return Base.create(Rectangle).set(e,t,n,r)}}},new function(){return Base.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,t){var n=e.join(""),r=/^[RL]/.test(n);t>=4&&(e[1]+=r?"Y":"X");var i=e[r?0:1],s=e[r?1:0],o="get"+i,u="get"+s,a="set"+i,f="set"+s,l="get"+n,c="set"+n;this[l]=function(){return LinkedPoint.create(this,c,this[o](),this[u](),arguments[0])},this[c]=function(e){e=Point.read(arguments),this[a](e.x),this[f](e.y)}},{})}),LinkedRectangle=Rectangle.extend({set:function(e,t,n,r,i){return this._x=e,this._y=t,this._width=n,this._height=r,i||this._owner[this._setter](this),this},statics:{create:function(e,t,n,r,i,s){var o=Base.create(LinkedRectangle).set(n,r,i,s,!0);return o._owner=e,o._setter=t,o}}},new function(){var e=Rectangle.prototype;return Base.each(["x","y","width","height"],function(e){var t=Base.capitalize(e),n="_"+e;this["get"+t]=function(){return this[n]},this["set"+t]=function(e){this[n]=e,this._dontNotify||this._owner[this._setter](this)}},Base.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(t){var n="set"+t;this[n]=function(t){this._dontNotify=!0,e[n].apply(this,arguments),delete this._dontNotify,this._owner[this._setter](this)}},{isSelected:function(){return this._owner._boundsSelected},setSelected:function(e){var t=this._owner;t.setSelected&&(t._boundsSelected=e,t.setSelected(e||t._selectedSegmentState>0))}}))}),Matrix=this.Matrix=Base.extend({_type:"Matrix",initialize:function(e){var t=arguments.length,n=!0;t==6?this.set.apply(this,arguments):t==1?e instanceof Matrix?this.set(e._a,e._c,e._b,e._d,e._tx,e._ty):Array.isArray(e)?this.set.apply(this,e):n=!1:t==0?this.reset():n=!1;if(!n)throw new Error("Unsupported matrix parameters")},set:function(e,t,n,r,i,s){return this._a=e,this._c=t,this._b=n,this._d=r,this._tx=i,this._ty=s,this},_serialize:function(e){return Base.serialize(this.getValues(),e)},clone:function(){return Matrix.create(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(e){return e&&this._a==e._a&&this._b==e._b&&this._c==e._c&&this._d==e._d&&this._tx==e._tx&&this._ty==e._ty},toString:function(){var e=Format.number;return"[["+[e(this._a),e(this._b),e(this._tx)].join(", ")+"], ["+[e(this._c),e(this._d),e(this._ty)].join(", ")+"]]"},reset:function(){return this._a=this._d=1,this._c=this._b=this._tx=this._ty=0,this},scale:function(e,t){var n=Point.read(arguments),r=Point.read(arguments,0,0,!1,!0);return r&&this.translate(r),this._a*=n.x,this._c*=n.x,this._b*=n.y,this._d*=n.y,r&&this.translate(r.negate()),this},translate:function(e){e=Point.read(arguments);var t=e.x,n=e.y;return this._tx+=t*this._a+n*this._b,this._ty+=t*this._c+n*this._d,this},rotate:function(e,t){t=Point.read(arguments,1),e=e*Math.PI/180;var n=t.x,r=t.y,i=Math.cos(e),s=Math.sin(e),o=n-n*i+r*s,u=r-n*s-r*i,a=this._a,f=this._b,l=this._c,c=this._d;return this._a=i*a+s*f,this._b=-s*a+i*f,this._c=i*l+s*c,this._d=-s*l+i*c,this._tx+=o*a+u*f,this._ty+=o*l+u*c,this},shear:function(e,t){var n=Point.read(arguments),r=Point.read(arguments);r&&this.translate(r);var i=this._a,s=this._c;return this._a+=n.y*this._b,this._c+=n.y*this._d,this._b+=n.x*i,this._d+=n.x*s,r&&this.translate(r.negate()),this},isIdentity:function(){return this._a==1&&this._c==0&&this._b==0&&this._d==1&&this._tx==0&&this._ty==0},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},concatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d;return this._a=e._a*t+e._c*n,this._b=e._b*t+e._d*n,this._c=e._a*r+e._c*i,this._d=e._b*r+e._d*i,this._tx+=e._tx*t+e._ty*n,this._ty+=e._tx*r+e._ty*i,this},preConcatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d,s=this._tx,o=this._ty;return this._a=e._a*t+e._b*r,this._b=e._a*n+e._b*i,this._c=e._c*t+e._d*r,this._d=e._c*n+e._d*i,this._tx=e._a*s+e._b*o+e._tx,this._ty=e._c*s+e._d*o+e._ty,this},transform:function(e,t,n,r,i){return arguments.length<5?this._transformPoint(Point.read(arguments)):this._transformCoordinates(e,t,n,r,i)},_transformPoint:function(e,t,n){var r=e.x,i=e.y;return t||(t=Base.create(Point)),t.set(r*this._a+i*this._b+this._tx,r*this._c+i*this._d+this._ty,n)},_transformCoordinates:function(e,t,n,r,i){var s=t,o=r,u=t+2*i;while(s<u){var a=e[s++],f=e[s++];n[o++]=a*this._a+f*this._b+this._tx,n[o++]=a*this._c+f*this._d+this._ty}return n},_transformCorners:function(e){var t=e.x,n=e.y,r=t+e.width,i=n+e.height,s=[t,n,r,n,r,i,t,i];return this._transformCoordinates(s,0,s,0,4)},_transformBounds:function(e,t,n){var r=this._transformCorners(e),i=r.slice(0,2),s=r.slice(0);for(var o=2;o<8;o++){var u=r[o],a=o&1;u<i[a]?i[a]=u:u>s[a]&&(s[a]=u)}return t||(t=Base.create(Rectangle)),t.set(i[0],i[1],s[0]-i[0],s[1]-i[1],n)},inverseTransform:function(e){return this._inverseTransform(Point.read(arguments))},_getDeterminant:function(){var e=this._a*this._d-this._b*this._c;return isFinite(e)&&!Numerical.isZero(e)&&isFinite(this._tx)&&isFinite(this._ty)?e:null},_inverseTransform:function(e,t,n){var r=this._getDeterminant();if(!r)return null;var i=e.x-this._tx,s=e.y-this._ty;return t||(t=Base.create(Point)),t.set((i*this._d-s*this._b)/r,(s*this._a-i*this._c)/r,n)},decompose:function(){var e=this._a,t=this._b,n=this._c,r=this._d;if(Numerical.isZero(e*r-t*n))return null;var i=Math.sqrt(e*e+t*t);e/=i,t/=i;var s=e*n+t*r;n-=e*s,r-=t*s;var o=Math.sqrt(n*n+r*r);return n/=o,r/=o,s/=o,e*r<t*n&&(e=-e,t=-t,s=-s,i=-i),{translation:this.getTranslation(),scaling:Point.create(i,o),rotation:-Math.atan2(t,e)*180/Math.PI,shearing:s}},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return Point.create(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var e=this._getDeterminant();return e&&Matrix.create(this._d/e,-this._c/e,-this._b/e,this._a/e,(this._b*this._ty-this._d*this._tx)/e,(this._c*this._tx-this._a*this._ty)/e)},shiftless:function(){return Matrix.create(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(e,t){return e[t?"setTransform":"transform"](this._a,this._c,this._b,this._d,this._tx,this._ty),this},statics:{create:function(e,t,n,r,i,s){return Base.create(Matrix).set(e,t,n,r,i,s)}}},new function(){return Base.each({scaleX:"_a",scaleY:"_d",translateX:"_tx",translateY:"_ty",shearX:"_b",shearY:"_c"},function(e,t){t=Base.capitalize(t),this["get"+t]=function(){return this[e]},this["set"+t]=function(t){this[e]=t}},{})}),Line=this.Line=Base.extend({initialize:function(e,t,n){var r=Point.read(arguments),i=Point.read(arguments),s=Base.read(arguments);s!==undefined?(this.point=r,this.vector=i.subtract(r),this.infinite=s):(this.point=r,this.vector=i,this.infinite=!0)},intersect:function(e){var t=this.vector.cross(e.vector);if(Numerical.isZero(t))return null;var n=e.point.subtract(this.point),r=n.cross(e.vector)/t,i=n.cross(this.vector)/t;return(this.infinite||0<=r&&r<=1)&&(e.infinite||0<=i&&i<=1)?this.point.add(this.vector.multiply(r)):null},getSide:function(e){var t=this.vector,n=e.subtract(this.point),r=n.cross(t);return r===0&&(r=n.dot(t),r>0&&(r=n.subtract(t).dot(t),r<0&&(r=0))),r<0?-1:r>0?1:0},getDistance:function(e){var t=this.vector.y/this.vector.x,n=this.point.y-t*this.point.x,r=Math.abs(e.y-t*e.x-n)/Math.sqrt(t*t+1);return this.infinite?r:Math.min(r,e.getDistance(this.point),e.getDistance(this.point.add(this.vector)))}}),Project=this.Project=PaperScopeItem.extend({_list:"projects",_reference:"project",initialize:function(e){this.base(!0),this.layers=[],this.symbols=[],this.activeLayer=new Layer,e&&(this.view=e instanceof View?e:View.create(e)),this._currentStyle=new PathStyle,this._selectedItems={},this._selectedItemCount=0,this._drawCount=0,this.options={}},_serialize:function(e,t){return Base.serialize(this.layers,e,!1,t)},_needsRedraw:function(){this.view&&(this.view._redrawNeeded=!0)},remove:function(){return this.base()?(this.view&&this.view.remove(),!0):!1},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.initialize(e)},getIndex:function(){return this._index},getSelectedItems:function(){var e=[];for(var t in this._selectedItems){var n=this._selectedItems[t];n._drawCount===this._drawCount&&e.push(n)}return e},_updateSelection:function(e){e._selected?(this._selectedItemCount++,this._selectedItems[e._id]=e,e.isInserted()&&(e._drawCount=this._drawCount)):(this._selectedItemCount--,delete this._selectedItems[e._id])},selectAll:function(){for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].setSelected(!0)},deselectAll:function(){for(var e in this._selectedItems)this._selectedItems[e].setSelected(!1)},hitTest:function(e,t){e=Point.read(arguments),t=HitResult.getOptions(Base.read(arguments));for(var n=this.layers.length-1;n>=0;n--){var r=this.layers[n].hitTest(e,t);if(r)return r}return null},importJson:function(e){return Base.importJson(e)},draw:function(e,t){function n(e,t,i){var s=i&&r[e._id];return s?s.clone():(e._parent&&(t=n(e._parent,t,!0)),e._matrix.isIdentity()||t.concatenate(e._matrix),i&&(r[e._id]=t.clone()),t)}var r={};this._drawCount++,e.save(),t.isIdentity()||t.applyToContext(e);var i={offset:new Point(0,0)};for(var s=0,o=this.layers.length;s<o;s++)Item.draw(this.layers[s],e,i);e.restore();if(this._selectedItemCount>0){e.save(),e.strokeWidth=1,e.strokeStyle=e.fillStyle="#009dec";for(var u in this._selectedItems){var a=this._selectedItems[u];if(a._drawCount===this._drawCount&&(a.drawSelected||a._boundsSelected)){var f=n(a,t.clone());a.drawSelected&&a.drawSelected(e,f),a._boundsSelected&&Item.drawSelectedBounds(a._getBounds("getBounds"),e,f)}}e.restore()}}}),Symbol=this.Symbol=Base.extend({_type:"Symbol",initialize:function(e,t){this._id=++Base._uid,this.project=paper.project,this.project.symbols.push(this),e&&this.setDefinition(e,t),this._instances={}},_serialize:function(e,t){return t.add(this,function(){return Base.serialize([this._type,this._definition],e,!1,t)})},_changed:function(e){Base.each(this._instances,function(t){t._changed(e)})},getDefinition:function(){return this._definition},setDefinition:function(e){e._parentSymbol&&(e=e.clone()),this._definition&&delete this._definition._parentSymbol,this._definition=e,e.remove(),e.setSelected(!1),arguments[1]||e.setPosition(new Point),e._parentSymbol=this,this._changed(5)},place:function(e){return new PlacedSymbol(this,e)},clone:function(){return new Symbol(this._definition.clone())}}),Item=this.Item=Base.extend(Callback,{statics:{extend:function(e){return e._serializeFields&&(e._serializeFields=Base.merge(this.prototype._serializeFields,e._serializeFields)),this.base.apply(this,arguments)}}},{_boundsSelected:!1,_serializeFields:{name:null,matrix:new Matrix,locked:!1,visible:!0,blendMode:"normal",opacity:1,guide:!1,clipMask:!1,data:{}},initialize:function(e){this._id=++Base._uid,this._project||paper.project.activeLayer.addChild(this),this._style||(this._style=PathStyle.create(this)),this.setStyle(this._project.getCurrentStyle()),this._matrix=new Matrix,e&&this._matrix.translate(e)},_events:new function(){var e={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}},t={install:function(t){var n=this._project.view._eventCounters;if(n)for(var r in e)n[r]=(n[r]||0)+(e[r][t]||0)},uninstall:function(t){var n=this._project.view._eventCounters;if(n)for(var r in e)n[r]-=e[r][t]||0}};return Base.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],function(e){this[e]=t},{onFrame:{install:function(){this._project.view._animateItem(this,!0)},uninstall:function(){this._project.view._animateItem(this,!1)}},onLoad:{}})},_serialize:function(e,t){function n(n,s){for(var o in n){var u=i[o];Base.equals(u,n[o])||(r[o]=Base.serialize(u,e,s&&o!=="data",t))}}var r={},i=this;return n(this._serializeFields,!0),this instanceof Group||n(this._style._defaults,!1),[this._type,r]},_changed:function(e){e&4&&(delete this._bounds,delete this._position),this._parent&&e&12&&this._parent._clearBoundsCache(),e&2&&this._clearBoundsCache(),e&1&&this._project._needsRedraw(),this._parentSymbol&&this._parentSymbol._changed(e);if(this._project._changes){var t=this._project._changesById[this._id];t?t.flags|=e:(t={item:this,flags:e},this._project._changesById[this._id]=t,this._project._changes.push(t))}},set:function(e){return this._set(e),this},getId:function(){return this._id},getType:function(){return this._type},getName:function(){return this._name},setName:function(e,t){this._name&&this._removeFromNamed();if(e&&this._parent){var n=this._parent._children,r=this._parent._namedChildren,i=e,s=1;while(t&&n[e])e=i+" "+s++;(r[e]=r[e]||[]).push(this),n[e]=this}this._name=e||undefined,this._changed(32)}},Base.each(["locked","visible","blendMode","opacity","guide"],function(e){var t=Base.capitalize(e),e="_"+e;this["get"+t]=function(){return this[e]},this["set"+t]=function(t){t!=this[e]&&(this[e]=t,this._changed(e==="_locked"?32:33))}},{}),{_locked:!1,_visible:!0,_blendMode:"normal",_opacity:1,_guide:!1,applyMatrix:!1,isSelected:function(){if(this._children)for(var e=0,t=this._children.length;e<t;e++)if(this._children[e].isSelected())return!0;return this._selected},setSelected:function(e){if(this._children&&!arguments[1])for(var t=0,n=this._children.length;t<n;t++)this._children[t].setSelected(e);(e=!!e)!=this._selected&&(this._selected=e,this._project._updateSelection(this),this._changed(33))},_selected:!1,isFullySelected:function(){if(this._children&&this._selected){for(var e=0,t=this._children.length;e<t;e++)if(!this._children[e].isFullySelected())return!1;return!0}return this._selected},setFullySelected:function(e){if(this._children)for(var t=0,n=this._children.length;t<n;t++)this._children[t].setFullySelected(e);this.setSelected(e,!0)},isClipMask:function(){return this._clipMask},setClipMask:function(e){this._clipMask!=(e=!!e)&&(this._clipMask=e,e&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(33),this._parent&&this._parent._changed(256))},_clipMask:!1,getData:function(){return this._data||(this._data={}),this._data},setData:function(e){this._data=e},getPosition:function(){var e=this._position||(this._position=this.getBounds().getCenter(!0));return arguments[0]?e:LinkedPoint.create(this,"setPosition",e.x,e.y)},setPosition:function(e){this.translate(Point.read(arguments).subtract(this.getPosition(!0)))},getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix.initialize(e),this._changed(5)},isEmpty:function(){return this._children.length==0}},Base.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){var t=this._boundsGetter,n=this._getCachedBounds(typeof t=="string"?t:t&&t[e]||e,arguments[0]);return e=="getBounds"?LinkedRectangle.create(this,"setBounds",n.x,n.y,n.width,n.height):n}},{_getCachedBounds:function(e,t,n){var r=(!t||t.equals(this._matrix))&&e;if(n&&this._parent){var i=n._id,s=this._parent._boundsCache=this._parent._boundsCache||{ids:{},list:[]};s.ids[i]||(s.list.push(n),s.ids[i]=n)}if(r&&this._bounds&&this._bounds[r])return this._bounds[r].clone();var o=this._matrix.isIdentity();t=!t||t.isIdentity()?o?null:this._matrix:o?t:t.clone().concatenate(this._matrix);var u=this._getBounds(e,t,r?this:n);return r&&(this._bounds||(this._bounds={}),this._bounds[r]=u.clone()),u},_clearBoundsCache:function(){if(this._boundsCache){for(var e=0,t=this._boundsCache.list,n=t.length;e<n;e++){var r=t[e];delete r._bounds,r!=this&&r._boundsCache&&r._clearBoundsCache()}delete this._boundsCache}},_getBounds:function(e,t,n){var r=this._children;if(!r||r.length==0)return new Rectangle;var i=Infinity,s=-i,o=i,u=s;for(var a=0,f=r.length;a<f;a++){var l=r[a];if(l._visible&&!l.isEmpty()){var c=l._getCachedBounds(e,t,n);i=Math.min(c.x,i),o=Math.min(c.y,o),s=Math.max(c.x+c.width,s),u=Math.max(c.y+c.height,u)}}return Rectangle.create(i,o,s-i,u-o)},setBounds:function(e){e=Rectangle.read(arguments);var t=this.getBounds(),n=new Matrix,r=e.getCenter();n.translate(r),(e.width!=t.width||e.height!=t.height)&&n.scale(t.width!=0?e.width/t.width:1,t.height!=0?e.height/t.height:1),r=t.getCenter(),n.translate(-r.x,-r.y),this.transform(n)}}),{getProject:function(){return this._project},_setProject:function(e){if(this._project!=e){this._project=e;if(this._children)for(var t=0,n=this._children.length;t<n;t++)this._children[t]._setProject(e)}},getLayer:function(){var e=this;while(e=e._parent)if(e instanceof Layer)return e;return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},getChildren:function(){return this._children},setChildren:function(e){this.removeChildren(),this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},isInserted:function(){return this._parent?this._parent.isInserted():!1},clone:function(){return this._clone(new this.constructor)},_clone:function(e){e.setStyle(this._style);if(this._children)for(var t=0,n=this._children.length;t<n;t++)e.addChild(this._children[t].clone(),!0);var r=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide","applyMatrix"];for(var t=0,n=r.length;t<n;t++){var i=r[t];this.hasOwnProperty(i)&&(e[i]=this[i])}return e._matrix.initialize(this._matrix),e.setSelected(this._selected),this._name&&e.setName(this._name,!0),e},copyTo:function(e){var t=this.clone();return e.layers?e.activeLayer.addChild(t):e.addChild(t),t},rasterize:function(e){var t=this.getStrokeBounds(),n=(e||72)/72,r=CanvasProvider.getCanvas(t.getSize().multiply(n)),i=r.getContext("2d");(new Matrix).scale(n).translate(-t.x,-t.y).applyToContext(i),Item.draw(this,i,{});var s=new Raster(r);return s.setBounds(t),s},hitTest:function(e,t){function n(n,s){var o=r["get"+s]();if(e.getDistance(o)<t.tolerance)return new HitResult(n,i,{name:Base.hyphenate(s),point:o})}if(this._locked)return null;e=Point.read(arguments),t=HitResult.getOptions(Base.read(arguments));if(!this._children&&!this.getRoughBounds().expand(t.tolerance)._containsPoint(e))return null;e=this._matrix._inverseTransform(e);if((t.center||t.bounds)&&!(this instanceof Layer&&!this._parent)){var r=this.getBounds(),i=this,s=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],o;if(t.center&&(o=n("center","Center")))return o;if(t.bounds)for(var u=0;u<8;u++)if(o=n("bounds",s[u]))return o}return this._children||!(t.guides&&!this._guide||t.selected&&!this._selected)?this._hitTest(e,t):null},_hitTest:function(e,t){if(this._children)for(var n=this._children.length-1;n>=0;n--){var r=this._children[n].hitTest(e,t);if(r)return r}},addChild:function(e,t){return this.insertChild(undefined,e,t)},insertChild:function(e,t,n){return this._children?(t._remove(!0),Base.splice(this._children,[t],e,0),t._parent=this,t._setProject(this._project),t._name&&t.setName(t._name),this._changed(3),t):null},addChildren:function(e,t){return this.insertChildren(this._children.length,e,t)},insertChildren:function(e,t,n){t=t&&Array.prototype.slice.apply(t);var r=this._children,i=r.length,s=e;for(var o=0,u=t&&t.length;o<u;o++)if(this.insertChild(s,t[o],n)){var a=r.length;s+=a-i,i=a}return s!=e},insertAbove:function(e,t){var n=e._index;return e._parent==this._parent&&n<this._index&&n++,e._parent.insertChild(n,this,t)},insertBelow:function(e,t){var n=e._index;return e._parent==this._parent&&n>this._index&&n--,e._parent.insertChild(n,this,t)},sendToBack:function(){return this._parent.insertChild(0,this)},bringToFront:function(){return this._parent.addChild(this)},appendTop:function(e){return this.addChild(e)},appendBottom:function(e){return this.insertChild(0,e)},moveAbove:function(e){return this.insertAbove(e)},moveBelow:function(e){return this.insertBelow(e)},_removeFromNamed:function(){var e=this._parent._children,t=this._parent._namedChildren,n=this._name,r=t[n],i=r?r.indexOf(this):-1;if(i==-1)return;e[n]==this&&delete e[n],r.splice(i,1),r.length?e[n]=r[r.length-1]:delete t[n]},_remove:function(e){return this._parent?(this._name&&this._removeFromNamed(),this._index!=null&&Base.splice(this._parent._children,null,this._index,1),e&&this._parent._changed(3),this._parent=null,!0):!1},remove:function(){return this._remove(!0)},removeChildren:function(e,t){if(!this._children)return null;e=e||0,t=Base.pick(t,this._children.length);var n=Base.splice(this._children,null,e,t-e);for(var r=n.length-1;r>=0;r--)n[r]._remove(!1);return n.length>0&&this._changed(3),n},reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,t=this._children.length;e<t;e++)this._children[e]._index=e;this._changed(3)}},isEditable:function(){var e=this;while(e){if(!e._visible||e._locked)return!1;e=e._parent}return!0},_getOrder:function(e){function t(e){var t=[];do t.unshift(e);while(e=e._parent);return t}var n=t(this),r=t(e);for(var i=0,s=Math.min(n.length,r.length);i<s;i++)if(n[i]!=r[i])return n[i]._index<r[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isAbove:function(e){return this._getOrder(e)==-1},isBelow:function(e){return this._getOrder(e)==1},isParent:function(e){return this._parent==e},isChild:function(e){return e&&e._parent==this},isDescendant:function(e){var t=this;while(t=t._parent)if(t==e)return!0;return!1},isAncestor:function(e){return e?e.isDescendant(this):!1},isGroupedWith:function(e){var t=this._parent;while(t){if(t._parent&&(t instanceof Group||t instanceof CompoundPath)&&e.isDescendant(t))return!0;t=t._parent}return!1},scale:function(e,t,n){if(arguments.length<2||typeof t=="object")n=t,t=e;return this.transform((new Matrix).scale(e,t,n||this.getPosition(!0)))},translate:function(e){var t=new Matrix;return this.transform(t.translate.apply(t,arguments))},rotate:function(e,t){return this.transform((new Matrix).rotate(e,t||this.getPosition(!0)))},shear:function(e,t,n){if(arguments.length<2||typeof t=="object")n=t,t=e;return this.transform((new Matrix).shear(e,t,n||this.getPosition(!0)))},transform:function(e){var t=this._bounds,n=this._position;this._matrix.preConcatenate(e),this._transform&&this._transform(e),(this.applyMatrix||arguments[1])&&this._applyMatrix(this._matrix)&&this._matrix.reset(),this._changed(5);if(t&&e.getRotation()%90===0){for(var r in t){var i=t[r];e._transformBounds(i,i)}var s=this._boundsGetter,i=t[s&&s.getBounds||s||"getBounds"];i&&(this._position=i.getCenter(!0)),this._bounds=t}else n&&(this._position=e._transformPoint(n,n));return this},_applyMatrix:function(e){if(this._children){for(var t=0,n=this._children.length;t<n;t++)this._children[t].transform(e,!0);return!0}},fitBounds:function(e,t){e=Rectangle.read(arguments);var n=this.getBounds(),r=n.height/n.width,i=e.height/e.width,s=(t?r>i:r<i)?e.width/n.width:e.height/n.height,o=new Rectangle(new Point,Size.create(n.width*s,n.height*s));o.setCenter(e.getCenter()),this.setBounds(o)},importJson:function(e){return this.addChild(Base.importJson(e))},_setStyles:function(e){var t=this._style,n=t._strokeWidth,r=t._strokeJoin,i=t._strokeCap,s=t._miterLimit,o=t._fillColor,u=t._strokeColor,a=t._dashArray,f=t._dashOffset;n!=null&&(e.lineWidth=n),r&&(e.lineJoin=r),i&&(e.lineCap=i),s&&(e.miterLimit=s),o&&(e.fillStyle=o.toCanvasStyle(e)),u&&(e.strokeStyle=u.toCanvasStyle(e),paper.support.nativeDash&&a&&a.length&&("setLineDash"in e?(e.setLineDash(a),e.lineDashOffset=f):(e.mozDash=a,e.mozDashOffset=f)));if(!o||!u)e.globalAlpha=this._opacity},statics:{drawSelectedBounds:function(e,t,n){var r=n._transformCorners(e);t.beginPath();for(var i=0;i<8;i++)t[i==0?"moveTo":"lineTo"](r[i],r[++i]);t.closePath(),t.stroke();for(var i=0;i<8;i++)t.beginPath(),t.rect(r[i]-2,r[++i]-2,4,4),t.fill()},draw:function(e,t,n){if(!e._visible||e._opacity==0)return;e._drawCount=e._project._drawCount;var r,i,s;if(e._blendMode!=="normal"||e._opacity<1&&e._type!=="Raster"&&(e._type!=="Path"||e.getFillColor()&&e.getStrokeColor())){var o=e.getStrokeBounds();if(!o.width||!o.height)return;s=n.offset,i=n.offset=o.getTopLeft().floor(),r=t,t=CanvasProvider.getContext(o.getSize().ceil().add(Size.create(1,1)))}n.clipping||t.save(),r&&t.translate(-i.x,-i.y),e._matrix.applyToContext(t),e.draw(t,n),n.clipping||t.restore(),r&&(n.offset=s,e._blendMode!=="normal"?BlendMode.process(e._blendMode,t,r,e._opacity,i.subtract(s)):(r.save(),r.globalAlpha=e._opacity,r.drawImage(t.canvas,i.x,i.y),r.restore()),CanvasProvider.release(t))}}},Base.each(["down","drag","up","move"],function(e){this["removeOn"+Base.capitalize(e)]=function(){var t={};return t[e]=!0,this.removeOn(t)}},{removeOn:function(e){for(var t in e)if(e[t]){var n="mouse"+t,r=Tool._removeSets=Tool._removeSets||{};r[n]=r[n]||{},r[n][this._id]=this}return this}})),Group=this.Group=Item.extend({_type:"Group",_serializeFields:{children:[]},initialize:function(e){this.base(),this._children=[],this._namedChildren={},this._set(e)||this.addChildren(Array.isArray(e)?e:arguments)},_changed:function(e){Item.prototype._changed.call(this,e),e&258&&delete this._clipItem},_getClipItem:function(){if(this._clipItem!==undefined)return this._clipItem;for(var e=0,t=this._children.length;e<t;e++){var n=this._children[e];if(n._clipMask)return this._clipItem=n}return this._clipItem=null},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var t=this.getFirstChild();t&&t.setClipMask(e)},draw:function(e,t){var n=this._getClipItem();n&&(t.clipping=!0,Item.draw(n,e,t),delete t.clipping);for(var r=0,i=this._children.length;r<i;r++){var s=this._children[r];s!=n&&Item.draw(s,e,t)}}}),Layer=this.Layer=Group.extend({_type:"Layer",initialize:function(e){this._project=paper.project,this._index=this._project.layers.push(this)-1,this.base.apply(this,arguments),this.activate()},_remove:function(e){return this._parent?this.base(e):this._index!=null?(Base.splice(this._project.layers,null,this._index,1),this._project._needsRedraw(),!0):!1},getNextSibling:function(){return this._parent?this.base():this._project.layers[this._index+1]||null},getPreviousSibling:function(){return this._parent?this.base():this._project.layers[this._index-1]||null},isInserted:function(){return this._index!=null},activate:function(){this._project.activeLayer=this}},new function(){function e(e){return function(t){return t instanceof Layer&&!t._parent&&this._remove(!0)?(Base.splice(t._project.layers,[this],t._index+(e?1:0),0),this._setProject(t._project),!0):this.base(t)}}return{insertAbove:e(!0),insertBelow:e(!1)}}),PlacedItem=this.PlacedItem=Item.extend({_boundsGetter:{getBounds:"getStrokeBounds"},_hitTest:function(e,t,n){var r=this._symbol._definition._hitTest(e,t,n);return r&&(r.item=this),r}}),Raster=this.Raster=PlacedItem.extend({_type:"Raster",_boundsSelected:!0,_serializeFields:{source:null},_boundsGetter:"getBounds",initialize:function(e,t){this.base(t!==undefined&&Point.read(arguments,1)),e&&!this._set(e)&&(e.getContext?this.setCanvas(e):typeof e=="string"?this.setSource(e):this.setImage(e)),this._size||(this._size=new Size)},clone:function(){var e=this._image;e||(e=CanvasProvider.getCanvas(this._size),e.getContext("2d").drawImage(this._canvas,0,0));var t=new Raster(e);return this._clone(t)},getSize:function(){return this._size},setSize:function(){var e=Size.read(arguments);if(!this._size.equals(e)){var t=this.getElement();this.setCanvas(CanvasProvider.getCanvas(e)),t&&this.getContext(!0).drawImage(t,0,0,e.width,e.height)}},getWidth:function(){return this._size.width},getHeight:function(){return this._size.height},isEmpty:function(){return this._size.width==0&&this._size.height==0},getPpi:function(){var e=this._matrix,t=(new Point(0,0)).transform(e),n=(new Point(1,0)).transform(e).subtract(t),r=(new Point(0,1)).transform(e).subtract(t);return Size.create(72/n.getLength(),72/r.getLength())},getContext:function(){return this._context||(this._context=this.getCanvas().getContext("2d")),arguments[0]&&(this._image=null,this._changed(129)),this._context},setContext:function(e){this._context=e},getCanvas:function(){if(!this._canvas){var e=CanvasProvider.getContext(this._size);try{this._image&&e.drawImage(this._image,0,0),this._canvas=e.canvas}catch(t){CanvasProvider.release(e)}}return this._canvas},setCanvas:function(e){this._canvas&&CanvasProvider.release(this._canvas),this._canvas=e,this._size=Size.create(e.width,e.height),this._image=null,this._context=null,this._changed(133)},getImage:function(){return this._image},setImage:function(e){this._canvas&&CanvasProvider.release(this._canvas),this._image=e,this._size=Size.create(e.naturalWidth,e.naturalHeight),this._canvas=null,this._context=null,this._changed(5)},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(e){function t(){n.fire("load"),n._project.view&&n._project.view.draw(!0)}var n=this,r=document.getElementById(e)||new Image;DomEvent.add(r,{load:function(){n.setImage(r),t()}}),r.width&&r.height?setTimeout(t,0):r.src||(r.src=e),this.setImage(r)},getElement:function(){return this._canvas||this._image},getSubImage:function(e){e=Rectangle.read(arguments);var t=CanvasProvider.getContext(e.getSize());return t.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.canvas},toDataURL:function(){var e=this._image&&this._image.src;if(/^data:/.test(e))return e;var t=this.getCanvas();return t?t.toDataURL():null},drawImage:function(e,t){t=Point.read(arguments,1),this.getContext(!0).drawImage(e,t.x,t.y)},getAverageColor:function(e){var t,n;e?e instanceof PathItem?(n=e,t=e.getBounds()):e.width?t=new Rectangle(e):e.x&&(t=Rectangle.create(e.x-.5,e.y-.5,1,1)):t=this.getBounds();var r=32,i=Math.min(t.width,r),s=Math.min(t.height,r),o=Raster._sampleContext;o?o.clearRect(0,0,r+1,r+1):o=Raster._sampleContext=CanvasProvider.getContext(new Size(r)),o.save(),o.scale(i/t.width,s/t.height),o.translate(-t.x,-t.y),n&&n.draw(o,{clip:!0}),this._matrix.applyToContext(o),o.drawImage(this.getElement(),-this._size.width/2,-this._size.height/2),o.restore();var u=o.getImageData(.5,.5,Math.ceil(i),Math.ceil(s)).data,a=[0,0,0],f=0;for(var l=0,c=u.length;l<c;l+=4){var h=u[l+3];f+=h,h/=255,a[0]+=u[l]*h,a[1]+=u[l+1]*h,a[2]+=u[l+2]*h}for(var l=0;l<3;l++)a[l]/=f;return f?Color.read(a):null},getPixel:function(e){e=Point.read(arguments);var t=this.getContext().getImageData(e.x,e.y,1,1).data,n=new Array(4);for(var r=0;r<4;r++)n[r]=t[r]/255;return RgbColor.read(n)},setPixel:function(e,t){var n=Point.read(arguments),r=Color.read(arguments),i=this.getContext(!0),s=i.createImageData(1,1),o=r.getAlpha();s.data[0]=r.getRed()*255,s.data[1]=r.getGreen()*255,s.data[2]=r.getBlue()*255,s.data[3]=o!=null?o*255:255,i.putImageData(s,n.x,n.y)},createImageData:function(e){return e=Size.read(arguments),this.getContext().createImageData(e.width,e.height)},getImageData:function(e){return e=Rectangle.read(arguments),e.isEmpty()&&(e=new Rectangle(this.getSize())),this.getContext().getImageData(e.x,e.y,e.width,e.height)},setImageData:function(e,t){t=Point.read(arguments,1),this.getContext(!0).putImageData(e,t.x,t.y)},_getBounds:function(e,t){var n=(new Rectangle(this._size)).setCenter(0,0);return t?t._transformBounds(n):n},_hitTest:function(e,t){if(e.isInside(this._getBounds())){var n=this;return new HitResult("pixel",n,{offset:e.add(n._size.divide(2)).round(),color:{get:function(){return n.getPixel(this.offset)}}})}},draw:function(e,t){var n=this.getElement();n&&(e.globalAlpha=this._opacity,e.drawImage(n,-this._size.width/2,-this._size.height/2))}}),PlacedSymbol=this.PlacedSymbol=PlacedItem.extend({_type:"PlacedSymbol",_boundsSelected:!0,_serializeFields:{symbol:null},initialize:function(e,t){this.base(t!==undefined&&Point.read(arguments,1)),this._set(e)||this.setSymbol(e instanceof Symbol?e:new Symbol(e))},getSymbol:function(){return this._symbol},setSymbol:function(e){this._symbol&&delete this._symbol._instances[this._id],this._symbol=e,e._instances[this._id]=this},clone:function(){return this._clone(new PlacedSymbol(this.symbol))},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(e,t){return this.symbol._definition._getCachedBounds(e,t)},draw:function(e,t){Item.draw(this.symbol._definition,e,t)}}),HitResult=this.HitResult=Base.extend({initialize:function(e,t,n){this.type=e,this.item=t,n&&(n.enumerable=!0,this.inject(n))},statics:{getOptions:function(e){return e&&e._merged?e:Base.merge({type:null,tolerance:paper.project.options.hitTolerance||2,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,center:!1,bounds:!1,guides:!1,selected:!1,_merged:!0},e)}}}),Segment=this.Segment=Base.extend({_type:"Segment",initialize:function(e,t,n,r,i,s){var o=arguments.length,u=SegmentPoint.create,a,f,l;o!=0&&(o==1?e.point?(a=e.point,f=e.handleIn,l=e.handleOut):a=e:o<6?o==2&&t.x===undefined?a=[e,t]:(a=e,f=t,l=n):o==6&&(a=[e,t],f=[n,r],l=[i,s])),u(this,"_point",a),u(this,"_handleIn",f),u(this,"_handleOut",l)},_serialize:function(e){return Base.serialize(this._handleIn.isZero()&&this._handleOut.isZero()?this._point:[this._point,this._handleIn,this._handleOut],e,!0)},_changed:function(e){if(!this._path)return;var t=this._path._curves&&this.getCurve(),n;t&&(t._changed(),(n=t[e==this._point||e==this._handleIn&&t._segment1==this?"getPrevious":"getNext"]())&&n._changed()),this._path._changed(5)},getPoint:function(){return this._point},setPoint:function(e){e=Point.read(arguments),this._point.set(e.x,e.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(e){e=Point.read(arguments),this._handleIn.set(e.x,e.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(e){e=Point.read(arguments),this._handleOut.set(e.x,e.y)},isLinear:function(){return this._handleIn.isZero()&&this._handleOut.isZero()},setLinear:function(){this._handleIn.set(0,0),this._handleOut.set(0,0)},_isSelected:function(e){var t=this._selectionState;return e==this._point?!!(t&4):e==this._handleIn?!!(t&1):e==this._handleOut?!!(t&2):!1},_setSelected:function(e,t){var n=this._path,t=!!t,r=this._selectionState||0,i=[!!(r&4),!!(r&1),!!(r&2)];if(e==this._point){if(t)i[1]=i[2]=!1;else{var s=this.getPrevious(),o=this.getNext();i[1]=s&&(s._point.isSelected()||s._handleOut.isSelected()),i[2]=o&&(o._point.isSelected()||o._handleIn.isSelected())}i[0]=t}else{var u=e==this._handleIn?1:2;i[u]!=t&&(t&&(i[0]=!1),i[u]=t)}this._selectionState=(i[0]?4:0)|(i[1]?1:0)|(i[2]?2:0),n&&r!=this._selectionState&&(n._updateSelection(this,r,this._selectionState),n._changed(33))},isSelected:function(){return this._isSelected(this._point)},setSelected:function(e){this._setSelected(this._point,e)},getIndex:function(){return this._index!==undefined?this._index:null},getPath:function(){return this._path||null},getCurve:function(){if(this._path){var e=this._index;return!this._path._closed&&e==this._path._segments.length-1&&e--,this._path.getCurves()[e]||null}return null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},reverse:function(){return new Segment(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut)},equals:function(e){return e==this||e&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)},toString:function(){var e=["point: "+this._point];return this._handleIn.isZero()||e.push("handleIn: "+this._handleIn),this._handleOut.isZero()||e.push("handleOut: "+this._handleOut),"{ "+e.join(", ")+" }"},_transformCoordinates:function(e,t,n){var r=this._point,i=!n||!this._handleIn.isZero()?this._handleIn:null,s=!n||!this._handleOut.isZero()?this._handleOut:null,o=r._x,u=r._y,a=2;return t[0]=o,t[1]=u,i&&(t[a++]=i._x+o,t[a++]=i._y+u),s&&(t[a++]=s._x+o,t[a++]=s._y+u),e&&(e._transformCoordinates(t,0,t,0,a/2),o=t[0],u=t[1],n?(r._x=o,r._y=u,a=2,i&&(i._x=t[a++]-o,i._y=t[a++]-u),s&&(s._x=t[a++]-o,s._y=t[a++]-u)):(i||(t[a++]=o,t[a++]=u),s||(t[a++]=o,t[a++]=u))),t}}),SegmentPoint=Point.extend({set:function(e,t){return this._x=e,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner._changed(this)},isZero:function(){return Numerical.isZero(this._x)&&Numerical.isZero(this._y)},setSelected:function(e){this._owner._setSelected(this,e)},isSelected:function(){return this._owner._isSelected(this)},statics:{create:function(e,t,n){var r=Base.create(SegmentPoint),i,s,o;return n?(i=n[0])!==undefined?s=n[1]:((i=n.x)===undefined&&(n=Point.read(arguments,2),i=n.x),s=n.y,o=n.selected):i=s=0,r._x=i,r._y=s,r._owner=e,e[t]=r,o&&r.setSelected(!0),r}}}),Curve=this.Curve=Base.extend({initialize:function(e,t,n,r,i,s,o,u){var a=arguments.length;if(a==0)this._segment1=new Segment,this._segment2=new Segment;else if(a==1)this._segment1=new Segment(e.segment1),this._segment2=new Segment(e.segment2);else if(a==2)this._segment1=new Segment(e),this._segment2=new Segment(t);else{var f,l,c,h;a==4?(f=e,l=t,c=n,h=r):a==8&&(f=[e,t],h=[o,u],l=[n-e,u-t],c=[i-o,s-u]),this._segment1=new Segment(f,null,l),this._segment2=new Segment(h,c,null)}},_changed:function(){delete this._length,delete this._bounds},getPoint1:function(){return this._segment1._point},setPoint1:function(e){e=Point.read(arguments),this._segment1._point.set(e.x,e.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(e){e=Point.read(arguments),this._segment2._point.set(e.x,e.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(e){e=Point.read(arguments),this._segment1._handleOut.set(e.x,e.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(e){e=Point.read(arguments),this._segment2._handleIn.set(e.x,e.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isSelected:function(){return this.getHandle1().isSelected()&&this.getHandle2().isSelected()},setSelected:function(e){this.getHandle1().setSelected(e),this.getHandle2().setSelected(e)},getValues:function(){return Curve.getValues(this._segment1,this._segment2)},getPoints:function(){var e=this.getValues(),t=[];for(var n=0;n<8;n+=2)t.push(Point.create(e[n],e[n+1]));return t},getLength:function(){var e=arguments[0],t=arguments[1],n=arguments.length==0||e==0&&t==1;if(n&&this._length!=null)return this._length;var r=Curve.getLength(this.getValues(),e,t);return n&&(this._length=r),r},getPart:function(e,t){return new Curve(Curve.getPart(this.getValues(),e,t))},isLinear:function(){return this._segment1._handleOut.isZero()&&this._segment2._handleIn.isZero()},getIntersections:function(e){return Curve._addIntersections(this.getValues(),e.getValues(),this,[])},getCrossings:function(e,t){var n=this.getValues(),r=Curve.solveCubic(n,1,e.y,t),i=0;for(var s=0;s<r;s++){var o=t[s];if(o>=0&&o<1&&Curve.evaluate(n,o,!0,0).x>e.x){if(o<1e-5&&Curve.evaluate(this.getPrevious().getValues(),1,!0,1).y*Curve.evaluate(n,o,!0,1).y>=1e-5)continue;i++}}return i},reverse:function(){return new Curve(this._segment2.reverse(),this._segment1.reverse())},divide:function(e){var t=null;e&&e.curve===this&&(e=e.parameter);if(e>0&&e<1){var n=Curve.subdivide(this.getValues(),e),r=this.isLinear(),i=n[0],s=n[1],o=this._segment1._point,u=this._segment2._point;r||(this._segment1._handleOut.set(i[2]-o._x,i[3]-o._y),this._segment2._handleIn.set(s[4]-u._x,s[5]-u._y));var a=i[6],f=i[7],l=new Segment(Point.create(a,f),r?null:Point.create(i[4]-a,i[5]-f),r?null:Point.create(s[2]-a,s[3]-f));if(this._path)this._segment1._index>0&&this._segment2._index===0?this._path.add(l):this._path.insert(this._segment2._index,l),t=this;else{var c=this._segment2;this._segment2=l,t=new Curve(l,c)}}return t},split:function(e){return this._path?this._path.split(this._segment1._index,e):null},clone:function(){return new Curve(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||e.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||e.push("handle2: "+this._segment2._handleIn),e.push("point2: "+this._segment2._point),"{ "+e.join(", ")+" }"},statics:{create:function(e,t,n){var r=Base.create(Curve);return r._path=e,r._segment1=t,r._segment2=n,r},getValues:function(e,t){var n=e._point,r=e._handleOut,i=t._handleIn,s=t._point;return[n._x,n._y,n._x+r._x,n._y+r._y,s._x+i._x,s._y+i._y,s._x,s._y]},evaluate:function(e,t,n,r){var i=n?t:Curve.getParameterAt(e,t,0),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7],p,d;if(r!=0||i!=0&&i!=1){var v=1e-5;i<v&&u==s&&a==o?i=v:i>1-v&&f==c&&l==h&&(i=1-v);var m=3*(u-s),g=3*(f-u)-m,y=c-s-m-g,b=3*(a-o),w=3*(l-a)-b,E=h-o-b-w;switch(r){case 0:p=((y*i+g)*i+m)*i+s,d=((E*i+w)*i+b)*i+o;break;case 1:case 2:p=(3*y*i+2*g)*i+m,d=(3*E*i+2*w)*i+b}}else p=i==0?s:c,d=i==0?o:h;return r==2?new Point(d,-p):new Point(p,d)},subdivide:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7];t===undefined&&(t=.5);var l=1-t,c=l*n+t*i,h=l*r+t*s,p=l*i+t*o,d=l*s+t*u,v=l*o+t*a,m=l*u+t*f,g=l*c+t*p,y=l*h+t*d,b=l*p+t*v,w=l*d+t*m,E=l*g+t*b,S=l*y+t*w;return[[n,r,c,h,g,y,E,S],[E,S,b,w,v,m,a,f]]},solveCubic:function(e,t,n,r){var i=e[t],s=e[t+2],o=e[t+4],u=e[t+6],a=3*(s-i),f=3*(o-s)-a,l=u-i-a-f;return Numerical.solveCubic(l,f,a,i-n,r,1e-5)},getParameterOf:function(e,t,n){if(Math.abs(e[0]-t)<1e-5&&Math.abs(e[1]-n)<1e-5)return 0;if(Math.abs(e[6]-t)<1e-5&&Math.abs(e[7]-n)<1e-5)return 1;var r=[],i=[],s=Curve.solveCubic(e,0,t,r),o=Curve.solveCubic(e,1,n,i),u,a;for(var f=0;s==-1||f<s;)if(s==-1||(u=r[f++])>=0&&u<=1){for(var l=0;o==-1||l<o;)if(o==-1||(a=i[l++])>=0&&a<=1){s==-1?u=a:o==-1&&(a=u);if(Math.abs(u-a)<1e-5)return(u+a)*.5}if(s==-1)break}return null},getPart:function(e,t,n){return t>0&&(e=Curve.subdivide(e,t)[1]),n<1&&(e=Curve.subdivide(e,(n-t)/(1-t))[0]),e},isFlatEnough:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=3*i-2*n-a,c=3*s-2*r-f,h=3*o-2*a-n,p=3*u-2*f-r;return Math.max(l*l,h*h)+Math.max(c*c,p*p)<16*t*t},getBounds:function(e){var t=e.slice(0,2),n=t.slice(0),r=new Array(2);for(var i=0;i<2;i++)Curve._addBounds(e[i],e[i+2],e[i+4],e[i+6],i,0,t,n,r);return Rectangle.create(t[0],t[1],n[0]-t[0],n[1]-t[1])},_addBounds:function(e,t,n,r,i,s,o,u,a){function f(e,t){var n=e-t,r=e+t;n<o[i]&&(o[i]=n),r>u[i]&&(u[i]=r)}var l=3*(t-n)-e+r,c=2*(e+n)-4*t,h=t-e,p=Numerical.solveQuadratic(l,c,h,a,1e-5),d=1e-5,v=1-d;f(r,0);for(var m=0;m<p;m++){var g=a[m],y=1-g;d<g&&g<v&&f(y*y*y*e+3*y*y*g*t+3*y*g*g*n+g*g*g*r,s)}},_addIntersections:function(e,t,n,r){var i=Curve.getBounds(e),s=Curve.getBounds(t);if(i.x+i.width>=s.x&&i.y+i.height>=s.y&&i.x<s.x+s.width&&i.y<s.y+s.height)if(Curve.isFlatEnough(e,1e-5)&&Curve.isFlatEnough(t,1e-5)){var o=(new Line(e[0],e[1],e[6],e[7],!1)).intersect(new Line(t[0],t[1],t[6],t[7],!1));o&&r.push(new CurveLocation(n,null,o))}else{var u=Curve.subdivide(e),a=Curve.subdivide(t);for(var f=0;f<2;f++)for(var l=0;l<2;l++)this._addIntersections(u[f],a[l],n,r)}return r}}},Base.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){this._bounds||(this._bounds={});var t=this._bounds[e];return t||(t=this._bounds[e]=Path[e]([this._segment1,this._segment2],!1,this._path._style)),t.clone()}},{}),Base.each(["getPoint","getTangent","getNormal"],function(e,t){this[e+"At"]=function(e,n){return Curve.evaluate(this.getValues(),e,n,t)},this[e]=function(e){return Curve.evaluate(this.getValues(),e,!0,t)}},{getParameterAt:function(e,t){return Curve.getParameterAt(this.getValues(),e,t!==undefined?t:e<0?1:0)},getParameterOf:function(e){return e=Point.read(arguments),Curve.getParameterOf(this.getValues(),e.x,e.y)},getLocationAt:function(e,t){return t||(e=this.getParameterAt(e)),new CurveLocation(this,e)},getLocationOf:function(e){var t=this.getParameterOf.apply(this,arguments);return t!=null?new CurveLocation(this,t):null}}),new function(){function e(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=9*(r-s)+3*(u-t),l=6*(t+s)-12*r,c=3*(r-t),h=9*(i-o)+3*(a-n),p=6*(n+o)-12*i,d=3*(i-n);return function(e){var t=(f*e+l)*e+c,n=(h*e+p)*e+d;return Math.sqrt(t*t+n*n)}}function t(e,t){return Math.max(2,Math.min(16,Math.ceil(Math.abs(t-e)*32)))}return{statics:!0,getLength:function(n,r,i){r===undefined&&(r=0),i===undefined&&(i=1);if(n[0]==n[2]&&n[1]==n[3]&&n[6]==n[4]&&n[7]==n[5]){var s=n[6]-n[0],o=n[7]-n[1];return(i-r)*Math.sqrt(s*s+o*o)}var u=e(n);return Numerical.integrate(u,r,i,t(r,i))},getParameterAt:function(n,r,i){function s(e){var n=t(i,e);return h+=i<e?Numerical.integrate(f,i,e,n):-Numerical.integrate(f,e,i,n),i=e,h-r}if(r==0)return i;var o=r>0,u=o?i:0,a=o?1:i,r=Math.abs(r),f=e(n),l=Numerical.integrate(f,u,a,t(u,a));if(r>=l)return o?a:u;var c=r/l,h=0;return Numerical.findRoot(s,f,o?u+c:a-c,u,a,16,1e-5)}}},new function(){function e(e,t){var n=3,r=5,i=[],s=[],u=[],a=[];for(var f=0;f<=n;f++)i[f]=e[f].subtract(t),f<n&&(s[f]=e[f+1].subtract(e[f]).multiply(n));for(var l=0;l<n;l++){u[l]=[];for(var c=0;c<=n;c++)u[l][c]=s[l].dot(i[c])}for(var f=0;f<=r;f++)a[f]=new Point(f/r,0);for(var h=0;h<=r;h++){var p=Math.max(0,h-n+1),d=Math.min(h,n);for(var f=p;f<=d;f++){var v=h-f;a[h].y+=u[v][f]*o[v][f]}}return a}function t(e,s){switch(n(e)){case 0:return[];case 1:if(s>=i)return[.5*(e[0].x+e[5].x)];if(r(e)){var o=new Line(e[0],e[5],!0);return[Numerical.isZero(o.vector.getLength(!0))?o.point.x:u.intersect(o).x]}}var a=[[]],f=[],l=[];for(var c=0;c<=5;c++)a[0][c]=new Point(e[c]);for(var h=1;h<=5;h++){a[h]=[];for(var c=0;c<=5-h;c++)a[h][c]=a[h-1][c].add(a[h-1][c+1]).multiply(.5)}for(var c=0;c<=5;c++)f[c]=a[c][0],l[c]=a[5-c][c];return t(f,s+1).concat(t(l,s+1))}function n(e){var t=0,n=null;for(var r=0,i=e.length;r<i;r++){var s=e[r].y<0?-1:1;n!=null&&s!=n&&t++,n=s}return t}function r(e){var t=e.length-1,n=e[0].y-e[t].y,r=e[t].x-e[0].x,i=e[0].x*e[t].y-e[t].x*e[0].y,o=0,u=0;for(var a=1;a<t;a++){var f=n*e[a].x+r*e[a].y+i,l=f*f;f<0&&l>u?u=l:l>o&&(o=l)}return Math.abs((o+u)/(2*n*(n*n+r*r)))<s}var i=32,s=Math.pow(2,-i-1),o=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=new Line(new Point(0,0),new Point(1,0));return{getNearestLocation:function(n){var r=e(this.getPoints(),n),i=t(r,0).concat([0,1]),s=Infinity,o,u;for(var a=0;a<i.length;a++){var f=this.getPointAt(i[a],!0),l=n.getDistance(f,!0);l<s&&(s=l,o=i[a],u=f)}return new CurveLocation(this,o,u,Math.sqrt(s))},getNearestPoint:function(e){return this.getNearestLocation(e).getPoint()}}}),CurveLocation=this.CurveLocation=Base.extend({initialize:function(e,t,n,r){this._curve=e,this._segment1=e._segment1,this._segment2=e._segment2,this._parameter=t,this._point=n,this._distance=r},getSegment:function(){if(!this._segment){var e=this.getCurve(),t=this.getParameter();if(t==0)this._segment=e._segment1;else if(t==1)this._segment=e._segment2;else{if(t==null)return null;this._segment=e.getLength(0,t)<e.getLength(t,1)?e._segment1:e._segment2}}return this._segment},getCurve:function(){if(!this._curve||arguments[0])this._curve=this._segment1.getCurve(),this._curve.getParameterOf(this._point)==null&&(this._curve=this._segment2.getPrevious().getCurve());return this._curve},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getOffset:function(){var e=this.getPath();return e&&e._getOffset(this)},getCurveOffset:function(){var e=this.getCurve(),t=this.getParameter();return t!=null&&e&&e.getLength(0,t)},getParameter:function(){if((this._parameter==null||arguments[0])&&this._point){var e=this.getCurve(arguments[0]&&this._point);this._parameter=e&&e.getParameterOf(this._point)}return this._parameter},getPoint:function(){if(!this._point&&this._parameter!=null){var e=this.getCurve();this._point=e&&e.getPointAt(this._parameter,!0)}return this._point},getTangent:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getTangentAt(e,!0)},getNormal:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getNormalAt(e,!0)},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(!0);return e&&e.divide(this.getParameter(!0))},split:function(){var e=this.getCurve(!0);return e&&e.split(this.getParameter(!0))},toString:function(){var e=[],t=this.getPoint();t&&e.push("point: "+t);var n=this.getIndex();n!=null&&e.push("index: "+n);var r=this.getParameter();return r!=null&&e.push("parameter: "+Format.number(r)),this._distance!=null&&e.push("distance: "+Format.number(this._distance)),"{ "+e.join(", ")+" }"}}),PathItem=this.PathItem=Item.extend({getIntersections:function(e){if(!this.getBounds().intersects(e.getBounds()))return[];var t=[],n=this.getCurves(),r=e.getCurves(),i=r.length,s=[];for(var o=0;o<i;o++)s[o]=r[o].getValues();for(var o=0,u=n.length;o<u;o++){var a=n[o],f=a.getValues();for(var l=0;l<i;l++)Curve._addIntersections(f,s[l],a,t)}return t},setPathData:function(e){function t(e,t,n){var r=parseFloat(i[e]);return s&&(r+=u[t]),n&&(u[t]=r),r}function n(e,n){return new Point(t(e,"x",n),t(e+1,"y",n))}var r=e.match(/[a-z][^a-z]*/ig),i,s=!1,o,u=new Point;this._type==="Path"?this.removeSegments():this.removeChildren();for(var a=0,f=r.length;a<f;a++){var l=r[a];cmd=l[0],lower=cmd.toLowerCase(),i=l.slice(1).trim().split(/[\s,]+|(?=[+-])/),s=cmd===lower;switch(lower){case"m":case"l":for(var c=0;c<i.length;c+=2)this[c===0&&lower==="m"?"moveTo":"lineTo"](n(c,!0));break;case"h":case"v":var h=lower=="h"?"x":"y";for(var c=0;c<i.length;c++)t(c,h,!0),this.lineTo(u);break;case"c":this.cubicCurveTo(n(0),o=n(2),n(4,!0));break;case"s":this.cubicCurveTo(u.multiply(2).subtract(o),o=n(0),n(2,!0));break;case"q":this.quadraticCurveTo(o=n(0),n(2,!0));break;case"t":for(var c=0;c<i.length;c+=2)this.quadraticCurveTo(o=u.multiply(2).subtract(o),n(c,!0));break;case"a":break;case"z":this.closePath()}}}}),Path=this.Path=PathItem.extend({_type:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(e){this._closed=!1,this._segments=[],this.base();var t=Array.isArray(e)?typeof e[0]=="object"?e:arguments:!e||e.point===undefined&&e.x===undefined?null:arguments;this.setSegments(t||[]),t||this._set(e)},clone:function(){var e=this._clone(new Path(this._segments));return e._closed=this._closed,this._clockwise!==undefined&&(e._clockwise=this._clockwise),e},_changed:function(e){Item.prototype._changed.call(this,e);if(e&4){delete this._length,delete this._clockwise;if(this._curves)for(var t=0,n=this._curves.length;t<n;t++)this._curves[t]._changed(5)}else e&8&&delete this._bounds},getSegments:function(){return this._segments},setSegments:function(e){this._selectedSegmentState=0,this._segments.length=0,delete this._curves,this._add(Segment.readAll(e))},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,t=this._segments;if(!e){var n=this._countCurves();e=this._curves=new Array(n);for(var r=0;r<n;r++)e[r]=Curve.create(this,t[r],t[r+1]||t[0])}return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},getPathData:function(){function e(e,t,n){var i=e._point,u=t._point,a=e._handleOut,f=t._handleIn;if(a.isZero()&&f.isZero())n||o.push("L"+r(u,s));else{var l=u.subtract(i);o.push("c"+r(a,s)+" "+r(l.add(f),s)+" "+r(l,s))}}var t=this._segments,n=this._style,r=Format.point,s=arguments[0],o=[];if(t.length===0)return"";o.push("M"+r(t[0]._point));for(i=0,l=t.length-1;i<l;i++)e(t[i],t[i+1],!1);return(this._closed&&n._strokeColor||n._fillColor)&&e(t[t.length-1],t[0],!0),this._closed&&o.push("z"),o.join("")},isClosed:function(){return this._closed},setClosed:function(e){if(this._closed!=(e=!!e)){this._closed=e;if(this._curves){var t=this._curves.length=this._countCurves();e&&(this._curves[t-1]=Curve.create(this,this._segments[t-1],this._segments[0]))}this._changed(5)}},isEmpty:function(){return this._segments.length===0},isPolygon:function(){for(var e=0,t=this._segments.length;e<t;e++)if(!this._segments[e].isLinear())return!1;return!0},applyMatrix:!0,_applyMatrix:function(e){var t=new Array(6);for(var n=0,r=this._segments.length;n<r;n++)this._segments[n]._transformCoordinates(e,t,!0);var i=this._style,s=i._fillColor,o=i._strokeColor;return s&&s.transform&&s.transform(e),o&&o.transform&&o.transform(e),!0},_add:function(e,t){var n=this._segments,r=this._curves,i=e.length,s=t==null,t=s?n.length:t,o=this.isFullySelected();for(var u=0;u<i;u++){var a=e[u];a._path&&(a=e[u]=a.clone()),a._path=this,a._index=t+u,o&&(a._selectionState=4),a._selectionState&&this._updateSelection(a,0,a._selectionState)}if(s)n.push.apply(n,e);else{n.splice.apply(n,[t,0].concat(e));for(var u=t+i,f=n.length;u<f;u++)n[u]._index=u}if(r||e._curves){r||(r=this._curves=[]);var l=t>0?t-1:t,c=l,h=Math.min(l+i,this._countCurves());e._curves&&(r.splice.apply(r,[l,0].concat(e._curves)),c+=e._curves.length);for(var u=c;u<h;u++)r.splice(u,0,Base.create(Curve));this._adjustCurves(l,h)}return this._changed(5),e},_adjustCurves:function(e,t){var n=this._segments,r=this._curves,i;for(var s=e;s<t;s++)i=r[s],i._path=this,i._segment1=n[s],i._segment2=n[s+1]||n[0];if(i=r[this._closed&&e===0?n.length-1:e-1])i._segment2=n[e]||n[0];if(i=r[t])i._segment1=n[t]},_countCurves:function(){var e=this._segments.length;return!this._closed&&e>0?e-1:e},add:function(e){return arguments.length>1&&typeof e!="number"?this._add(Segment.readAll(arguments)):this._add([Segment.read(arguments)])[0]},insert:function(e,t){return arguments.length>2&&typeof t!="number"?this._add(Segment.readAll(arguments,1),e):this._add([Segment.read(arguments,1)],e)[0]},addSegment:function(e){return this._add([Segment.read(arguments)])[0]},insertSegment:function(e,t){return this._add([Segment.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(Segment.readAll(e))},insertSegments:function(e,t){return this._add(Segment.readAll(t),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(e,t){e=e||0,t=Base.pick(t,this._segments.length);var n=this._segments,r=this._curves,i=n.length,s=n.splice(e,t-e),o=s.length;if(!o)return s;for(var u=0;u<o;u++){var a=s[u];a._selectionState&&this._updateSelection(a,a._selectionState,0),delete a._index,delete a._path}for(var u=e,f=n.length;u<f;u++)n[u]._index=u;if(r){var l=t==i+(this._closed?1:0)?e-1:e,r=r.splice(l,o);arguments[2]&&(s._curves=r.slice(1)),this._adjustCurves(l,l)}return this._changed(5),s},isFullySelected:function(){return this._selected&&this._selectedSegmentState==this._segments.length*4},setFullySelected:function(e){e&&this._selectSegments(!0),this.setSelected(e)},setSelected:function(e){e||this._selectSegments(!1),this.base(e)},_selectSegments:function(e){var t=this._segments.length;this._selectedSegmentState=e?t*4:0;for(var n=0;n<t;n++)this._segments[n]._selectionState=e?4:0},_updateSelection:function(e,t,n){e._selectionState=n;var r=this._selectedSegmentState+=n-t;r>0&&this.setSelected(!0)},flatten:function(e){var t=new PathFlattener(this),n=0,r=t.length/Math.ceil(t.length/e),i=t.length+(this._closed?-r:r)/2,s=[];while(n<=i)s.push(new Segment(t.evaluate(n,0))),n+=r;this.setSegments(s)},simplify:function(e){if(this._segments.length>2){var t=new PathFitter(this,e||2.5);this.setSegments(t.fit())}},split:function(e,t){if(t===null)return;if(arguments.length==1){var n=e;typeof n=="number"&&(n=this.getLocationAt(n)),e=n.index,t=n.parameter}t>=1&&(e++,t--);var r=this.getCurves();if(e>=0&&e<r.length){t>0&&r[e++].divide(t);var i=this.removeSegments(e,this._segments.length,!0),s;return this._closed?(this.setClosed(!1),s=this):e>0&&(s=this._clone((new Path).insertAbove(this,!0))),s._add(i,0),this.addSegment(i[0]),s}return null},isClockwise:function(){function e(e,i){n!==undefined&&(t+=(n-e)*(i+r)),n=e,r=i}if(this._clockwise!==undefined)return this._clockwise;var t=0,n,r;for(var i=0,s=this._segments.length;i<s;i++){var o=this._segments[i],u=this._segments[i+1<s?i+1:0],a=o._point,f=o._handleOut,l=u._handleIn,c=u._point;e(a._x,a._y),e(a._x+f._x,a._y+f._y),e(c._x+l._x,c._y+l._y),e(c._x,c._y)}return t>0},setClockwise:function(e){this.isClockwise()!=(e=!!e)&&this.reverse(),this._clockwise=e},reverse:function(){this._segments.reverse();for(var e=0,t=this._segments.length;e<t;e++){var n=this._segments[e],r=n._handleIn;n._handleIn=n._handleOut,n._handleOut=r,n._index=e}this._clockwise!==undefined&&(this._clockwise=!this._clockwise)},join:function(e){if(e){var t=e._segments,n=this.getLastSegment(),r=e.getLastSegment();n._point.equals(r._point)&&e.reverse();var i=e.getFirstSegment();if(n._point.equals(i._point))n.setHandleOut(i._handleOut),this._add(t.slice(1));else{var s=this.getFirstSegment();s._point.equals(i._point)&&e.reverse(),r=e.getLastSegment(),s._point.equals(r._point)?(s.setHandleIn(r._handleIn),this._add(t.slice(0,t.length-1),0)):this._add(t.slice(0))}e.remove();var s=this.getFirstSegment();return n=this.getLastSegment(),n._point.equals(s._point)&&(s.setHandleIn(n._handleIn),n.remove(),this.setClosed(!0)),this._changed(5),!0}return!1},reduce:function(){return this},getLength:function(){if(this._length==null){var e=this.getCurves();this._length=0;for(var t=0,n=e.length;t<n;t++)this._length+=e[t].getLength()}return this._length},_getOffset:function(e){var t=e&&e.getIndex();if(t!=null){var n=this.getCurves(),r=0;for(var i=0;i<t;i++)r+=n[i].getLength();var s=n[t];return r+s.getLength(0,e.getParameter())}return null},getLocationOf:function(e){e=Point.read(arguments);var t=this.getCurves();for(var n=0,r=t.length;n<r;n++){var i=t[n].getLocationOf(e);if(i)return i}return null},getLocationAt:function(e,t){var n=this.getCurves(),r=0;if(t){var i=~~e;return n[i].getLocationAt(e-i,!0)}for(var s=0,o=n.length;s<o;s++){var u=r,a=n[s];r+=a.getLength();if(r>=e)return a.getLocationAt(e-u)}return e<=this.getLength()?new CurveLocation(n[n.length-1],1):null},getPointAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getPoint()},getTangentAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getTangent()},getNormalAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getNormal()},getNearestLocation:function(e){var t=this.getCurves(),n=Infinity,r=null;for(var i=0,s=t.length;i<s;i++){var o=t[i].getNearestLocation(e);o._distance<n&&(n=o._distance,r=o)}return r},getNearestPoint:function(e){return this.getNearestLocation(e).getPoint()},hasFill:function(){return this._style._fillColor||this._parent instanceof CompoundPath&&this._parent._style._fillColor},contains:function(e){e=Point.read(arguments);var t=this.hasFill();if(!this._closed&&!t||!this.getRoughBounds()._containsPoint(e))return!1;var n=this.getCurves(),r=this._segments,i=0,s=new Array(3);for(var o=0,u=n.length;o<u;o++)i+=n[o].getCrossings(e,s);return!this._closed&&t&&(i+=Curve.create(this,r[r.length-1],r[0]).getCrossings(e,s)),(i&1)==1},_hitTest:function(e,t){function n(t,n,r){if(e.getDistance(n)<s)return new HitResult(r,l,{segment:t,point:n})}function r(e,r){var i=e._point;return(r||t.segments)&&n(e,i,"segment")||!r&&t.handles&&(n(e,i.add(e._handleIn),"handle-in")||n(e,i.add(e._handleOut),"handle-out"))}var i=this._style,s=t.tolerance||0,o=(t.stroke&&i._strokeColor?i._strokeWidth/2:0)+s,u,a,f=[],l=this;if(t.ends&&!t.segments&&!this._closed){if(a=r(this.getFirstSegment(),!0)||r(this.getLastSegment(),!0))return a}else if(t.segments||t.handles)for(var c=0,h=this._segments.length;c<h;c++)if(a=r(this._segments[c]))return a;t.stroke&&o>0&&(u=this.getNearestLocation(e));if(!(u&&u._distance<=o)&&t.fill&&this.hasFill()&&this.contains(e))return new HitResult("fill",this);!u&&t.stroke&&o>0&&(u=this.getNearestLocation(e));if(u&&u._distance<=o)return t.stroke?new HitResult("stroke",this,{location:u}):new HitResult("fill",this)}},new function(){function e(e,t,n,r){function i(t){var n=o[t],r=o[t+1];if(h!=n||p!=r)e.beginPath(),e.moveTo(h,p),e.lineTo(n,r),e.stroke(),e.beginPath(),e.arc(n,r,s,0,Math.PI*2,!0),e.fill()}var s=r/2,o=new Array(6);for(var u=0,a=t.length;u<a;u++){var f=t[u];f._transformCoordinates(n,o,!1);var l=f._selectionState,c=l&4,h=o[0],p=o[1];(c||l&1)&&i(2),(c||l&2)&&i(4),e.save(),e.beginPath(),e.rect(h-s,p-s,r,r),e.fill(),c||(e.beginPath(),e.rect(h-s+1,p-s+1,r-2,r-2),e.fillStyle="#ffffff",e.fill()),e.restore()}}function t(e,t,n){function r(t){var r=i[t];if(n)r._transformCoordinates(n,o,!1),a=o[0],f=o[1];else{var s=r._point;a=s._x,f=s._y}if(u)e.moveTo(a,f),u=!1;else{if(n)h=o[2],p=o[3];else{var m=r._handleIn;h=a+m._x,p=f+m._y}h==a&&p==f&&d==l&&v==c?e.lineTo(a,f):e.bezierCurveTo(d,v,h,p,a,f)}l=a,c=f;if(n)d=o[4],v=o[5];else{var m=r._handleOut;d=l+m._x,v=c+m._y}}var i=t._segments,s=i.length,o=new Array(6),u=!0,a,f,l,c,h,p,d,v;for(var m=0;m<s;m++)r(m);t._closed&&s>1&&r(0)}return{draw:function(e,n){n.compound||e.beginPath();var r=this._style,i=r._fillColor,s=r._strokeColor,o=r._dashArray,u=!paper.support.nativeDash&&s&&o&&o.length,a=n.clip||this._clipMask;(n.compound||a||i||s&&!u)&&t(e,this),this._closed&&e.closePath();if(a)e.clip();else if(!n.compound&&(i||s)){this._setStyles(e),i&&e.fill();if(s){if(u){e.beginPath();var f=new PathFlattener(this),l=r._dashOffset,c,h=0;while(l<f.length)c=l+o[h++%o.length],f.drawPart(e,l,c),l=c+o[h++%o.length]}e.stroke()}}},drawSelected:function(n,r){n.beginPath(),t(n,this,r),n.stroke(),e(n,this._segments,r,this._project.options.handleSize||4)}}},new function(){function e(e){var t=e.length,n=[],r=[],i=2;n[0]=e[0]/i;for(var s=1;s<t;s++)r[s]=1/i,i=(s<t-1?4:2)-r[s],n[s]=(e[s]-n[s-1])/i;for(var s=1;s<t;s++)n[t-s-1]-=r[t-s]*n[t-s];return n}return{smooth:function(){var t=this._segments,n=t.length,r=n,i;if(n<=2)return;this._closed?(i=Math.min(n,4),r+=Math.min(n,i)*2):i=0;var s=[];for(var o=0;o<n;o++)s[o+i]=t[o]._point;if(this._closed)for(var o=0;o<i;o++)s[o]=t[o+n-i]._point,s[o+n+i]=t[o]._point;else r--;var u=[];for(var o=1;o<r-1;o++)u[o]=4*s[o]._x+2*s[o+1]._x;u[0]=s[0]._x+2*s[1]._x,u[r-1]=3*s[r-1]._x;var a=e(u);for(var o=1;o<r-1;o++)u[o]=4*s[o]._y+2*s[o+1]._y;u[0]=s[0]._y+2*s[1]._y,u[r-1]=3*s[r-1]._y;var f=e(u);if(this._closed){for(var o=0,l=n;o<i;o++,l++){var c=o/i,h=1-c,p=o+i,d=l+i;a[l]=a[o]*c+a[l]*h,f[l]=f[o]*c+f[l]*h,a[d]=a[p]*h+a[d]*c,f[d]=f[p]*h+f[d]*c}r--}var v=null;for(var o=i;o<=r-i;o++){var m=t[o-i];v&&m.setHandleIn(v.subtract(m._point)),o<r&&(m.setHandleOut(Point.create(a[o],f[o]).subtract(m._point)),o<r-1?v=Point.create(2*s[o+1]._x-a[o+1],2*s[o+1]._y-f[o+1]):v=Point.create((s[r]._x+a[r-1])/2,(s[r]._y+f[r-1])/2))}if(this._closed&&v){var m=this._segments[0];m.setHandleIn(v.subtract(m._point))}}}},new function(){function e(e){var t=e._segments;if(t.length==0)throw new Error("Use a moveTo() command first");return t[t.length-1]}return{moveTo:function(e){this._segments.length===1&&this.removeSegment(0),this._segments.length||this._add([new Segment(Point.read(arguments))])},moveBy:function(e){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(e){this._add([new Segment(Point.read(arguments))])},cubicCurveTo:function(t,n,r){var i=Point.read(arguments),s=Point.read(arguments),o=Point.read(arguments),u=e(this);u.setHandleOut(i.subtract(u._point)),this._add([new Segment(o,s.subtract(r))])},quadraticCurveTo:function(t,n){var r=Point.read(arguments),n=Point.read(arguments),i=e(this)._point;this.cubicCurveTo(r.add(i.subtract(r).multiply(1/3)),r.add(n.subtract(r).multiply(1/3)),n)},curveTo:function(t,n,r){var i=Point.read(arguments),s=Point.read(arguments),o=Base.pick(Base.read(arguments),.5),u=1-o,a=e(this)._point,f=i.subtract(a.multiply(u*u)).subtract(s.multiply(o*o)).divide(2*o*u);if(f.isNaN())throw new Error("Cannot put a curve through points with parameter = "+o);this.quadraticCurveTo(f,s)},arcTo:function(t,n){var r=e(this),i=r._point,s,o=Point.read(arguments),u=Base.pick(Base.peek(arguments),!0);if(typeof u=="boolean"){t=o,n=u;var a=i.add(t).divide(2),s=a.add(a.subtract(i).rotate(n?-90:90))}else s=o,t=Point.read(arguments);var f=new Line(i.add(s).divide(2),s.subtract(i).rotate(90)),l=new Line(s.add(t).divide(2),t.subtract(s).rotate(90)),c=f.intersect(l),h=new Line(i,t,!0),p=h.getSide(s);if(!c){if(!p)return this.lineTo(t);throw new Error("Cannot put an arc through the given points: "+[i,s,t])}var d=i.subtract(c),v=d.getLength(),m=d.getDirectedAngle(t.subtract(c)),g=h.getSide(c);g==0?m=p*Math.abs(m):p==g&&(m-=360*(m<0?-1:1));var y=Math.abs(m),b=y>=360?4:Math.ceil(y/90),w=m/b,E=w*Math.PI/360,S=4/3*Math.sin(E)/(1+Math.cos(E)),x=[];for(var T=0;T<=b;T++){var N=T<b?c.add(d):t,C=T<b?d.rotate(90).multiply(S):null;T==0?r.setHandleOut(C):x.push(new Segment(N,d.rotate(-90).multiply(S),C)),d=d.rotate(w)}this._add(x)},lineBy:function(t){t=Point.read(arguments);var n=e(this);this.lineTo(n._point.add(t))},curveBy:function(t,n,r){t=Point.read(t),n=Point.read(n);var i=e(this)._point;this.curveTo(i.add(t),i.add(n),r)},arcBy:function(t,n){t=Point.read(t),n=Point.read(n);var r=e(this)._point;this.arcBy(r.add(t),r.add(n))},closePath:function(){var e=this.getFirstSegment(),t=this.getLastSegment();e._point.equals(t._point)&&(e.setHandleIn(t._handleIn),t.remove()),this.setClosed(!0)}}},{_getBounds:function(e,t){return Path[e](this._segments,this._closed,this._style,t)},statics:{getBounds:function(e,t,n,r,i){function s(e){e._transformCoordinates(r,u,!1);for(var t=0;t<2;t++)Curve._addBounds(a[t],a[t+4],u[t+2],u[t],t,i?i[t]:0,f,l,c);var n=a;a=u,u=n}var o=e[0];if(!o)return new Rectangle;var u=new Array(6),a=o._transformCoordinates(r,new Array(6),!1),f=a.slice(0,2),l=f.slice(0),c=new Array(2);for(var h=1,p=e.length;h<p;h++)s(e[h]);return t&&s(o),Rectangle.create(f[0],f[1],l[0]-f[0],l[1]-f[1])},getStrokeBounds:function(e,t,n,r){function i(e,t){if(!t)return[e,e];var n=t.shiftless(),r=n.transform(Point.create(e,0)),i=n.transform(Point.create(0,e)),s=r.getAngleInRadians(),o=r.getLength(),u=i.getLength(),a=Math.sin(s),f=Math.cos(s),l=Math.tan(s),c=-Math.atan(u*l/o),h=Math.atan(u/(l*o));return[Math.abs(o*Math.cos(c)*f-u*Math.sin(c)*a),Math.abs(u*Math.sin(h)*f+o*Math.cos(h)*a)]}function s(e){c=c.include(r?r._transformPoint(e,e):e)}function o(e,t){var n=e.getPointAt(t,!0),r=e.getNormalAt(t,!0).normalize(f);s(n.add(r)),s(n.subtract(r))}function u(e,t){if(t==="round"||!e._handleIn.isZero()&&!e._handleOut.isZero())c=c.unite(v.setCenter(r?r._transformPoint(e._point):e._point));else if(t=="bevel"){var n=e.getCurve();o(n,0),o(n.getPrevious(),1)}else if(t=="miter"){var i=e.getCurve(),a=i.getPrevious(),l=i.getPointAt(0,!0),h=a.getNormalAt(1,!0).normalize(f),p=i.getNormalAt(0,!0).normalize(f),m=new Line(l.subtract(h),Point.create(-h.y,h.x)),g=new Line(l.subtract(p),Point.create(-p.y,p.x)),y=m.intersect(g);!y||l.getDistance(y)>d?u(e,"bevel"):s(y)}}function a(e,t,n){switch(t){case"round":return u(e,t);case"butt":case"square":var r=e.getCurve(),i=r.getPointAt(n,!0),o=r.getNormalAt(n,!0).normalize(f);t==="square"&&(i=i.add(o.rotate(n==0?-90:90))),s(i.add(o)),s(i.subtract(o))}}if(!n._strokeColor||!n._strokeWidth)return Path.getBounds(e,t,n,r);var f=n._strokeWidth/2,l=i(f,r),c=Path.getBounds(e,t,n,r,l),h=n._strokeJoin,p=n._strokeCap,d=n._miterLimit*n._strokeWidth/2,v=new Rectangle((new Size(l)).multiply(2));for(var m=1,g=e.length-(t?0:1);m<g;m++)u(e[m],h);return t?u(e[0],h):(a(e[0],p,0),a(e[e.length-1],p,1)),c},getHandleBounds:function(e,t,n,r,i,s){var o=new Array(6),u=Infinity,a=-u,f=u,l=a;i=i/2||0,s=s/2||0;for(var c=0,h=e.length;c<h;c++){var p=e[c];p._transformCoordinates(r,o,!1);for(var d=0;d<6;d+=2){var v=d==0?s:i,m=o[d],g=o[d+1],y=m-v,b=m+v,w=g-v,E=g+v;y<u&&(u=y),b>a&&(a=b),w<f&&(f=w),E>l&&(l=E)}}return Rectangle.create(u,f,a-u,l-f)},getRoughBounds:function(e,t,n,r){var i=n._strokeColor?n._strokeWidth:0;return Path.getHandleBounds(e,t,n,r,i,n._strokeJoin=="miter"?i*n._miterLimit:i)}}});Path.inject({statics:new function(){function e(e){return(new Path).set(Base.getNamed(e))}function t(){var t=Rectangle.readNamed(arguments,"rectangle"),n=t.getLeft(),r=t.getTop(),i=t.getRight(),s=t.getBottom(),o=e(arguments);return o._add([new Segment(Point.create(n,s)),new Segment(Point.create(n,r)),new Segment(Point.create(i,r)),new Segment(Point.create(i,s))]),o._closed=!0,o}function n(){var t=Rectangle.readNamed(arguments,"rectangle"),n=e(arguments),r=t.getPoint(!0),s=t.getSize(!0),o=new Array(4);for(var u=0;u<4;u++){var a=i[u];o[u]=new Segment(a._point.multiply(s).add(r),a._handleIn.multiply(s),a._handleOut.multiply(s))}return n._add(o),n._closed=!0,n}var r=2*(Math.sqrt(2)-1)/3,i=[new Segment([0,.5],[0,r],[0,-r]),new Segment([.5,0],[-r,0],[r,0]),new Segment([1,.5],[0,-r],[0,r]),new Segment([.5,1],[r,0],[-r,0])];return{Line:function(){return(new Path(Point.readNamed(arguments,"from"),Point.readNamed(arguments,"to"))).set(Base.getNamed(arguments))},Rectangle:t,RoundRectangle:function(){var n=Rectangle.readNamed(arguments,"rectangle"),i=Size.readNamed(arguments,"radius");if(i.isZero())return t(n);i=Size.min(i,n.getSize(!0).divide(2));var s=n.getBottomLeft(!0),o=n.getTopLeft(!0),u=n.getTopRight(!0),a=n.getBottomRight(!0),f=i.multiply(r*2),l=e(arguments);return l._add([new Segment(s.add(i.width,0),null,[-f.width,0]),new Segment(s.subtract(0,i.height),[0,f.height],null),new Segment(o.add(0,i.height),null,[0,-f.height]),new Segment(o.add(i.width,0),[-f.width,0],null),new Segment(u.subtract(i.width,0),null,[f.width,0]),new Segment(u.add(0,i.height),[0,-f.height],null),new Segment(a.subtract(0,i.height),null,[0,f.height]),new Segment(a.subtract(i.width,0),[f.width,0],null)]),l._closed=!0,l},Ellipse:n,Oval:n,Circle:function(){var e=Point.readNamed(arguments,"center"),t=Base.readNamed(arguments,"radius");return n(new Rectangle(e.subtract(t),Size.create(t*2,t*2))).set(Base.getNamed(arguments))},Arc:function(){var t=Point.readNamed(arguments,"from"),n=Point.readNamed(arguments,"through"),r=Point.readNamed(arguments,"to"),i=e(arguments);return i.moveTo(t),i.arcTo(n,r),i},RegularPolygon:function(){var t=Point.readNamed(arguments,"center"),n=Base.readNamed(arguments,"sides"),r=Base.readNamed(arguments,"radius"),i=e(arguments),s=360/n,o=!(n%3),u=new Point(0,o?-r:r),a=o?-1:.5,f=new Array(n);for(var l=0;l<n;l++)f[l]=new Segment(t.add(u.rotate((l+a)*s)));return i._add(f),i._closed=!0,i},Star:function(){var t=Point.readNamed(arguments,"center"),n=Base.readNamed(arguments,"points")*2,r=Base.readNamed(arguments,"radius1"),i=Base.readNamed(arguments,"radius2"),s=e(arguments),o=360/n,u=new Point(0,-1),a=new Array(n);for(var f=0;f<n;f++)a[f]=new Segment(t.add(u.rotate(o*f).multiply(f%2?i:r)));return s._add(a),s._closed=!0,s}}}});var CompoundPath=this.CompoundPath=PathItem.extend({_type:"CompoundPath",_serializeFields:{pathData:""},initialize:function(e){this.base(),this._children=[],this._namedChildren={},this._set(e)||this.addChildren(Array.isArray(e)?e:arguments)},insertChild:function(e,t,n){return t._type!=="Path"?null:(t=this.base(e,t),!n&&t&&t._clockwise===undefined&&t.setClockwise(t._index==0),t)},reduce:function(){if(this._children.length==1){var e=this._children[0];return e.insertAbove(this),this.remove(),e}return this},smooth:function(){for(var e=0,t=this._children.length;e<t;e++)this._children[e].smooth()},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t=t.concat(e[n].getCurves());return t},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getFirstCurve()},getPathData:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n].getPathData(arguments[0]));return t.join(" ")},_contains:function(e){var t=[];for(var n=0,r=this._children.length;n<r;n++){var i=this._children[n];i.contains(e)&&t.push(i)}return(t.length&1)==1&&t},contains:function(e){return!!this._contains(Point.read(arguments))},_hitTest:function(e,t){var n=this.base(e,Base.merge(t,{fill:!1}));return!n&&t.fill&&this._style._fillColor&&(n=this._contains(e),n=n?new HitResult("fill",n[0]):null),n},draw:function(e,t){var n=this._children,r=this._style;if(n.length==0)return;e.beginPath(),t.compound=!0;for(var i=0,s=n.length;i<s;i++)Item.draw(n[i],e,t);t.compound=!1,t.clip||this._clipMask?e.clip():(this._setStyles(e),r._fillColor&&e.fill(),r._strokeColor&&e.stroke())}},new function(){function e(e){if(!e._children.length)throw new Error("Use a moveTo() command first");return e._children[e._children.length-1]}var t={moveTo:function(e){var t=new Path;this.addChild(t),t.moveTo.apply(t,arguments)},moveBy:function(t){this.moveTo(e(this).getLastSegment()._point.add(Point.read(arguments)))},closePath:function(){e(this).closePath()}};return Base.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","curveBy","arcBy"],function(n){t[n]=function(){var t=e(this);t[n].apply(t,arguments)}}),t}),PathFlattener=Base.extend({initialize:function(e){function t(e,t){var n=Curve.getValues(e,t);s.curves.push(n),s._computeParts(n,e._index,0,1)}this.curves=[],this.parts=[],this.length=0,this.index=0;var n=e._segments,r=n[0],i,s=this;for(var o=1,u=n.length;o<u;o++)i=n[o],t(r,i),r=i;e._closed&&t(i,n[0])},_computeParts:function(e,t,n,r){if(r-n>1/32&&!Curve.isFlatEnough(e,.25)){var i=Curve.subdivide(e),s=(n+r)/2;this._computeParts(i[0],t,n,s),this._computeParts(i[1],t,s,r)}else{var o=e[6]-e[0],u=e[7]-e[1],a=Math.sqrt(o*o+u*u);a>1e-5&&(this.length+=a,this.parts.push({offset:this.length,value:r,index:t}))}},getParameterAt:function(e){var t,n=this.index;for(;;){t=n;if(n==0||this.parts[--n].offset<e)break}for(var r=this.parts.length;t<r;t++){var i=this.parts[t];if(i.offset>=e){this.index=t;var s=this.parts[t-1],o=s&&s.index==i.index?s.value:0,u=s?s.offset:0;return{value:o+(i.value-o)*(e-u)/(i.offset-u),index:i.index}}}var i=this.parts[this.parts.length-1];return{value:1,index:i.index}},evaluate:function(e,t){var n=this.getParameterAt(e);return Curve.evaluate(this.curves[n.index],n.value,!0,t)},drawPart:function(e,t,n){t=this.getParameterAt(t),n=this.getParameterAt(n);for(var r=t.index;r<=n.index;r++){var i=Curve.getPart(this.curves[r],r==t.index?t.value:0,r==n.index?n.value:1);r==t.index&&e.moveTo(i[0],i[1]),e.bezierCurveTo.apply(e,i.slice(2))}}}),PathFitter=Base.extend({initialize:function(e,t){this.points=[];var n=e._segments,r;for(var i=0,s=n.length;i<s;i++){var o=n[i].point.clone();if(!r||!r.equals(o))this.points.push(o),r=o}this.error=t},fit:function(){var e=this.points,t=e.length;return this.segments=t>0?[new Segment(e[0])]:[],t>1&&this.fitCubic(0,t-1,e[1].subtract(e[0]).normalize(),e[t-2].subtract(e[t-1]).normalize()),this.segments},fitCubic:function(e,t,n,r){if(t-e==1){var i=this.points[e],s=this.points[t],o=i.getDistance(s)/3;this.addCurve([i,i.add(n.normalize(o)),s.add(r.normalize(o)),s]);return}var u=this.chordLengthParameterize(e,t),a=Math.max(this.error,this.error*this.error),f,l;for(var c=0;c<=4;c++){var h=this.generateBezier(e,t,u,n,r),p=this.findMaxError(e,t,h,u);if(p.error<this.error){this.addCurve(h);return}l=p.index;if(p.error>=a)break;this.reparameterize(e,t,u,h),a=p.error}var d=this.points[l-1].subtract(this.points[l]),v=this.points[l].subtract(this.points[l+1]),m=d.add(v).divide(2).normalize();this.fitCubic(e,l,n,m),this.fitCubic(l,t,m.negate(),r)},addCurve:function(e){var t=this.segments[this.segments.length-1];t.setHandleOut(e[1].subtract(e[0])),this.segments.push(new Segment(e[3],e[2].subtract(e[3])))},generateBezier:function(e,t,n,r,i){var s=1e-11,o=this.points[e],u=this.points[t],a=[[0,0],[0,0]],f=[0,0];for(var l=0,c=t-e+1;l<c;l++){var h=n[l],p=1-h,d=3*h*p,v=p*p*p,m=d*p,g=d*h,y=h*h*h,b=r.normalize(m),w=i.normalize(g),E=this.points[e+l].subtract(o.multiply(v+m)).subtract(u.multiply(g+y));a[0][0]+=b.dot(b),a[0][1]+=b.dot(w),a[1][0]=a[0][1],a[1][1]+=w.dot(w),f[0]+=b.dot(E),f[1]+=w.dot(E)}var S=a[0][0]*a[1][1]-a[1][0]*a[0][1],x,T;if(Math.abs(S)>s){var N=a[0][0]*f[1]-a[1][0]*f[0],C=f[0]*a[1][1]-f[1]*a[0][1];x=C/S,T=N/S}else{var k=a[0][0]+a[0][1],L=a[1][0]+a[1][1];Math.abs(k)>s?x=T=f[0]/k:Math.abs(L)>s?x=T=f[1]/L:x=T=0}var A=u.getDistance(o);s*=A;if(x<s||T<s)x=T=A/3;return[o,o.add(r.normalize(x)),u.add(i.normalize(T)),u]},reparameterize:function(e,t,n,r){for(var i=e;i<=t;i++)n[i-e]=this.findRoot(r,this.points[i],n[i-e])},findRoot:function(e,t,n){var r=[],i=[];for(var s=0;s<=2;s++)r[s]=e[s+1].subtract(e[s]).multiply(3);for(var s=0;s<=1;s++)i[s]=r[s+1].subtract(r[s]).multiply(2);var o=this.evaluate(3,e,n),u=this.evaluate(2,r,n),a=this.evaluate(1,i,n),f=o.subtract(t),l=u.dot(u)+f.dot(a);return Math.abs(l)<1e-5?n:n-f.dot(u)/l},evaluate:function(e,t,n){var r=t.slice();for(var i=1;i<=e;i++)for(var s=0;s<=e-i;s++)r[s]=r[s].multiply(1-n).add(r[s+1].multiply(n));return r[0]},chordLengthParameterize:function(e,t){var n=[0];for(var r=e+1;r<=t;r++)n[r-e]=n[r-e-1]+this.points[r].getDistance(this.points[r-1]);for(var r=1,i=t-e;r<=i;r++)n[r]/=n[i];return n},findMaxError:function(e,t,n,r){var i=Math.floor((t-e+1)/2),s=0;for(var o=e+1;o<t;o++){var u=this.evaluate(3,n,r[o-e]),a=u.subtract(this.points[o]),f=a.x*a.x+a.y*a.y;f>=s&&(s=f,i=o)}return{error:s,index:i}}}),TextItem=this.TextItem=Item.extend({_boundsSelected:!0,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(e){this._style=CharacterStyle.create(this),this._paragraphStyle=ParagraphStyle.create(this);var t=Base.isPlainObject(e)&&e.x===undefined&&e.y===undefined;this.base(t?null:Point.read(arguments)),this.setParagraphStyle(),this._content="",this._lines=[],t&&this._set(e)},_clone:function(e){return e.setContent(this._content),e.setParagraphStyle(this._paragraphStyle),this.base(e)},getContent:function(){return this._content},setContent:function(e){this._content=""+e,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(69)},isEmpty:function(){return!this._content},getCharacterStyle:function(){return this.getStyle()},setCharacterStyle:function(e){this.setStyle(e)}}),PointText=this.PointText=TextItem.extend({_type:"PointText",clone:function(){return this._clone(new PointText)},getPoint:function(){var e=this._matrix.getTranslation();return LinkedPoint.create(this,"setPoint",e.x,e.y)},setPoint:function(e){this.translate(Point.read(arguments).subtract(this._matrix.getTranslation()))},draw:function(e){if(!this._content)return;this._setStyles(e);var t=this._style,n=this.getLeading(),r=this._lines;e.font=t.getFontStyle(),e.textAlign=this.getJustification();for(var i=0,s=r.length;i<s;i++){var o=r[i];t._fillColor&&e.fillText(o,0,0),t._strokeColor&&e.strokeText(o,0,0),e.translate(0,n)}}},new function(){var e=null;return{_getBounds:function(t,n){e||(e=CanvasProvider.getContext(1,1));var r=this.getJustification(),i=0;e.font=this._style.getFontStyle();var s=0;for(var o=0,u=this._lines.length;o<u;o++)s=Math.max(s,e.measureText(this._lines[o]).width);r!=="left"&&(i-=s/(r==="center"?2:1));var a=this.getLeading(),f=this._lines.length,l=Rectangle.create(i,f?a/4+(f-1)*a:0,s,-f*a);return n?n._transformBounds(l,l):l}}}),Style=Base.extend({initialize:function(e){var t=e instanceof Style;return Base.each(this._defaults,function(n,r){n=e&&e[r]||n,this[r]=n&&t&&n.clone?n.clone():n},this)},_getChildren:function(){return this._item instanceof Group&&this._item._children},statics:{create:function(e){var t=Base.create(this);return t._item=e,t},extend:function(e){var t="_"+e._style,n=Base.capitalize(e._style),r=e._flags||{},i={};return i["get"+n]=function(){return this[t]},i["set"+n]=function(e){this[t].initialize(e)},Base.each(e._defaults,function(n,s){var o=/Color$/.test(s),u=Base.capitalize(s),a="set"+u,f="get"+u;e[a]=function(e){var n=this._getChildren();e=o?Color.read(arguments,0,0,!0):e;if(n&&n.length>0)for(var i=0,u=n.length;i<u;i++)n[i][t][a](e);else{var f=this["_"+s];Base.equals(f,e)||(o&&(f&&delete f._owner,e&&(e._owner=this._item)),this["_"+s]=e,this._item&&this._item._changed(r[s]||17))}},e[f]=function(){var e=this._getChildren(),n;if(!e||e.length===0)return this["_"+s];for(var r=0,i=e.length;r<i;r++){var o=e[r][t][f]();if(!n)n=o;else if(!Base.equals(n,o))return undefined}return n},i[f]=function(){return this[t][f]()},i[a]=function(e){this[t][a](e)}}),e._owner.inject(i),this.base.apply(this,arguments)}}}),PathStyle=this.PathStyle=Style.extend({_owner:Item,_style:"style",_defaults:{fillColor:undefined,strokeColor:undefined,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",miterLimit:10,dashOffset:0,dashArray:[]},_flags:{strokeWidth:25,strokeCap:25,strokeJoin:25,miterLimit:25}}),ParagraphStyle=this.ParagraphStyle=Style.extend({_owner:TextItem,_style:"paragraphStyle",_defaults:{justification:"left"},_flags:{justification:5}}),CharacterStyle=this.CharacterStyle=PathStyle.extend({_owner:TextItem,_style:"style",_defaults:Base.merge(PathStyle.prototype._defaults,{fillColor:"black",fontSize:12,leading:null,font:"sans-serif"}),_flags:{fontSize:5,leading:5,font:5}},{getLeading:function(){var e=this.base();return e!=null?e:this.getFontSize()*1.2},getFontStyle:function(){var e=this._fontSize;return(/[a-z]/i.test(e)?e+" ":e+"px ")+this._font}}),Color=this.Color=Base.extend(new function(){function e(e){var t=r[e];if(t)return t.clone();i||(i=CanvasProvider.getContext(1,1),i.globalCompositeOperation="copy"),i.fillStyle="rgba(0,0,0,0)",i.fillStyle=e,i.fillRect(0,0,1,1);var n=i.getImageData(0,0,1,1).data,s=[n[0]/255,n[1]/255,n[2]/255];return(r[e]=RgbColor.read(s)).clone()}function t(e){var t=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);if(t.length>=4){var n=new Array(3);for(var r=0;r<3;r++){var i=t[r+1];n[r]=parseInt(i.length==1?i+i:i,16)/255}return RgbColor.read(n)}}var n={gray:["gray"],rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsb:["hue","saturation","brightness"]},r={},i,s=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(e){var t=e._red,n=e._green,r=e._blue,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s,u=o==0?0:(i==t?(n-r)/o+(n<r?6:0):i==n?(r-t)/o+2:(t-n)/o+4)*60,a=i==0?0:o/i,f=i;return new HsbColor(u,a,f,e._alpha)},"hsb-rgb":function(e){var t=e._hue/60%6,n=e._saturation,r=e._brightness,i=Math.floor(t),o=t-i,i=s[i],u=[r,r*(1-n),r*(1-n*o),r*(1-n*(1-o))];return new RgbColor(u[i[0]],u[i[1]],u[i[2]],e._alpha)},"rgb-hsl":function(e){var t=e._red,n=e._green,r=e._blue,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s,u=o==0,a=u?0:(i==t?(n-r)/o+(n<r?6:0):i==n?(r-t)/o+2:(t-n)/o+4)*60,f=(i+s)/2,l=u?0:f<.5?o/(i+s):o/(2-i-s);return new HslColor(a,l,f,e._alpha)},"hsl-rgb":function(e){var t=e._saturation,n=e._hue/360,r=e._lightness;if(t==0)return new RgbColor(r,r,r,e._alpha);var i=[n+1/3,n,n-1/3],s=r<.5?r*(1+t):r+t-r*t,o=2*r-s,u=[];for(var a=0;a<3;a++){var f=i[a];f<0&&(f+=1),f>1&&(f-=1),u[a]=6*f<1?o+(s-o)*6*f:2*f<1?s:3*f<2?o+(s-o)*(2/3-f)*6:o}return new RgbColor(u[0],u[1],u[2],e._alpha)},"rgb-gray":function(e){return new GrayColor(1-(e._red*.2989+e._green*.587+e._blue*.114),e._alpha)},"gray-rgb":function(e){var t=1-e._gray;return new RgbColor(t,t,t,e._alpha)},"gray-hsb":function(e){return new HsbColor(0,0,1-e._gray,e._alpha)},"gray-hsl":function(e){return new HslColor(0,0,1-e._gray,e._alpha)}},u={_readNull:!0,_readIndex:!0,initialize:function(n){var r=Array.isArray(n),i=this._type,s;if(typeof n=="object"&&!r)i?(s=Color.read(arguments).convert(i),this._read&&(s._read=arguments._read)):(s=n.red!==undefined?new RgbColor(n.red,n.green,n.blue,n.alpha):n.gray!==undefined?new GrayColor(n.gray,n.alpha):n.lightness!==undefined?new HslColor(n.hue,n.saturation,n.lightness,n.alpha):n.hue!==undefined?new HsbColor(n.hue,n.saturation,n.brightness,n.alpha):new RgbColor,this._read&&(s._read=1));else if(typeof n=="string"){var o=n.match(/^#[0-9a-f]{3,6}$/i)?t(n):e(n);s=i?o.convert(i):o,this._read&&(s._read=1)}else{var u=r?n:Array.prototype.slice.call(arguments);if(!i){var a=u.length>=3?RgbColor:GrayColor;s=new a(u)}else s=Base.each(this._components,function(e,t){var n=u[t];this["_"+e]=n!==undefined?n:null},this);this._read&&(s._read=s._components.length)}return s},_serialize:function(e){var t=[this._type];for(var n=0,r=this._components.length;n<r;n++){var i=this._components[n],s=this["_"+i];(i!=="alpha"||s!=null&&s<1)&&t.push(Format.number(s,e.precision))}return t},clone:function(){var e=Base.create(this.constructor),t=this._components;for(var n=0,r=t.length;n<r;n++){var i="_"+t[n];e[i]=this[i]}return e},convert:function(e){var t;return this._type==e?this.clone():(t=o[this._type+"-"+e])?t(this):o["rgb-"+e](o[this._type+"-rgb"](this))},statics:{extend:function(e){var t=n[e._type];return t&&(e._components=t.concat(["alpha"]),Base.each(t,function(e){var t=e==="hue",n=Base.capitalize(e),e="_"+e;this["get"+n]=function(){return this[e]},this["set"+n]=function(n){this[e]=t?(n%360+360)%360:Math.min(Math.max(n,0),1),this._changed()}},e)),this.base.apply(this,arguments)},random:function(){return new RgbColor(Math.random(),Math.random(),Math.random())}}};return Base.each(n,function(e,t){Base.each(e,function(e){var n=Base.capitalize(e);u["get"+n]=function(){return this.convert(t)[e]},u["set"+n]=function(n){var r=this.convert(t);r[e]=n,r=r.convert(this._type);for(var i=0,s=this._components.length;i<s;i++){var o=this._components[i];this[o]=r[o]}}})}),u},{_changed:function(){this._css=null,this._owner&&this._owner._changed(17)},getType:function(){return this._type},getComponents:function(){var e=this._components.length,t=new Array(e);for(var n=0;n<e;n++)t[n]=this["_"+this._components[n]];return t},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(e){this._alpha=e==null?null:Math.min(Math.max(e,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(e){if(e&&e._type===this._type){for(var t=0,n=this._components.length;t<n;t++){var r="_"+this._components[t];if(this[r]!==e[r])return!1}return!0}return!1},toString:function(){var e=[],t=Format.number;for(var n=0,r=this._components.length;n<r;n++){var i=this._components[n],s=this["_"+i];i==="alpha"&&s==null&&(s=1),e.push(i+": "+t(s))}return"{ "+e.join(", ")+" }"},toCss:function(e){var t=this._css;if(!t||e){var n=this.convert("rgb"),r=e?1:n.getAlpha(),i=[Math.round(n._red*255),Math.round(n._green*255),Math.round(n._blue*255)];r<1&&i.push(r);var t=(i.length==4?"rgba(":"rgb(")+i.join(", ")+")";e||(this._css=t)}return t},toCanvasStyle:function(){return this.toCss()}}),GrayColor=this.GrayColor=Color.extend({_type:"gray"}),RgbColor=this.RgbColor=this.RGBColor=Color.extend({_type:"rgb"}),HsbColor=this.HsbColor=this.HSBColor=Color.extend({_type:"hsb"}),HslColor=this.HslColor=this.HSLColor=Color.extend({_type:"hsl"}),GradientColor=this.GradientColor=Color.extend({_type:"gradient",initialize:function(e,t,n,r){this._id=++Base._uid,this._set(e)||(this.setGradient(e||new LinearGradient),this.setOrigin(t),this.setDestination(n),r&&this.setHilite(r))},clone:function(){return new GradientColor(this._gradient,this._origin,this._destination,this._hilite)},_serialize:function(e,t){var n=[this._gradient,this._origin,this._destination];return this._hilite&&n.push(this._hilite),Base.serialize(n,e,!0,t)},getGradient:function(){return this._gradient},setGradient:function(e){this._gradient=e,e._addOwner(this),this._changed()},getOrigin:function(){return this._origin},setOrigin:function(e){e=Point.read(arguments,0,0,!0),this._origin=e,this._destination&&(this._radius=this._destination.getDistance(this._origin)),this._changed()},getDestination:function(){return this._destination},setDestination:function(e){e=Point.read(arguments,0,0,!0),this._destination=e,this._radius=this._destination.getDistance(this._origin),this._changed()},getHilite:function(){return this._hilite},setHilite:function(e){e=Point.read(arguments,0,0,!0);var t=e.subtract(this._origin);t.getLength()>this._radius?this._hilite=this._origin.add(t.normalize(this._radius-.1)):this._hilite=e,this._changed()},toCanvasStyle:function(e){var t,n=this._gradient._stops;if(this._gradient._type==="LinearGradient")t=e.createLinearGradient(this._origin.x,this._origin.y,this._destination.x,this._destination.y);else{var r=this._hilite||this._origin;t=e.createRadialGradient(r.x,r.y,0,this._origin.x,this._origin.y,this._radius)}for(var i=0,s=n.length;i<s;i++){var o=n[i];t.addColorStop(o._rampPoint,o._color.toCss())}return t},equals:function(e){return e===this||e&&e._type===this._type&&this._gradient.equals(e._gradient)&&this._origin.equals(e._origin)&&this._destination.equals(e._destination)},transform:function(e){e._transformPoint(this._origin,this._origin,!0),e._transformPoint(this._destination,this._destination,!0),this._hilite&&e._transformPoint(this._hilite,this._hilite,!0),this._radius=this._destination.getDistance(this._origin)}}),Gradient=this.Gradient=Base.extend({initialize:function(e,t){if(this.constructor===Gradient)return new(t==="radial"?RadialGradient:LinearGradient)(e);this._id=++Base._uid,this.setStops((arguments.length>1?arguments:e)||["white","black"])},_serialize:function(e,t){return t.add(this,function(){return Base.serialize([this._type,this._stops],e,!0,t)})},_changed:function(){for(var e=0,t=this._owners&&this._owners.length;e<t;e++)this._owners[e]._changed()},_addOwner:function(e){this._owners||(this._owners=[]),this._owners.push(e)},_removeOwner:function(e){var t=this._owners?this._owners.indexOf(e):-1;t!=-1&&(this._owners.splice(t,1),this._owners.length==0&&delete this._owners)},clone:function(){var e=[];for(var t=0,n=this._stops.length;t<n;t++)e[t]=this._stops[t].clone();return new this.constructor(e)},getStops:function(){return this._stops},setStops:function(e){if(this.stops)for(var t=0,n=this._stops.length;t<n;t++)delete this._stops[t]._owner;if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");this._stops=GradientStop.readAll(e,0,!0);for(var t=0,n=this._stops.length;t<n;t++){var r=this._stops[t];r._owner=this,r._defaultRamp&&r.setRampPoint(t/(n-1))}this._changed()},equals:function(e){if(e&&e.constructor==this.constructor&&this._stops.length==e._stops.length){for(var t=0,n=this._stops.length;t<n;t++)if(!this._stops[t].equals(e._stops[t]))return!1;return!0}return!1}}),LinearGradient=this.LinearGradient=Gradient.extend({_type:"LinearGradient"}),RadialGradient=this.RadialGradient=Gradient.extend({_type:"RadialGradient"}),GradientStop=this.GradientStop=Base.extend({initialize:function(e,t){if(e){var n,r;t===undefined&&Array.isArray(e)?(n=e[0],r=e[1]):e.color?(n=e.color,r=e.rampPoint):(n=e,r=t),this.setColor(n),this.setRampPoint(r)}},clone:function(){return new GradientStop(this._color.clone(),this._rampPoint)},_serialize:function(e,t){return Base.serialize([this._color,this._rampPoint],e,!1,t)},_changed:function(){this._owner&&this._owner._changed(17)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(e){this._defaultRamp=e==null,this._rampPoint=e||0,this._changed()},getColor:function(){return this._color},setColor:function(e){this._color=Color.read(arguments),this._color===e&&(this._color=e.clone()),this._color._owner=this,this._changed()},equals:function(e){return e==this||e instanceof GradientStop&&this._color.equals(e._color)&&this._rampPoint==e._rampPoint}}),DomElement=new function(){function e(t,n){var r=[];for(var i=0,s=t&&t.length;i<s;){var o=t[i++];if(typeof o=="string")o=document.createElement(o);else if(!o||!o.nodeType)continue;Base.isPlainObject(t[i])&&DomElement.set(o,t[i++]),Array.isArray(t[i])&&e(t[i++],o),n&&n.appendChild(o),r.push(o)}return r}var t=/^(checked|value|selected|disabled)$/i,n={text:"textContent",html:"innerHTML"},r={lineHeight:1,zoom:1,zIndex:1,opacity:1};return{create:function(t,n){var r=Array.isArray(t),i=e(r?t:arguments,r?n:null);return i.length==1?i[0]:i},find:function(e,t){return(t||document).querySelector(e)},findAll:function(e,t){return(t||document).querySelectorAll(e)},get:function(e,r){return e?t.test(r)?r==="value"||typeof e[r]!="string"?e[r]:!0:r in n?e[n[r]]:e.getAttribute(r):null},set:function(e,r,i){if(typeof r!="string")for(var s in r)r.hasOwnProperty(s)&&this.set(e,s,r[s]);else{if(!e||i===undefined)return e;t.test(r)?e[r]=i:r in n?e[n[r]]=i:r==="style"?this.setStyle(e,i):r==="events"?DomEvent.add(e,i):e.setAttribute(r,i)}return e},getStyles:function(e){var t=e&&e.ownerDocument.defaultView;return t&&t.getComputedStyle(e,"")},getStyle:function(e,t){return e&&e.style[t]||this.getStyles(e)[t]||null},setStyle:function(e,t,n){if(typeof t!="string")for(var i in t)t.hasOwnProperty(i)&&this.setStyle(e,i,t[i]);else/^-?[\d\.]+$/.test(n)&&!(t in r)&&(n+="px"),e.style[t]=n;return e},hasClass:function(e,t){return(new RegExp("\\s*"+t+"\\s*")).test(e.className)},addClass:function(e,t){e.className=(e.className+" "+t).trim()},removeClass:function(e,t){e.className=e.className.replace(new RegExp("\\s*"+t+"\\s*")," ").trim()},remove:function(e){e.parentNode&&e.parentNode.removeChild(e)},removeChildren:function(e){while(e.firstChild)e.removeChild(e.firstChild)},getBounds:function(e,t){var n=e.getBoundingClientRect(),r=e.ownerDocument,i=r.body,s=r.documentElement,o=n.left-(s.clientLeft||i.clientLeft||0),u=n.top-(s.clientTop||i.clientTop||0);if(!t){var a=r.defaultView;o+=a.pageXOffset||s.scrollLeft||i.scrollLeft,u+=a.pageYOffset||s.scrollTop||i.scrollTop}return new Rectangle(o,u,n.width,n.height)},getViewportBounds:function(e){var t=e.ownerDocument,n=t.defaultView,r=t.documentElement;return Rectangle.create(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(e,t){return this.getBounds(e,t).getPoint()},getSize:function(e){return this.getBounds(e,!0).getSize()},isInvisible:function(e){return this.getSize(e).equals([0,0])},isInView:function(e){return!this.isInvisible(e)&&this.getViewportBounds(e).intersects(this.getBounds(e,!0))}}},DomEvent={add:function(e,t){for(var n in t){var r=t[n];e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent("on"+n,r.bound=function(){r.call(e,window.event)})}},remove:function(e,t){for(var n in t){var r=t[n];e.removeEventListener?e.removeEventListener(n,r,!1):e.detachEvent&&e.detachEvent("on"+n,r.bound)}},getPoint:function(e){var t=e.targetTouches?e.targetTouches.length?e.targetTouches[0]:e.changedTouches[0]:e;return Point.create(t.pageX||t.clientX+document.documentElement.scrollLeft,t.pageY||t.clientY+document.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getOffset:function(e,t){return DomEvent.getPoint(e).subtract(DomElement.getOffset(t||DomEvent.getTarget(e)))},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},stop:function(e){DomEvent.stopPropagation(e),DomEvent.preventDefault(e)}};DomEvent.requestAnimationFrame=new function(){var e="equestAnimationFrame",t=window["r"+e]||window["webkitR"+e]||window["mozR"+e]||window["oR"+e]||window["msR"+e];t&&t(function(e){e==null&&(t=null)});var n=[],r=!0,i;return DomEvent.add(window,{focus:function(){r=!0},blur:function(){r=!1}}),function(e,s){if(t)return t(e,s);n.push([e,s]);if(i)return;i=setInterval(function(){for(var e=n.length-1;e>=0;e--){var t=n[e],i=t[0],s=t[1];if(!s||(PaperScript.getAttribute(s,"keepalive")=="true"||r)&&DomElement.isInView(s))n.splice(e,1),i(Date.now())}},1e3/60)}};var View=this.View=Base.extend(Callback,{initialize:function(e){this._scope=paper,this._project=paper.project,this._element=e;var t;this._id=e.getAttribute("id"),this._id==null&&e.setAttribute("id",this._id="view-"+View._id++),DomEvent.add(e,this._viewHandlers);if(PaperScript.hasAttribute(e,"resize")){var n=DomElement.getOffset(e,!0),r=this;t=DomElement.getViewportBounds(e).getSize().subtract(n),this._windowHandlers={resize:function(t){DomElement.isInvisible(e)||(n=DomElement.getOffset(e,!0)),r.setViewSize(DomElement.getViewportBounds(e).getSize().subtract(n))}},DomEvent.add(window,this._windowHandlers)}else t=Size.create(parseInt(e.getAttribute("width"),10),parseInt(e.getAttribute("height"),10)),t.isNaN()&&(t=DomElement.getSize(e));e.width=t.width,e.height=t.height;if(PaperScript.hasAttribute(e,"stats")){this._stats=new Stats;var i=this._stats.domElement,s=i.style,n=DomElement.getOffset(e);s.position="absolute",s.left=n.x+"px",s.top=n.y+"px",document.body.appendChild(i)}View._views.push(this),View._viewsById[this._id]=this,this._viewSize=LinkedSize.create(this,"setViewSize",t.width,t.height),this._matrix=new Matrix,this._zoom=1,View._focused||(View._focused=this),this._frameItems={},this._frameItemCount=0},remove:function(){return this._project?(View._focused==this&&(View._focused=null),View._views.splice(View._views.indexOf(this),1),delete View._viewsById[this._id],this._project.view==this&&(this._project.view=null),DomEvent.remove(this._element,this._viewHandlers),DomEvent.remove(window,this._windowHandlers),this._element=this._project=null,this.detach("frame"),this._frameItems={},!0):!1},_events:{onFrame:{install:function(){this._requested||(this._animate=!0,this._handleFrame(!0))},uninstall:function(){this._animate=!1}},onResize:{}},_animate:!1,_time:0,_count:0,_handleFrame:function(e){this._requested=!1;if(!this._animate)return;paper=this._scope;if(e){this._requested=!0;var t=this;DomEvent.requestAnimationFrame(function(){t._handleFrame(!0)},this._element)}var n=Date.now()/1e3,r=this._before?n-this._before:0;this._before=n,this.fire("frame",Base.merge({delta:r,time:this._time+=r,count:this._count++})),this._stats&&this._stats.update(),this.draw(!0)},_animateItem:function(e,t){var n=this._frameItems;t?(n[e._id]={item:e,time:0,count:0},++this._frameItemCount==1&&this.attach("frame",this._handleFrameItems)):(delete n[e._id],--this._frameItemCount==0&&this.detach("frame",this._handleFrameItems))},_handleFrameItems:function(e){for(var t in this._frameItems){var n=this._frameItems[t];n.item.fire("frame",Base.merge(e,{time:n.time+=e.delta,count:n.count++}))}},_redraw:function(){this._redrawNeeded=!0,this._animate?this._handleFrame():this.draw()},_transform:function(e){this._matrix.concatenate(e),this._bounds=null,this._inverse=null,this._redraw()},getElement:function(){return this._element},getViewSize:function(){return this._viewSize},setViewSize:function(e){e=Size.read(arguments);var t=e.subtract(this._viewSize);if(t.isZero())return;this._element.width=e.width,this._element.height=e.height,this._viewSize.set(e.width,e.height,!0),this._bounds=null,this.fire("resize",{size:e,delta:t}),this._redraw()},getBounds:function(){return this._bounds||(this._bounds=this._getInverse()._transformBounds(new Rectangle(new Point,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(e){this.scrollBy(Point.read(arguments).subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(e){this._transform((new Matrix).scale(e/this._zoom,this.getCenter())),this._zoom=e},isVisible:function(){return DomElement.isInView(this._element)},scrollBy:function(e){this._transform((new Matrix).translate(Point.read(arguments).negate()))},projectToView:function(e){return this._matrix._transformPoint(Point.read(arguments))},viewToProject:function(e){return this._getInverse()._transformPoint(Point.read(arguments))},_getInverse:function(){return this._inverse||(this._inverse=this._matrix.inverted()),this._inverse}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e){return typeof e=="string"&&(e=document.getElementById(e)),new CanvasView(e)}}},new function(){function e(e){var t=DomEvent.getTarget(e);return t.getAttribute&&View._viewsById[t.getAttribute("id")]}function t(e,t){return e.viewToProject(DomEvent.getOffset(t,e._element))}function n(){if(!View._focused||!View._focused.isVisible())for(var e=0,t=View._views.length;e<t;e++){var n=View._views[e];if(n&&n.isVisible()){View._focused=f=n;break}}}function r(n){var r=View._focused=e(n),i=t(r,n);l=!0,r._onMouseDown&&r._onMouseDown(n,i),(u=r._scope._tool)&&u._onHandleEvent("mousedown",i,n),r.draw(!0)}function i(r){var i;l||(i=e(r),i?(a=View._focused,View._focused=f=i):f&&f==View._focused&&(View._focused=a,n()));if(!(i=i||View._focused))return;var s=r&&t(i,r);i._onMouseMove&&i._onMouseMove(r,s),(u=i._scope._tool)&&u._onHandleEvent(l&&u.responds("mousedrag")?"mousedrag":"mousemove",s,r)&&DomEvent.stop(r),i.draw(!0)}function s(e){var n=View._focused;if(!n||!l)return;var r=t(n,e);curPoint=null,l=!1,n._onMouseUp&&n._onMouseUp(e,r),u&&u._onHandleEvent("mouseup",r,e)&&DomEvent.stop(e),n.draw(!0)}function o(e){l&&DomEvent.stop(e)}var u,a,f,l=!1;return DomEvent.add(document,{mousemove:i,mouseup:s,touchmove:i,touchend:s,selectstart:o,scroll:n}),DomEvent.add(window,{load:n}),{_viewHandlers:{mousedown:r,touchstart:r,selectstart:o},statics:{updateFocus:n}}}),CanvasView=View.extend({initialize:function(e){if(!(e instanceof HTMLCanvasElement)){var t=Size.read(arguments,1);t.isZero()&&(t=Size.create(1024,768)),e=CanvasProvider.getCanvas(t)}this._context=e.getContext("2d"),this._eventCounters={},this.base(e)},draw:function(e){if(e&&!this._redrawNeeded)return!1;var t=this._context,n=this._viewSize;return t.clearRect(0,0,n._width+1,n._height+1),this._project.draw(t,this._matrix),this._redrawNeeded=!1,!0}},new function(){function e(e,t,n,r,i,s){var o=r,u;while(o){if(o.responds(e)){u||(u=new MouseEvent(e,t,n,r,i?n.subtract(i):null));if(o.fire(e,u)&&(!s||u._stopped))return!1}o=o.getParent()}return!0}function t(t,n,r,i,s){if(t._eventCounters[n]){var o=t._project,f=o.hitTest(i,{tolerance:o.options.hitTolerance||0,fill:!0,stroke:!0}),l=f&&f.item;if(l)return n==="mousemove"&&l!=u&&(s=i),(n!=="mousemove"||!a)&&e(n,r,i,l,s),l}}var n,r,i,s,o,u,a,f,l;return{_onMouseDown:function(e,u){var c=t(this,"mousedown",e,u);f=o==c&&Date.now()-l<300,s=o=c,n=r=i=u,a=s&&s.responds("mousedrag")},_onMouseUp:function(o,u){var c=t(this,"mouseup",o,u);a&&(r&&!r.equals(u)&&e("mousedrag",o,u,s,r),c!=s&&(i=u,e("mousemove",o,u,c,i))),c===s&&(l=Date.now(),(!f||e("doubleclick",o,n,c))&&e("click",o,n,c),f=!1),s=null,a=!1},_onMouseMove:function(n,o){s&&e("mousedrag",n,o,s,r);var a=t(this,"mousemove",n,o,i);r=i=o,a!==u&&(e("mouseleave",n,o,u),u=a,e("mouseenter",n,o,a))}}}),Event=this.Event=Base.extend({initialize:function(e){this.event=e},preventDefault:function(){this._prevented=!0,DomEvent.preventDefault(this.event)},stopPropagation:function(){this._stopped=!0,DomEvent.stopPropagation(this.event)},stop:function(){this.stopPropagation(),this.preventDefault()},getModifiers:function(){return Key.modifiers}}),KeyEvent=this.KeyEvent=Event.extend({initialize:function(e,t,n,r){this.base(r),this.type=e?"keydown":"keyup",this.key=t,this.character=n},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Key=this.Key=new function(){function e(e,n,r,s){var o=String.fromCharCode(r),u=t[n]||o.toLowerCase(),a=e?"keydown":"keyup",f=View._focused,l=f&&f.isVisible()&&f._scope,c=l&&l._tool;i[u]=e,c&&c.responds(a)&&(c.fire(a,new KeyEvent(e,u,o,s)),f&&f.draw(!0))}var t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},n=Base.merge({shift:!1,control:!1,option:!1,command:!1,capsLock:!1,space:!1}),r={},i={},s;return DomEvent.add(document,{keydown:function(i){var o=i.which||i.keyCode,u=t[o],a;u?((a=Base.camelize(u))in n&&(n[a]=!0),r[o]=0,e(!0,o,null,i)):s=o},keypress:function(t){if(s!=null){var n=t.which||t.keyCode;r[s]=n,e(!0,s,n,t),s=null}},keyup:function(i){var s=i.which||i.keyCode,o=t[s],u;o&&(u=Base.camelize(o))in n&&(n[u]=!1),r[s]!=null&&(e(!1,s,r[s],i),delete r[s])}}),{modifiers:n,isDown:function(e){return!!i[e]}}},MouseEvent=this.MouseEvent=Event.extend({initialize:function(e,t,n,r,i){this.base(t),this.type=e,this.point=n,this.target=r,this.delta=i},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Palette=this.Palette=Base.extend(Callback,{_events:["onChange"],initialize:function(e,t,n){var r=DomElement.find(".palettejs-panel")||DomElement.find("body").appendChild(DomElement.create("div",{"class":"palettejs-panel"}));this._element=r.appendChild(DomElement.create("table",{"class":"palettejs-pane"})),this._title=e,n||(n={});for(var i in this._components=t){var s=t[i];s instanceof Component||(s.value==null&&(s.value=n[i]),s.name=i,s=t[i]=new Component(s)),this._element.appendChild(s._element),s._palette=this,n[i]===undefined&&(n[i]=s.value)}this._values=Base.each(n,function(e,r){var i=t[r];i&&Base.define(n,r,{enumerable:!0,configurable:!0,writable:!0,get:function(){return i._value},set:function(e){i.setValue(e)}})}),window.paper&&paper.palettes.push(this)},reset:function(){for(var e in this._components)this._components[e].reset()},remove:function(){DomElement.remove(this._element)}}),Component=this.Component=Base.extend(Callback,{_events:["onChange","onClick"],_types:{"boolean":{type:"checkbox",value:"checked"},string:{type:"text"},number:{type:"number",number:!0},button:{type:"button"},text:{tag:"div",value:"text"},slider:{type:"range",number:!0},list:{tag:"select",options:function(){DomElement.removeChildren(this._inputItem),DomElement.create(Base.each(this._options,function(e){this.push("option",{value:e,text:e})},[]),this._inputItem)}}},initialize:function(e){this._type=e.type in this._types?e.type:"options"in e?"list":"onClick"in e?"button":typeof e.value,this._info=this._types[this._type]||{type:this._type};var t=this,n=!1;this._inputItem=DomElement.create(this._info.tag||"input",{type:this._info.type,events:{change:function(){t.setValue(DomElement.get(this,t._info.value||"value")),n&&(t._palette.fire("change",t,t.name,t._value),t.fire("change",t._value))},click:function(){t.fire("click")}}}),this._element=DomElement.create("tr",[this._labelItem=DomElement.create("td"),"td",[this._inputItem]]),Base.each(e,function(e,t){this[t]=e},this),this._defaultValue=this._value,n=!0},getType:function(){return this._type},getLabel:function(){return this._label},setLabel:function(e){this._label=e,DomElement.set(this._labelItem,"text",e+":")},getOptions:function(){return this._options},setOptions:function(e){this._options=e,this._info.options&&this._info.options.call(this)},getValue:function(){return this._value},setValue:function(e){var t=this._info.value||"value";DomElement.set(this._inputItem,t,e),e=DomElement.get(this._inputItem,t),this._value=this._info.number?parseFloat(e,10):e},getRange:function(){return[parseFloat(DomElement.get(this._inputItem,"min")),parseFloat(DomElement.get(this._inputItem,"max"))]},setRange:function(e,t){var n=Array.isArray(e)?e:[e,t];DomElement.set(this._inputItem,{min:n[0],max:n[1]})},getMin:function(){return this.getRange()[0]},setMin:function(e){this.setRange(e,this.getMax())},getMax:function(){return this.getRange()[1]},setMax:function(e){this.setRange(this.getMin(),e)},getStep:function(){return parseFloat(DomElement.get(this._inputItem,"step"))},setStep:function(e){DomElement.set(this._inputItem,"step",e)},reset:function(){this.setValue(this._defaultValue)}}),ToolEvent=this.ToolEvent=Event.extend({_item:null,initialize:function(e,t,n){this.tool=e,this.type=t,this.event=n},_choosePoint:function(e,t){return e?e:t?t.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this.middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){var t=e.item,n=t._parent;while(n instanceof Group&&!(n instanceof Layer)||n instanceof CompoundPath)t=n,n=n._parent;this._item=t}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Tool=this.Tool=PaperScopeItem.extend({_list:"tools",_reference:"_tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(e){this.base(),this._firstMove=!0,this._count=0,this._downCount=0,this._set(e)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){this._minDistance=e,this._minDistance!=null&&this._maxDistance!=null&&this._minDistance>this._maxDistance&&(this._maxDistance=this._minDistance)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e,this._minDistance!=null&&this._maxDistance!=null&&this._maxDistance<this._minDistance&&(this._minDistance=e)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=e,this._maxDistance=e},_updateEvent:function(e,t,n,r,i,s,o){if(!i){if(n!=null||r!=null){var u=n!=null?n:0,a=t.subtract(this._point),f=a.getLength();if(f<u)return!1;var l=r!=null?r:0;if(l!=0)if(f>l)t=this._point.add(a.normalize(l));else if(o)return!1}if(s&&t.equals(this._point))return!1}this._lastPoint=i&&e=="mousemove"?t:this._point,this._point=t;switch(e){case"mousedown":this._lastPoint=this._downPoint,this._downPoint=this._point,this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint}return this._count=i?0:this._count+1,!0},fire:function(e,t){var n=Tool._removeSets;if(n){e==="mouseup"&&(n.mousedrag=null);var r=n[e];if(r){for(var i in r){var s=r[i];for(var o in n){var u=n[o];u&&u!=r&&delete u[s._id]}s.remove()}n[e]=null}}return this.base(e,t)},_onHandleEvent:function(e,t,n){paper=this._scope;var r=!1;switch(e){case"mousedown":this._updateEvent(e,t,null,null,!0,!1,!1),this.responds(e)&&(r=this.fire(e,new ToolEvent(this,e,n)));break;case"mousedrag":var i=!1,s=!1;while(this._updateEvent(e,t,this.minDistance,this.maxDistance,!1,i,s))this.responds(e)&&(r=this.fire(e,new ToolEvent(this,e,n))),i=!0,s=!0;break;case"mouseup":!t.equals(this._point)&&this._updateEvent("mousedrag",t,this.minDistance,this.maxDistance,!1,!1,!1)&&this.responds("mousedrag")&&(r=this.fire("mousedrag",new ToolEvent(this,e,n))),this._updateEvent(e,t,null,this.maxDistance,!1,!1,!1),this.responds(e)&&(r=this.fire(e,new ToolEvent(this,e,n))),this._updateEvent(e,t,null,null,!0,!1,!1),this._firstMove=!0;break;case"mousemove":while(this._updateEvent(e,t,this.minDistance,this.maxDistance,this._firstMove,!0,!1))this.responds(e)&&(r=this.fire(e,new ToolEvent(this,e,n))),this._firstMove=!1}return r}}),Format=new function(){function e(e,t){return t=t?i[t]||(i[t]=Math.pow(10,t)):1e5,Math.round(e*t)/t}function t(t,n,r){return e(t.x,n)+(r||",")+e(t.y,n)}function n(t,n,r){return e(t.width,n)+(r||",")+e(t.height,n)}function r(e,r,i){return t(e,r,i)+(i||",")+n(e,r,i)}var i={};return{number:e,point:t,size:n,rectangle:r}},CanvasProvider={canvases:[],getCanvas:function(e,t){var n=t===undefined?e:Size.create(e,t);if(this.canvases.length){var r=this.canvases.pop();return r.width!=n.width||r.height!=n.height?(r.width=n.width,r.height=n.height):r.getContext("2d").clearRect(0,0,n.width+1,n.height+1),r}var r=document.createElement("canvas");return r.width=n.width,r.height=n.height,r},getContext:function(e,t){return this.getCanvas(e,t).getContext("2d")},release:function(e){this.canvases.push(e.canvas?e.canvas:e)}},Numerical=new function(){function e(e){return e>0?s(e,1/3):e<0?-s(-e,1/3):0}var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],n=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],r=Math.abs,i=Math.sqrt,s=Math.pow,o=Math.cos,u=Math.PI;return{TOLERANCE:1e-5,EPSILON:1e-11,isZero:function(e){return Math.abs(e)<=this.EPSILON},integrate:function(e,r,i,s){var o=t[s-2],u=n[s-2],a=.5*(i-r),f=a+r,l=0,c=s+1>>1,h=s&1?u[l++]*e(f):0;while(l<c){var p=a*o[l];h+=u[l++]*(e(f+p)+e(f-p))}return a*h},findRoot:function(e,t,n,i,s,o,u){for(var a=0;a<o;a++){var f=e(n),l=f/t(n);if(r(l)<u)return n;var c=n-l;f>0?(s=n,n=c<=i?.5*(i+s):c):(i=n,n=c>=s?.5*(i+s):c)}},solveQuadratic:function(e,t,n,s,o){if(r(e)<o)return r(t)>=o?(s[0]=-n/t,1):r(n)<o?-1:0;var u=t*t-4*e*n;if(u<0)return 0;u=i(u),e*=2;var a=0;return s[a++]=(-t-u)/e,u>0&&(s[a++]=(-t+u)/e),a},solveCubic:function(t,n,s,a,f,l){if(r(t)<l)return Numerical.solveQuadratic(n,s,a,f,l);n/=t,s/=t,a/=t;var c=n*n,h=1/3*(-1/3*c+s),p=.5*(2/27*n*c-1/3*n*s+a),d=h*h*h,v=p*p+d;n/=3;if(r(v)<l){if(r(p)<l)return f[0]=-n,1;var m=e(-p);return f[0]=2*m-n,f[1]=-m-n,2}if(v<0){var g=1/3*Math.acos(-p/i(-d)),y=2*i(-h);return f[0]=y*o(g)-n,f[1]=-y*o(g+u/3)-n,f[2]=-y*o(g-u/3)-n,3}return v=i(v),f[0]=e(v-p)-e(v+p)-n,1}}},BlendMode={process:function(e,t,n,r,i){function s(e,t,n){return.2989*e+.587*t+.114*n}function o(e,t,n,r){var i=r-s(e,t,n);T=e+i,N=t+i,C=n+i;var r=s(T,N,C),o=p(T,N,C),u=d(T,N,C);if(o<0){var a=r-o;T=r+(T-r)*r/a,N=r+(N-r)*r/a,C=r+(C-r)*r/a}if(u>255){var f=255-r,l=u-r;T=r+(T-r)*f/l,N=r+(N-r)*f/l,C=r+(C-r)*f/l}}function u(e,t,n){return d(e,t,n)-p(e,t,n)}function a(e,t,n,r){var i=[e,t,n],s=d(e,t,n),o=p(e,t,n),u;o=o==e?0:o==t?1:2,s=s==e?0:s==t?1:2,u=p(o,s)==0?d(o,s)==1?2:1:0,i[s]>i[o]?(i[u]=(i[u]-i[o])*r/(i[s]-i[o]),i[s]=r):i[u]=i[s]=0,i[o]=0,T=i[0],N=i[1],C=i[2]}var f=t.canvas,l=n.getImageData(i.x,i.y,f.width,f.height),c=l.data,h=t.getImageData(0,0,f.width,f.height).data,p=Math.min,d=Math.max,v=Math.abs,m,g,y,b,w,E,S,x,T,N,C,k={multiply:function(){T=w*m/255,N=E*g/255,C=S*y/255},screen:function(){T=255-(255-w)*(255-m)/255,N=255-(255-E)*(255-g)/255,C=255-(255-S)*(255-y)/255},overlay:function(){T=w<128?2*w*m/255:255-2*(255-w)*(255-m)/255,N=E<128?2*E*g/255:255-2*(255-E)*(255-g)/255,C=S<128?2*S*y/255:255-2*(255-S)*(255-y)/255},"soft-light":function(){var e=m*w/255;T=e+w*(255-(255-w)*(255-m)/255-e)/255,e=g*E/255,N=e+E*(255-(255-E)*(255-g)/255-e)/255,e=y*S/255,C=e+S*(255-(255-S)*(255-y)/255-e)/255},"hard-light":function(){T=m<128?2*m*w/255:255-2*(255-m)*(255-w)/255,N=g<128?2*g*E/255:255-2*(255-g)*(255-E)/255,C=y<128?2*y*S/255:255-2*(255-y)*(255-S)/255},"color-dodge":function(){T=m==255?m:p(255,w*255/(255-m)),N=g==255?g:p(255,E*255/(255-g)),C=y==255?y:p(255,S*255/(255-y))},"color-burn":function(){T=m==0?0:d(255-(255-w)*255/m,0),N=g==0?0:d(255-(255-E)*255/g,0),C=y==0?0:d(255-(255-S)*255/y,0)},darken:function(){T=w<m?w:m,N=E<g?E:g,C=S<y?S:y},lighten:function(){T=w>m?w:m,N=E>g?E:g,C=S>y?S:y},difference:function(){T=w-m,T<0&&(T=-T),N=E-g,N<0&&(N=-N),C=S-y,C<0&&(C=-C)},exclusion:function(){T=w+m*(255-w-w)/255,N=E+g*(255-E-E)/255,C=S+y*(255-S-S)/255},hue:function(){a(m,g,y,u(w,E,S)),o(T,N,C,s(w,E,S))},saturation:function(){a(w,E,S,u(m,g,y)),o(T,N,C,s(w,E,S))},luminosity:function(){o(w,E,S,s(m,g,y))},color:function(){o(m,g,y,s(w,E,S))},add:function(){T=p(w+m,255),N=p(E+g,255),C=p(S+y,255)},subtract:function(){T=d(w-m,0),N=d(E-g,0),C=d(S-y,0)},average:function(){T=(w+m)/2,N=(E+g)/2,C=(S+y)/2},negation:function(){T=255-v(255-m-w),N=255-v(255-g-E),C=255-v(255-y-S)}},L=k[e];if(!L)return;for(var A=0,O=c.length;A<O;A+=4){m=h[A],w=c[A],g=h[A+1],E=c[A+1],y=h[A+2],S=c[A+2],b=h[A+3],x=c[A+3],L();var M=b*r/255,_=1-M;c[A]=M*T+_*w,c[A+1]=M*N+_*E,c[A+2]=M*C+_*S,c[A+3]=b*r+_*x}n.putImageData(l,i.x,i.y)}},SvgStyles=Base.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"]},function(e,t){var n=Base.capitalize(t);this[t]={type:e[1],property:t,attribute:e[0],get:"get"+n,set:"set"+n}},{});new function(){function e(e,t){for(var n in t){var r=t[n],i=E[n];typeof r=="number"&&(r=w(r)),i?e.setAttributeNS(i,n,r):e.setAttribute(n,r)}return e}function t(t,n){return e(document.createElementNS("http://www.w3.org/2000/svg",t),n)}function n(e,t,n){return e[t]._point.getDistance(e[n]._point)}function r(e,t){var n=e._matrix,r=n.getTranslation(),i={};if(t){n=n.shiftless();var s=n._inverseTransform(r);i.x=s.x,i.y=s.y,r=null}if(n.isIdentity())return i;var o=n.decompose();if(o&&!o.shearing){var u=[],a=o.rotation,f=o.scaling;r&&!r.isZero()&&u.push("translate("+Format.point(r)+")"),(!Numerical.isZero(f.x-1)||!Numerical.isZero(f.y-1))&&u.push("scale("+Format.point(f)+")"),a&&u.push("rotate("+w(a)+")"),i.transform=u.join(" ")}else i.transform="matrix("+n.getValues().join(",")+")";return i}function s(e,t,n,r){var i=n==="rect"?t[1]._point.add(t[2]._point).divide(2):n==="roundrect"?t[3]._point.add(t[4]._point).divide(2):n==="circle"||n==="ellipse"?t[1]._point:null,s=i&&i.subtract(r).getAngle()+90;return Numerical.isZero(s||0)?0:s}function o(e,t){function r(e,n){var r=t[e],i=r.getNext(),s=t[n],o=s.getNext();return r._handleOut.isZero()&&i._handleIn.isZero()&&s._handleOut.isZero()&&o._handleIn.isZero()&&i._point.subtract(r._point).isColinear(o._point.subtract(s._point))}function i(e){var n=t[e],r=n.getNext(),i=n._handleOut,o=r._handleIn;if(i.isOrthogonal(o)){var u=n._point,a=r._point,f=(new Line(u,i)).intersect(new Line(a,o));return f&&Numerical.isZero(i.getLength()/f.subtract(u).getLength()-s)&&Numerical.isZero(o.getLength()/f.subtract(a).getLength()-s)}}var s=4*(Math.sqrt(2)-1)/3;if(e.isPolygon())return t.length===4&&e._closed&&r(0,2)&&r(1,3)?"rect":t.length===0?"empty":t.length>=3?e._closed?"polygon":"polyline":"line";if(e._closed){if(t.length===8&&i(0)&&i(2)&&i(4)&&i(6)&&r(1,5)&&r(3,7))return"roundrect";if(t.length===4&&i(0)&&i(1)&&i(2)&&i(3))return Numerical.isZero(n(t,0,2)-n(t,1,3))?"circle":"ellipse"}return"path"}function u(e){var n=r(e),i=e._children;n.fill="none";var s=t("g",n);for(var o=0,u=i.length;o<u;o++){var a=b(i[o]);a&&s.appendChild(a)}return s}function a(e){var n=r(e,!0),i=e.getSize();return n.x-=i.width/2,n.y-=i.height/2,n.width=i.width,n.height=i.height,n.href=e.toDataURL(),t("image",n)}function f(e){var n=r(e,!0),i=e._style;i._font!=null&&(n["font-family"]=i._font),i._fontSize!=null&&(n["font-size"]=i._fontSize);var s=t("text",n);return s.textContent=e._content,s}function c(e){var r=e._segments,u=e.getPosition(!0),a=o(e,r),f=s(e,r,a,u),c;switch(a){case"empty":return null;case"path":var h=e.getPathData();c=h&&{d:h};break;case"polyline":case"polygon":var p=[];for(i=0,l=r.length;i<l;i++)p.push(Format.point(r[i]._point));c={points:p.join(" ")};break;case"rect":var d=n(r,0,3),v=n(r,0,1),m=r[1]._point.rotate(-f,u);c={x:m.x,y:m.y,width:d,height:v};break;case"roundrect":a="rect";var d=n(r,1,6),v=n(r,0,3),g=(d-n(r,0,7))/2,y=(v-n(r,1,2))/2,b=r[3]._point,E=r[4]._point,m=b.subtract(E.subtract(b).normalize(g)).rotate(-f,u);c={x:m.x,y:m.y,width:d,height:v,rx:g,ry:y};break;case"line":var S=r[0]._point,x=r[r.length-1]._point;c={x1:S._x,y1:S._y,x2:x._x,y2:x._y};break;case"circle":var T=n(r,0,2)/2;c={cx:u.x,cy:u.y,r:T};break;case"ellipse":var g=n(r,2,0)/2,y=n(r,3,1)/2;c={cx:u.x,cy:u.y,rx:g,ry:y}}return f&&(c.transform="rotate("+w(f)+","+Format.point(u)+")",e._gradientMatrix=(new Matrix).rotate(-f,u)),t(a,c)}function h(e){var n=r(e,!0),i=e.getPathData();return i&&(n.d=i),t("path",n)}function p(e){var n=r(e,!0),i=e.getSymbol(),s=m(i);return definition=i.getDefinition(),bounds=definition.getBounds(),s||(s=t("symbol",{viewBox:Format.rectangle(bounds)}),s.appendChild(b(definition)),g(i,s)),n.href="#"+s.id,n.x+=bounds.x,n.y+=bounds.y,n.width=w(bounds.width),n.height=w(bounds.height),t("use",n)}function d(e,n){var r=m(e);if(!r){var i=e.gradient,s=i._type,o=n._gradientMatrix,u=e._origin.transform(o),a=e._destination.transform(o),f=e._hilite&&e._hilite.transform(o),l;s=="RadialGradient"?(l={cx:u.x,cy:u.y,r:u.getDistance(a)},f&&(l.fx=f.x,l.fy=f.y)):l={x1:u.x,y1:u.y,x2:a.x,y2:a.y},l.gradientUnits="userSpaceOnUse",r=t(s[0].toLowerCase()+s.slice(1),l);var c=i._stops;for(var h=0,p=c.length;h<p;h++){var d=c[h],v=d._color;l={offset:d._rampPoint,"stop-color":v.toCss(!0)},v.getAlpha()<1&&(l["stop-opacity"]=v._alpha),r.appendChild(t("stop",l))}g(e,r)}return"url(#"+r.id+")"}function v(t,n){var r={},i=t._style,s=t.getParent(),o=s&&s._style;return t._name!=null&&(r.id=t._name),Base.each(SvgStyles,function(e){var n=i[e.get]();if(!o||!Base.equals(o[e.get](),n))e.type==="color"&&n!=null&&n.getAlpha()<1&&(r[e.attribute+"-opacity"]=n._alpha),r[e.attribute]=n==null?"none":e.type==="color"?n.gradient?d(n,t):n.toCss(!0):e.type==="array"?n.join(","):e.type==="number"?w(n):n}),t._opacity!=null&&t._opacity<1&&(r.opacity=t._opacity),t._visibility!=null&&!t._visibility&&(r.visibility="hidden"),delete t._gradientMatrix,e(n,r)}function m(e){return x||(x={ids:{},svgs:{}}),x.svgs[e._id]}function g(e,t){var n=e._type,r=x.ids[n]=(x.ids[n]||0)+1;t.id=n+"-"+r,x.svgs[e._id]=t}function y(e){if(!x)return e;var n=e.nodeName=="svg"&&e,r=n?n.firstChild:e;for(var i in x.svgs)n||(n=t("svg"),n.appendChild(e)),n.insertBefore(x.svgs[i],r);return x=null,n}function b(e){var t=S[e._type],n=t&&t(e,e._type);return n&&v(e,n)}var w=Format.number,E={href:"http://www.w3.org/1999/xlink"},S={Group:u,Layer:u,Raster:a,PointText:f,PlacedSymbol:p,Path:c,CompoundPath:h},x;Item.inject({exportSvg:function(){var e=b(this);return y(e)}}),Project.inject({exportSvg:function(){var e=t("svg"),n=this.layers;for(var r=0,i=n.length;r<i;r++)e.appendChild(b(n[r]));return y(e)}})},new function(){function e(e,t,n,r){var i=(!n||e.getAttribute(t)!=null)&&e[t]&&e[t].baseVal;return i?r!==undefined?r<i.numberOfItems?Base.pick((i=i.getItem(r)).value,i):null:Base.pick(i.value,i):null}function t(t,n,r,i,s){return n=e(t,n,i,s),r=e(t,r,i,s),i&&n==null&&r==null?null:Point.create(n||0,r||0)}function n(t,n,r,i,s){return n=e(t,n,i,s),r=e(t,r,i,s),i&&n==null&&r==null?null:Size.create(n||0,r||0)}function r(e,t){return e==="none"?null:t==="number"?parseFloat(e):t==="array"?e?e.split(/[\s,]+/g).map(parseFloat):[]:t==="color"&&p(e)||e}function i(e,t){var n=e.childNodes,r=t==="clipPath",i=r?new CompoundPath:new Group,s=i._project,o=s._currentStyle;i.setFillColor("black"),r||(i=h(i,e),s._currentStyle=i._style.clone());for(var u=0,a=n.length;u<a;u++){var f=n[u],l;f.nodeType==1&&(l=d(f))&&(r&&l instanceof CompoundPath?(i.addChildren(l.removeChildren()),l.remove()):l instanceof Symbol||i.addChild(l))}r&&(i=h(i.reduce(),e)),s._currentStyle=o;if(r||t==="defs")i.remove(),i=null;return i}function s(e,t){var n=new Path,r=e.points;n.moveTo(r.getItem(0));for(var i=1,s=r.numberOfItems;i<s;i++)n.lineTo(r.getItem(i));return t==="polygon"&&n.closePath(),n}function o(e){var t=e.getAttribute("d"),n=t.match(/m/gi).length>1?new CompoundPath:new Path;return n.setPathData(t),n}function u(n,r){var i=n.childNodes,s=[];for(var o=0,u=i.length;o<u;o++){var a=i[o];a.nodeType==1&&s.push(h(new GradientStop,a))}var f=r==="radialGradient",l=new(f?RadialGradient:LinearGradient)(s),c,p,d;return f?(c=t(n,"cx","cy"),p=c.add(e(n,"r"),0),d=t(n,"fx","fy",!0)):(c=t(n,"x1","y1"),p=t(n,"x2","y2")),h(new GradientColor(l,c,p,d),n),null}function a(e,t,n,r){var i=r[n].baseVal,s=new Matrix;for(var o=0,u=i.numberOfItems;o<u;o++){var a=i.getItem(o).matrix;s.concatenate(new Matrix(a.a,a.b,a.c,a.d,a.e,a.f))}e.transform(s)}function f(e,t,n){var r=e._style[n==="fill-opacity"?"getFillColor":"getStrokeColor"]();r&&r.setAlpha(parseFloat(t))}function l(e,t){if(e instanceof TextItem)t(e);else if(e instanceof Group){var n=e._children;for(var r=0,i=n.length;r<i;r++)t(n[r])}}function c(e,t,n){var r=e.attributes[t],i=r&&r.value;if(!i){var s=Base.camelize(t);i=e.style[s],!i&&n.node[s]!==n.parent[s]&&(i=n.node[s])}return i?i==="none"?null:i:undefined}function h(e,t){var n={node:DomElement.getStyles(t)||{},parent:DomElement.getStyles(t.parentNode)||{}};return Base.each(m,function(r,i){var s=c(t,i,n);s!==undefined&&(e=Base.pick(r(e,s,i,t,n),e))}),e}function p(e){var t=e&&e.match(/\((?:#|)([^)']+)/);return t&&g[t[1]]}function d(e,t){var n=e.nodeName,r=v[n],i=r&&r(e,n);return i&&i._type!=="Group"&&(i=h(i,e)),t&&(g={}),i}var v={g:i,svg:i,clipPath:i,polygon:s,polyline:s,path:o,linearGradient:u,radialGradient:u,image:function(r){var i=new Raster(e(r,"href"));return i.attach("load",function(){var e=n(r,"width","height");this.setSize(e),this.translate(t(r,"x","y").add(e.divide(2)))}),i},symbol:function(e,t){return new Symbol(i(e,t),!0)},defs:i,use:function(n,r){var i=(e(n,"href")||"").substring(1),s=g[i],o=t(n,"x","y");return s?s instanceof Symbol?s.place(o):s.clone().translate(o):null},circle:function(n){return new Path.Circle(t(n,"cx","cy"),e(n,"r"))},ellipse:function(e){var r=t(e,"cx","cy"),i=n(e,"rx","ry");return new Path.Ellipse(new Rectangle(r.subtract(i),r.add(i)))},rect:function(e){var r=t(e,"x","y"),i=n(e,"width","height"),s=n(e,"rx","ry");return new Path.RoundRectangle(new Rectangle(r,i),s)},line:function(e){return new Path.Line(t(e,"x1","y1"),t(e,"x2","y2"))},text:function(e){var n=new PointText(t(e,"x","y",!1,0).add(t(e,"dx","dy",!1,0)));return n.setContent(e.textContent.trim()||""),n}},m=Base.each(SvgStyles,function(e){this[e.attribute]=function(t,n,i,s){t._style[e.set](r(n,e.type))}},{id:function(e,t){g[t]=e,e.setName&&e.setName(t)},"clip-path":function(e,t){var n=p(t);if(n)return n=n.clone(),n.setClipMask(!0),new Group(n,e)},gradientTransform:a,transform:a,opacity:function(e,t){e.setOpacity(parseFloat(t))},"fill-opacity":f,"stroke-opacity":f,"font-family":function(e,t){l(e,function(e){e.setFont(t.split(",")[0].replace(/^\s+|\s+$/g,""))})},"font-size":function(e,t){l(e,function(e){e.setFontSize(parseFloat(t))})},"text-anchor":function(e,t){l(e,function(e){e.setJustification({start:"left",middle:"center",end:"right"}[t])})},visibility:function(e,t){e.setVisible(t==="visible")},"stop-color":function(e,t){e.setColor(t)},"stop-opacity":function(e,t){e._color&&e._color.setAlpha(parseFloat(t))},offset:function(e,t){var n=t.match(/(.*)%$/);e.setRampPoint(n?n[1]/100:t)},viewBox:function(e,t,i,s,o){var u=Rectangle.create.apply(this,r(t,"array")),a=n(s,"width","height",!0);if(e instanceof Group){var f=a?u.getSize().divide(a):1,l=(new Matrix).translate(u.getPoint()).scale(f);e.transform(l.inverted())}else if(e instanceof Symbol){a&&u.setSize(a);var h=c(s,"overflow",o)!="visible",p=e._definition;h&&!u.contains(p.getBounds())&&(h=(new Path.Rectangle(u)).transform(p._matrix),h.setClipMask(!0),p.addChild(h))}}}),g={};Item.inject({importSvg:function(e){return this.addChild(d(e,!0))}}),Project.inject({importSvg:function(e){return this.activate(),d(e,!0)}})},function(e){function t(e){pt=e||{};for(var t in gt)pt.hasOwnProperty(t)||(pt[t]=gt[t]);mt=pt.sourceFile||null}function n(e,t){var n=yt(dt,e);t+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=bt,r}function r(e){function t(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var t=0;e.length>t;++t)n+="case "+JSON.stringify(e[t])+":";n+="return true}return false;"}e=e.split(" ");var n="",r=[];e:for(var i=0;e.length>i;++i){for(var s=0;r.length>s;++s)if(r[s][0].length==e[i].length){r[s].push(e[i]);continue e}r.push([e[i]])}if(r.length>3){r.sort(function(e,t){return t.length-e.length}),n+="switch(str.length){";for(var i=0;r.length>i;++i){var o=r[i];n+="case "+o[0].length+":",t(o)}n+="}"}else t(e);return Function("str",n)}function i(e){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Kn.test(String.fromCharCode(e))}function s(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Qn.test(String.fromCharCode(e))}function o(){this.line=kt,this.column=bt-Lt}function u(){kt=1,bt=Lt=0,Ct=!0,c()}function a(e,t){Et=bt,pt.locations&&(xt=new o),Tt=e,c(),Nt=t,Ct=e.beforeExpr}function f(){var e=pt.onComment&&pt.locations&&new o,t=bt,r=dt.indexOf("*/",bt+=2);if(-1===r&&n(bt-2,"Unterminated comment"),bt=r+2,pt.locations){Yn.lastIndex=t;for(var i;(i=Yn.exec(dt))&&bt>i.index;)++kt,Lt=i.index+i[0].length}pt.onComment&&pt.onComment(!0,dt.slice(t+2,r),t,bt,e,pt.locations&&new o)}function l(){for(var e=bt,t=pt.onComment&&pt.locations&&new o,n=dt.charCodeAt(bt+=2);vt>bt&&10!==n&&13!==n&&8232!==n&&8329!==n;)++bt,n=dt.charCodeAt(bt);pt.onComment&&pt.onComment(!1,dt.slice(e+2,bt),e,bt,t,pt.locations&&new o)}function c(){for(;vt>bt;){var e=dt.charCodeAt(bt);if(32===e)++bt;else if(13===e){++bt;var t=dt.charCodeAt(bt);10===t&&++bt,pt.locations&&(++kt,Lt=bt)}else if(10===e)++bt,++kt,Lt=bt;else if(14>e&&e>8)++bt;else if(47===e){var t=dt.charCodeAt(bt+1);if(42===t)f();else{if(47!==t)break;l()}}else if(14>e&&e>8||32===e||160===e)++bt;else{if(!(e>=5760&&Vn.test(String.fromCharCode(e))))break;++bt}}}function h(){var e=dt.charCodeAt(bt+1);return e>=48&&57>=e?C(!0):(++bt,a(Sn))}function p(){var e=dt.charCodeAt(bt+1);return Ct?(++bt,x()):61===e?S(Cn,2):S(Tn,1)}function d(){var e=dt.charCodeAt(bt+1);return 61===e?S(Cn,2):S(Fn,1)}function v(e){var t=dt.charCodeAt(bt+1);return t===e?S(124===e?On:Mn,2):61===t?S(Cn,2):S(124===e?_n:Pn,1)}function m(){var e=dt.charCodeAt(bt+1);return 61===e?S(Cn,2):S(Dn,1)}function g(e){var t=dt.charCodeAt(bt+1);return t===e?S(Ln,2):61===t?S(Cn,2):S(kn,1)}function y(e){var t=dt.charCodeAt(bt+1),n=1;return t===e?(n=62===e&&62===dt.charCodeAt(bt+2)?3:2,61===dt.charCodeAt(bt+n)?S(Cn,n+1):S(jn,n)):(61===t&&(n=61===dt.charCodeAt(bt+2)?3:2),S(Bn,n))}function b(e){var t=dt.charCodeAt(bt+1);return 61===t?S(Hn,61===dt.charCodeAt(bt+2)?3:2):S(61===e?Nn:An,1)}function w(e){switch(e){case 46:return h();case 40:return++bt,a(gn);case 41:return++bt,a(yn);case 59:return++bt,a(wn);case 44:return++bt,a(bn);case 91:return++bt,a(pn);case 93:return++bt,a(dn);case 123:return++bt,a(vn);case 125:return++bt,a(mn);case 58:return++bt,a(En);case 63:return++bt,a(xn);case 48:var t=dt.charCodeAt(bt+1);if(120===t||88===t)return N();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return C(!1);case 34:case 39:return k(e);case 47:return p(e);case 37:case 42:return d();case 124:case 38:return v(e);case 94:return m();case 43:case 45:return g(e);case 60:case 62:return y(e);case 61:case 33:return b(e);case 126:return S(An,1)}return!1}function E(e){if(wt=bt,pt.locations&&(St=new o),e)return x();if(bt>=vt)return a(It);var t=dt.charCodeAt(bt);if(i(t)||92===t)return O();var r=w(t);if(r===!1){var s=String.fromCharCode(t);if("\\"===s||Kn.test(s))return O();n(bt,"Unexpected character '"+s+"'")}return r}function S(e,t){var n=dt.slice(bt,bt+t);bt+=t,a(e,n)}function x(){for(var e,t,r="",i=bt;;){bt>=vt&&n(i,"Unterminated regular expression");var s=dt.charAt(bt);if(Gn.test(s)&&n(i,"Unterminated regular expression"),e)e=!1;else{if("["===s)t=!0;else if("]"===s&&t)t=!1;else if("/"===s&&!t)break;e="\\"===s}++bt}var r=dt.slice(i,bt);++bt;var o=A();return o&&!/^[gmsiy]*$/.test(o)&&n(i,"Invalid regexp flag"),a(Bt,RegExp(r,o))}function T(e,t){for(var n=bt,r=0,i=0,s=null==t?1/0:t;s>i;++i){var o,u=dt.charCodeAt(bt);if(o=u>=97?u-97+10:u>=65?u-65+10:u>=48&&57>=u?u-48:1/0,o>=e)break;++bt,r=r*e+o}return bt===n||null!=t&&bt-n!==t?null:r}function N(){bt+=2;var e=T(16);return null==e&&n(wt+2,"Expected hexadecimal number"),i(dt.charCodeAt(bt))&&n(bt,"Identifier directly after number"),a(Ht,e)}function C(e){var t=bt,r=!1,s=48===dt.charCodeAt(bt);e||null!==T(10)||n(t,"Invalid number"),46===dt.charCodeAt(bt)&&(++bt,T(10),r=!0);var o=dt.charCodeAt(bt);(69===o||101===o)&&(o=dt.charCodeAt(++bt),(43===o||45===o)&&++bt,null===T(10)&&n(t,"Invalid number"),r=!0),i(dt.charCodeAt(bt))&&n(bt,"Identifier directly after number");var u,f=dt.slice(t,bt);return r?u=parseFloat(f):s&&1!==f.length?/[89]/.test(f)||Pt?n(t,"Invalid number"):u=parseInt(f,8):u=parseInt(f,10),a(Ht,u)}function k(e){bt++;for(var t="";;){bt>=vt&&n(wt,"Unterminated string constant");var r=dt.charCodeAt(bt);if(r===e)return++bt,a(jt,t);if(92===r){r=dt.charCodeAt(++bt);var i=/^[0-7]+/.exec(dt.slice(bt,bt+3));for(i&&(i=i[0]);i&&parseInt(i,8)>255;)i=i.slice(0,i.length-1);if("0"===i&&(i=null),++bt,i)Pt&&n(bt-2,"Octal literal in strict mode"),t+=String.fromCharCode(parseInt(i,8)),bt+=i.length-1;else switch(r){case 110:t+="\n";break;case 114:t+="\r";break;case 120:t+=String.fromCharCode(L(2));break;case 117:t+=String.fromCharCode(L(4));break;case 85:t+=String.fromCharCode(L(8));break;case 116:t+="	";break;case 98:t+="\b";break;case 118:t+="";break;case 102:t+="\f";break;case 48:t+="\0";break;case 13:10===dt.charCodeAt(bt)&&++bt;case 10:pt.locations&&(Lt=bt,++kt);break;default:t+=String.fromCharCode(r)}}else(13===r||10===r||8232===r||8329===r)&&n(wt,"Unterminated string constant"),t+=String.fromCharCode(r),++bt}}function L(e){var t=T(16,e);return null===t&&n(wt,"Bad character escape sequence"),t}function A(){qn=!1;for(var e,t=!0,r=bt;;){var o=dt.charCodeAt(bt);if(s(o))qn&&(e+=dt.charAt(bt)),++bt;else{if(92!==o)break;qn||(e=dt.slice(r,bt)),qn=!0,117!=dt.charCodeAt(++bt)&&n(bt,"Expecting Unicode escape sequence \\uXXXX"),++bt;var u=L(4),a=String.fromCharCode(u);a||n(bt-1,"Invalid Unicode escape"),(t?i(u):s(u))||n(bt-4,"Invalid Unicode escape"),e+=a}t=!1}return qn?e:dt.slice(r,bt)}function O(){var e=A(),t=Ft;return qn||(Xn(e)?t=hn[e]:(pt.forbidReserved&&(3===pt.ecmaVersion?Rn:Un)(e)||Pt&&zn(e))&&n(wt,"The keyword '"+e+"' is reserved")),a(t,e)}function M(){At=wt,Ot=Et,Mt=xt,E()}function _(e){Pt=e,bt=Ot,c(),E()}function D(){this.type=null,this.start=wt,this.end=null}function P(){this.start=St,this.end=null,null!==mt&&(this.source=mt)}function H(){var e=new D;return pt.locations&&(e.loc=new P),pt.ranges&&(e.range=[wt,0]),e}function B(e){var t=new D;return t.start=e.start,pt.locations&&(t.loc=new P,t.loc.start=e.loc.start),pt.ranges&&(t.range=[e.range[0],0]),t}function j(e,t){return e.type=t,e.end=Ot,pt.locations&&(e.loc.end=Mt),pt.ranges&&(e.range[1]=Ot),e}function F(e){return pt.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function I(e){return Tt===e?(M(),!0):void 0}function q(){return!pt.strictSemicolons&&(Tt===It||Tt===mn||Gn.test(dt.slice(Ot,wt)))}function R(){I(wn)||q()||z()}function U(e){Tt===e?M():z()}function z(){n(wt,"Unexpected token")}function W(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&n(e.start,"Assigning to rvalue"),Pt&&"Identifier"===e.type&&Wn(e.name)&&n(e.start,"Assigning to "+e.name+" in strict mode")}function X(e){At=Ot=bt,pt.locations&&(Mt=new o),_t=Pt=null,Dt=[],E();var t=e||H(),n=!0;for(e||(t.body=[]);Tt!==It;){var r=V();t.body.push(r),n&&F(r)&&_(!0),n=!1}return j(t,"Program")}function V(){Tt===Tn&&E(!0);var e=Tt,t=H();switch(e){case qt:case zt:M();var r=e===qt;I(wn)||q()?t.label=null:Tt!==Ft?z():(t.label=ht(),R());for(var i=0;Dt.length>i;++i){var s=Dt[i];if(null==t.label||s.name===t.label.name){if(!(null==s.kind||!r&&"loop"!==s.kind))break;if(t.label&&r)break}}return i===Dt.length&&n(t.start,"Unsyntactic "+e.keyword),j(t,r?"BreakStatement":"ContinueStatement");case Wt:return M(),R(),j(t,"DebuggerStatement");case Vt:return M(),Dt.push(Zn),t.body=V(),Dt.pop(),U(rn),t.test=$(),R(),j(t,"DoWhileStatement");case Kt:if(M(),Dt.push(Zn),U(gn),Tt===wn)return K(t,null);if(Tt===nn){var o=H();return M(),G(o,!0),1===o.declarations.length&&I(cn)?Q(t,o):K(t,o)}var o=Y(!1,!0);return I(cn)?(W(o),Q(t,o)):K(t,o);case Qt:return M(),lt(t,!0);case Gt:return M(),t.test=$(),t.consequent=V(),t.alternate=I($t)?V():null,j(t,"IfStatement");case Yt:return _t||n(wt,"'return' outside of function"),M(),I(wn)||q()?t.argument=null:(t.argument=Y(),R()),j(t,"ReturnStatement");case Zt:M(),t.discriminant=$(),t.cases=[],U(vn),Dt.push(er);for(var u,a;Tt!=mn;)if(Tt===Rt||Tt===Xt){var f=Tt===Rt;u&&j(u,"SwitchCase"),t.cases.push(u=H()),u.consequent=[],M(),f?u.test=Y():(a&&n(At,"Multiple default clauses"),a=!0,u.test=null),U(En)}else u||z(),u.consequent.push(V());return u&&j(u,"SwitchCase"),M(),Dt.pop(),j(t,"SwitchStatement");case en:return M(),Gn.test(dt.slice(Ot,wt))&&n(Ot,"Illegal newline after throw"),t.argument=Y(),R(),j(t,"ThrowStatement");case tn:for(M(),t.block=J(),t.handlers=[];Tt===Ut;){var l=H();M(),U(gn),l.param=ht(),Pt&&Wn(l.param.name)&&n(l.param.start,"Binding "+l.param.name+" in strict mode"),U(yn),l.guard=null,l.body=J(),t.handlers.push(j(l,"CatchClause"))}return t.finalizer=I(Jt)?J():null,t.handlers.length||t.finalizer||n(t.start,"Missing catch or finally clause"),j(t,"TryStatement");case nn:return M(),t=G(t),R(),t;case rn:return M(),t.test=$(),Dt.push(Zn),t.body=V(),Dt.pop(),j(t,"WhileStatement");case sn:return Pt&&n(wt,"'with' in strict mode"),M(),t.object=$(),t.body=V(),j(t,"WithStatement");case vn:return J();case wn:return M(),j(t,"EmptyStatement");default:var c=Nt,h=Y();if(e===Ft&&"Identifier"===h.type&&I(En)){for(var i=0;Dt.length>i;++i)Dt[i].name===c&&n(h.start,"Label '"+c+"' is already declared");var p=Tt.isLoop?"loop":Tt===Zt?"switch":null;return Dt.push({name:c,kind:p}),t.body=V(),Dt.pop(),t.label=h,j(t,"LabeledStatement")}return t.expression=h,R(),j(t,"ExpressionStatement")}}function $(){U(gn);var e=Y();return U(yn),e}function J(){var e,t=H(),n=!0,r=!1;for(t.body=[],U(vn);!I(mn);){var i=V();t.body.push(i),n&&F(i)&&(e=r,_(r=!0)),n=!1}return r&&!e&&_(!1),j(t,"BlockStatement")}function K(e,t){return e.init=t,U(wn),e.test=Tt===wn?null:Y(),U(wn),e.update=Tt===yn?null:Y(),U(yn),e.body=V(),Dt.pop(),j(e,"ForStatement")}function Q(e,t){return e.left=t,e.right=Y(),U(yn),e.body=V(),Dt.pop(),j(e,"ForInStatement")}function G(e,t){for(e.declarations=[],e.kind="var";;){var r=H();if(r.id=ht(),Pt&&Wn(r.id.name)&&n(r.id.start,"Binding "+r.id.name+" in strict mode"),r.init=I(Nn)?Y(!0,t):null,e.declarations.push(j(r,"VariableDeclarator")),!I(bn))break}return j(e,"VariableDeclaration")}function Y(e,t){var n=Z(t);if(!e&&Tt===bn){var r=B(n);for(r.expressions=[n];I(bn);)r.expressions.push(Z(t));return j(r,"SequenceExpression")}return n}function Z(e){var t=et(e);if(Tt.isAssign){var n=B(t);return n.operator=Nt,n.left=t,M(),n.right=Z(e),W(t),j(n,"AssignmentExpression")}return t}function et(e){var t=tt(e);if(I(xn)){var n=B(t);return n.test=t,n.consequent=Y(!0),U(En),n.alternate=Y(!0,e),j(n,"ConditionalExpression")}return t}function tt(e){return nt(rt(e),-1,e)}function nt(e,t,n){var r=Tt.binop;if(null!=r&&(!n||Tt!==cn)&&r>t){var i=B(e);i.left=e,i.operator=Nt,M(),i.right=nt(rt(n),r,n);var i=j(i,/&&|\|\|/.test(i.operator)?"LogicalExpression":"BinaryExpression");return nt(i,t,n)}return e}function rt(e){if(Tt.prefix){var t=H(),r=Tt.isUpdate;return t.operator=Nt,t.prefix=!0,M(),t.argument=rt(e),r?W(t.argument):Pt&&"delete"===t.operator&&"Identifier"===t.argument.type&&n(t.start,"Deleting local variable in strict mode"),j(t,r?"UpdateExpression":"UnaryExpression")}for(var i=it();Tt.postfix&&!q();){var t=B(i);t.operator=Nt,t.prefix=!1,t.argument=i,W(i),M(),i=j(t,"UpdateExpression")}return i}function it(){return st(ot())}function st(e,t){if(I(Sn)){var n=B(e);return n.object=e,n.property=ht(!0),n.computed=!1,st(j(n,"MemberExpression"),t)}if(I(pn)){var n=B(e);return n.object=e,n.property=Y(),n.computed=!0,U(dn),st(j(n,"MemberExpression"),t)}if(!t&&I(gn)){var n=B(e);return n.callee=e,n.arguments=ct(yn,!1),st(j(n,"CallExpression"),t)}return e}function ot(){switch(Tt){case un:var e=H();return M(),j(e,"ThisExpression");case Ft:return ht();case Ht:case jt:case Bt:var e=H();return e.value=Nt,e.raw=dt.slice(wt,Et),M(),j(e,"Literal");case an:case fn:case ln:var e=H();return e.value=Tt.atomValue,e.raw=Tt.keyword,M(),j(e,"Literal");case gn:var t=St,n=wt;M();var r=Y();return r.start=n,r.end=Et,pt.locations&&(r.loc.start=t,r.loc.end=xt),pt.ranges&&(r.range=[n,Et]),U(yn),r;case pn:var e=H();return M(),e.elements=ct(dn,!0,!0),j(e,"ArrayExpression");case vn:return at();case Qt:var e=H();return M(),lt(e,!1);case on:return ut();default:z()}}function ut(){var e=H();return M(),e.callee=st(ot(),!0),e.arguments=I(gn)?ct(yn,!1):[],j(e,"NewExpression")}function at(){var e=H(),t=!0,r=!1;for(e.properties=[],M();!I(mn);){if(t)t=!1;else if(U(bn),pt.allowTrailingCommas&&I(mn))break;var i,s={key:ft()},o=!1;if(I(En)?(s.value=Y(!0),i=s.kind="init"):pt.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(o=r=!0,i=s.kind=s.key.name,s.key=ft(),Tt!==gn&&z(),s.value=lt(H(),!1)):z(),"Identifier"===s.key.type&&(Pt||r))for(var u=0;e.properties.length>u;++u){var a=e.properties[u];if(a.key.name===s.key.name){var f=i==a.kind||o&&"init"===a.kind||"init"===i&&("get"===a.kind||"set"===a.kind);f&&!Pt&&"init"===i&&"init"===a.kind&&(f=!1),f&&n(s.key.start,"Redefinition of property")}}e.properties.push(s)}return j(e,"ObjectExpression")}function ft(){return Tt===Ht||Tt===jt?ot():ht(!0)}function lt(e,t){Tt===Ft?e.id=ht():t?z():e.id=null,e.params=[];var r=!0;for(U(gn);!I(yn);)r?r=!1:U(bn),e.params.push(ht());var i=_t,s=Dt;if(_t=!0,Dt=[],e.body=J(!0),_t=i,Dt=s,Pt||e.body.body.length&&F(e.body.body[0]))for(var o=e.id?-1:0;e.params.length>o;++o){var u=0>o?e.id:e.params[o];if((zn(u.name)||Wn(u.name))&&n(u.start,"Defining '"+u.name+"' in strict mode"),o>=0)for(var a=0;o>a;++a)u.name===e.params[a].name&&n(u.start,"Argument name clash in strict mode")}return j(e,t?"FunctionDeclaration":"FunctionExpression")}function ct(e,t,n){for(var r=[],i=!0;!I(e);){if(i)i=!1;else if(U(bn),t&&pt.allowTrailingCommas&&I(e))break;n&&Tt===bn?r.push(null):r.push(Y(!0))}return r}function ht(e){var t=H();return t.name=Tt===Ft?Nt:e&&!pt.forbidReserved&&Tt.keyword||z(),M(),j(t,"Identifier")}e.version="0.1.01";var pt,dt,vt,mt;e.parse=function(e,n){return dt=e+"",vt=dt.length,t(n),u(),X(pt.program)};var gt=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},yt=e.getLineInfo=function(e,t){for(var n=1,r=0;;){Yn.lastIndex=r;var i=Yn.exec(e);if(!(i&&t>i.index))break;++n,r=i.index+i[0].length}return{line:n,column:t-r}};e.tokenize=function(e,n){function r(e){return E(e),i.start=wt,i.end=Et,i.startLoc=St,i.endLoc=xt,i.type=Tt,i.value=Nt,i}dt=e+"",vt=dt.length,t(n),u();var i={};return r.jumpTo=function(e,t){if(bt=e,pt.locations){kt=Lt=Yn.lastIndex=0;for(var n;(n=Yn.exec(dt))&&e>n.index;)++kt,Lt=n.index+n[0].length}dt.charAt(e-1),Ct=t,c()},r};var bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht={type:"num"},Bt={type:"regexp"},jt={type:"string"},Ft={type:"name"},It={type:"eof"},qt={keyword:"break"},Rt={keyword:"case",beforeExpr:!0},Ut={keyword:"catch"},zt={keyword:"continue"},Wt={keyword:"debugger"},Xt={keyword:"default"},Vt={keyword:"do",isLoop:!0},$t={keyword:"else",beforeExpr:!0},Jt={keyword:"finally"},Kt={keyword:"for",isLoop:!0},Qt={keyword:"function"},Gt={keyword:"if"},Yt={keyword:"return",beforeExpr:!0},Zt={keyword:"switch"},en={keyword:"throw",beforeExpr:!0},tn={keyword:"try"},nn={keyword:"var"},rn={keyword:"while",isLoop:!0},sn={keyword:"with"},on={keyword:"new",beforeExpr:!0},un={keyword:"this"},an={keyword:"null",atomValue:null},fn={keyword:"true",atomValue:!0},ln={keyword:"false",atomValue:!1},cn={keyword:"in",binop:7,beforeExpr:!0},hn={"break":qt,"case":Rt,"catch":Ut,"continue":zt,"debugger":Wt,"default":Xt,"do":Vt,"else":$t,"finally":Jt,"for":Kt,"function":Qt,"if":Gt,"return":Yt,"switch":Zt,"throw":en,"try":tn,"var":nn,"while":rn,"with":sn,"null":an,"true":fn,"false":ln,"new":on,"in":cn,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":un,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},pn={type:"[",beforeExpr:!0},dn={type:"]"},vn={type:"{",beforeExpr:!0},mn={type:"}"},gn={type:"(",beforeExpr:!0},yn={type:")"},bn={type:",",beforeExpr:!0},wn={type:";",beforeExpr:!0},En={type:":",beforeExpr:!0},Sn={type:"."},xn={type:"?",beforeExpr:!0},Tn={binop:10,beforeExpr:!0},Nn={isAssign:!0,beforeExpr:!0},Cn={isAssign:!0,beforeExpr:!0},kn={binop:9,prefix:!0,beforeExpr:!0},Ln={postfix:!0,prefix:!0,isUpdate:!0},An={prefix:!0,beforeExpr:!0},On={binop:1,beforeExpr:!0},Mn={binop:2,beforeExpr:!0},_n={binop:3,beforeExpr:!0},Dn={binop:4,beforeExpr:!0},Pn={binop:5,beforeExpr:!0},Hn={binop:6,beforeExpr:!0},Bn={binop:7,beforeExpr:!0},jn={binop:8,beforeExpr:!0},Fn={binop:10,beforeExpr:!0};e.tokTypes={bracketL:pn,bracketR:dn,braceL:vn,braceR:mn,parenL:gn,parenR:yn,comma:bn,semi:wn,colon:En,dot:Sn,question:xn,slash:Tn,eq:Nn,name:Ft,eof:It,num:Ht,regexp:Bt,string:jt};for(var In in hn)e.tokTypes[In]=hn[In];var qn,Rn=r("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Un=r("class enum extends super const export import"),zn=r("implements interface let package private protected public static yield"),Wn=r("eval arguments"),Xn=r("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Vn=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,$n="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Jn="ͱ-ʹ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Kn=RegExp("["+$n+"]"),Qn=RegExp("["+$n+Jn+"]"),Gn=/[\n\r\u2028\u2029]/,Yn=/\r\n|[\n\r\u2028\u2029]/g,Zn={kind:"loop"},er={kind:"switch"}}("undefined"==typeof exports?self.acorn={}:exports);var PaperScript=this.PaperScript=new function(){function _$_(e,t,n){var r=binaryOperators[t];if(e&&e[r]){var i=e[r](n);return t==="!="?!i:i}switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"%":return e%n;case"==":return e==n;case"!=":return e!=n}}function $_(e,t){var n=unaryOperators[e];if(n&&t&&t[n])return t[n]();switch(e){case"+":return+t;case"-":return-t}}function compile(e){function t(e){var t=e;for(var n=0,r=s.length;n<r;n++){var i=s[n];if(i[0]>=e)break;e+=i[1]}return e}function n(n){return e.substring(t(n.range[0]),t(n.range[1]))}function r(n,r){var i=t(n.range[0]),o=t(n.range[1]),u=0;for(var a=s.length-1;a>=0;a--)if(i>s[a][0]){u=a+1;break}s.splice(u,0,[i,r.length-o+i]),e=e.substring(0,i)+r+e.substring(o)}function i(e){for(var t in e){if(t==="range")continue;var s=e[t];if(Array.isArray(s))for(var o=0,u=s.length;o<u;o++)i(s[o]);else s&&typeof s=="object"&&i(s)}switch(e&&e.type){case"BinaryExpression":if(e.operator in binaryOperators&&e.left.type!=="Literal"){var a=n(e.left),f=n(e.right);r(e,"_$_("+a+', "'+e.operator+'", '+f+")")}break;case"AssignmentExpression":if(/^.=$/.test(e.operator)&&e.left.type!=="Literal"){var a=n(e.left),f=n(e.right);r(e,a+" = _$_("+a+', "'+e.operator[0]+'", '+f+")")}break;case"UpdateExpression":if(!e.prefix){var l=n(e.argument);r(e,l+" = _$_("+l+', "'+e.operator[0]+'", 1)')}break;case"UnaryExpression":if(e.operator in unaryOperators&&e.argument.type!=="Literal"){var l=n(e.argument);r(e,'$_("'+e.operator+'", '+l+")")}}}var s=[];return i(acorn.parse(e,{ranges:!0})),e}function evaluate(code,scope){paper=scope;var view=scope.project&&scope.project.view,res;with(scope)(function(){var onActivate,onDeactivate,onEditOptions,onMouseDown,onMouseUp,onMouseDrag,onMouseMove,onKeyDown,onKeyUp,onFrame,onResize;res=eval(compile(code)),/on(?:Key|Mouse)(?:Up|Down|Move|Drag)/.test(code)&&Base.each(Tool.prototype._events,function(key){var value=eval(key);value&&(scope.getTool()[key]=value)}),view&&(view.setOnResize(onResize),view.fire("resize",{size:view.size,delta:new Point}),view.setOnFrame(onFrame),view.draw())}).call(scope);return res}function request(e,t){var n=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");return n.open("GET",e,!0),n.overrideMimeType&&n.overrideMimeType("text/plain"),n.onreadystatechange=function(){if(n.readyState===4)return evaluate(n.responseText,t)},n.send(null)}function load(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;t++){var r=e[t];if(/^text\/(?:x-|)paperscript$/.test(r.type)&&!r.getAttribute("data-paper-ignore")){var i=PaperScript.getAttribute(r,"canvas"),s=PaperScope.get(i)||(new PaperScope(r)).setup(i);r.src?request(r.src,s):evaluate(r.innerHTML,s),r.setAttribute("data-paper-ignore",!0)}}}function handleAttribute(e){return e+="Attribute",function(t,n){return t[e](n)||t[e]("data-paper-"+n)}}var binaryOperators={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"modulo","==":"equals","!=":"equals"},unaryOperators={"-":"negate","+":null};return document.readyState==="complete"?setTimeout(load):DomEvent.add(window,{load:load}),{compile:compile,evaluate:evaluate,load:load,getAttribute:handleAttribute("get"),hasAttribute:handleAttribute("has")}};return this.enumerable=!0,new(PaperScope.inject(this))};define("paperJS",function(){}),define("interaction/ui/animation",["interaction/model/base","paperJS"],function(){return{set:function(e,t,n){switch(n){case 301:case 302:interaction.animation.path.init(e,t,n)}},save:function(e,t,n){var r=interaction.elementlist.get(t),i=interaction.iAnimationGroupList.get(e);interaction.animation.setDetail(e,t,n),interaction.animation.close(e,t,n)},preview:function(){$(".interaction-view").jswait(),$(".interaction-view").children(".iView").remove(),$("#animation_preview").children(".modal-body").attr("id",interaction.currentpage.id),interaction_view.ipagelist.reset();var e=new interaction_view.model.Page({id:interaction.currentpage.id});interaction.animation.stop(interaction.currentpage.id),interaction.modal.show("#animation_preview"),$("#preloader").empty(),e.iview.overlays=interaction.elementlist.toJSON(),e.iview.animations=interaction.iAnimationGroupList.toJSON(),e.iview.actions=interaction.iActionList.toJSON(),e.iview.afterload()},stop:function(e){var t=interaction_view.ipagelist.get(e);t.iAnimationlist.timeline&&t.iAnimationlist.timeline.pause(),t.iViewlist.each(function(e){e.media&&(e.media.pause(),e.media=null)})},close:function(e,t,n){switch(n){case 301:case 302:interaction.animation.path.close(e,t,n)}},setDetail:function(e,t,n){switch(n){case 301:case 302:return interaction.animation.path.setDetail(e,t,n);default:return}},path:{prompt:function(e){switch(e){case 0:return"双击进入画线模式";case 1:return"ESC退出画线模式"}},init:function(e,t,n){var r=interaction.elementlist.get(t),i=interaction.iAnimationGroupList.get(e);r.iview.path=new paper.Path,r.iview.path.strokeColor="black",r.iview.path.strokeWidth=2,r.iview.path.selected=!1;var s=i.toJSON().iDetail.path;s&&_.each(s,function(e){r.iview.path.add(e)}),interaction.animation.path.setmirror(r),interaction.animation.path.setevent(r,n)},setmirror:function(e){var t=e.iview.$el.width(),n=e.iview.$el.height(),r=new paper.Point(0,0),i=(t,n);e.mirror=new paper.Path,e.mirror.strokeColor="blue",e.mirror.strokeWidth=1,e.mirror.visible=!1,e.mirror.add(new paper.Point(0,0)),e.mirror.add(new paper.Point(t,0)),e.mirror.add(new paper.Point(t,n)),e.mirror.add(new paper.Point(0,n)),e.mirror.closePath()},setevent:function(e,t){e.tempPoint=null;var n=e.iview.path,r=null,i={segments:!0,stroke:!0,fill:!0,tolerance:5};interaction.animation.path.status=0;var s=interaction.animation.path.paperTool=new paper.Tool;$("canvas#interaction").removeClass("hide"),$(document).on("dblclick","canvas#interaction",function(e){return interaction.animation.path.status==0&&(interaction.animation.path.status=1),!1}),s.onMouseDrag=function(i){r&&(r.point=i.point,e.mirror.position=i.point,e.mirror.visible=!0,t==302&&n.smooth())},s.onMouseDown=function(e){if(interaction.animation.path.status==0){r=null;var t=n.hitTest(e.point,i);if(e.modifiers.shift){t&&t.type=="segment"&&t.segment.remove();return}t&&t.type=="segment"&&(r=t.segment)}},s.onMouseUp=function(r){interaction.animation.path.status==1&&(e.tempPoint||(n.add(r.point),t==302&&n.smooth()),e.tempPoint=null)},s.onMouseMove=function(r){var s=r.point;$(".interaction-area .tooltip.prompt .tooltip-inner").html(interaction.animation.path.prompt(interaction.animation.path.status)),$(".interaction-area .tooltip.prompt").css("left",s.x-75),$(".interaction-area .tooltip.prompt").css("top",s.y-70),$(".interaction-area .tooltip.prompt").removeClass("hide");if(interaction.animation.path.status==1)e.tempPoint?(n.lastSegment.point=r.point,t==302&&n.smooth()):(n.add(r.point),t==302&&n.smooth(),e.tempPoint=n.lastSegment),e.mirror.position=r.point,e.mirror.visible=!0;else{var o=n.hitTest(r.point,i);n.selected=!1,o&&o.item?(o.item.selected=!0,e.mirror.position=r.point,e.mirror.visible=!0):e.mirror.visible=!1}},s.onKeyUp=function(r){console.log(r.key),r.key=="escape"&&(interaction.animation.path.status=0,e.tempPoint&&(n.lastSegment.remove(),e.tempPoint=null));if(r.key=="x"||r.key=="X"){var i=interaction.animation.path.getLastPoint(e,t);i&&(n.segments.length==1?(n.add(new paper.Point(0,0)),e.tempPoint=n.lastSegment,n.firstSegment.point=i):n.firstSegment&&(n.firstSegment.point=i),t==302&&n.smooth())}}},getLastPoint:function(e,t){var n=null,r=interaction.iAnimationGroupList.toJSON(),i=_.filter(r,function(t){return t.overlay_id==e.id&&_.include([301,302],t.iType)});if(i.length<2){var s=e.iview.getcommon(),o=new paper.Point(s.iStartx+s.iWidth/2,s.iStarty+s.iHeight/2);return o}var u=i[i.length-2].iDetail.path;if(u.length>0){var o=new paper.Point(u[u.length-1].point);return o}return n},setDetail:function(animationid,overlayid,iType){var overlaymodel=interaction.elementlist.get(overlayid),animationmodel=interaction.iAnimationGroupList.get(animationid),overlayanimationmodel=interaction.iAnimationlist.get(animationid);overlaymodel.tempPoint&&overlaymodel.iview.path.lastSegment.remove();var detail=animationmodel.iview.getdetail();detail.path=_.map(overlaymodel.iview.path.segments,function(i){return eval("("+i.toString()+")")}),animationmodel.set("iDetail",detail),overlayanimationmodel&&overlayanimationmodel.set("iDetail",detail)},close:function(e,t,n){var r=interaction.elementlist.get(t),i=interaction.iAnimationGroupList.get(e);r.iview.path&&r.iview.path.remove(),interaction.animation.path.paperTool&&interaction.animation.path.paperTool.remove(),$("canvas#interaction").addClass("hide"),$(".interaction-area .tooltip.prompt").addClass("hide"),$(document).off("mousemove","canvas#interaction"),$(document).off("mouseout","canvas#interaction"),$(document).off("click","canvas#interaction")}}}}),define("interaction/ui/event",["interaction/model/base"],function(){var e={init:function(){this.bindactions(),this.bindpageactions()},bindpageactions:function(){$(".navi header .action-del").click(function(){var e=$(".doc-layout-left .thumbs").find("li.ui-selected").attr("id");return e?(iPagelist.get(e).iview.removemodel(),!1):!1})},bindactions:function(){function e(e,t){tabDiv=$("ul#"+e),tabDiv.children("li").each(function(){$(this).attr("id")==t?$(this).addClass("selected"):$(this).removeClass("selected")})}$(".interaction-action ul").selectable({filter:"li",selected:function(){e($(this).parent("ul").attr("id"),$(this).attr("id"));var t=$(".interaction-action ul").children("li.ui-selected").attr("id"),n=_.clone(interaction.model[t].prototype.defaults.iCommon);n&&(n.landscape=_.clone(n.landscape)),n&&(n.portait=_.clone(n.portait));var r=_.clone(interaction.model[t].prototype.defaults.iDetail),i=new interaction.model[t]({iType:t,iCommon:n,iDetail:r,iParent:interaction.elementlist.url,iUrl:context_url+interaction.elementlist.url,iPageid:interaction.currentpage.id})}})}};return e}),define("interaction/ui/resources",["interaction/model/base"],function(){var e={load:function(){},openforchange:function(){var t={};return $("#materialslistforchange").remove(),t.onfilterload=function(){$("#materialslistforchange").find('select[name="portal_type"]').attr("disabled",!0).val("interaction.image").trigger("change")},material.listforchange(function(t,n){e.change(t.options.right.model,n)},t),global.modal.show("#materialslistforchange"),!1},open:function(t){var n,r={};$("#materialslistforinsert").remove();switch(t){case"Audio":n="interaction.audio";break;case"Video":n="interaction.video";break;default:n="interaction.image"}return r.onfilterload=function(){$("#materialslistforinsert").find('select[name="portal_type"]').attr("disabled",!0).val(n).trigger("change")},material.listforinsert(function(t,n){e.insert(t.options.right.model,n)},r),global.modal.show("#materialslistforinsert"),!1},insert:function(e,t){var n=interaction.current.get("iDetail"),r={},i="";r[interaction.current.iview.resourcesattr]=n[interaction.current.iview.resourcesattr];if(interaction.current.iview.resourcestype=="single"){r[interaction.current.iview.resourcesattr]=[];var s=e.icollection.get(t[0]).toJSON();s.id=interaction.getUniqueIdByRandom("Resources_"),s.elementid=interaction.current.id,s.resourceattr=interaction.current.iview.resourcesattr,i=s.title,r[interaction.current.iview.resourcesattr].push(s)}else r[interaction.current.iview.resourcesattr]||(r[interaction.current.iview.resourcesattr]=[]),_.each(t,function(n){var s=e.icollection.get(n).toJSON();t.indexOf(n)==0&&(i=s.title),s.id=interaction.getUniqueIdByRandom("Resources_"),s.elementid=interaction.current.id,s.resourceattr=interaction.current.iview.resourcesattr,r[interaction.current.iview.resourcesattr].push(s)});return $("#info_attributes").find('[name="title"]').val(i).trigger("change"),interaction.current.iview.setdetail(r),interaction.current.iview.updateresources(),!1},change:function(e,t){if(!t||t.length==0)return;var n=t[0],r=e.icollection.get(n).toJSON(),i={};i.width=r.width,i.height=r.height,i.preview=r.preview,i.thumbnail=r.thumbnail,i.thumb_height=r.thumb_height,i.thumb_width=r.thumb_width,i.picture=r.picture,i.uid=r.uid,interaction.currentpage.set(i),interaction.currentpage.iview.updatepageinfo(),interaction.currentpage.iview.updatebackground(),interaction.currentpage.iview.$el.children("a").html("<img src="+interaction.currentpage.get("thumbnail")+"/>")}};return e}),define("text!global/templates/confirm.js",[],function(){return'<form onSubmit="return false;">\n		  <div class="modal-header">\n		  	<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>\n		  	<h3>确认框</h3>\n		  </div>\n		  <div class="modal-body">\n		  	<span style="font-size:14px;">\n		  		<%=msg%></span>\n		  </div>\n		  <div class="modal-footer">\n		  	<button class="btn btn-primary btn-confirm" type="submit">确定</button>\n		  	<button aria-hidden="true" data-dismiss="modal" style="margin-left:20px;" class="btn">取消</button>\n		  </div>\n</form>'}),define("text!interaction/template/page.js",[],function(){return'<li class="pagetemplate" id=<%=id%>><a class="addpage" href="#"><img src="<%=thumbnail%>"></a></li>'}),define("interaction/ui/templatepage",["global/main","text!interaction/template/page.js"],function(){var e=require("text!interaction/template/page.js");return{load:function(){$.getJSON(portal_url+"templates/getimages",function(e){e=e.data,e.results&&interaction.templatepage.render(e.results)})},render:function(e){_.each(e,function(e){new interaction.templatepage.model(e)})},model:Backbone.Model.extend({initialize:function(){this.iview=new interaction.templatepage.view({model:this})}}),view:Backbone.View.extend({initialize:function(){_.bindAll(this),this.render()},events:{"click a.addpage":"addpage"},render:function(){this.container=$(".action-add .templates").children("ul");var t=_.template(e,this.model.toJSON());return this.container.append(t),this.setElement(this.container.find('li[id="'+this.model.id+'"]')),this},addpage:function(){var e="addpage.json?template_id="+this.model.id;return jqwait_simple(),$.getJSON(e,function(e){if(e.code==200){var t=e.data;t.iType="Page",t.isNew=!0,iPagelist.add(t),jqwait_simple_close()}}),!1}})}}),define("interaction/ui/main",["global/main","interaction/ui/animation","interaction/ui/event","interaction/ui/resources","text!global/templates/confirm.js","interaction/ui/templatepage","text!interaction_view/template/message.js"],function(){var MessageTemplate=require("text!interaction_view/template/message.js"),confirmT=require("text!global/templates/confirm.js"),func={modal:{create:function(e,t,n,r){r||(r=""),t||(t="large-modal"),$("body").append(global.template.modal({name:e,data:r,type:t,options:n||{}}))},create_preview_modal:function(e,t){t||(t=""),$("body").append(global.template.modal_preview({name:e,data:t}))},show:function(e){$(e).modal("show")},hide:function(e){$(e).modal("hide")}},save:function(model,attributes,callback){attributes||(attributes={}),model.save(attributes,{wait:!0,success:function(m,response){$("button.action-save").button("reset"),returned=eval(response),callback(response)},error:function(){$("button.action-save").button("reset"),interaction.message("error","服务器请求未应答")}})},serializeValueSimple:function(e){var t={};return $(e).find('input[type="text"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-type");if(!e)return;t[e]=$(this).attr("value"),n=="number"&&(t[e]=Number(t[e]))}),$(e).find('input[type="hidden"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-type");if(!e)return;t[e]=$(this).attr("value"),t[e]=="true"&&(t[e]=!0),t[e]=="false"&&(t[e]=!1),n=="number"&&(t[e]=Number(t[e]))}),$(e).find('input[type="checkbox"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-type");if(!e)return;t[e]||(t[e]=[]),$(this).attr("checked")=="checked"?n=="boolean"?t[e]=!0:n=="number"?t[e].push(Number($(this).val())):t[e].push($(this).val()):$(this).attr("data-type")=="boolean"&&(t[e]=!1)}),$(e).find('input[type="radio"]:checked').each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-type");if(!e)return;t[e]=$(this).val(),n=="number"&&(t[e]=Number(t[e]))}),$(e).find("select").each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-type");if(!e)return;if($(this).val()=="null"||$(this).val()=="")return;t[e]=$(this).val(),n=="number"&&(t[e]=Number(t[e]))}),$(e).find("textarea").each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;t[e]=$(this).html()}),t},serializeValue:function(e){var t={},n=null,r=null,i=function(e,i,s,o){if(!s)return;t[s]=o,t[s]=="true"&&(t[s]=!0),t[s]=="false"&&(t[s]=!1),e=="iCommon"&&(n||(n={}),n[s]=Number(o)),e=="iDetail"&&(r||(r={}),r[s]=o)};return $(e).find('input[type="text"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-attr"),n=$(this).attr("data-type"),r=$(this).attr("value");i(t,n,e,r)}),$(e).find('input[type="hidden"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-attr"),n=$(this).attr("data-type"),r=$(this).attr("value");i(t,n,e,r)}),$(e).find('input[type="checkbox"]').each(function(){var e=$(this).attr("name")||$(this).attr("id"),n=$(this).attr("data-attr"),r=$(this).attr("data-type");if(!e)return;t[e]||i(n,r,e,[]),$(this).attr("checked")=="checked"?$(this).attr("data-type")=="boolean"?i(n,r,e,!0):(t[e].push($(this).val()),i(n,r,e,t[e])):$(this).attr("data-type")=="boolean"&&i(n,r,e,!1)}),$(e).find('input[type="radio"]:checked').each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-attr"),n=$(this).attr("data-type"),r=$(this).val();$(this).attr("checked")=="checked"?$(this).attr("data-type")=="boolean"?i(t,n,e,!0):i(t,n,e,r):$(this).attr("data-type")=="boolean"&&i(t,n,e,!1)}),$(e).find("select").each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-attr"),n=$(this).attr("data-type"),r=$(this).val();i(t,n,e,r)}),$(e).find("textarea").each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=$(this).attr("data-attr"),n=$(this).attr("data-type");value=$(this).html(),i(t,n,e,value)}),{data:t,common:n,detail:r}},get_array:function(e,t){var n=[];return e.each(function(){var e=$(this).attr(t);n.push(e)}),n},tEditorinit:function(){$("table.mceLayout").css("width","100%"),$("table.mceLayout").css("height","100%"),$("table.mceLayout").css("background","transparent"),$("table.mceLayout").children("tbody").children("tr.last").css("position","absolute"),$("table.mceLayout").children("tbody").children("tr.last").css("background","#FFFFFF"),$("table.mceLayout").children("tbody").children("tr.last").css("top","-50px"),$("table.mceLayout").children("tbody").children("tr.mceLast").css("position","absolute"),$("table.mceLayout").children("tbody").children("tr.mceLast").css("background","#FFFFFF"),$("table.mceLayout").children("tbody").children("tr.mceLast").css("top","-50px"),$("table.mceLayout iframe").css("background","transparent"),interaction.current.iview.$el.find("iframe").css("height",interaction.current.iview.getcommon().iHeight+"px"),tinyMCE.execCommand("mceFocus",!1,"tEditor_"+interaction.current.id)},sortable:function(e,t,n,r,i){$(e).sortable({handle:n,items:t,axis:"y",helper:"clone",forceHelperSize:!0,placeholder:"ui-sortable-placehoder",forceHelperSize:!0,dropOnEmpty:!0,start:function(n,i){function o(n){if(n.type=="mouseover"){if($(n.currentTarget).parents(t).first().hasClass("ui-sortable-helper"))return!1;$(n.currentTarget).parents(t).first().addClass("current"),$(n.currentTarget).parents(t).first().children(".wraparea").addClass("ui-sortable-hover"),$(e).find("li.ui-sortable-placehoder").css("visibility","hidden"),r(s.attr("id"),$(n.currentTarget).parents(t).first().attr("id"))?$(n.currentTarget).parents(t).first().children(".wraparea").removeClass("ui-sortable-disable"):$(n.currentTarget).parents(t).first().children(".wraparea").addClass("ui-sortable-disable")}else{if($(n.currentTarget).parents(t).first().hasClass("ui-sortable-helper"))return!1;$(n.currentTarget).parents(t).first().removeClass("current"),$(n.currentTarget).parents(t).first().children(".wraparea").removeClass("ui-sortable-hover"),$(e).find("li.ui-sortable-placehoder").css("visibility","visible"),r(s.attr("id"),$(n.currentTarget).parents(t).first().attr("id"))?$(n.currentTarget).parents(t).first().children(".wraparea").removeClass("ui-sortable-disable"):$(n.currentTarget).parents(t).first().children(".wraparea").removeClass("ui-sortable-disable")}}startposition=i.item.prevAll().length+1;var s=$(i.item);$(e).find(t+" .btn-draged").each(function(){$(this).bind("mouseover mouseout",o)})},stop:function(n,s){$(e).find(t+" .btn-draged").each(function(){$(this).unbind("mouseover mouseout")});if($(e).find(".current").length>0){var o=$(s.item).attr("id"),u=$(e).find(".current").first().attr("id");r(o,u)&&($dest=$(e).find('[id="'+u+'"]'),$source=$(e).find('[id="'+o+'"]').detach(),$dest.children("ul").length==0&&$dest.append("<ul></ul>"),$dest.children("ul").append($source)),$(e).find(".current").children(".wraparea").removeClass("ui-sortable-hover"),$(e).find(".current").removeClass("current")}var a=$(s.item).attr("id");i(a)},update:function(e,t){if(startposition!=-1){var n=t.item.prevAll().length+1-startposition;id=$(t.item).attr("id")}},sort:function(e,t){}})},getUniqueIdByRandom:function(e,t){e||(e=""),t||(t="");var n=_.uniqueId(e);return n+=(new Date).getTime(),n+=t,n},get_tree:function(e,t,n,r){var i=[];return t&&$(e).children(t).children(n).each(function(){var e={};e.id=$(this).attr(r),e.children=global.get_tree($(this),t,n,r),i.push(e)}),i},changeTab:function(e){$('a[data-toggle="tab"][href="#'+e+'"]').trigger("click")},confirmDelete:function(e){var t=require("text!global/templates/confirm.js");$("#confirmModal").html(_.template(t,{msg:"确认删除？"})),interaction.modal.show("#confirmModal"),$("#confirmModal").find(".btn.btn-confirm").focus().on("click",function(){interaction.modal.hide("#confirmModal"),e()})},div_find:function(e){return $('div.element[id="'+e+'"]')},preload:function(e){},EaseTypes:{0:"Linear.easeNone",20:"Cubic.easeInOut"},StartTypes:{0:"点击后开始",1:"上一个之后开始",2:"和上一个一起开始"},RepeatTypes:{0:"不重复","-1":"一直播放到该页结束","-2":"播放到下一次点击"},AxialTypes:{0:"Z轴",1:"X轴",2:"Y轴"},DirectionTypes:{0:"top",1:"right",2:"bottom",3:"left"},MediaAnimationTypes:{501:"播放",502:"暂停",503:"结束"},AnimationTypes:{101:"飞入",102:"放大",103:"渐现",201:"飞出",202:"缩小",203:"渐隐",301:"直线运动",302:"曲线运动",401:"放大缩小",402:"透明",403:"旋转"},ActionTypes:{0:"onClick"},ActionExecTypes:{0:"Play animations",1:"show elements",2:"hide elements"},getAnimationTypeName:function(e){switch(e){case 100:return"出现动画";case 101:return"飞入";case 102:return"放大";case 103:return"渐现";case 200:return"消失动画";case 201:return"飞出";case 202:return"缩小";case 203:return"渐隐";case 300:return"运动路径";case 301:return"直线运动";case 302:return"曲线运动";case 400:return"强调动画";case 401:return"放大缩小";case 402:return"透明";case 403:return"旋转";case 500:return"媒体动画";case 501:return"播放";case 502:return"暂停";case 503:return"结束"}},message:function(e,t,n){$("body").append('<div class="msg"></div>'),n||(n=3e3),$(".msg").html(_.template(MessageTemplate,{type:e,msg:t})),$(".msg").fadeIn(),setTimeout(function(){$(".msg").fadeOut("slow"),$(".msg").remove()},n)},pagesort:function(){var e=!1,t=!1;$(document).on("keydown",function(e,n){console.log(e.keyCode),e.keyCode==18&&(t=!0)}),$(".thumbs ul").sortable({item:"li",containment:"parent",opacity:"0.5",start:function(n,r){$(document).on("keyup",function(n,r){console.log(n.keyCode),n.keyCode==27?(e=!0,$(".thumbs ul").sortable("cancel")):n.keyCode==18&&(t=!1)})},stop:function(e,t){$(document).off("keyup")},update:function(n,r){if($(r.item).nextAll().hasClass("top")||e){$(".thumbs ul").sortable("cancel"),e=!1;return}if($(r.item).prevAll().length==0)var i=Number($(r.item).next().attr("data-position"))-1;else var i=$(r.item).prev().attr("data-position");i=parseInt(i);var s=$(r.item).attr("id"),o=iPagelist.get(s),u=context_url+o.id,a=parseInt(o.toJSON().position);if(t==1){t=!1;var f=context_url+"copypage.json?position="+(a>i?i+1:i)+"&id="+s;$(".thumbs ul").sortable("cancel"),global.confirmModal("你确认要复制一页吗？",function(){jqwait_simple(),global.json.load(f,function(e){if(e.code==200){var t=e.data.id;$.getJSON(context_url+"getimages",function(e){if(e.code==200){iPagelist.reset([],{silent:!0});var n=$(".doc-layout-left .thumbs").children("ul").children("li").detach();iPagelist.add(e.data.results),n.each(function(e){$(".doc-layout-left .thumbs").children("ul").children('li[id="'+$(this).attr("id")+'"]').append($(this).children(".interaction_thumbitem"))}),iPagelist.get(t).iview.focus(),jqwait_simple_close()}}),global.message("success",e.msg)}else jqwait_simple_close(),global.message("error",e.msg),$(".thumbs ul").sortable("cancel")})})}else{jqwait_simple();var f=u+"/movetoposition?position="+(a>i?i+1:i);global.json.load(f,function(e){e.code==200?($.getJSON(context_url+"getimages",function(e){if(e.code==200){console.log(e),iPagelist.reset([],{silent:!0});var t=$(".doc-layout-left .thumbs").children("ul").children("li").detach();iPagelist.add(e.data.results),t.each(function(e){$(".doc-layout-left .thumbs").children("ul").children('li[id="'+$(this).attr("id")+'"]').append($(this).children(".interaction_thumbitem"))}),interaction.currentpage&&iPagelist.get(interaction.currentpage.id).iview.focus(),jqwait_simple_close()}}),global.message("success",e.msg)):(jqwait_simple_close(),global.message("error",e.msg),$(".thumbs ul").sortable("cancel"))})}console.log(f)}})}};return func.action={},func.event=require("interaction/ui/event"),func.animation=require("interaction/ui/animation"),func.resources=require("interaction/ui/resources"),func.templatepage=require("interaction/ui/templatepage"),func}),function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,!t.href||!s||i.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.10.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s=r==="Width"?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n,r=this,i=!1,s=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),n=this.element[0];while(n&&(n=n.parentNode))n===document&&(i=!0);return!i&&this.options.helper==="original"?!1:(this.options.revert==="invalid"&&!s||this.options.revert==="valid"&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;return e(this.options.handle,this.element).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo==="parent"?this.element[0].parentNode:n.appendTo),r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);if(i.containment==="document"||i.containment==="window")this.containment=[i.containment==="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,i.containment==="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(i.containment==="document"?0:e(window).scrollLeft())+e(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(i.containment==="document"?0:e(window).scrollTop())+(e(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(i.containment)&&i.containment.constructor!==Array){n=e(i.containment),r=n[0];if(!r)return;t=e(r).css("overflow")!=="hidden",this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}else i.containment.constructor===Array&&(this.containment=i.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName),f=t.pageX,l=t.pageY;return this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(f=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(f=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,f=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t==="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper==="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&t.scrollParent[0].tagName!=="HTML"&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;if(n.scrollParent[0]!==document&&n.scrollParent[0].tagName!=="HTML"){if(!r.axis||r.axis!=="x")n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed);if(!r.axis||r.axis!=="y")n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed)}else{if(!r.axis||r.axis!=="x")t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed));if(!r.axis||r.axis!=="y")t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed))}i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--){u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height;if(!(u-v<m&&m<a+v&&f-v<y&&y<l+v||u-v<m&&m<a+v&&f-v<b&&b<l+v||u-v<g&&g<a+v&&f-v<y&&y<l+v||u-v<g&&g<a+v&&f-v<b&&b<l+v)){p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1;continue}d.snapMode!=="inner"&&(r=Math.abs(f-b)<=v,i=Math.abs(l-y)<=v,s=Math.abs(u-g)<=v,o=Math.abs(a-m)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,d.snapMode!=="outer"&&(r=Math.abs(f-y)<=v,i=Math.abs(l-b)<=v,s=Math.abs(u-m)<=v,o=Math.abs(a-g)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=e(this).data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!r.length)return;t=parseInt(r[0].style.zIndex,10)||0,e(r).each(function(e){this.style.zIndex=t+e}),this[0].style.zIndex=t+r.length}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&e<t+n}e.widget("ui.droppable",{version:"1.10.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=0,n=e.ui.ddmanager.droppables[this.options.scope];for(;t<n.length;t++)n[t]===this&&n.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){t==="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return!r||(r.currentItem||r.element)[0]===this.element[0]?!1:(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1)},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,t,r){if(!t.offset)return!1;var i,s,o=(e.positionAbs||e.position.absolute).left,u=o+e.helperProportions.width,a=(e.positionAbs||e.position.absolute).top,f=a+e.helperProportions.height,l=t.offset.left,c=l+t.proportions.width,h=t.offset.top,p=h+t.proportions.height;switch(r){case"fit":return l<=o&&u<=c&&h<=a&&f<=p;case"intersect":return l<o+e.helperProportions.width/2&&u-e.helperProportions.width/2<c&&h<a+e.helperProportions.height/2&&f-e.helperProportions.height/2<p;case"pointer":return i=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,s=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,n(s,h,t.proportions.height)&&n(i,l,t.proportions.width);case"touch":return(a>=h&&a<=p||f>=h&&f<=p||a<h&&f>p)&&(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++){if(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))continue;for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions.height=0;continue e}s[r].visible=s[r].element.css("display")!=="none";if(!s[r].visible)continue;o==="mousedown"&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;if(!u)return;this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===i}),s.length&&(r=e.data(s[0],"ui-droppable"),r.greedyChild=u==="isover")),r&&u==="isover"&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this[u==="isout"?"isover":"isout"]=!1,this[u==="isover"?"_over":"_out"].call(this,n),r&&u==="isout"&&(r.isout=!1,r.isover=!0,r._over.call(r,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){function n(e){return parseInt(e,10)||0}function r(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,r,i,s,o=this,u=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor===String){this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={};for(n=0;n<t.length;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i)}this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles){this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize());if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(u.disabled)return;e(this).removeClass("ui-resizable-autohide"),o._handles.show()}).mouseleave(function(){if(u.disabled)return;o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles){r=e(this.handles[n])[0];if(r===t.target||e.contains(r,t.target))i=!0}return!this.options.disabled&&i},_mouseStart:function(t){var r,i,s,o=this.options,u=this.element.position(),a=this.element;return this.resizing=!0,/absolute/.test(a.css("position"))?a.css({position:"absolute",top:a.css("top"),left:a.css("left")}):a.is(".ui-draggable")&&a.css({position:"absolute",top:u.top,left:u.left}),this._renderProxy(),r=n(this.helper.css("left")),i=n(this.helper.css("top")),o.containment&&(r+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:i},this.size=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:r,top:i},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof o.aspectRatio=="number"?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor",s==="auto"?this.axis+"-resize":s),a.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=this.position.top,a=this.position.left,f=this.size.width,l=this.size.height,c=t.pageX-s.left||0,h=t.pageY-s.top||0,p=this._change[o];if(!p)return!1;n=p.apply(this,[t,c,h]),this._updateVirtualBoundaries(t.shiftKey);if(this._aspectRatio||t.shiftKey)n=this._updateRatio(n,t);return n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==u&&(i.top=this.position.top+"px"),this.position.left!==a&&(i.left=this.position.left+"px"),this.size.width!==f&&(i.width=this.size.width+"px"),this.size.height!==l&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,a,f=this.options,l=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&e.ui.hasScroll(n[0],"left")?0:l.sizeDiff.height,s=r?0:l.sizeDiff.width,o={width:l.helper.width()-s,height:l.helper.height()-i},u=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null,a=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null,f.animate||this.element.css(e.extend(o,{top:a,left:u})),l.helper.height(l.size.height),l.helper.width(l.size.width),this._helper&&!f.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,i,s,o,u=this.options;o={minWidth:r(u.minWidth)?u.minWidth:0,maxWidth:r(u.maxWidth)?u.maxWidth:Infinity,minHeight:r(u.minHeight)?u.minHeight:0,maxHeight:r(u.maxHeight)?u.maxHeight:Infinity};if(this._aspectRatio||e)t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,s=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),s<o.maxHeight&&(o.maxHeight=s);this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),i==="sw"&&(e.left=t.left+(n.width-e.width),e.top=null),i==="nw"&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=r(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=r(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=r(e.width)&&t.minWidth&&t.minWidth>e.width,u=r(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,f=this.position.top+this.size.height,l=/sw|nw|w/.test(n),c=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),u&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),s&&(e.height=t.maxHeight),o&&l&&(e.left=a-t.minWidth),i&&l&&(e.left=a-t.maxWidth),u&&c&&(e.top=f-t.minHeight),s&&c&&(e.top=f-t.maxHeight),!e.width&&!e.height&&!e.left&&e.top?e.top=null:!e.width&&!e.height&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length)return;var e,t,n,r,i,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){i=this._proportionallyResizeElements[e];if(!this.borderDif){this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];for(t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0)}i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!=="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,a={width:n.size.width-u,height:n.size.height-o},f=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,l=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(a,l&&f?{top:l,left:f}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,r,i,s,o,u,a,f=e(this).data("ui-resizable"),l=f.options,c=f.element,h=l.containment,p=h instanceof e?h.get(0):/parent/.test(h)?c.parent().get(0):h;if(!p)return;f.containerElement=e(p),/document/.test(h)||h===document?(f.containerOffset={left:0,top:0},f.containerPosition={left:0,top:0},f.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),r=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){r[e]=n(t.css("padding"+i))}),f.containerOffset=t.offset(),f.containerPosition=t.position(),f.containerSize={height:t.innerHeight()-r[3],width:t.innerWidth()-r[1]},i=f.containerOffset,s=f.containerSize.height,o=f.containerSize.width,u=e.ui.hasScroll(p,"left")?p.scrollWidth:o,a=e.ui.hasScroll(p)?p.scrollHeight:s,f.parentData={element:p,left:i.left,top:i.top,width:u,height:a})},resize:function(t){var n,r,i,s,o=e(this).data("ui-resizable"),u=o.options,a=o.containerOffset,f=o.position,l=o._aspectRatio||t.shiftKey,c={top:0,left:0},h=o.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(c=a),f.left<(o._helper?a.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-c.left),l&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=u.helper?a.left:0),f.top<(o._helper?a.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top),l&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?a.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,n=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),r=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-a.top)+o.sizeDiff.height),i=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),i&&s&&(n-=o.parentData.left),n+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-n,l&&(o.size.height=o.size.width/o.aspectRatio)),r+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-r,l&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,f=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof n.alsoResize=="object"&&!n.alsoResize.parentNode?n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)}):r(n.alsoResize)},resize:function(t,n){var r=e(this).data("ui-resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof n.ghost=="string"?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u=typeof n.grid=="number"?[n.grid,n.grid]:n.grid,a=u[0]||1,f=u[1]||1,l=Math.round((r.width-i.width)/a)*a,c=Math.round((r.height-i.height)/f)*f,h=i.width+l,p=i.height+c,d=n.maxWidth&&n.maxWidth<h,v=n.maxHeight&&n.maxHeight<p,m=n.minWidth&&n.minWidth>h,g=n.minHeight&&n.minHeight>p;n.grid=u,m&&(h+=a),g&&(p+=f),d&&(h-=a),v&&(p-=f),/^(se|s|e)$/.test(o)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.top=s.top-c):/^(sw)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.left=s.left-l):(t.size.width=h,t.size.height=p,t.position.top=s.top-c,t.position.left=s.left-l)}})}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,r=this.options;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,i=e.data(this,"selectable-item");if(i)return r=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),i.unselecting=!r,i.selecting=r,i.selected=r,r?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1})},_mouseDrag:function(t){this.dragged=!0;if(this.options.disabled)return;var n,r=this,i=this.options,s=this.opos[0],o=this.opos[1],u=t.pageX,a=t.pageY;return s>u&&(n=u,u=s,s=n),o>a&&(n=a,a=o,o=n),this.helper.css({left:s,top:o,width:u-s,height:a-o}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),f=!1;if(!n||n.element===r.element[0])return;i.tolerance==="touch"?f=!(n.left>u||n.right<s||n.top>a||n.bottom<o):i.tolerance==="fit"&&(f=n.left>s&&n.right<u&&n.top>o&&n.bottom<a),f?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,r._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),r._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&!t.metaKey&&!t.ctrlKey&&!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,r._trigger("unselecting",t,{unselecting:n.element})))}),!1},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&e<t+n}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=null,i=!1,s=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type==="static")return!1;this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,s.widgetName+"-item")===s)return r=e(this),!1}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)});if(!i)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i,s=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",s.cursor)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";for(n=this.items.length-1;n>=0;n--){r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r);if(!s)continue;if(r.instance!==this.currentContainer)continue;if(i!==this.currentItem[0]&&this.placeholder[s===1?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&(this.options.type==="semi-dynamic"?!e.contains(this.element[0],i):!0)){this.direction=s===1?"down":"up";if(this.options.tolerance!=="pointer"&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper==="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&r+f<a&&t+l>s&&t+l<o;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t=this.options.axis==="x"||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),r=this.options.axis==="y"||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=t&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o==="right"||s==="down"?2:1:s&&(s==="down"?2:1):!1},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s==="right"&&r||s==="left"&&!r:i&&(i==="down"&&t||i==="up"&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--){i=e(a[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s])}u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(n=u.length-1;n>=0;n--)u[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--){i=e(h[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s))}for(n=c.length-1;n>=0;n--){o=c[n][1],u=c[n][0];for(r=0,f=u.length;r<f;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--){r=this.items[n];if(r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0])continue;i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;if(!r.placeholder||r.placeholder.constructor===String)n=r.placeholder,r.placeholder={element:function(){var r=e(document.createElement(t.currentItem[0].nodeName)).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return n||(r.style.visibility="hidden"),r},update:function(e,i){if(n&&!r.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}};t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,i,s,o,u,a,f,l,c=null,h=null;for(n=this.containers.length-1;n>=0;n--){if(e.contains(this.currentItem[0],this.containers[n].element[0]))continue;if(this._intersectsWith(this.containers[n].containerCache)){if(c&&e.contains(this.containers[n].element[0],c.element[0]))continue;c=this.containers[n],h=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0)}if(!c)return;if(this.containers.length===1)this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1;else{i=1e4,s=null,o=this.containers[h].floating?"left":"top",u=this.containers[h].floating?"width":"height",a=this.positionAbs[o]+this.offset.click[o];for(r=this.items.length-1;r>=0;r--){if(!e.contains(this.containers[h].element[0],this.items[r].item[0]))continue;if(this.items[r].item[0]===this.currentItem[0])continue;f=this.items[r].item.offset()[o],l=!1,Math.abs(f-a)>Math.abs(f+this.items[r][u]-a)&&(l=!0,f+=this.items[r][u]),Math.abs(f-a)<i&&(i=Math.abs(f-a),s=this.items[r],this.direction=l?"up":"down")}if(!s&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[h],s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[h].element,!0),this._trigger("change",t,this._uiHash()),this.containers[h]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper==="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!=="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);if(i.containment==="document"||i.containment==="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r=e(t).css("overflow")!=="hidden",this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return this.cssPosition==="relative"&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(t,n){this.reverting=!1;var r,i=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)if(this._storedCSS[r]==="auto"||this._storedCSS[r]==="static")this._storedCSS[r]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!n&&i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(r=this.containers.length-1;r>=0;r--)n||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!n){for(r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),jQuery.effects||function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function n(e,t,n){var r=l[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function r(t){var n=a(),r=n._rgba=[];return t=t.toLowerCase(),d(u,function(e,i){var s,o=i.re.exec(t),u=o&&i.parse(o),a=i.space||"rgba";if(u)return s=n[a](u),n[f[a].cache]=s[f[a].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,p.transparent),n):p[t]}function i(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",o=/^([\-+])=\s*(\d+\.?\d*)/,u=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],a=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},f={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=a.support={},h=e("<p>")[0],p,d=e.each;h.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=h.style.backgroundColor.indexOf("rgba")>-1,d(f,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),a.fn=e.extend(a.prototype,{parse:function(i,s,o,u){if(i===t)return this._rgba=[null,null,null,null],this;if(i.jquery||i.nodeType)i=e(i).css(s),s=t;var l=this,c=e.type(i),h=this._rgba=[];s!==t&&(i=[i,s,o,u],c="array");if(c==="string")return this.parse(r(i)||p._default);if(c==="array")return d(f.rgba.props,function(e,t){h[t.idx]=n(i[t.idx],t)}),this;if(c==="object")return i instanceof a?d(f,function(e,t){i[t.cache]&&(l[t.cache]=i[t.cache].slice())}):d(f,function(t,r){var s=r.cache;d(r.props,function(e,t){if(!l[s]&&r.to){if(e==="alpha"||i[e]==null)return;l[s]=r.to(l._rgba)}l[s][t.idx]=n(i[e],t,!0)}),l[s]&&e.inArray(null,l[s].slice(0,3))<0&&(l[s][3]=1,r.from&&(l._rgba=r.from(l[s])))}),this},is:function(e){var t=a(e),n=!0,r=this;return d(f,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],d(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return d(f,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=a(e),i=r._space(),s=f[i],o=this.alpha()===0?a("transparent"):this,u=o[s.cache]||s.to(o._rgba),c=u.slice();return r=r[s.cache],d(s.props,function(e,i){var s=i.idx,o=u[s],a=r[s],f=l[i.type]||{};if(a===null)return;o===null?c[s]=a:(f.mod&&(a-o>f.mod/2?o+=f.mod:o-a>f.mod/2&&(o-=f.mod)),c[s]=n((a-o)*t+o,i))}),this[i](c)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=a(t)._rgba;return a(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),a.fn.parse.prototype=a.fn,f.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},f.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=r<=.5?r*(1+n):r+n-r*n,u=2*r-o;return[Math.round(i(u,o,t+1/3)*255),Math.round(i(u,o,t)*255),Math.round(i(u,o,t-1/3)*255),s]},d(f,function(r,i){var s=i.props,u=i.cache,f=i.to,l=i.from;a.fn[r]=function(r){f&&!this[u]&&(this[u]=f(this._rgba));if(r===t)return this[u].slice();var i,o=e.type(r),c=o==="array"||o==="object"?r:arguments,h=this[u].slice();return d(s,function(e,t){var r=c[o==="object"?e:t.idx];r==null&&(r=h[t.idx]),h[t.idx]=n(r,t)}),l?(i=a(l(h)),i[u]=h,i):a(h)},d(s,function(t,n){if(a.fn[t])return;a.fn[t]=function(i){var s=e.type(i),u=t==="alpha"?this._hsla?"hsla":"rgba":r,a=this[u](),f=a[n.idx],l;return s==="undefined"?f:(s==="function"&&(i=i.call(this,f),s=e.type(i)),i==null&&n.empty?this:(s==="string"&&(l=o.exec(i),l&&(i=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[n.idx]=i,this[u](a)))}})}),a.hook=function(t){var n=t.split(" ");d(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,u="";if(i!=="transparent"&&(e.type(i)!=="string"||(s=r(i)))){i=a(s||i);if(!c.rgba&&i._rgba[3]!==1){o=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&o&&o.style)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}i=i.blend(u&&u!=="transparent"?u:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=a(t.elem,n),t.end=a(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},a.hook(s),e.cssHooks.borderColor={expand:function(e){var t={};return d(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},p=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]]){r=i.length;while(r--)n=i[r],typeof i[n]=="string"&&(s[e.camelCase(n)]=i[n])}else for(n in i)typeof i[n]=="string"&&(s[n]=i[n]);return s}function r(t,n){var r={},i,o;for(i in n)o=n[i],t[i]!==o&&!s[i]&&(e.fx.step[i]||!isNaN(parseFloat(o)))&&(r[i]=o);return r}var i=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,s,o,u){var a=e.speed(s,o,u);return this.queue(function(){var s=e(this),o=s.attr("class")||"",u,f=a.children?s.find("*").addBack():s;f=f.map(function(){var t=e(this);return{el:t,start:n(this)}}),u=function(){e.each(i,function(e,n){t[n]&&s[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=n(this.el[0]),this.diff=r(this.start,this.end),this}),s.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(s[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function r(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function i(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]}e.extend(e.effects,{version:"1.10.0",save:function(e,t){for(var r=0;r<t.length;r++)t[r]!==null&&e.data(n+t[r],e[0].style[t[r]])},restore:function(e,r){var i,s;for(s=0;s<r.length;s++)r[s]!==null&&(i=e.data(n+r[s]),i===t&&(i=""),e.css(r[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function t(t){function r(){e.isFunction(s)&&s.call(i[0]),e.isFunction(t)&&t()}var i=e(this),s=n.complete,u=n.mode;(i.is(":hidden")?u==="hide":u==="show")?r():o.call(i[0],n,r)}var n=r.apply(this,arguments),i=n.mode,s=n.queue,o=e.effects.effect[n.effect];return e.fx.off||!o?i?this[i](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):s===!1?this.each(t):this.queue(s||"fx",t)},_show:e.fn.show,show:function(e){if(i(e))return this._show.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(i(e))return this._hide.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(i(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery),function(e,t){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),!t.collapsible&&(t.active===!1||t.active==null)&&(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&e.css("height","")},_setOption:function(e,t){if(e==="active"){this._activate(t);return}e==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),e==="collapsible"&&!t&&this.options.active===!1&&this._activate(0),e==="icons"&&(this._destroyIcons(),t&&this._createIcons()),e==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels();if(t.active===!1&&t.collapsible===!0||!this.headers.length)t.active=!1,this.active=e();t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,r=this.options,i=r.heightStyle,s=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var n=e(this),r=n.attr("id"),i=n.next(),s=i.attr("id");r||(r=o+"-header-"+t,n.attr("id",r)),s||(s=o+"-panel-"+t,i.attr("id",s)),n.attr("aria-controls",s),i.attr("aria-labelledby",r)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(r.event),i==="fill"?(t=s.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");if(r==="absolute"||r==="fixed")return;t-=n.outerHeight(!0)}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):i==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];if(n===this.active[0])return;n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1)return;n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active"))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};typeof h=="number"&&(u=h),typeof h=="string"&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration;if(!t.length)return e.animate(i,u,o,p);if(!e.length)return t.animate(r,u,o,p);s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),n.prop!=="height"?f+=n.now:a.options.heightStyle!=="content"&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{version:"1.10.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly")){t=!0,r=!0,n=!0;return}t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t){t=!1,r.preventDefault();return}if(n)return;var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}},input:function(e){if(r){r=!1,e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this._appendTo()).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target!==t.element[0]&&r.target!==n&&!e.contains(n,r.target)&&t.close()})})},menufocus:function(t,n){if(this.isNewMenu){this.isNewMenu=!1;if(t.originalEvent&&/^mouse/.test(t.originalEvent.type)){this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});return}}var r=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),e==="source"&&this._initSource(),e==="appendTo"&&this.menu.element.appendTo(this._appendTo()),e==="disabled"&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):typeof this.options.source=="string"?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){e=e!=null?e:this._value(),this.term=this._value();if(e.length<this.options.minLength)return this.close(t);if(this._trigger("search",t)===!1)return;return this._search(e)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){t===n&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return typeof t=="string"?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){this._value(this.term),this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(e,t),t.preventDefault()}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch)return;e&&e.length?t=this.options.messages.results(e.length):t=this.options.messages.noResults,this.liveRegion.text(t)}})}(jQuery),function(e,t){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(n=n.replace(/'/g,"\\'"),r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.10.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a=this.type==="checkbox"||this.type==="radio",c=a?"":"ui-state-active",h="ui-state-focus";u.label===null&&(u.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(u.disabled)return;this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(u.disabled)return;e(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change"+this.eventNamespace,function(){if(s)return;t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){if(u.disabled)return;s=!1,r=e.pageX,i=e.pageY}).bind("mouseup"+this.eventNamespace,function(e){if(u.disabled)return;if(r!==e.pageX||i!==e.pageY)s=!0})),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null})}).bind("mouseup"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(u.disabled)return!1;(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if(e==="disabled"){t?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){e==="disabled"&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(u.inline?t.parent()[0]:u.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))})}function i(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.0"}});var s="datepicker",o=(new Date).getTime(),u;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return i(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var i=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]);if(r.hasClass(this.markerClassName))return;this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,s,n),n.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);if(r.hasClass(this.markerClassName))return;r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,s,n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block")},_dialogDatepicker:function(t,n,r,o,u){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],s,p)),i(p.settings,o||{}),n=n&&n.constructor===Date?this._formatDate(p,n):n,this._dialogInput.val(n),this._pos=u?u.length?u:[u.pageX,u.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],s,p),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,s);if(!r.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase(),e.removeData(t,s),n==="input"?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(n==="div"||n==="span")&&r.removeClass(this.markerClassName).empty()},_enableDatepicker:function(t){var n,r,i=e(t),o=e.data(t,s);if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var n,r,i=e(t),o=e.data(t,s);if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,s)}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,s){var o,u,a,f,l=this._getInst(n);if(arguments.length===2&&typeof r=="string")return r==="defaults"?e.extend({},e.datepicker._defaults):l?r==="all"?e.extend({},l.settings):this._get(l,r):null;o=r||{},typeof r=="string"&&(o={},o[r]=s),l&&(this._curInst===l&&this._hideDatepicker(),u=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),i(l.settings,o),a!==null&&o.dateFormat!==t&&o.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),f!==null&&o.dateFormat!==t&&o.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in o&&(o.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,u),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,s,o,u,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),s=r?r.apply(t,[t,n]):{};if(s===!1)return;i(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|=e(this).css("position")==="fixed",!o}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),n.input.is(":visible")&&!n.input.is(":disabled")&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,u=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,r=this._getNumberOfMonths(t),i=r[1],s=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),t.dpDiv[(r[0]!==1||r[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&t.input[0]!==document.activeElement&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,o,u=this._curInst;if(!u||t&&u!==e.data(t,s))return;this._datepickerShowing&&(n=this._get(u,"showAnim"),r=this._get(u,"duration"),i=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[n]||e.effects[n])?u.dpDiv.hide(n,e.datepicker._get(u,"showOptions"),r,i):u.dpDiv[n==="slideDown"?"slideUp":n==="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,o=this._get(u,"onClose"),o&&o.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){window["DP_jQuery_"+o].datepicker._adjustDate(r,-n,"M")},next:function(){window["DP_jQuery_"+o].datepicker._adjustDate(r,+n,"M")},hide:function(){window["DP_jQuery_"+o].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+o].datepicker._gotoToday(r)},selectDay:function(){return window["DP_jQuery_"+o].datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+o].datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+o].datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2]+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10)+r,u=parseInt(n[1],10)+r),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.0",window["DP_jQuery_"+o]=e}(jQuery),function(e,t){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},r={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.0",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n=this;if(!this._isOpen||this._trigger("beforeClose",t)===!1)return;this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||e(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var n=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return n&&!t&&this._trigger("focus",e),n},open:function(){if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show),this._focusTabbable(),this._isOpen=!0,this._trigger("open"),this._trigger("focus")},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE){t.preventDefault(),this.close(t);return}if(t.keyCode!==e.ui.keyCode.TAB)return;var n=this.uiDialog.find(":tabbable"),r=n.filter(":first"),i=n.filter(":last");t.target!==i[0]&&t.target!==this.uiDialog[0]||!!t.shiftKey?(t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey&&(i.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty();if(e.isEmptyObject(n)){this.uiDialog.removeClass("ui-dialog-buttons");return}e.each(n,function(n,r){var i,s;r=e.isFunction(r)?{click:r,text:n}:r,r=e.extend({type:"button"},r),i=r.click,r.click=function(){i.apply(t.element[0],arguments)},s={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,r=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,i){e(this).addClass("ui-dialog-dragging"),n._trigger("dragStart",r,t(i))},drag:function(e,r){n._trigger("drag",e,t(r))},stop:function(i,s){r.position=[s.position.left-n.document.scrollLeft(),s.position.top-n.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),n._trigger("dragStop",i,t(s))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var n=this,r=this.options,i=r.resizable,s=this.uiDialog.css("position"),o=typeof i=="string"?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:o,start:function(r,i){e(this).addClass("ui-dialog-resizing"),n._trigger("resizeStart",r,t(i))},resize:function(e,r){n._trigger("resize",e,t(r))},stop:function(i,s){r.height=e(this).height(),r.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),n._trigger("resizeStop",i,t(s))}}).css("position",s)},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in n&&(s=!0),e in r&&(o[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var n,r,i=this.uiDialog;e==="dialogClass"&&i.removeClass(this.options.dialogClass).addClass(t);if(e==="disabled")return;this._super(e,t),e==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),e==="buttons"&&this._createButtons(),e==="closeText"&&this.uiDialogTitlebarClose.button({label:""+t}),e==="draggable"&&(n=i.is(":data(ui-draggable)"),n&&!t&&i.draggable("destroy"),!n&&t&&this._makeDraggable()),e==="position"&&this._position(),e==="resizable"&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&typeof t=="string"&&i.resizable("option","handles",t),!r&&t!==!1&&this._makeResizable()),e==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))},_size:function(){var e,t,n,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),n=typeof r.maxHeight=="number"?Math.max(0,r.maxHeight-e):"none",r.height==="auto"?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_createOverlay:function(){if(!this.options.modal)return;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this._on(this.document,{focusin:function(t){e(t.target).closest(".ui-dialog").length||(t.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data("ui-dialog")._focusTabbable())}})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this.document[0].body),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++},_destroyOverlay:function(){if(!this.options.modal)return;e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this._off(this.document,"focusin"),this.overlay.remove()}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t=this.options.position,n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()}})}(jQuery),function(e,t){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d=u==="show",v,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function r(){p.push(this),p.length===s*o&&i()}function i(){u.css({visibility:"visible"}),e(p).remove(),f||u.hide(),n()}var s=t.pieces?Math.round(Math.sqrt(t.pieces)):3,o=s,u=e(this),a=e.effects.setMode(u,t.mode||"hide"),f=a==="show",l=u.show().css("visibility","hidden").offset(),c=Math.ceil(u.outerWidth()/o),h=Math.ceil(u.outerHeight()/s),p=[],d,v,m,g,y,b;for(d=0;d<s;d++){g=l.top+d*h,b=d-(s-1)/2;for(v=0;v<o;v++)m=l.left+v*c,y=v-(o-1)/2,u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-v*c,top:-d*h}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:c,height:h,left:m+(f?y*c:0),top:g+(f?b*h:0),opacity:f?0:1}).animate({left:m+(f?0:y*c),top:g+(f?0:b*h),opacity:f?1:0},t.duration||500,t.easing,r)}}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||p!=="effect",v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};p==="show"&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},t.mode==="toggle"&&p==="show"?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||(p==="show"?b:r),o.to=t.to||(p==="hide"?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}};if(v==="box"||v==="both")s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to));(v==="content"||v==="both")&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from);if(v==="content"||v==="both")c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})});o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o.to.opacity===0&&o.css("opacity",o.from.opacity),p==="hide"&&o.hide(),e.effects.restore(o,y),d||(g==="static"?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return n==="auto"?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery),function(e,t){e.widget("ui.menu",{version:"1.10.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),n.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var r,i,s,o,u,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",s=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),s===i?o=!0:s=i+s,u=new RegExp("^"+n(s),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(e(this).children("a").text())}),r=o&&r.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):r,r.length||(s=String.fromCharCode(t.keyCode),u=new RegExp("^"+n(s),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(e(this).children("a").text())})),r.length?(this.focus(t,r),r.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-—–\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){e==="icons"&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,r;this.blur(e,e&&e.type==="focus"),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&e.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),i<0?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer);if(!this.active)return;this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active})},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true")return;this.timer=this._delay(function(){this._close(),this._open(e)},this.delay)},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(e==="first"||e==="last"?r=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):r=this.active[e+"All"](".ui-menu-item").eq(0));if(!r||!r.length||!this.active)r=this.activeMenu.children(".ui-menu-item")[t]();this.focus(n,r)},nextPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isLastItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r-i<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isFirstItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){function n(e,t,n){return[parseInt(e[0],10)*(p.test(e[0])?t/100:1),parseInt(e[1],10)*(p.test(e[1])?n/100:1)]}function r(t,n){return parseInt(e.css(t,n),10)||0}function i(t){var n=t[0];return n.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,o=Math.max,u=Math.abs,a=Math.round,f=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+%?/,h=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var n,r,i=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=i.children()[0];return e("body").append(i),n=o.offsetWidth,i.css("overflow","scroll"),r=o.offsetWidth,n===r&&(r=i[0].clientWidth),i.remove(),s=n-r},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=e.extend({},t);var s,p,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=i(b),b[0].preventDefault&&(t.at="left top"),p=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=f.test(e[0])?e.concat(["center"]):l.test(e[0])?["center"].concat(e):["center","center"]),e[0]=f.test(e[0])?e[0]:"center",e[1]=l.test(e[1])?e[1]:"center",n=c.exec(e[0]),r=c.exec(e[1]),x[this]=[n?n[0]:0,r?r[0]:0],t[this]=[h.exec(e[0])[0],h.exec(e[1])[0]]}),S.length===1&&(S[1]=S[0]),t.at[0]==="right"?g.left+=p:t.at[0]==="center"&&(g.left+=p/2),t.at[1]==="bottom"?g.top+=v:t.at[1]==="center"&&(g.top+=v/2),s=n(x.at,p,v),g.left+=s[0],g.top+=s[1],this.each(function(){var i,f,l=e(this),c=l.outerWidth(),h=l.outerHeight(),d=r(this,"marginLeft"),y=r(this,"marginTop"),T=c+d+r(this,"marginRight")+E.width,N=h+y+r(this,"marginBottom")+E.height,C=e.extend({},g),k=n(x.my,l.outerWidth(),l.outerHeight());t.my[0]==="right"?C.left-=c:t.my[0]==="center"&&(C.left-=c/2),t.my[1]==="bottom"?C.top-=h:t.my[1]==="center"&&(C.top-=h/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=a(C.left),C.top=a(C.top)),i={marginLeft:d,marginTop:y},e.each(["left","top"],function(n,r){e.ui.position[S[n]]&&e.ui.position[S[n]][r](C,{targetWidth:p,targetHeight:v,elemWidth:c,elemHeight:h,collisionPosition:i,collisionWidth:T,collisionHeight:N,offset:[s[0]+k[0],s[1]+k[1]],my:t.my,at:t.at,within:w,elem:l})}),t.using&&(f=function(e){var n=m.left-C.left,r=n+p-c,i=m.top-C.top,s=i+v-h,a={target:{element:b,left:m.left,top:m.top,width:p,height:v},element:{element:l,left:C.left,top:C.top,width:c,height:h},horizontal:r<0?"left":n>0?"right":"center",vertical:s<0?"top":i>0?"bottom":"middle"};p<c&&u(n+r)<p&&(a.horizontal="center"),v<h&&u(i+s)<v&&(a.vertical="middle"),o(u(n),u(r))>o(u(i),u(s))?a.important="horizontal":a.important="vertical",t.using.call(this,e,a)}),l.offset(e.extend(C,{using:f}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,r=n.isWindow?n.scrollLeft:n.offset.left,i=n.width,s=e.left-t.collisionPosition.marginLeft,u=r-s,a=s+t.collisionWidth-i-r,f;t.collisionWidth>i?u>0&&a<=0?(f=e.left+u+t.collisionWidth-i-r,e.left+=u-f):a>0&&u<=0?e.left=r:u>a?e.left=r+i-t.collisionWidth:e.left=r:u>0?e.left+=u:a>0?e.left-=a:e.left=o(e.left-s,e.left)},top:function(e,t){var n=t.within,r=n.isWindow?n.scrollTop:n.offset.top,i=t.within.height,s=e.top-t.collisionPosition.marginTop,u=r-s,a=s+t.collisionHeight-i-r,f;t.collisionHeight>i?u>0&&a<=0?(f=e.top+u+t.collisionHeight-i-r,e.top+=u-f):a>0&&u<=0?e.top=r:u>a?e.top=r+i-t.collisionHeight:e.top=r:u>0?e.top+=u:a>0?e.top-=a:e.top=o(e.top-s,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,i=n.width,s=n.isWindow?n.scrollLeft:n.offset.left,o=e.left-t.collisionPosition.marginLeft,a=o-s,f=o+t.collisionWidth-i-s,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-i-r;if(p<0||p<u(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-s;if(d>0||u(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,i=n.height,s=n.isWindow?n.scrollTop:n.offset.top,o=e.top-t.collisionPosition.marginTop,a=o-s,f=o+t.collisionHeight-i-s,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-i-r,e.top+c+h+p>a&&(v<0||v<u(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-s,e.top+c+h+p>f&&(d>0||u(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.0",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){if(e===t)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,typeof e!="number"&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){e==="max"&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(n.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this.range=e([]),r.range&&(r.range===!0&&(r.values?r.values.length&&r.values.length!==2?r.values=[r.values[0],r.values[0]]:e.isArray(r.values)&&(r.values=r.values.slice(0)):r.values=[this._valueMin(),this._valueMin()]),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(r.range==="min"||r.range==="max"?" ui-slider-range-"+r.range:""))),n=r.values&&r.values.length||1;for(t=i.length;t<n;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){r.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){r.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._setOption("disabled",r.disabled),this._on(this.handles,this._handleEvents),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));if(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))i=n,s=e(this),o=t}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0)):this.handles.prop("disabled",!1);break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.10.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);i!==undefined&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){if(!t)return;if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()},"mousedown .ui-spinner-button":function(t){function n(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r}))}var r;r=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)});if(this._start(t)===!1)return;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(!e(t.currentTarget).hasClass("ui-state-active"))return;if(this._start(t)===!1)return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(e.height()*.5)&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return!this.spinning&&this._trigger("start",e)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:n})!==!1)this._value(n),this.counter++},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return this.options.min!==null&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return n===-1?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=r.min!==null?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),r.max!==null&&e>r.max?r.max:r.min!==null&&e<r.min?r.min:e},_stop:function(e){if(!this.spinning)return;clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e)},_setOption:function(e,t){if(e==="culture"||e==="numberFormat"){var n=this._parse(this.element.val());this.options[e]=t,this.element.val(this._format(n));return}(e==="max"||e==="min"||e==="step")&&typeof t=="string"&&(t=this._parse(t)),e==="icons"&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),e==="disabled"&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return typeof e=="string"&&e!==""&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),e===""||isNaN(e)?null:e},_format:function(e){return e===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;e!==""&&(n=this._parse(e),n!==null&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function n(){return++i}function r(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(s,""))===decodeURIComponent(location.href.replace(s,""))}var i=0,s=/#.*$/;e.widget("ui.tabs",{version:"1.10.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(n.active):this.active=e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,r=location.hash.substring(1);if(t===null){r&&this.tabs.each(function(n,i){if(e(i).attr("aria-controls")===r)return t=n,!1}),t===null&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active")));if(t===null||t===-1)t=this.tabs.length?0:!1}return t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),t===-1&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(this._handlePageNav(t))return;switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:t.preventDefault(),clearTimeout(this.activating),this._activate(r);return;case e.ui.keyCode.ENTER:t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r);return;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))},_panelKeydown:function(t){if(this._handlePageNav(t))return;t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(t,n){function r(){return t>i&&(t=0),t<0&&(t=i),t}var i=this.tabs.length-1;while(e.inArray(r(),this.options.disabled)!==-1)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="disabled"){this._setupDisabled(t);return}this._super(e,t),e==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),e==="event"&&this._setupEvents(t),e==="heightStyle"&&this._setupHeightStyle(t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+n()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active===!1||!this.anchors.length?(t.active=!1,this.active=e()):this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,i){var s,o,u,a=e(i).uniqueId().attr("id"),f=e(i).closest("li"),l=f.attr("aria-controls");r(i)?(s=i.hash,o=t.element.find(t._sanitizeSelector(s))):(u=t._tabId(f),s="#"+u,o=t.element.find(s),o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),l&&f.data("ui-tabs-aria-controls",l),f.attr({"aria-controls":s.substring(1),"aria-labelledby":a}),o.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n=0,r;r=this.tabs[n];n++)t===!0||e.inArray(n,t)!==-1?e(r).addClass("ui-state-disabled").attr("aria-disabled","true"):e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r=this.element.parent();t==="fill"?(n=r.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if(r==="absolute"||r==="fixed")return;n-=t.outerHeight(!0)}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):t==="auto"&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault();if(s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1)return;n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),!f.length&&!a.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l)},_toggle:function(t,n){function r(){s.running=!1,s._trigger("activate",t,n)}function i(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,r):(o.show(),r())}var s=this,o=n.newPanel,u=n.oldPanel;this.running=!0,u.length&&this.options.hide?this._hide(u,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u.hide(),i()),u.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),o.length&&u.length?n.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);if(r[0]===this.active[0])return;r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return typeof e=="string"&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(n){var r=this.options.disabled;if(r===!1)return;n===t?r=!1:(n=this._getIndex(n),e.isArray(r)?r=e.map(r,function(e){return e!==n?e:null}):r=e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(r)},disable:function(n){var r=this.options.disabled;if(r===!0)return;if(n===t)r=!0;else{n=this._getIndex(n);if(e.inArray(n,r)!==-1)return;e.isArray(r)?r=e.merge([n],r).sort():r=[n]}this._setupDisabled(r)},load:function(t,n){t=this._getIndex(t);var i=this,s=this.tabs.eq(t),o=s.find(".ui-tabs-anchor"),u=this._getPanelForTab(s),a={tab:s,panel:u};if(r(o[0]))return;this.xhr=e.ajax(this._ajaxSettings(o,n,a)),this.xhr&&this.xhr.statusText!=="canceled"&&(s.addClass("ui-tabs-loading"),u.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){u.html(e),i._trigger("load",n,a)},1)}).complete(function(e,t){setTimeout(function(){t==="abort"&&i.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),u.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr},1)}))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}})}(jQuery),function(e){function t(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))}function n(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);i!==-1&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var r=0;e.widget("ui.tooltip",{version:"1.10.0",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var r=this;if(t==="disabled"){this[n?"_disable":"_enable"](),this.options[t]=n;return}this._super(t,n),t==="content"&&e.each(this.tooltips,function(e,t){r._updateContent(t)})},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,r=e(t?t.target:this.element).closest(this.options.items);if(!r.length||r.data("ui-tooltip-id"))return;r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&t.type==="mouseover"&&r.parents().each(function(){var t=e(this),r;t.data("ui-tooltip-open")&&(r=e.Event("blur"),r.target=r.currentTarget=this,n.close(r,!0)),t.attr("title")&&(t.uniqueId(),n.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(r,t)},_updateContent:function(e,t){var n,r=this.options.content,i=this,s=t?t.type:null;if(typeof r=="string")return this._open(t,e,r);n=r.call(e[0],function(n){if(!e.data("ui-tooltip-open"))return;i._delay(function(){t&&(t.type=s),this._open(t,e,n)})}),n&&this._open(t,e,n)},_open:function(n,r,i){function s(e){f.of=e;if(o.is(":hidden"))return;o.position(f)}var o,u,a,f=e.extend({},this.options.position);if(!i)return;o=this._find(r);if(o.length){o.find(".ui-tooltip-content").html(i);return}r.is("[title]")&&(n&&n.type==="mouseover"?r.attr("title",""):r.removeAttr("title")),o=this._tooltip(r),t(r,o.attr("id")),o.find(".ui-tooltip-content").html(i),this.options.track&&n&&/^mouse/.test(n.type)?(this._on(this.document,{mousemove:s}),s(n)):o.position(e.extend({of:r},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval(function(){o.is(":visible")&&(s(f.of),clearInterval(a))},e.fx.interval)),this._trigger("open",n,{tooltip:o}),u={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=r[0],this.close(n,!0)}},remove:function(){this._removeTooltip(o)}};if(!n||n.type==="mouseover")u.mouseleave="close";if(!n||n.type==="focusin")u.focusout="close";this._on(!0,r,u)},close:function(t){var r=this,i=e(t?t.currentTarget:this.element),s=this._find(i);if(this.closing)return;clearInterval(this.delayedShow),i.data("ui-tooltip-title")&&i.attr("title",i.data("ui-tooltip-title")),n(i),s.stop(!0),this._hide(s,this.options.hide,function(){r._removeTooltip(e(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),t&&t.type==="mouseleave"&&e.each(this.parents,function(t,n){e(n.element).attr("title",n.title),delete r.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:s}),this.closing=!1},_tooltip:function(t){var n="ui-tooltip-"+r++,i=e("<div>").attr({id:n,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[n]=t,i},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery),define("jqueryui",["jquery"],function(){}),define("lists/model/list",["global/main"],function(){var iListModel=Backbone.Model.extend({defaults:{},options:{},initialize:function(){if(!this.id){var e=this.get("iType")?this.get("iType"):this.get("type");this.set("id",e+"_"+this.cid+(new Date).getTime())}this.get("isRoot")&&(this.unset("isRoot"),this.isRoot=!0),this.setoptions(),this.setcollection(),this.setview()},setcollection:function(e){var t=$.extend({},this.options);this.collectionstructure=iListCollection.extend({options:t}),this.icollection=new this.collectionstructure},setoptions:function(e){this.options=$.extend({},this.options),this.isRoot&&(this.options.level=0),this.options.id=this.id,this.updateurl=this.options.saveurl},setview:function(){var e=$.extend({},this.options.events);this.viewstructure=iListView.extend({events:e}),this.iview=new this.viewstructure({model:this})},url:"",deleteurl:"",sync:function(e,t,n){switch(e){case"create":n.url=this.createurl;break;case"update":n.url=typeof this.updateurl=="function"?this.updateurl():this.updateurl;break;case"read":n.url=this.readurl;break;case"delete":n.url=this.deleteurl}if(!n.url)return;Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}}),iListCollection=Backbone.Collection.extend({options:{},model:function(e,t){return new t.collection.modelstructure(e,t)},initialize:function(){this.setonadd(),this.setonremove(),this.setonreset();var e=$.extend({},this.options);e.level+=1,this.modelstructure=iListModel.extend({defaults:e.defaults,options:e})},gridadd:function(e){var t=this,n=t.options;if(e.isRoot)return;if(!n.container)return;var r=n.container,i=n.wrap,s=e.attributes;template=n.template;var o="";typeof template=="function"?o=template(s):typeof template=="string"&&(o=_.template(template,s));var u=$(n.el);if(i){if(!(u.children(i).length>0)){var a=document.createElement(i);u.append(a)}u.children(i).append(o)}else u.append(o);n.type=="custom"&&u.find('[id="'+e.id+'"]').length==0?e.iview.setElement(u):e.iview.setElement(u.find('[id="'+e.id+'"]')),e.iview.addClassName(),e.iview.addInlineEditor()},treeadd:function(e){var t=this,n=t.options;if(e.isRoot)return;if(!n.container)return;var r=n.container,i=n.wrap;template=n.template;var s=e.attributes,o="";typeof template=="function"?o=template(s):typeof template=="string"&&(o=_.template(template,s));if(n.level!=0)var u=$(n.el).find('[id="'+n.id+'"]');else var u=$(n.el);if(i){if(!(u.children(i).length>0)){var a=document.createElement(i);u.append(a)}u.children(i).append(o)}else u.append(o);e.iview.setElement(u.find('[id="'+e.id+'"]')),e.iview.addClassName(),e.iview.addInlineEditor()},setonreset:function(){var e=this;this.on("reset",function(t){e.options.el&&e.options.reset&&$(e.options.el).empty()})},setoffadd:function(){this.off("add")},setonadd:function(){var e=this;this.on("add",function(t){(e.options.type=="grid"||e.options.type=="custom")&&e.gridadd(t),e.options.type=="tree"&&e.treeadd(t)})},setonremove:function(){var e=this;this.on("remove",function(t){$(e.options.el).find('[id="'+t.id+'"]').addClass("updating"),$(e.options.el).find('[id="'+t.id+'"]').fadeOut(1e3,function(){$(e.options.el).find('[id="'+t.id+'"]').remove()}),e.options.rightpanel&&$(".ui-layout-right").find('.mod[data-modelid="'+t.id+'"]').remove()})},url:"",sync:function(e,t,n){return}}),iListView=Backbone.View.extend({initialize:function(e){_.bindAll(this),this.model.options.bindchange&&((this.model.options.type=="grid"||this.model.options.type=="custom")&&this.model.bind("change",this.update),this.model.options.type=="tree"&&this.model.bind("change",this.update_tree))},addClassName:function(){if(!this.model.options.className)return;if(this.$el.hasClass(this.model.options.className))return;this.$el.addClass(this.model.options.className)},addInlineEditor:function(){var e=this;this.model.options.inlineEdit&&this.$el.find("[data-type=text]","[data-type=textarea]").each(function(){$(this).on("click",function(){global.text2form($(this),function(t){t&&(e.model.set(t),e.model.options.onChange&&e.model.options.onChange(e.model.id))})})})},render_model:function(e){e||(e=this.model.options.template);var t="";return typeof e=="function"?t=e(this.model.toJSON()):typeof e=="string"&&(t=_.template(e,this.model.toJSON())),t},return_tree:function(e){e||(e=this.model.options.template);var t="";typeof e=="function"?t=e(this.model.toJSON()):typeof e=="string"&&(t=_.template(e,this.model.toJSON()));var n="",r,i;n=t;if(this.model.icollection.length>0){r=i=$(n);if(this.model.wrap){var s=document.createElement(this.model.wrap);r.append(s.outerHTML),i=r.children(this.model.wrap)}this.model.icollection.each(function(t){var n=t.iview.return_tree(e);i.append(n)}),n=r[0].outerHTML}return n},update:function(){if(!this.model.isRoot){var e=$(this.model.options.container).find('[id="'+this.model.id+'"]').hasClass("active");$(this.model.options.container).find('[id="'+this.model.id+'"]').replaceWith(this.render_model()),this.setElement($(this.model.options.container).find('[id="'+this.model.id+'"]')),e&&$(this.model.options.container).find('[id="'+this.model.id+'"]').addClass("active"),this.model.options.onChange&&this.model.options.onChange(this.model.id),this.addClassName(),this.addInlineEditor(),$(this.model.options.container).find('[id="'+this.model.id+'"]').addClass("updating"),this.updateEffect()}},update_tree:function(){if(!this.model.isRoot){$hasmenu=$(this.model.options.container).find('[id="'+this.model.id+'"]').hasClass("hasmenu")?"hasmenu ":"",$hasfolder=$(this.model.options.container).find('[id="'+this.model.id+'"]').hasClass("unfold")?"unfold ":"",$active=$(this.model.options.container).find('[id="'+this.model.id+'"]').hasClass("active")?"active ":"";var e="";this.model.options.wrap&&$(this.model.options.container).find('[id="'+this.model.id+'"]').find(this.model.options.wrap).length>0&&(e=$(this.model.options.container).find('[id="'+this.model.id+'"]').children(this.model.options.wrap).detach()),$(this.model.options.container).find('[id="'+this.model.id+'"]').replaceWith(this.render_model()),this.setElement($(this.model.options.container).find('[id="'+this.model.id+'"]')),$(this.model.options.container).find('[id="'+this.model.id+'"]').append(e),$(this.model.options.container).find('[id="'+this.model.id+'"]').addClass($hasmenu+$hasfolder+$active),this.model.options.onChange&&this.model.options.onChange(this.model.id),this.addClassName(),this.addInlineEditor(),$(this.model.options.container).find('[id="'+this.model.id+'"]').addClass("updating"),this.updateEffect()}},updateEffect:function(){if(this.model.options.type=="custom"||!this.model.options.updateEffect)return;var e=$(this.model.options.container).find('[id="'+this.model.id+'"]');t2=setTimeout(function(){e.removeClass("updating")},1e3)},savemodel:function(callback){this.model.save({},{wait:!0,success:function(m,response){$(".action-save").length>0&&$(".action-save").button("reset"),returned=eval(response),lists.message("success",response.msg),callback&&callback(response)},error:function(){$(".action-save").length>0&&$(".action-save").button("reset"),lists.message("error","服务器请求未应答")}})},simpledelete:function(e){var t=this;return this.model.deleteurl=null,lists.confirmDelete(function(){t.model.destroy(),e&&e()}),!1},deletemodel:function(e){var t=this;return this.model.deleteurl=this.model.get("url")+"/deleteobject",lists.confirmDelete(function(){t.model.destroy({wait:!0,success:function(t,n){n.code==200&&global.message("success",n.msg),e&&e(n)},error:function(){lists.message("error","服务器请求未应答")}})}),!1}}),ListModelForSave=Backbone.Model.extend({initialize:function(){this.set("id","GlobalSave")},sync:function(e,t,n){var r=this.data;this.attributes=r;if(e=="create")return;e=="update"&&(n.url=this.url);if(e=="delete")return;if(e=="read")return;Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,n)}}),ModelForSaveAll=new ListModelForSave;return{model:iListModel,collection:iListCollection,view:iListView,ModelForSaveAll:ModelForSaveAll}}),define("lists/main",["global/main","jqueryui","lists/model/list"],function(){var e=require("lists/model/list");return window.lists={model2collection:function(e,t){e.has(t)&&e.icollection.add(e.get(t))},model2tree:function(e,t,n){e.has(t)&&(e.icollection.add(e.get(t)),e.icollection.each(function(e){e.has(n)&&lists.model2tree(e,n,n)}))},message:function(e,t,n){n||(n=3e3),$(".msg").html(lists.msg_template({type:e,msg:t})),$(".msg").show(),setTimeout(function(){$(".msg").fadeOut("slow")},n)},confirmDelete:function(e){$("#confirmModal").html(lists.confirm_template({msg:"确认删除？"})),global.modal.show("#confirmModal"),$("#confirmModal").find(".btn.btn-confirm").on("click",function(){global.modal.hide("#confirmModal"),e()})},confirm_template:_.template(['		  <div class="modal-header">','		    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>',"		    <h3>确认框</h3>","		  </div>",'		  <div class="modal-body"> <span style="font-size:14px;"><%=msg%></span></div>','		  <div class="modal-footer">','		    <button class="btn btn-primary btn-confirm">确定</button>','		    <button aria-hidden="true" data-dismiss="modal" style="margin-left:20px;" class="btn btn-cancel">取消</button>',"		  </div>"].join("")),msg_template:_.template(['  			<div class="status <%=type%>">',"   			 <p><%=global.dict.query(msg)%></p>",'   		<a href="#" class="close">Close</a></div>'].join("")),load:function(e,t,n){var r=$.ajax({url:e,type:"GET",data:"",dataType:"JSON",success:function(e){$(document).trigger("server_ok"),t(e,e.code)},error:function(){lists.message("error","服务器错误"),$(document).trigger("server_error")}});return r},post:function(e,t,n){$.ajax({url:e,type:"POST",data:t,dataType:"JSON",success:function(e){var t=e.code;$(document).trigger("server_ok"),n(e,e.code)},error:function(){lists.message("error","服务器请求未应答"),$(document).trigger("server_error")}})},serializeValue:function(e,t){var n={};return $(e).find('input[type="text"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;n[e]=$(this).attr("value")}),$(e).find('input[type="hidden"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;n[e]=$(this).attr("value"),n[e]=="true"&&(n[e]=!0),n[e]=="false"&&(n[e]=!1)}),$(e).find('input[type="checkbox"]').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;n[e]||(n[e]=[]),$(this).attr("checked")=="checked"?$(this).attr("data-type")=="boolean"?n[e]=!0:n[e].push($(this).val()):$(this).attr("data-type")=="boolean"?n[e]=!1:t}),$(e).find('input[type="radio"]:checked').each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;n[e]=$(this).val()}),$(e).find("select").each(function(){var e=$(this).attr("name")||$(this).attr("id"),t=Boolean($(this).attr("data-mutiple"));if(!e)return;if(!t){if($(this).val()=="null")return;n[e]=$(this).val()}else n[e]||(n[e]=[]),n[e].push($(this).val())}),$(e).find("textarea").each(function(){var e=$(this).attr("name")||$(this).attr("id");if(!e)return;n[e]=$(this).val()}),n},setscrollnano:function(e){$(e).hasClass("nanoscrollbar")?$selector=$(e):$selector=$(e).find(".nanoscrollbar"),$selector.children(".nano").length==0&&$selector.wrapInner('<div class="nano"><div class="content"></div></div>'),$selector.children(".nano").nanoScroller(),$selector.children(".nano").children(".pane").css({visibility:"hidden"}),$selector.children(".nano").hover(function(){$(this).children(".pane").css({visibility:"visible"})},function(){$(this).children(".pane").css({visibility:"hidden"})})},save:function(t,n,r){e.ModelForSaveAll.data=t,e.ModelForSaveAll.url=e.ModelForSaveAll.updateurl=n,e.ModelForSaveAll.save({},{wait:!0,success:function(e,t){$(".action-save").length>0&&$(".action-save").button("reset"),lists.message("success",t.msg),r&&r(t)},error:function(){$(".action-save").length>0&&$(".action-save").button("reset"),lists.message("error","服务器请求未应答")}})},sortable:function(e,t,n,r){var i=!1;$(e).sortable({containment:"parent",items:t,opacity:"0.5",start:function(t,n){$(document).on("keyup",function(t,n){console.log(t.keyCode),t.keyCode==27&&(i=!0,$(e).sortable("cancel"))})},sort:function(e,t){},stop:function(e,t){$(document).off("keyup")},update:function(t,s){if($(s.item).nextAll().hasClass("top")||i){$(e).sortable("cancel"),i=!1;return}if($(s.item).prevAll().length==0)var o=Number($(s.item).next().attr("data-position"))+1;else var o=$(s.item).prev().attr("data-position");o=parseInt(o);var u=$(s.item).attr("id"),a=global.model.getModelById(n,u),f=a.toJSON().url,l=parseInt(a.toJSON().position);if(!l||!o)return global.message("error","无法进行排序，缺少position参数"),!1;var c=f+"/movetoposition?position="+(l<o?o-1:o);global.json.load(c,function(t){t.code==200?(global.message("success",t.msg),r()):(global.message("error",t.msg),$(e).sortable("cancel"))})}})}},lists.listcollection=new Backbone.Collection,lists.templateslist=[],lists.list=function(e){this.defaults={initialize:{name:"list",container:".ui-layout-center-bd",template:null,templatefile:null,menu:!0,left:!0,right:!0,filter:!0,search:!0,page:!0,servertemplatefiles:null,onFinishRender:null,events:{},wait:!1,request:null},menu:{name:"menu",container:".list-menu",template:null,templatefile:null},left:{className:"tree-item",defaults:{title:""},name:"tree",container:".list-tree",type:"tree",template:null,templatefile:null,wrap:null,events:{},url:null,saveurl:null,saveallurl:null,deleteurl:null,data:null,bindchange:!0,onClick:null,onUpdate:null,onChange:null,reset:!0,rightpanel:!1,bindsort:null,updateEffect:!0,initopts:null},right:{className:"content-item",defaults:{title:""},name:"content",container:".list-content",type:"grid",template:null,templatefile:null,wrap:null,events:{},url:null,saveurl:null,saveallurl:null,deleteurl:null,data:null,bindchange:!0,onClick:null,onUpdate:null,onChange:null,reset:!0,rightpanel:!1,bindsort:null,updateEffect:!0,initopts:null},page:{name:"page",container:".list-page",template:null,templatefile:null},filter:{defaults:{title:""},name:"filter",container:".list-menu",type:"grid",template:null,templatefile:null,wrap:null,url:null,data:null,bindchange:!1,onChange:null,reset:!1,onUpdate:null,onChange:null},rightpanel:{events:null,bindchange:!0}},this.options=e;var t=$.extend({},this.defaults);this.options=$.extend(!0,{},t,typeof e=="object"&&e),this.init()},lists.list.prototype={init:function(){_.bindAll(this),this.$opt=this.options.initialize,this.options.query={},this.templates_loaded=!1,this.models_loaded=!1,this.templateslist=[]},init_templates:function(){var e=this;if(this.$opt.servertemplatefiles){typeof this.$opt.servertemplatefiles=="string"&&(this.$opt.servertemplatefiles=JSON.parse(this.$opt.servertemplatefiles));if(typeof this.$opt.servertemplatefiles!="object")return;_.each(this.$opt.servertemplatefiles,function(t){e.templateslist.push(portal_url+t)})}this.$opt.template||this.$opt.templatefile&&(this.templates_loaded?this.$opt.template=require("text!"+this.$opt.templatefile):this.templateslist.push("text!"+this.$opt.templatefile)),this.$opt.menu&&!this.options.menu.template&&this.options.menu.templatefile&&(this.templates_loaded?this.options.menu.template=require("text!"+this.options.menu.templatefile):this.templateslist.push("text!"+this.options.menu.templatefile)),this.$opt.filter&&!this.options.filter.template&&this.options.filter.templatefile&&(this.templates_loaded?this.options.filter.template=require("text!"+this.options.filter.templatefile):this.templateslist.push("text!"+this.options.filter.templatefile)),this.$opt.left&&!this.options.left.template&&this.options.left.templatefile&&(this.templates_loaded?this.options.left.template=require("text!"+this.options.left.templatefile):this.templateslist.push("text!"+this.options.left.templatefile)),this.$opt.right&&!this.options.right.template&&this.options.right.templatefile&&(this.templates_loaded?this.options.right.template=require("text!"+this.options.right.templatefile):this.templateslist.push("text!"+this.options.right.templatefile)),this.$opt.page&&!this.options.page.template&&this.options.page.templatefile&&(this.templates_loaded?this.options.page.template=require("text!"+this.options.page.templatefile):this.templateslist.push("text!"+this.options.page.templatefile));if(!this.templates_loaded&&this.templateslist.length>0){lists.templateslist=_.union(lists.templateslist,this.templateslist),this.getTemplate(this.templateslist,function(){e.templates_loaded=!0,e.init_templates()});return}this.init_models()},init_models:function(){var t=this;this.models_loaded||(this.$opt.left&&(this.options.left.el=this.$opt.container+" "+this.options.left.container,this.options.left.modelstructure=e.model.extend({options:this.options.left}),this.options.left.model=new this.options.left.modelstructure({iType:this.options.left.name,isRoot:!0})),this.$opt.right&&(this.options.right.el=this.$opt.container+" "+this.options.right.container,this.options.right.modelstructure=e.model.extend({options:this.options.right}),this.options.right.model=new this.options.right.modelstructure({iType:this.options.right.name,isRoot:!0})),this.$opt.filter&&(this.options.filter.el=this.$opt.container+" "+this.options.filter.container,this.options.filter.modelstructure=e.model.extend({options:this.options.filter}),this.options.filter.model=new this.options.filter.modelstructure({iType:this.options.filter.name,isRoot:!0})),this.$opt.menu&&(this.options.menu.el=this.$opt.container+" "+this.options.menu.container),this.$opt.page&&(this.options.page.el=this.$opt.container+" "+this.options.page.container),this.models_loaded=!0),this.render_list();if(this.$opt.events){var t=this;_.each(this.$opt.events,function(e,n){var r=n.split(" "),i=r[0],s=n.slice(r[0].length==n.length?r[0].length:r[0].length+1);Boolean(s)?$(t.$opt.container).on(i,s,e):$(t.$opt.container).on(i,e)})}},render:function(){this.init_templates()},render_list:function(){var e=this;if(this.$opt.container&&this.$opt.template){var t=typeof this.$opt.template=="string"?_.template(this.$opt.template,{}):this.$opt.template({});$(this.$opt.container).html(t)}this.$opt.search&&$(this.$opt.container).parent().find("form.search").on("submit",function(){var t=$(this).find(".search-query").val();return e.options.query.SearchableText=t,e.load_right(),!1}),this.load_left()},render_menu:function(){if(!this.$opt.menu){this.load_filter();return}var e=this,t=$(this.$opt.container).find(this.options.menu.container),n=typeof this.options.menu.template=="string"?_.template(this.options.menu.template,{}):this.options.menu.template();t.html(n),t.find('input[type="checkbox"][value="selectall"]').on("change",function(){if(!e.$opt.right)return;$rightel=$(e.$opt.container).find(e.options.right.container),$(this).attr("checked")=="checked"?$rightel.find('input[type="checkbox"]').attr("checked","checked"):$rightel.find('input[type="checkbox"]').removeAttr("checked")}),t.find('input[type="checkbox"][value="checked_children"]').on("change",function(){if(!e.$opt.right)return;$(this).attr("checked")=="checked"?e.options.right.checked_children=!0:e.options.right.checked_children=!1}),this.load_filter()},load_filter:function(){var e=this;if(!this.$opt.filter)return;var t=$(this.$opt.container).find(this.options.filter.container);this.options.filter.data?this.render_filter(this.options.filter.data):this.options.filter.url&&lists.load(this.options.filter.url,function(t){if(t.code==200){var n=t.data;e.render_filter(n)}})},render_filter:function(e){var t=this,n=$(this.$opt.container).find(this.options.filter.container);if(!this.options.filter.template)return this.options.filter.templatefile?(this.getTemplate(this.options.filter.templatefile,function(e){t.options.filter.template=e,t.render_menu()}),!1):!1;t.options.filter.model.set(e),t.options.filter.model.icollection.reset(),lists.model2collection(t.options.filter.model,"results"),n.find("select").on("change",function(){var e=lists.serializeValue(n);t.options.query.filter=e,t.load_right(),t.options.filter.onChnage&&t.options.filter.onChnage(e),t.options.filter.onChange&&t.options.filter.onChange(e)}),t.options.filter.onUpdate&&t.options.filter.onUpdate()},load_left:function(){var e=this;if(!this.$opt.left){this.load_right(),e.render_menu();return}if(this.options.left.data){var t=this.options.left.data;t.code&&(t=t.data),this.render_left(t)}else this.options.left.url&&lists.load(this.options.left.url,function(t){t.code==200&&e.render_left(t.data)})},render_left:function(e){var t=this,n=$(this.$opt.container).find(this.options.left.container);this.options.left.model.set(e),n.hasClass("list-tree")||n.addClass("list-tree"),this.options.left.type=="grid"&&lists.model2collection(this.options.left.model,"results"),this.options.left.type=="tree"&&lists.model2tree(this.options.left.model,"results","children"),n.find("li h4 a").each(function(){$(this).on("click",function(){n.find("li").removeClass("active");var e=$(this).parents("li").first().attr("id");$(this).parents("li").first().addClass("active"),t.options.left.current=e,t.options.left.model.current=e,t.options.query={},e?(t.options.query.type_categorized=e,opt="id="+t.options.query.type_categorized+"&"):(t.options.query.type_categorized=null,opt=""),t.load_right(),t.render_menu(),$(t.$opt.container).parent().find("form.search").find(".search-query").val("");if(t.options.left.rightpanel&&e){var r=global.model.getModelById(t.options.left.model,e);r&&t.render_template(r,t.options.left)}return t.options.left.onclick&&t.options.left.onClick(e),!1})}),$("body").tooltip&&n.find('[rel="tooltip"]').tooltip(),$("body").nanoScroller&&lists.setscrollnano(n.parents(".nanoscrollbar").first()),t.$opt.request&&global.getRequest(t.$opt.request)?(id=global.getRequest(t.$opt.request),n.find('li.tree-item[id="'+id+'"]').find("h4 a").first().click(),n.find('li.tree-item[id="'+id+'"]').addClass("active")):(n.find("li.tree-item").first().find("h4 a").first().click(),n.find("li.tree-item").first().addClass("active"));if(this.options.left.bindsort&&!this.options.left.sorted){this.options.left.bindsort.item||(this.options.left.bindsort.item=".tree-item");var r=this.options.left.bindsort,i=$(this.$opt.container).find(this.options.left.container);lists.sortable(i,r.item,this.options.left.model,function(){t.load_left(),r.callback&&r.callback()}),this.options.left.sorted=!0}this.options.left.onUpdate&&this.options.left.onUpdate(id),this.hasmenu_check()},load_right:function(){if(!this.$opt.right)return;this.$opt.wait&&$(this.options.right.el).jswait();var e=this,t="";e.options.query.type_categorized&&(t="id="+e.options.query.type_categorized+"&"),e.options.query.filter&&_.each(e.options.query.filter,function(e,n){t=t+n+"="+e+"&"}),e.options.query.SearchableText&&(t=t+"SearchableText="+e.options.query.SearchableText+"&"),e.options.query.page&&(t=t+"page="+e.options.query.page);if(this.options.right.data){var n=this.options.right.data;n.code&&(n=n.data),this.render_right(n)}else if(this.options.right.url){var r=this.options.right.url.indexOf("?")==-1?this.options.right.url+"?"+t:this.options.right.url+"&"+t;lists.load(r,function(t){t.code==200&&e.render_right(t.data)})}},render_right:function(e){var t=this,n=$(this.$opt.container).find(this.options.right.container);t.options.right.model.icollection.reset(),t.options.right.model.set(e),n.hasClass("list-content")||n.addClass("list-content"),this.options.right.type=="grid"&&lists.model2collection(this.options.right.model,"results"),this.options.right.type=="tree"&&lists.model2tree(this.options.right.model,"results","children"),n.find(".content-item h4,tr.content-item").live("click",function(e,n){if($(this).hasClass("content-item"))var r=$(this).attr("id");else var r=$(this).parents(".content-item").first().attr("id");t.options.right.current=r,t.options.right.model.current=r;if(t.options.right.rightpanel&&r){var i=global.model.getModelById(t.options.right.model,r);i&&t.render_template(i,t.options.right)}t.options.right.onClick&&t.options.right.onClick(r)}),this.options.right.onUpdate&&this.options.right.onUpdate(id);if(!this.$opt.left)if(t.$opt.request&&global.getRequest(t.$opt.request))id=global.getRequest(t.$opt.request),n.find('.content-item[id="'+id+'"]').first().click(),n.find('.content-item[id="'+id+'"]').addClass("active");else{var r=$(this.$opt.container).find(this.options.right.container).find("h4 a").first();typeof r!=undefined&&r.click()}$("body").tooltip&&n.find('[rel="tooltip"]').tooltip(),this.hasmenu_check(),this.render_page();if(this.options.right.bindsort&&!this.options.right.sorted){this.options.right.bindsort.item||(this.options.right.bindsort.item=".content-item");var i=this.options.right.bindsort,s=$(this.$opt.container).find(this.options.right.container);lists.sortable(s,i.item,this.options.right.model,function(){t.load_right(),i.callback&&i.callback()}),this.options.right.sorted=!0}this.$opt.onFinishRender&&this.$opt.onFinishRender(),$("body").nanoScroller&&lists.setscrollnano(n.parents(".nanoscrollbar").first()),this.$opt.wait&&$(this.options.right.el).jswait("close")},render_page:function(){if(!this.$opt.page)return;var e=this,t=this.options.page.el=$(this.$opt.container).find(this.options.page.container);this.options.page.model=this.options.right.model;var n=typeof this.options.page.template=="string"?_.template(this.options.page.template,this.options.page.model.toJSON()):this.options.page.template(this.options.page.model.toJSON());t.html(n),$(this.options.page.el).find(".first").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=1,e.load_right(),!1)}),$(this.options.page.el).find(".last").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("numpages"),e.load_right(),!1)}),$(this.options.page.el).find(".prev").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("page")-1,e.load_right(),!1)}),$(this.options.page.el).find(".next").on("click",function(){return $(this).parent().hasClass("disabled")?!1:(e.options.query.page=e.options.right.model.get("page")+1,e.load_right(),!1)}),$(this.options.page.el).find(".page").on("click",function(){return e.options.query.page=parseInt($(this).html()),e.load_right(),!1})},hasmenu_check:function(){var e=this;$(this.$opt.container).find("li.content-item,li.tree-item").each(function(){$(this).children("ul").length>0&&$(this).children("ul").children("li").length>0?($(this).addClass("hasmenu unfold"),$(this).find('input[type="checkbox"]').on("change",function(){e.options.right.checked_children&&($(this).attr("checked")=="checked"?$(this).parents("li.content-item").first().children("ul").find('input[type="checkbox"]').attr("checked","checked"):$(this).parents("li.content-item").first().children("ul").find('input[type="checkbox"]').removeAttr("checked"))})):$(this).removeClass("hasmenu")})},left_saveAll:function(e){if(!this.options.left.saveallurl)return;this.save(this.options.left.model.icollection.toJSON(),this.options.left.saveallurl,e)},right_saveAll:function(e){if(!this.options.right.saveallurl)return;this.save(this.options.right.model.icollection.toJSON(),this.options.right.saveallurl,e)},left_saveone:function(e,t){if(!e||!this.options.left.saveurl)return;this.save([this.options.left.model.icollection.get(e).toJSON()],this.options.left.saveurl,t)},right_saveone:function(e,t){if(!e||!this.options.right.saveurl)return;this.save([this.options.right.model.icollection.get(e).toJSON()],this.options.right.saveurl,t)},save:function(t,n,r){e.ModelForSaveAll.data=t,e.ModelForSaveAll.url=e.ModelForSaveAll.updateurl=n,e.ModelForSaveAll.save({},{wait:!0,success:function(e,t){$(".action-save").length>0&&$(".action-save").button("reset"),lists.message("success",t.msg),r&&r(t)},error:function(){$(".action-save").length>0&&$(".action-save").button("reset"),lists.message("error","服务器请求未应答")}})},getTemplate:function(e,t){e.length>0&&require(e,function(){t()})},render_template:function(e,t,n){var r=this,i=$(this.$opt.container).find(t.container),s=e.get("properties"),o=e.toJSON();_.each(s,function(t){global.template[t]&&(typeof global.template[t]=="function"?templatevalue=global.template[t](o):typeof global.template[t]=="string"&&(templatevalue=_.template(global.template[t],o)),$(".ui-layout-right").find('.mod[data-id="'+t+'"]').length>0?$(".ui-layout-right").find('.mod[data-id="'+t+'"]').replaceWith(templatevalue):$(".ui-layout-right").find(".nano").length>0?$(".ui-layout-right").find(".nano").children(".content").append(templatevalue):$(".ui-layout-right").append(templatevalue),t!="update"&&_.has(o[t],"readonly")&&$(".ui-layout-right").find('.mod[data-name="'+t+'"]').append('<input type="hidden" name="readonly" value="'+o[t].readonly+'">'),$(".ui-layout-right").find('.mod[data-id="'+t+'"]').hasClass("inline-edit")&&global.initInlineEdit($(".ui-layout-right").find('.mod[data-id="'+t+'"]')),$(".ui-layout-right").find('.mod[data-id="'+t+'"]').attr("data-modelid",e.id),r.setModEvent($(".ui-layout-right").find('.mod[data-id="'+t+'"]'),function(t,r){var i={};t?i[t]=r:i=r,e.set(i),n&&n(i)}))}),r.options.rightpanel.events&&r.setRightPanelEvents(e,t),$(".ui-layout-right").find(".nano").length==0&&global.setscrollnano(".ui-layout-right")},setRightPanelEvents:function(e,t){if(this.options.rightpanel.events){var n=this;_.each(this.options.rightpanel.events,function(n,r){var i=r.split(" "),s=i[0],o=r.slice(i[0].length==r.length?i[0].length:i[0].length+1);Boolean(o)?($(".ui-layout-right").off(s,o),$(".ui-layout-right").on(s,o,function(){n(e,t)})):($(".ui-layout-right").off(s),$(".ui-layout-right").on(s,function(){n(e,t)}))})}},setModEvent:function(e,t){$(e).find("select").on("change",function(){var e=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");t(n,e,r)}),$(e).find('input[type="checkbox"]').on("change",function(){var e=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");t(n,e,r)}),$(e).find('input[type="radio"]').on("change",function(){var e=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");t(n,e,r)}),$(e).find('input[type="text"]').on("change",function(){var e=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");t(n,e,r)}),$(e).find("textarea").on("change",function(){var e=global.serializeValue($(this).parents(".mod").first()),n=$(this).parents(".mod").first().attr("data-name"),r=$(this).parents(".mod").first().attr("data-model");t(n,e,r)})}},lists});var qq=qq||{};qq.FileUploader=function(e){this._options={element:null,action:"/server/upload",params:{},allowedExtensions:[],sizeLimit:0,onAfterSelect:function(e,t){},autoUpload:!0,simUploadLimit:2,onSubmit:function(e,t){},onComplete:function(e,t,n){},template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Browse for a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><a class="qq-upload-cancel" href="#">&nbsp;</a><div class="qq-upload-infos"><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-failed-text">Failed</span></div><div class="qq-upload-size"></div></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",emptyError:"{file} is empty, please select files again without it."},showMessage:function(e){alert(e)},debugMode:!1},qq.extend(this._options,e),this._element=this._options.element;if(this._element.nodeType!=1)throw new Error("element param of FileUploader should be dom node");base_template=this._options.template,debug_template='<div class="qq-upload-debug">  <strong>Current Uploads : </strong><span class="qq-upload-debug-curruploads"></span></div>',this._options.debugMode&&(base_template+=debug_template),this._element.innerHTML=base_template,this._filesInProgress=0,this._classes=this._options.classes,this._handler=this._createUploadHandler(),this._debugConsole=this.getDebugConsole(),this._bindCancelEvent();var t=this;this._button=new qq.UploadButton({element:this._getElement("button"),multiple:qq.UploadHandlerXhr.isSupported(),onChange:function(e){t._onInputChange(e)}}),this._setupDragDrop()},qq.FileUploader.prototype={setParams:function(e){this._options.params=e},getDebugConsole:function(){return qq.getByClass(this._element,"qq-upload-debug")[0]},logDebug:function(e,t){blocdebug=qq.getByClass(this._debugConsole,"qq-upload-debug-"+e),blocdebug&&qq.setText(blocdebug[0],t)},isUploading:function(){return!!this._filesInProgress},_getElement:function(e,t){typeof e=="string"&&(t=e,e=this._element);var n=qq.getByClass(e,this._options.classes[t])[0];if(!n)throw new Error("element not found "+t);return n},_error:function(e,t,n){var r=this._options.messages[e];r=r.replace("{file}",this._formatFileName(t)),r=r.replace("{extensions}",this._options.allowedExtensions.join(", ")),r=r.replace("{sizeLimit}",this._formatSize(this._options.sizeLimit));if(typeof n=="undefined")this._options.showMessage(r);else{var i=this._getItemByFileId(n),s=document.createElement("div");i.appendChild(s),eclass=document.createAttribute("class"),eclass.nodeValue="server-error",s.setAttributeNode(eclass),s.innerText=r,s.textContent=r}},_formatFileName:function(e){return e.length>33&&(e=e.slice(0,19)+"..."+e.slice(-13)),e},_isAllowedExtension:function(e){var t=-1!==e.indexOf(".")?e.replace(/.*[.]/,"").toLowerCase():"",n=this._options.allowedExtensions;if(!n.length)return!0;for(var r=0;r<n.length;r++)if(n[r].toLowerCase()==t)return!0;return!1},_setupDragDrop:function(){function e(e){var t=e.dataTransfer,n=navigator.userAgent.indexOf("AppleWebKit")>-1;return t&&t.effectAllowed!="none"&&(t.files||!n&&t.types.contains&&t.types.contains("Files"))}var t=this,n=this._getElement("drop");n.style.display="none";var r;qq.attach(document,"dragenter",function(e){e.preventDefault()}),qq.attach(document,"dragover",function(i){if(e(i)){r&&clearTimeout(r);if(n==i.target||qq.contains(n,i.target)){var s=i.dataTransfer.effectAllowed;s=="move"||s=="linkMove"?i.dataTransfer.dropEffect="move":i.dataTransfer.dropEffect="copy",qq.addClass(n,t._classes.dropActive),i.stopPropagation()}else n.style.display="block",i.dataTransfer.dropEffect="none";i.preventDefault()}}),qq.attach(document,"dragleave",function(i){e(i)&&(n==i.target||qq.contains(n,i.target)?(qq.removeClass(n,t._classes.dropActive),i.stopPropagation()):(r&&clearTimeout(r),r=setTimeout(function(){n.style.display="none"},77)))}),qq.attach(n,"drop",function(e){n.style.display="none",t._addSelection(e.dataTransfer.files),e.preventDefault()})},_createUploadHandler:function(){var e=this,t;qq.UploadHandlerXhr.isSupported()?t="UploadHandlerXhr":t="UploadHandlerForm";var n=new qq[t]({action:this._options.action,onProgress:function(t,n,r,i){e._updateProgress(t,r,i)},onComplete:function(t,n,r){var i=e._getItemByFileId(t);qq.remove(e._getElement(i,"spinner")),r.success?(qq.remove(e._getElement(i,"cancel")),qq.addClass(i,e._classes.success)):(qq.addClass(i,e._classes.fail),r.error&&e._error(r.error,n,t)),e._filesInProgress--,e._options.onComplete(t,n,r)}});return n},_onInputChange:function(e){this._handler instanceof qq.UploadHandlerXhr?this._addSelection(e.files):this._validateFile(e)&&this._addFile(e),this._button.reset()},_addSelection:function(e){var t=!0,n=0,r=e.length-1;while(n<=r){if(!this._validateFile(e[n])){t=!1;break}n++}if(t){var n=0,r=e.length-1;while(n<=r)this._addFile(e[n]),n++}},_addFile:function(e){var t=this._handler.add(e),n=this._handler.getName(t);this._options.onSubmit(t,n),this._addToList(t,n),this._options.autoUpload?this._queueUpload(t,this._options.params):this._options.onAfterSelect(e,t)},_uploadAll:function(){var e=this._handler._files;for(var t=0;t<e.length;t++)e[t]&&this._queueUpload(t,this._options.params)},_queueUpload:function(e,t){var n=this._options.simUploadLimit;this._options.debugMode&&this.logDebug("curruploads",this._filesInProgress);if(this._filesInProgress<n||!n){this._filesInProgress++;if(this._handler instanceof qq.UploadHandlerXhr)var r=e;else if(typeof e=="number")var r="qq-upload-handler-iframe"+e;else var r=e;var i=this._getItemByFileId(r),s=this._getElement(i,"spinner");qq.css(s,{display:"inline-block"}),this._handler.upload(e,t)}else{var o=this;window.setTimeout(function(){o._queueUpload(e,t)},100)}},_cancelAll:function(){var e=this._handler._files;for(var t=0;t<e.length;t++)e[t]&&this._handler.cancel(t)},_validateFile:function(e){var t,n;return e.value?t=e.value.replace(/.*(\/|\\)/,""):(t=e.fileName!=null?e.fileName:e.name,n=e.fileSize!=null?e.fileSize:e.size),this._isAllowedExtension(t)?n===0?(this._error("emptyError",t),!1):n&&this._options.sizeLimit&&n>this._options.sizeLimit?(this._error("sizeError",t),!1):!0:(this._error("typeError",t),!1)},_addToList:function(e,t){var n=qq.toElement(this._options.fileTemplate);n.qqFileId=e;var r=this._getElement(n,"file");qq.setText(r,this._formatFileName(t)),this._getElement("list").appendChild(n)},_updateProgress:function(e,t,n){var r=this._getItemByFileId(e),i=this._getElement(r,"size"),s,o;t!=n?s=Math.round(t/n*100):s=100,o="&nbsp;"+this._formatSize(n),qq.setProgressBar(i,s,o)},_formatSize:function(e){var t=-1;do e/=1024,t++;while(e>99);return Math.max(e,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][t]},_getItemByFileId:function(e){var t=this._getElement("list").firstChild;while(t){if(t.qqFileId==e)return t;t=t.nextSibling}},_bindCancelEvent:function(){var e=this,t=this._getElement("list");qq.attach(t,"click",function(t){t=t||window.event;var n=t.target||t.srcElement;if(qq.hasClass(n,e._classes.cancel)){qq.preventDefault(t);var r=n.parentNode;e._handler.cancel(r.qqFileId),qq.remove(r)}})}},qq.UploadButton=function(e){this._options={element:null,multiple:!1,name:"file",onChange:function(e){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,e),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var e=document.createElement("input");this._options.multiple&&e.setAttribute("multiple","multiple"),e.setAttribute("type","file"),e.setAttribute("name",this._options.name),qq.css(e,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"243px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(e);var t=this;return qq.attach(e,"change",function(){t._options.onChange(e)}),qq.attach(e,"mouseover",function(){qq.addClass(t._element,t._options.hoverClass)}),qq.attach(e,"mouseout",function(){qq.removeClass(t._element,t._options.hoverClass)}),qq.attach(e,"focus",function(){qq.addClass(t._element,t._options.focusClass)}),qq.attach(e,"blur",function(){qq.removeClass(t._element,t._options.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}},qq.UploadHandlerForm=function(e){this._options={action:"/upload",onComplete:function(e,t,n){}},qq.extend(this._options,e),this._inputs={},this._files=[]},qq.UploadHandlerForm.prototype={add:function(e){e.setAttribute("name","qqfile");var t=qq.getUniqueId(),n="qq-upload-handler-iframe"+t;return this._inputs[n]=e,this._files[t]=e,e.parentNode&&qq.remove(e),n},upload:function(e,t){if(typeof e=="number")var e="qq-upload-handler-iframe"+e;var n=this._inputs[e];if(!n)throw new Error("file with passed id was not added, or already uploaded or cancelled");var r=this.getName(e),i=this._createIframe(e),s=this._createForm(i,t);s.appendChild(n);var o=this;return this._attachLoadEvent(i,function(){o._options.onComplete(e,r,o._getIframeContentJSON(i)),delete o._inputs[e],uid=e.replace("qq-upload-handler-iframe",""),o._files[uid]=null,setTimeout(function(){qq.remove(i)},1)}),s.submit(),qq.remove(s),e},cancel:function(e){e in this._inputs&&(delete this._inputs[e],uid=e.replace("qq-upload-handler-iframe",""),this._files[uid]=null);var t=document.getElementById(e);t&&(t.setAttribute("src","javascript:false;"),qq.remove(t))},getName:function(e){return this._inputs[e].value.replace(/.*(\/|\\)/,"")},_attachLoadEvent:function(e,t){qq.attach(e,"load",function(){if(!e.parentNode)return;if(e.contentDocument&&e.contentDocument.body&&e.contentDocument.body.innerHTML=="false")return;t()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(e){var t=qq.toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e,t){var n=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),r="?"+qq.obj2url(t);return n.setAttribute("action",this._options.action+r),n.setAttribute("target",e.name),n.style.display="none",document.body.appendChild(n),n}},qq.UploadHandlerXhr=function(e){this._options={action:"/upload",onProgress:function(e,t,n,r){},onComplete:function(e,t,n){}},qq.extend(this._options,e),this._files=[],this._xhrs=[]},qq.UploadHandlerXhr.isSupported=function(){var e=document.createElement("input");return e.type="file","multiple"in e&&typeof File!="undefined"&&typeof (new XMLHttpRequest).upload!="undefined"},qq.UploadHandlerXhr.prototype={add:function(e){return this._files.push(e)-1},upload:function(id,params){var file=this._files[id],name=this.getName(id),size=this.getSize(id);if(!file)throw new Error("file with passed id was not added, or already uploaded or cancelled");var xhr=this._xhrs[id]=new XMLHttpRequest,self=this;xhr.upload.onprogress=function(e){e.lengthComputable&&self._options.onProgress(id,name,e.loaded,e.total)},xhr.onreadystatechange=function(){if(!self._files[id])return;if(xhr.readyState==4){self._options.onProgress(id,name,size,size);if(xhr.status==200){var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}self._options.onComplete(id,name,response)}else self._options.onComplete(id,name,{});self._files[id]=null,self._xhrs[id]=null}};var queryString="?qqfile="+encodeURIComponent(name)+"&"+qq.obj2url(params);xhr.open("POST",this._options.action+queryString,!0),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("X-File-Name",encodeURIComponent(name)),xhr.setRequestHeader("Content-Type","application/octet-stream"),xhr.send(file)},cancel:function(e){this._files[e]=null,this._xhrs[e]&&(this._xhrs[e].abort(),this._xhrs[e]=null)},getName:function(e){var t=this._files[e];return t.fileName!=null?t.fileName:t.name},getSize:function(e){var t=this._files[e];return t.fileSize!=null?t.fileSize:t.size}};var qq=qq||{};qq.extend=function(e,t){for(var n in t)e[n]=t[n]},qq.getUniqueId=function(){var e=0;return function(){return e++}}(),qq.attach=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},qq.detach=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n)},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.insertBefore=function(e,t){t.parentNode.insertBefore(e,t)},qq.remove=function(e){e.parentNode.removeChild(e)},qq.contains=function(e,t){return e.contains?e.contains(t):!!(t.compareDocumentPosition(e)&8)},qq.toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n),n}}(),qq.css=function(e,t){t.opacity!=null&&typeof e.style.opacity!="string"&&typeof e.filters!="undefined"&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t)},qq.hasClass=function(e,t){var n=new RegExp("(^| )"+t+"( |$)");return n.test(e.className)},qq.addClass=function(e,t){qq.hasClass(e,t)||(e.className+=" "+t)},qq.removeClass=function(e,t){var n=new RegExp("(^| )"+t+"( |$)");e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(e,t){e.innerText=t,e.textContent=t},qq.setProgressBar=function(e,t,n){if(!e.hasChildNodes()){t?size=t+"%":size="2px";var r='<div class="sizeContainer"><div class="sizeBar" style="width:'+size+'"></div></div>',i='<div class="sizeTotal">'+n+"</div>";e.innerHTML=i+r}else{var s=qq.getByClass(e,"sizeBar")[0];s.style.width=t+"%"}},qq.children=function(e){var t=[],n=e.firstChild;while(n)n.nodeType==1&&t.push(n),n=n.nextSibling;return t},qq.getByClass=function(e,t){if(e.querySelectorAll)return e.querySelectorAll("."+t);var n=[],r=e.getElementsByTagName("*"),i=r.length;for(var s=0;s<i;s++)qq.hasClass(r[s],t)&&n.push(r[s]);return n},qq.obj2url=function(e,t){var n=[],r=function(e,r){var i=t?/\[\]$/.test(t)?t:t+"["+r+"]":r;n.push(typeof e=="object"?qq.obj2url(e,i):Object.prototype.toString.call(e)==="[object Function]"?encodeURIComponent(i)+"="+encodeURIComponent(e()):encodeURIComponent(i)+"="+encodeURIComponent(e))};if(Object.prototype.toString.call(e)==="[object Array]")for(var i=0,s=e.length;i<s;++i)r(e[i],i);else if(e!==undefined&&e!==null&&typeof e=="object")for(var i in e)r(e[i],i);else n.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return n.join("&").replace(/%20/g,"+")},define("quickupload/fileuploader",["jquery"],function(){});var PloneQuickUpload={};PloneQuickUpload.addUploadFields=function(e,t,n,r,i){if(i){var s=jQuery("#uploadify_label_file_title").val(),o=e._getItemByFileId(r);typeof r=="string"&&(r=parseInt(r.replace("qq-upload-handler-iframe",""))),jQuery(".qq-upload-cancel",o).after('                  <div class="uploadField">                      <label>'+s+'&nbsp;:&nbsp;</label>                       <input type="text"                              class="file_title_field"                              id="title_'+r+'"                              name="title"                              value="" />                  </div>                   ')}PloneQuickUpload.showButtons(e,t)},PloneQuickUpload.showButtons=function(e,t){var n=e._handler;return n._files.length?(jQuery(".uploadifybuttons",jQuery(t).parent()).show(),"ok"):!1},PloneQuickUpload.sendDataAndUpload=function(e,t,n){var r=e._handler,i=r._files,s=0;for(var o=0;o<i.length;o++)if(i[o]){var u=jQuery(".qq-upload-list li",t)[o-s],a="";fillTitles&&(a=jQuery(".file_title_field",u).val()),e._queueUpload(o,{title:a,typeupload:n})}else s++},PloneQuickUpload.onAllUploadsComplete=function(){Browser.onUploadComplete()},PloneQuickUpload.clearQueue=function(e,t){var n=e._handler,r=n._files;for(var i=0;i<r.length;i++)r[i]&&n.cancel(i),jQuery(".qq-upload-list li",t).remove(),n._files=[],typeof n._inputs!="undefined"&&(n._inputs={})},PloneQuickUpload.onUploadComplete=function(e,t,n,r,i){var s=jQuery(".qq-upload-list",t);i.success&&window.setTimeout(function(){jQuery(e._getItemByFileId(n)).remove();var t=jQuery("li",s);t.length||window.setTimeout(PloneQuickUpload.onAllUploadsComplete,5)},50)},define("quickupload/helpers",["jquery"],function(){}),jQuery&&function(e){e.extend(e.fn,{uploadify:function(t){e(this).each(function(){settings=e.extend({id:e(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:110,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:!1,displayData:"percentage",onInit:function(){},onSelect:function(){},onQueueFull:function(){},onCheck:function(){},onCancel:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},t);var n=location.pathname;n=n.split("/"),n.pop(),n=n.join("/")+"/";var r={};r.uploadifyID=settings.id,r.pagepath=n,settings.buttonImg&&(r.buttonImg=escape(settings.buttonImg)),settings.buttonText&&(r.buttonText=escape(settings.buttonText)),settings.rollover&&(r.rollover=!0),r.script=settings.script,r.folder=escape(settings.folder);if(settings.scriptData){var i="";for(var s in settings.scriptData)i+="&"+s+"="+settings.scriptData[s];r.scriptData=escape(i.substr(1))}r.width=settings.width,r.height=settings.height,r.wmode=settings.wmode,r.method=settings.method,r.queueSizeLimit=settings.queueSizeLimit,r.simUploadLimit=settings.simUploadLimit,settings.hideButton&&(r.hideButton=!0),settings.fileDesc&&(r.fileDesc=settings.fileDesc),settings.fileExt&&(r.fileExt=settings.fileExt),settings.multi&&(r.multi=!0),settings.auto&&(r.auto=!0),settings.sizeLimit&&(r.sizeLimit=settings.sizeLimit),settings.checkScript&&(r.checkScript=settings.checkScript),settings.fileDataName&&(r.fileDataName=settings.fileDataName),settings.queueID&&(r.queueID=settings.queueID),settings.onInit()!==!1&&(e(this).css("display","none"),e(this).after('<div id="'+e(this).attr("id")+'Uploader"></div>'),swfobject.embedSWF(settings.uploader,settings.id+"Uploader",settings.width,settings.height,"9.0.24",settings.expressInstall,r,{quality:"high",wmode:settings.wmode,allowScriptAccess:settings.scriptAccess}),settings.queueID==0&&e("#"+e(this).attr("id")+"Uploader").after('<div id="'+e(this).attr("id")+'Queue" class="upload-bd"><ul></ul></div>')),typeof settings.onOpen=="function"&&e(this).bind("uploadifyOpen",settings.onOpen),e(this).bind("uploadifySelect",{action:settings.onSelect,queueID:settings.queueID},function(t,n,r){if(t.data.action(t,n,r)!==!1){var i=Math.round(r.size/1024*100)*.01,s="KB";i>1e3&&(i=Math.round(i*.001*100)*.01,s="MB");var o=i.toString().split(".");o.length>1?i=o[0]+"."+o[1].substr(0,2):i=o[0],r.name.length>20?fileName=r.name.substr(0,20)+"...":fileName=r.name,queue="#"+e(this).attr("id")+"Queue ul",t.data.queueID&&(queue="#"+t.data.queueID+" ul"),e(queue).append('<li id="'+e(this).attr("id")+n+'">                                <div class="cancel">                                    <a href="javascript:jQuery(\'#'+e(this).attr("id")+"').uploadifyCancel('"+n+'\')">x</a>                                </div>                                <div class="meta-data">'+fileName+" ("+i+s+')</div><div class="percentage"></div>                                <div class="uploadifyProgress progress">                                    <div id="'+e(this).attr("id")+n+'ProgressBar" class="uploadifyProgressBar bar"><!--Progress Bar--></div>                                </div>                            </li>')}}),typeof settings.onSelectOnce=="function"&&e(this).bind("uploadifySelectOnce",settings.onSelectOnce),e(this).bind("uploadifyQueueFull",{action:settings.onQueueFull},function(e,t){e.data.action(e,t)!==!1&&alert("The queue is full.  The max size is "+t+".")}),e(this).bind("uploadifyCheckExist",{action:settings.onCheck},function(t,r,i,s,o){var u=new Object;u=i,u.folder=n+s;if(o)for(var a in i)var f=a;e.post(r,u,function(n){for(var u in n)if(t.data.action(t,r,i,s,o)!==!1){var a=confirm("Do you want to replace the file "+n[u]+"?");a||document.getElementById(e(t.target).attr("id")+"Uploader").cancelFileUpload(u,!0,!0)}o?document.getElementById(e(t.target).attr("id")+"Uploader").startFileUpload(f,!0):document.getElementById(e(t.target).attr("id")+"Uploader").startFileUpload(null,!0)},"json")}),e(this).bind("uploadifyCancel",{action:settings.onCancel},function(t,n,r,i,s){if(t.data.action(t,n,r,i,s)!==!1){var o=s==1?0:250;e("#"+e(this).attr("id")+n).fadeOut(o,function(){e(this).remove()})}}),typeof settings.onClearQueue=="function"&&e(this).bind("uploadifyClearQueue",settings.onClearQueue);var o=[];e(this).bind("uploadifyError",{action:settings.onError},function(t,n,r,i){if(t.data.action(t,n,r,i)!==!1){var s=new Array(n,r,i);o.push(s),e("#"+e(this).attr("id")+n+" .percentage").text(" - "+i.type+" Error"),e("#"+e(this).attr("id")+n).addClass("uploadifyError")}}),e(this).bind("uploadifyProgress",{action:settings.onProgress,toDisplay:settings.displayData},function(t,n,r,i){t.data.action(t,n,r,i)!==!1&&(e("#"+e(this).attr("id")+n+"ProgressBar").css("width",i.percentage+"%"),t.data.toDisplay=="percentage"&&(displayData=" - "+i.percentage+"%"),t.data.toDisplay=="speed"&&(displayData=" - "+i.speed+"KB/s"),t.data.toDisplay==null&&(displayData=" "),e("#"+e(this).attr("id")+n+" .percentage").text(displayData))}),e(this).bind("uploadifyComplete",{action:settings.onComplete},function(t,n,r,i,s){t.data.action(t,n,r,unescape(i),s)!==!1&&(e("#"+e(this).attr("id")+n+" .percentage").text(" 100% "),e("#"+e(this).attr("id")+n).fadeOut(250,function(){e(this).remove()}),addPage())}),typeof settings.onAllComplete=="function"&&e(this).bind("uploadifyAllComplete",{action:settings.onAllComplete},function(e,t){e.data.action(e,t)!==!1&&(o=[])})})},uploadifySettings:function(t,n,r){var i=!1;e(this).each(function(){if(t=="scriptData"&&n!=null){if(r)var s=n;else var s=e.extend(settings.scriptData,n);var o="";for(var u in s)o+="&"+u+"="+escape(s[u]);n=o.substr(1)}i=document.getElementById(e(this).attr("id")+"Uploader").updateSettings(t,n)});if(n==null){if(t=="scriptData"){var s=unescape(i).split("&"),o=new Object;for(var u=0;u<s.length;u++){var a=s[u].split("=");o[a[0]]=a[1]}i=o}return i}},uploadifyUpload:function(t){e(this).each(function(){document.getElementById(e(this).attr("id")+"Uploader").startFileUpload(t,!1)})},uploadifyCancel:function(t){e(this).each(function(){document.getElementById(e(this).attr("id")+"Uploader").cancelFileUpload(t,!0,!1)})},uploadifyClearQueue:function(){e(this).each(function(){document.getElementById(e(this).attr("id")+"Uploader").clearFileUploadQueue(!1)})}})}(jQuery),define("quickupload/jquery.uploadify",["jquery"],function(){});var swfobject=function(){function C(){if(b)return;try{var e=a.getElementsByTagName("body")[0].appendChild(U("span"));e.parentNode.removeChild(e)}catch(t){return}b=!0;var n=c.length;for(var r=0;r<n;r++)c[r]()}function k(e){b?e():c[c.length]=e}function L(t){if(typeof u.addEventListener!=e)u.addEventListener("load",t,!1);else if(typeof a.addEventListener!=e)a.addEventListener("load",t,!1);else if(typeof u.attachEvent!=e)z(u,"onload",t);else if(typeof u.onload=="function"){var n=u.onload;u.onload=function(){n(),t()}}else u.onload=t}function A(){l?O():M()}function O(){var n=a.getElementsByTagName("body")[0],r=U(t);r.setAttribute("type",i);var s=n.appendChild(r);if(s){var o=0;(function(){if(typeof s.GetVariable!=e){var t=s.GetVariable("$version");t&&(t=t.split(" ")[1].split(","),T.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)])}else if(o<10){o++,setTimeout(arguments.callee,10);return}n.removeChild(r),s=null,M()})()}else M()}function M(){var t=h.length;if(t>0)for(var n=0;n<t;n++){var r=h[n].id,i=h[n].callbackFn,s={success:!1,id:r};if(T.pv[0]>0){var o=R(r);if(o)if(W(h[n].swfVersion)&&!(T.wk&&T.wk<312))V(r,!0),i&&(s.success=!0,s.ref=_(r),i(s));else if(h[n].expressInstall&&D()){var u={};u.data=h[n].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));var a={},f=o.getElementsByTagName("param"),l=f.length;for(var c=0;c<l;c++)f[c].getAttribute("name").toLowerCase()!="movie"&&(a[f[c].getAttribute("name")]=f[c].getAttribute("value"));P(u,a,r,i)}else H(o),i&&i(s)}else{V(r,!0);if(i){var p=_(r);p&&typeof p.SetVariable!=e&&(s.success=!0,s.ref=p),i(s)}}}}function _(n){var r=null,i=R(n);if(i&&i.nodeName=="OBJECT")if(typeof i.SetVariable!=e)r=i;else{var s=i.getElementsByTagName(t)[0];s&&(r=s)}return r}function D(){return!w&&W("6.0.65")&&(T.win||T.mac)&&!(T.wk&&T.wk<312)}function P(t,n,r,i){w=!0,g=i||null,y={success:!1,id:r};var o=R(r);if(o){o.nodeName=="OBJECT"?(v=B(o),m=null):(v=o,m=r),t.id=s;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310)t.width="310";if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137)t.height="137";a.title=a.title.slice(0,47)+" - Flash Player Installation";var f=T.ie&&T.win?"ActiveX":"PlugIn",l="MMredirectURL="+u.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+a.title;typeof n.flashvars!=e?n.flashvars+="&"+l:n.flashvars=l;if(T.ie&&T.win&&o.readyState!=4){var c=U("div");r+="SWFObjectNew",c.setAttribute("id",r),o.parentNode.insertBefore(c,o),o.style.display="none",function(){o.readyState==4?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}j(t,n,r)}}function H(e){if(T.ie&&T.win&&e.readyState!=4){var t=U("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(B(e),t),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(B(e),e)}function B(e){var n=U("div");if(T.win&&T.ie)n.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(t)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++)(i[o].nodeType!=1||i[o].nodeName!="PARAM")&&i[o].nodeType!=8&&n.appendChild(i[o].cloneNode(!0))}}}return n}function j(n,r,s){var o,u=R(s);if(T.wk&&T.wk<312)return o;if(u){typeof n.id==e&&(n.id=s);if(T.ie&&T.win){var a="";for(var f in n)n[f]!=Object.prototype[f]&&(f.toLowerCase()=="data"?r.movie=n[f]:f.toLowerCase()=="styleclass"?a+=' class="'+n[f]+'"':f.toLowerCase()!="classid"&&(a+=" "+f+'="'+n[f]+'"'));var l="";for(var c in r)r[c]!=Object.prototype[c]&&(l+='<param name="'+c+'" value="'+r[c]+'" />');u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>",p[p.length]=n.id,o=R(n.id)}else{var h=U(t);h.setAttribute("type",i);for(var d in n)n[d]!=Object.prototype[d]&&(d.toLowerCase()=="styleclass"?h.setAttribute("class",n[d]):d.toLowerCase()!="classid"&&h.setAttribute(d,n[d]));for(var v in r)r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"&&F(h,v,r[v]);u.parentNode.replaceChild(h,u),o=h}}return o}function F(e,t,n){var r=U("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function I(e){var t=R(e);t&&t.nodeName=="OBJECT"&&(T.ie&&T.win?(t.style.display="none",function(){t.readyState==4?q(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function q(e){var t=R(e);if(t){for(var n in t)typeof t[n]=="function"&&(t[n]=null);t.parentNode.removeChild(t)}}function R(e){var t=null;try{t=a.getElementById(e)}catch(n){}return t}function U(e){return a.createElement(e)}function z(e,t,n){e.attachEvent(t,n),d[d.length]=[e,t,n]}function W(e){var t=T.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function X(n,r,i,s){if(T.ie&&T.mac)return;var o=a.getElementsByTagName("head")[0];if(!o)return;var u=i&&typeof i=="string"?i:"screen";s&&(E=null,S=null);if(!E||S!=u){var f=U("style");f.setAttribute("type","text/css"),f.setAttribute("media",u),E=o.appendChild(f),T.ie&&T.win&&typeof a.styleSheets!=e&&a.styleSheets.length>0&&(E=a.styleSheets[a.styleSheets.length-1]),S=u}T.ie&&T.win?E&&typeof E.addRule==t&&E.addRule(n,r):E&&typeof a.createTextNode!=e&&E.appendChild(a.createTextNode(n+" {"+r+"}"))}function V(e,t){if(!x)return;var n=t?"visible":"hidden";b&&R(e)?R(e).style.visibility=n:X("#"+e,"visibility:"+n)}function $(t){var n=/[\\\"<>\.;]/,r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",t="object",n="Shockwave Flash",r="ShockwaveFlash.ShockwaveFlash",i="application/x-shockwave-flash",s="SWFObjectExprInst",o="onreadystatechange",u=window,a=document,f=navigator,l=!1,c=[A],h=[],p=[],d=[],v,m,g,y,b=!1,w=!1,E,S,x=!0,T=function(){var s=typeof a.getElementById!=e&&typeof a.getElementsByTagName!=e&&typeof a.createElement!=e,o=f.userAgent.toLowerCase(),c=f.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(o),p=c?/mac/.test(c):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,v=!1,m=[0,0,0],g=null;if(typeof f.plugins!=e&&typeof f.plugins[n]==t)g=f.plugins[n].description,g&&(typeof f.mimeTypes==e||!f.mimeTypes[i]||!!f.mimeTypes[i].enabledPlugin)&&(l=!0,v=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof u.ActiveXObject!=e)try{var y=new ActiveXObject(r);y&&(g=y.GetVariable("$version"),g&&(v=!0,g=g.split(" ")[1].split(","),m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]))}catch(b){}return{w3:s,pv:m,wk:d,ie:v,win:h,mac:p}}(),N=function(){if(!T.w3)return;(typeof a.readyState!=e&&a.readyState=="complete"||typeof a.readyState==e&&(a.getElementsByTagName("body")[0]||a.body))&&C(),b||(typeof a.addEventListener!=e&&a.addEventListener("DOMContentLoaded",C,!1),T.ie&&T.win&&(a.attachEvent(o,function(){a.readyState=="complete"&&(a.detachEvent(o,arguments.callee),C())}),u==top&&function(){if(b)return;try{a.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}C()}()),T.wk&&function(){if(b)return;if(!/loaded|complete/.test(a.readyState)){setTimeout(arguments.callee,0);return}C()}(),L(C))}(),J=function(){T.ie&&T.win&&window.attachEvent("onunload",function(){var e=d.length;for(var t=0;t<e;t++)d[t][0].detachEvent(d[t][1],d[t][2]);var n=p.length;for(var r=0;r<n;r++)I(p[r]);for(var i in T)T[i]=null;T=null;for(var s in swfobject)swfobject[s]=null;swfobject=null})}();return{registerObject:function(e,t,n,r){if(T.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=r,h[h.length]=i,V(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(T.w3)return _(e)},embedSWF:function(n,r,i,s,o,u,a,f,l,c){var h={success:!1,id:r};T.w3&&!(T.wk&&T.wk<312)&&n&&r&&i&&s&&o?(V(r,!1),k(function(){i+="",s+="";var p={};if(l&&typeof l===t)for(var d in l)p[d]=l[d];p.data=n,p.width=i,p.height=s;var v={};if(f&&typeof f===t)for(var m in f)v[m]=f[m];if(a&&typeof a===t)for(var g in a)typeof v.flashvars!=e?v.flashvars+="&"+g+"="+a[g]:v.flashvars=g+"="+a[g];if(W(o)){var y=j(p,v,r);p.id==r&&V(r,!0),h.success=!0,h.ref=y}else{if(u&&D()){p.data=u,P(p,v,r,c);return}V(r,!0)}c&&c(h)})):c&&c(h)},switchOffAutoHideShow:function(){x=!1},ua:T,getFlashPlayerVersion:function(){return{major:T.pv[0],minor:T.pv[1],release:T.pv[2]}},hasFlashPlayerVersion:W,createSWF:function(e,t,n){return T.w3?j(e,t,n):undefined},showExpressInstall:function(e,t,n,r){T.w3&&D()&&P(e,t,n,r)},removeSWF:function(e){T.w3&&I(e)},createCSS:function(e,t,n,r){T.w3&&X(e,t,n,r)},addDomLoadEvent:k,addLoadEvent:L,getQueryParamValue:function(e){var t=a.location.search||a.location.hash;if(t){/\?/.test(t)&&(t=t.split("?")[1]);if(e==null)return $(t);var n=t.split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return $(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(w){var e=R(s);e&&v&&(e.parentNode.replaceChild(v,e),m&&(V(m,!0),T.ie&&T.win&&(v.style.display="block")),g&&g(y)),w=!1}}}}();define("quickupload/swfobject",["jquery"],function(){}),define("quickupload/main",["global/main","quickupload/fileuploader","quickupload/helpers","quickupload/jquery.uploadify","quickupload/swfobject"],function(){var e=_.template(['	  <div class="modal-header">','	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>',"	    <h3>上传素材</h3>","	  </div>",'	  <div class="modal-body">','	    <div class="upload-hd">','	      <button class="btn btn-small btn-primary" type="button">上传素材</button>',"	      <p>提示：每次最多可以批量上传二十张照片，按着 “command” 键可以一次选择多张照片。</p>","	    </div>",'	    <div class="upload-ft">',"	  </div>"].join(""));window.upload=function(t){this.defaults={url:portal_url+"medias/miniupload",template:e,onUpload:null},this.options=t;var n=$.extend({},this.defaults);this.options=$.extend(!0,{},n,typeof t=="object"&&t),this.init()},window.upload.prototype={init:function(){$("body").append(global.modal.create("upload","medium-modal")),$("#upload").css("z-index","2000"),$("#upload.modal").html(this.options.template());var e=this.options.url,t=$(".upload-hd");this.options.onUpload&&(window.addPage=this.options.onUpload),global.html.load(e,function(e){t.html(e),set_click_event(".action-upload",function(){return global.modal.show("#upload"),!1})})}}}),define("text!material/template/list.js",[],function(){return'  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\n    <h3>素材库</h3>\n    <button class="btn btn-small btn-primary action-upload" type="button" style="position:absolute; left:415px; top:6px;" data-target="#upload">上传素材</button>\n    <button class="btn btn-small action-inset" type="button" style="position:absolute; left:320px; top:6px;">插入所选</button>\n    <form class="search" style="position:absolute; right:50px; top:6px;">\n      <input type="text" placeholder="搜索" class="input-medium search-query">\n      <button class="btn" type="submit"><i class="icon-search"></i></button>\n    </form>\n  </div>\n  <div class="modal-body"><div class="left-column">\n        <div class="column-hd">\n          <h3>分类目录</h3>\n        </div>\n        <div class="column-bd nanoscrollbar"><div class="nano"><div class="content" tabindex="0">\n          <div class="treeview categories">\n            <ul>\n              <li class="tree-item">\n                <div class="wraparea"><h4><a href="#">所有</a></h4></div>\n              </li>\n              <li id="owner" class="tree-item">\n                <div class="wraparea"><h4><a href="#">我的内容</a></h4></div>\n              </li>\n              <li id="unset" class="tree-item">\n                <div class="wraparea"><h4><a href="#">未分类</a></h4></div>\n              </li>\n              <!-- left template -->\n            </ul>\n          </div>\n        </div><div class="pane" style="visibility: hidden;"><div class="slider" style="height: 67px; top: 0px;"></div></div></div></div>\n        <div class="column-ft"> \n          <!--<div style="margin:0 20px; height:29px; line-height:29px; text-align:right;"><a href="content_organization.html">内容组织？</a></div>--> \n        </div>\n      </div><div class="right-column">\n        <div class="column-hd">\n          <table cellspacing="0" class="hascheckbox hascover list">\n            <thead>\n              <tr>\n                <!-- menu +filter area -->\n              </tr>\n            </thead>\n          </table>\n        </div>\n        <div class="column-bd nanoscrollbar"><div class="nano"><div class="content" tabindex="0"> \n          <!--<div class="loading">Loading ..</div>-->\n          <table cellspacing="0" class="hascheckbox hascover list">\n            <tbody>\n              <!-- right template -->\n            </tbody>\n          </table>\n        </div><div class="pane" style="visibility: hidden;"><div class="slider" style="height: 61px; top: 18.036677454153182px;"></div></div></div></div>\n        <div class="column-ft">\n            <!--page template -->\n        </div>\n      </div></div>'}),define("text!material/template/left.js",[],function(){return'  <li id="<%=id%>">\n    <div class="wraparea"><h4><a href="#"><%=title%></a></h4><div class="hitarea"></div></div>\n  </li>\n'}),define("text!material/template/right.js",[],function(){return'              <tr id="<%=id%>" class="<%=review_state%> <%=type%> gallery" data-type="<%=type%>">\n                <td width="40"><input type="checkbox" name="material_list" value="<%=id%>"></td>\n                <td><span class="thumb"><img src="<%=thumbnail%>" alt=""></span></td>\n                <td><span class="title"><%=title%></span>\n                  <div class="action">\n                    <ul>\n          						<li>\n          							<a href="#" class="material-insert">插入</a>\n          						</li>\n          						<li>\n          							<a href="<%=url%>/preview" class="list-preview">预览</a>\n          						</li>\n                    </ul>\n                  </div></td>\n                <td width="12%"><%=created%></td>\n                <td width="10%"><%=creator%></td>\n                <td width="10%"><span class="status"><%=global.dict.query(review_state)%></span></td>\n                <td width="12%"><img src=<%=icon%> width="32" height="32" alt=<%=type%> title=<%=type%> rel="tooltip"></td>\n              </tr>\n'}),define("text!material/template/filter.js",[],function(){return'		<th width="10%" scope="col">\n			<select name=<%=id%>>\n				<option value=null><%=title%></option>\n				<% _.each(options,function(option){ %> \n					<option value=<%=option.id%>><%=option.title%></option>\n				<% }) %> \n			</select>\n		</th>'}),define("text!material/template/page.js",[],function(){return'          <div class="result-stats">共<%=numpages%>页，<%=sum%>条记录</div>\n	          <div class="pagination pagination-centered">\n	            <ul>\n				 <% var startpage=global.get_page(page,numpages,10).start; var endpage=global.get_page(page,numpages,10).end; %>\n	              <li <% var left=(page!=1&&numpages>1)?"":"class=disabled";%><%=left%>><a class="first" href="#">«</a></li>\n	              <li <% var left=(page!=1&&numpages>1)?"":"class=disabled";%><%=left%>><a class="prev" href="#">‹</a></li>\n				<% for(i=startpage;i<=endpage;i++){ %>\n					<li <% var current=(i==page)?"class=active":""; %><%=current%>><a class="page" href="#"><%=i%></a></li>\n				<% } %>\n	              <li <% var right=(page!=numpages&&numpages>0)?"":"class=disabled";%><%=right%>><a class="next" href="#">›</a></li>\n	              <li <% var right=(page!=numpages&&numpages>0)?"":"class=disabled";%><%=right%>><a class="last" href="#">»</a></li>\n	            </ul>\n	          </div>'}),define("text!material/template/menu.js",[],function(){return'	                <th scope="col" width="40"><input type="checkbox" value="selectall"></th>\n	                <th scope="col" colspan="2">标题</th>\n	                <th scope="col" width="12%">创建时间</th>'}),define("text!material/template/listforchange.js",[],function(){return'  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\n    <h3>素材库</h3>\n    <button class="btn btn-small btn-primary action-upload" type="button" style="position:absolute; left:415px; top:6px;" data-target="#upload">上传素材</button>\n    <form class="search" style="position:absolute; right:50px; top:6px;">\n      <input type="text" placeholder="搜索" class="input-medium search-query">\n      <button class="btn" type="submit"><i class="icon-search"></i></button>\n    </form>\n  </div>\n  <div class="modal-body"><div class="left-column">\n        <div class="column-hd">\n          <h3>分类目录</h3>\n        </div>\n        <div class="column-bd nanoscrollbar"><div class="nano"><div class="content" tabindex="0">\n          <div class="treeview categories">\n            <ul>\n              <li class="tree-item">\n                <div class="wraparea"><h4><a href="#">所有</a></h4></div>\n              </li>\n              <li id="owner" class="tree-item">\n                <div class="wraparea"><h4><a href="#">我的内容</a></h4></div>\n              </li>\n              <li id="unset" class="tree-item">\n                <div class="wraparea"><h4><a href="#">未分类</a></h4></div>\n              </li>\n              <!-- left template -->\n            </ul>\n          </div>\n        </div><div class="pane" style="visibility: hidden;"><div class="slider" style="height: 67px; top: 0px;"></div></div></div></div>\n        <div class="column-ft"> \n          <!--<div style="margin:0 20px; height:29px; line-height:29px; text-align:right;"><a href="content_organization.html">内容组织？</a></div>--> \n        </div>\n      </div><div class="right-column">\n        <div class="column-hd">\n          <table cellspacing="0" class="hascheckbox hascover list">\n            <thead>\n              <tr>\n                <!-- menu +filter area -->\n              </tr>\n            </thead>\n          </table>\n        </div>\n        <div class="column-bd nanoscrollbar"><div class="nano"><div class="content" tabindex="0"> \n          <!--<div class="loading">Loading ..</div>-->\n          <table cellspacing="0" class="hascheckbox hascover list">\n            <tbody>\n              <!-- right template -->\n            </tbody>\n          </table>\n        </div><div class="pane" style="visibility: hidden;"><div class="slider" style="height: 61px; top: 18.036677454153182px;"></div></div></div></div>\n        <div class="column-ft">\n            <!--page template -->\n        </div>\n      </div></div>'}),define("text!material/template/rightforchange.js",[],function(){return'              <tr id="<%=id%>" class="<%=review_state%> <%=type%> gallery" data-type="<%=type%>">\n                <td width="40"><input type="checkbox" name="material_list" value="<%=id%>"></td>\n                <td><span class="thumb"><img src="<%=thumbnail%>" alt=""></span></td>\n                <td><span class="title"><%=title%></span>\n                  <div class="action">\n                    <ul>\n          						<li>\n          							<a href="#" class="material-change">替换</a>\n          						</li>\n          						<li>\n          							<a href="<%=url%>/preview" class="list-preview">预览</a>\n          						</li>\n                    </ul>\n                  </div></td>\n                <td width="12%"><%=created%></td>\n                <td width="10%"><%=creator%></td>\n                <td width="10%"><span class="status"><%=global.dict.query(review_state)%></span></td>\n                <td width="12%"><img src=<%=icon%> width="32" height="32" alt=<%=type%> title=<%=type%> rel="tooltip"></td>\n              </tr>\n'}),define("material/main",["lists/main","global/main","quickupload/main","text!material/template/list.js","text!material/template/left.js","text!material/template/right.js","text!material/template/filter.js","text!material/template/page.js","text!material/template/menu.js","text!material/template/listforchange.js","text!material/template/rightforchange.js"],function(){window.material={listforinsert:function(e,t){t||(t={}),$defaults={onlistload:null,onleftload:null,onrightload:null,onfilterload:null};var n=$.extend(!0,{},$defaults,typeof t=="object"&&t);$("#materialslistforinsert").length==0&&global.modal.create("materialslistforinsert","large-modal");var r=new lists.list({initialize:{container:"#materialslistforinsert",templatefile:"material/template/list.js",wait:!0,events:{"click .action-inset":function(){var t=global.get_array($("input[name=material_list]:checked"),"value");return e&&e(r,t),!1}},onUpdate:n.onlistload},menu:{container:".right-column .column-hd table tr",templatefile:"material/template/menu.js"},left:{container:".treeview",templatefile:"material/template/left.js",wrap:"ul",events:{},url:portal_url+"categories.json?type=material",onUpdate:n.onleftload},right:{defaults:{},container:".right-column .column-bd table tbody",templatefile:"material/template/right.js",wrap:null,events:{"click .material-insert":function(){return e&&e(r,[this.model.id]),!1}},url:portal_url+"materialslist.json?source=insert&size=20",onUpdate:n.onrightload},page:{container:".right-column .column-ft",templatefile:"material/template/page.js"},filter:{defaults:{},name:"filter",container:".right-column .column-hd table tr",url:portal_url+"material_filterconfig.json",templatefile:"material/template/filter.js",onUpdate:n.onfilterload}});r.render(),materialupload=new upload({onUpload:function(){r.load_right()}})},listforchange:function(e,t){t||(t={}),$defaults={onlistload:null,onleftload:null,onrightload:null,onfilterload:null};var n=$.extend(!0,{},$defaults,typeof t=="object"&&t);$("#materialslistforchange").length==0&&global.modal.create("materialslistforchange","large-modal");var r=new lists.list({initialize:{container:"#materialslistforchange",templatefile:"material/template/listforchange.js",wait:!0,events:{"click .action-inset":function(){var t=global.get_array($(r.options.list.container).find("input[name=material_list]:checked"),"value");return e&&e(r,t),!1}},onUpdate:n.onlistload},menu:{container:".right-column .column-hd table tr",templatefile:"material/template/menu.js"},left:{container:".treeview",templatefile:"material/template/left.js",wrap:"ul",events:{},url:portal_url+"categories.json?type=material",onUpdate:n.onleftload},right:{defaults:{},container:".right-column .column-bd table tbody",templatefile:"material/template/rightforchange.js",wrap:null,events:{"click .material-change":function(){return e&&e(r,[this.model.id]),!1}},url:portal_url+"materialslist.json?source=insert&size=20",onUpdate:n.onrightload},page:{container:".right-column .column-ft",templatefile:"material/template/page.js"},filter:{defaults:{},name:"filter",container:".right-column .column-hd table tr",url:portal_url+"material_filterconfig.json",templatefile:"material/template/filter.js",onUpdate:n.onfilterload}});r.render(),materialupload=new upload({onUpload:function(){r.load_right()}})}}}),define("interaction/main",["interaction/model/main","interaction/ui/main","iEditor/main","material/main","interaction_view/ui/presentation","interaction/ui/thumb"],function(){var e=require("interaction/ui/main");interaction=$.extend({},interaction,e),interaction.init=function(){$(".interaction-area").attr("id","interaction-area"),$(".interaction-area").append('<canvas id="interaction" class="hide" width=1024 height=768></canvas>'),$(".interaction-area").append('<div class="tooltip prompt fade in top hide" style="position:absolute;z-index:1000000;"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>');var e=document.getElementById("interaction");paper.setup(e),interaction.event.init(),iEditor.initForInteraction(),$(".doc-layout-right").addClass("nanoscrollbar"),global.setscrollnano(".doc-layout-center"),global.setscrollnano(".doc-layout-left"),global.setscrollnano(".doc-layout-right"),global.modal.create("confirmModal","small-modal"),interaction.templatepage.load(),$.getJSON(context_url+"getimages",function(e){if(e.code==200){var t=e.data.results;_.each(t,function(e){e.iType="Page",iPagelist.add(e)}),interaction.thumb.load();if(iPagelist.length>0){var n=iPagelist.at(0);n.iview.focus(),interaction.pagesort()}else iPagelist.addpage()}}),presentation.foredit(),$("#interactionEditor").on("click",function(e,t){($(e.target).attr("id")=="interactionEditor"||$(e.target).attr("id")=="interaction-area"||$(e.target).attr("id")=="animationbk"||$(e.target).is("img.animationbackground"))&&interaction.current&&interaction.current.iview.confirm()}),$("button.action-playinteraction").on("click",function(){window.open(context_url+"newcbtview")})}});var prewait=document.createElement("div");prewait.className="prewait",document.body.appendChild(prewait),requirejs.config({waitSeconds:100,paths:path,shim:shim}),requirejs.onError=function(e){console.log(e.requireType),e.requireType==="timeout"&&console.log("modules: "+e.requireModules),alert("Module"+e.requireModules+" Load Error ,Please try again!")},require(["interaction/main"],function(){document.body.removeChild(prewait),interaction.init()}),define("app/interaction/main0902",function(){});