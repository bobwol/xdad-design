var paper=new function(){var Base=new function(){function l(e,t,n){if(a){try{delete e[t];return a(e,t,n)}catch(r){}}if((n.get||n.set)&&e.__defineGetter__){n.get&&e.__defineGetter__(t,n.get);n.set&&e.__defineSetter__(t,n.set)}else{e[t]=n.value}return e}function c(e,t){if(f){try{return f(e,t)}catch(n){}}var r=e.__lookupGetter__&&e.__lookupGetter__(t);return r?{get:r,set:e.__lookupSetter__(t),enumerable:true,configurable:true}:e.hasOwnProperty(t)?{value:e[t],enumerable:true,configurable:true,writable:true}:null}function h(t,n,r,s,o,u){function h(e,u,h,p){var u=u||(u=c(n,e))&&(u.get?u:u.value),d=typeof u==="function",v=u,m=o||d?u&&u.get?e in t:t[e]:null;if((h||u!==undefined&&n.hasOwnProperty(e))&&(!o||!m)){if(d){if(m&&/\bthis\.base\b/.test(u)){var g=s&&s[e]==m;v=function(){var t=c(this,"base");l(this,"base",{value:g?s[e]:m,configurable:true});try{return u.apply(this,arguments)}finally{t?l(this,"base",t):delete this.base}};v.toString=function(){return u.toString()};v.valueOf=function(){return u.valueOf()}}if(a&&u.length===0&&(f=e.match(/^(get|is)(([A-Z])(.*))$/)))a.push([f[3].toLowerCase()+f[4],f[2]])}if(!v||d||!v.get)v={value:v,writable:true};if((c(t,e)||{configurable:true}).configurable){v.configurable=true;v.enumerable=r}l(t,e,v)}if(p&&d&&(!o||!p[e])){p[e]=function(n){return n&&t[e].apply(n,i.call(arguments,1))}}}var a,f;if(n){a=[];for(var p in n)if(n.hasOwnProperty(p)&&!e.test(p))h(p,null,true,u);h("toString");h("valueOf");for(var d=0,v=a&&a.length;d<v;d++)try{var f=a[d],m=f[1];h(f[0],{get:t["get"+m]||t["is"+m],set:t["set"+m]},true)}catch(g){}}return t}function p(e,t,n,i){try{if(e)(i||i===undefined&&r(e)?s:o).call(e,t,n=n||e)}catch(u){if(u!==Base.stop)throw u}return n}function d(e){return p(e,function(e,t){this[t]=e},new e.constructor)}var e=/^(statics|generics|preserve|enumerable|prototype|toString|valueOf)$/,t=Object.prototype,n=t.toString,t=Array.prototype,r=Array.isArray=Array.isArray||function(e){return n.call(e)==="[object Array]"},i=t.slice,s=t.forEach||function(e,t){for(var n=0,r=this.length;n<r;n++)e.call(t,this[n],n,this)},o=function(e,t){for(var n in this)if(this.hasOwnProperty(n))e.call(t,this[n],n,this)},u=Object.create||function(e){return{__proto__:e}},a=Object.defineProperty,f=Object.getOwnPropertyDescriptor;return h(function(){},{inject:function(e){if(e){var t=this.prototype,n=Object.getPrototypeOf(t).constructor,r=e.statics===true?e:e.statics;if(r!=e)h(t,e,e.enumerable,n&&n.prototype,e.preserve,e.generics&&this);h(this,r,true,n,e.preserve)}for(var i=1,s=arguments.length;i<s;i++)this.inject(arguments[i]);return this},extend:function(e){var t=function(){if(this.initialize)return this.initialize.apply(this,arguments)};t.prototype=u(this.prototype);t.toString=function(){return(this.prototype.initialize||function(){}).toString()};l(t.prototype,"constructor",{value:t,writable:true,configurable:true});h(t,this,true);return arguments.length?this.inject.apply(t,arguments):t}},true).inject({inject:function(){for(var e=0,t=arguments.length;e<t;e++)h(this,arguments[e],arguments[e].enumerable);return this},extend:function(){var e=u(this);return e.inject.apply(e,arguments)},each:function(e,t){return p(this,e,t)},clone:function(){return d(this)},statics:{each:p,clone:d,define:l,describe:c,create:function(e){return u(e.prototype)},isPlainObject:function(e){var t=e!==null&&typeof e==="object"&&Object.getPrototypeOf(e);return t&&(t===Object.prototype||t===Base.prototype)},check:function(e){return!!(e||e===0)},pick:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!==undefined)return arguments[e];return null},stop:{}}})};this.Base=Base.inject({generics:true,clone:function(){return new this.constructor(this)},toString:function(){return this._id!=null?(this._type||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+Base.each(this,function(e,t){if(!/^_/.test(t)){var n=typeof e;this.push(t+": "+(n==="number"?Format.number(e):n==="string"?"'"+e+"'":e))}},[]).join(", ")+" }"},exportJson:function(e){return Base.exportJson(this,e)},toJSON:function(){return Base.serialize(this)},_set:function(e){if(Base.isPlainObject(e)){for(var t in e)if(e.hasOwnProperty(t)&&t in this)this[t]=e[t];return true}},statics:{_types:{},_uid:0,extend:function(e){var t=this.base.apply(this,arguments);if(e._type)Base._types[e._type]=t;return t},equals:function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&typeof t[n]==="undefined")return false;return true}if(e==t)return true;if(e&&e.equals)return e.equals(t);if(t&&t.equals)return t.equals(e);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return false;for(var r=0,i=e.length;r<i;r++){if(!Base.equals(e[r],t[r]))return false}return true}if(e&&typeof e==="object"&&t&&typeof t==="object"){if(!n(e,t)||!n(t,e))return false;for(var r in e){if(e.hasOwnProperty(r)&&!Base.equals(e[r],t[r]))return false}return true}return false},read:function(e,t,n,r,i){if(this===Base){var s=this.peek(e,t);e._index++;e._read=1;return s}var o=this.prototype,u=o._readIndex,a=t||u&&e._index||0;if(!n)n=e.length-a;var f=e[a];if(f instanceof this||(o._readNull||i)&&f==null&&n<=1){if(u)e._index=a+1;return f&&r?f.clone():f}f=Base.create(this);if(u)f._read=true;f=f.initialize.apply(f,a>0||n<e.length?Array.prototype.slice.call(e,a,a+n):e)||f;if(u){e._index=a+f._read;e._read=f._read;delete f._read}return f},peek:function(e,t){return e[e._index=t||e._index||0]},readAll:function(e,t,n){var r=[],i;for(var s=t||0,o=e.length;s<o;s++){r.push(Array.isArray(i=e[s])?this.read(i,0,0,n):this.read(e,s,1,n))}return r},readNamed:function(e,t){var n=this.getNamed(e,t);return this.read(n!=null?[n]:e)},getNamed:function(e,t){var n=e[0];if(e._hasObject===undefined)e._hasObject=e.length===1&&Base.isPlainObject(n);if(e._hasObject)return t?n[t]:n},hasNamed:function(e,t){return!!this.getNamed(e,t)},serialize:function(e,t,n,r){t=t||{};var i=!r,s;if(i){r={length:0,definitions:{},references:{},add:function(e,t){var n="#"+e._id,r=this.references[n];if(!r){this.length++;this.definitions[n]=t.call(e);r=this.references[n]=[n]}return r}}}if(e&&e._serialize){s=e._serialize(t,r);if(e._type&&!n&&s[0]!==e._type)s.unshift(e._type)}else if(Array.isArray(e)){s=[];for(var o=0,u=e.length;o<u;o++)s[o]=Base.serialize(e[o],t,n,r)}else if(Base.isPlainObject(e)){s={};for(var o in e)if(e.hasOwnProperty(o))s[o]=Base.serialize(e[o],t,n,r)}else if(typeof e==="number"){s=Format.number(e,t.precision)}else{s=e}return i&&r.length>0?[["dictionary",r.definitions],s]:s},deserialize:function(e,t){var n=e;t=t||{};if(Array.isArray(e)){var r=e[0],i=r==="dictionary";if(!i){if(t.dictionary&&e.length==1&&/^#/.test(r))return t.dictionary[r];r=Base._types[r]}n=[];for(var s=r?1:0,o=e.length;s<o;s++)n.push(Base.deserialize(e[s],t));if(i){t.dictionary=n[0]}else if(r){var u=n;n=Base.create(r);n.initialize.apply(n,u)}}else if(Base.isPlainObject(e)){n={};for(var a in e)n[a]=Base.deserialize(e[a],t)}return n},exportJson:function(e,t){return JSON.stringify(Base.serialize(e,t))},importJson:function(e){return Base.deserialize(JSON.parse(e))},splice:function(e,t,n,r){var i=t&&t.length,s=n===undefined;n=s?e.length:n;if(n>e.length)n=e.length;for(var o=0;o<i;o++)t[o]._index=n+o;if(s){e.push.apply(e,t);return[]}else{var u=[n,r];if(t)u.push.apply(u,t);var a=e.splice.apply(e,u);for(var o=0,f=a.length;o<f;o++)delete a[o]._index;for(var o=n+i,f=e.length;o<f;o++)e[o]._index=o;return a}},merge:function(){return Base.each(arguments,function(e){Base.each(e,function(e,t){this[t]=e},this)},new Base,true)},capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Callback={attach:function(e,t){if(typeof e!=="string"){Base.each(e,function(e,t){this.attach(t,e)},this);return}var n=this._eventTypes[e];if(n){var r=this._handlers=this._handlers||{};r=r[e]=r[e]||[];if(r.indexOf(t)==-1){r.push(t);if(n.install&&r.length==1)n.install.call(this,e)}}},detach:function(e,t){if(typeof e!=="string"){Base.each(e,function(e,t){this.detach(t,e)},this);return}var n=this._eventTypes[e],r=this._handlers&&this._handlers[e],i;if(n&&r){if(!t||(i=r.indexOf(t))!=-1&&r.length==1){if(n.uninstall)n.uninstall.call(this,e);delete this._handlers[e]}else if(i!=-1){r.splice(i,1)}}},fire:function(e,t){var n=this._handlers&&this._handlers[e];if(!n)return false;var r=[].slice.call(arguments,1);Base.each(n,function(e){if(e.apply(this,r)===false&&t&&t.stop)t.stop()},this);return true},responds:function(e){return!!(this._handlers&&this._handlers[e])},statics:{inject:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e],r=n._events;if(r){var i={};Base.each(r,function(e,t){var r=typeof e==="string",s=r?e:t,o=Base.capitalize(s),u=s.substring(2).toLowerCase();i[u]=r?{}:e;s="_"+s;n["get"+o]=function(){return this[s]};n["set"+o]=function(e){if(e){this.attach(u,e)}else if(this[s]){this.detach(u,this[s])}this[s]=e}});n._eventTypes=i}this.base(n)}return this}}};var PaperScope=this.PaperScope=Base.extend({initialize:function(e){paper=this;this.project=null;this.projects=[];this.tools=[];this.palettes=[];this._id=e&&(e.getAttribute("id")||e.src)||"paperscope-"+PaperScope._id++;if(e)e.setAttribute("id",this._id);PaperScope._scopes[this._id]=this;if(!this.support){var t=CanvasProvider.getContext(1,1);PaperScope.prototype.support={nativeDash:"setLineDash"in t||"mozDash"in t};CanvasProvider.release(t)}},version:.8,getView:function(){return this.project&&this.project.view},getTool:function(){if(!this._tool)this._tool=new Tool;return this._tool},evaluate:function(e){var t=PaperScript.evaluate(e,this);View.updateFocus();return t},install:function(e){var t=this;Base.each(["project","view","tool"],function(n){Base.define(e,n,{configurable:true,writable:true,get:function(){return t[n]}})});for(var n in this){if(!/^(version|_id)/.test(n)&&!(n in e))e[n]=this[n]}},setup:function(e){paper=this;this.project=new Project(e);return this},clear:function(){for(var e=this.projects.length-1;e>=0;e--)this.projects[e].remove();for(var e=this.tools.length-1;e>=0;e--)this.tools[e].remove();for(var e=this.palettes.length-1;e>=0;e--)this.palettes[e].remove()},remove:function(){this.clear();delete PaperScope._scopes[this._id]},statics:{_scopes:{},_id:0,get:function(e){if(typeof e==="object")e=e.getAttribute("id");return this._scopes[e]||null}}});var PaperScopeItem=Base.extend(Callback,{initialize:function(e){this._scope=paper;this._index=this._scope[this._list].push(this)-1;if(e||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return false;var e=this._scope[this._reference];if(e&&e!=this)e.fire("deactivate");this._scope[this._reference]=this;this.fire("activate",e);return true},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return false;Base.splice(this._scope[this._list],null,this._index,1);if(this._scope[this._reference]==this)this._scope[this._reference]=null;this._scope=null;return true}});var Point=this.Point=Base.extend({_type:"Point",_readIndex:true,initialize:function(e,t){var n=typeof e;if(n==="number"){var r=typeof t==="number";this.x=e;this.y=r?t:e;if(this._read)this._read=r?2:1}else if(n==="undefined"||e===null){this.x=this.y=0;if(this._read)this._read=e===null?1:0}else{if(Array.isArray(e)){this.x=e[0];this.y=e.length>1?e[1]:e[0]}else if(e.x!=null){this.x=e.x;this.y=e.y}else if(e.width!=null){this.x=e.width;this.y=e.height}else if(e.angle!=null){this.x=e.length;this.y=0;this.setAngle(e.angle)}else{this.x=this.y=0;if(this._read)this._read=0}if(this._read)this._read=1}},set:function(e,t){this.x=e;this.y=t;return this},equals:function(e){e=Point.read(arguments);return this.x==e.x&&this.y==e.y},clone:function(){return Point.create(this.x,this.y)},toString:function(){var e=Format.number;return"{ x: "+e(this.x)+", y: "+e(this.y)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.x,n),t(this.y,n)]},add:function(e){e=Point.read(arguments);return Point.create(this.x+e.x,this.y+e.y)},subtract:function(e){e=Point.read(arguments);return Point.create(this.x-e.x,this.y-e.y)},multiply:function(e){e=Point.read(arguments);return Point.create(this.x*e.x,this.y*e.y)},divide:function(e){e=Point.read(arguments);return Point.create(this.x/e.x,this.y/e.y)},modulo:function(e){e=Point.read(arguments);return Point.create(this.x%e.x,this.y%e.y)},negate:function(){return Point.create(-this.x,-this.y)},transform:function(e){return e?e._transformPoint(this):this},getDistance:function(e,t){e=Point.read(arguments);var n=e.x-this.x,r=e.y-this.y,i=n*n+r*r;return t?i:Math.sqrt(i)},getLength:function(){var e=this.x*this.x+this.y*this.y;return arguments.length&&arguments[0]?e:Math.sqrt(e)},setLength:function(e){if(this.isZero()){var t=this._angle||0;this.set(Math.cos(t)*e,Math.sin(t)*e)}else{var n=e/this.getLength();if(n==0)this.getAngle();this.set(this.x*n,this.y*n)}return this},normalize:function(e){if(e===undefined)e=1;var t=this.getLength(),n=t!=0?e/t:0,r=Point.create(this.x*n,this.y*n);r._angle=this._angle;return r},getAngle:function(){return this.getAngleInRadians(arguments[0])*180/Math.PI},setAngle:function(e){e=this._angle=e*Math.PI/180;if(!this.isZero()){var t=this.getLength();this.set(Math.cos(e)*t,Math.sin(e)*t)}return this},getAngleInRadians:function(){if(arguments[0]===undefined){if(this._angle==null)this._angle=Math.atan2(this.y,this.x);return this._angle}else{var e=Point.read(arguments),t=this.getLength()*e.getLength();if(Numerical.isZero(t)){return NaN}else{return Math.acos(this.dot(e)/t)}}},getAngleInDegrees:function(){return this.getAngle(arguments[0])},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3},getDirectedAngle:function(e){e=Point.read(arguments);return Math.atan2(this.cross(e),this.dot(e))*180/Math.PI},rotate:function(e,t){if(e===0)return this.clone();e=e*Math.PI/180;var n=t?this.subtract(t):this,r=Math.sin(e),i=Math.cos(e);n=Point.create(n.x*i-n.y*r,n.y*i+n.x*r);return t?n.add(t):n},isInside:function(e){return e.contains(this)},isClose:function(e,t){return this.getDistance(e)<t},isColinear:function(e){return this.cross(e)<1e-5},isOrthogonal:function(e){return this.dot(e)<1e-5},isZero:function(){return Numerical.isZero(this.x)&&Numerical.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(e){e=Point.read(arguments);return this.x*e.x+this.y*e.y},cross:function(e){e=Point.read(arguments);return this.x*e.y-this.y*e.x},project:function(e){e=Point.read(arguments);if(e.isZero()){return Point.create(0,0)}else{var t=this.dot(e)/e.dot(e);return Point.create(e.x*t,e.y*t)}},statics:{create:function(e,t){var n=Base.create(Point);n.x=e;n.y=t;return n},min:function(e,t){var n=Point.read(arguments);_point2=Point.read(arguments);return Point.create(Math.min(n.x,_point2.x),Math.min(n.y,_point2.y))},max:function(e,t){var n=Point.read(arguments);_point2=Point.read(arguments);return Point.create(Math.max(n.x,_point2.x),Math.max(n.y,_point2.y))},random:function(){return Point.create(Math.random(),Math.random())}}},new function(){return Base.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return Point.create(t(this.x),t(this.y))}},{})});var LinkedPoint=Point.extend({set:function(e,t,n){this._x=e;this._y=t;if(!n)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(e){this._x=e;this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e;this._owner[this._setter](this)},statics:{create:function(e,t,n,r,i){if(i)return Point.create(n,r);var s=Base.create(LinkedPoint);s._x=n;s._y=r;s._owner=e;s._setter=t;return s}}});var Size=this.Size=Base.extend({_type:"Size",_readIndex:true,initialize:function(e,t){var n=typeof e;if(n==="number"){var r=typeof t==="number";this.width=e;this.height=r?t:e;if(this._read)this._read=r?2:1}else if(n==="undefined"||e===null){this.width=this.height=0;if(this._read)this._read=e===null?1:0}else{if(Array.isArray(e)){this.width=e[0];this.height=e.length>1?e[1]:e[0]}else if(e.width!=null){this.width=e.width;this.height=e.height}else if(e.x!=null){this.width=e.x;this.height=e.y}else{this.width=this.height=0;if(this._read)this._read=0}if(this._read)this._read=1}},set:function(e,t){this.width=e;this.height=t;return this},equals:function(e){e=Size.read(arguments);return this.width==e.width&&this.height==e.height},clone:function(){return Size.create(this.width,this.height)},toString:function(){var e=Format.number;return"{ width: "+e(this.width)+", height: "+e(this.height)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.width,n),t(this.height,n)]},add:function(e){e=Size.read(arguments);return Size.create(this.width+e.width,this.height+e.height)},subtract:function(e){e=Size.read(arguments);return Size.create(this.width-e.width,this.height-e.height)},multiply:function(e){e=Size.read(arguments);return Size.create(this.width*e.width,this.height*e.height)},divide:function(e){e=Size.read(arguments);return Size.create(this.width/e.width,this.height/e.height)},modulo:function(e){e=Size.read(arguments);return Size.create(this.width%e.width,this.height%e.height)},negate:function(){return Size.create(-this.width,-this.height)},isZero:function(){return Numerical.isZero(this.width)&&Numerical.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{create:function(e,t){return Base.create(Size).set(e,t)},min:function(e,t){return Size.create(Math.min(e.width,t.width),Math.min(e.height,t.height))},max:function(e,t){return Size.create(Math.max(e.width,t.width),Math.max(e.height,t.height))},random:function(){return Size.create(Math.random(),Math.random())}}},new function(){return Base.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return Size.create(t(this.width),t(this.height))}},{})});var LinkedSize=Size.extend({set:function(e,t,n){this._width=e;this._height=t;if(!n)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(e){this._width=e;this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e;this._owner[this._setter](this)},statics:{create:function(e,t,n,r,i){if(i)return Size.create(n,r);var s=Base.create(LinkedSize);s._width=n;s._height=r;s._owner=e;s._setter=t;return s}}});var Rectangle=this.Rectangle=Base.extend({_type:"Rectangle",_readIndex:true,initialize:function(e,t,n,r){var i=typeof e,s=0;if(i==="number"){this.x=e;this.y=t;this.width=n;this.height=r;s=4}else if(i==="undefined"||e===null){this.x=this.y=this.width=this.height=0;s=e===null?1:0}else if(arguments.length===1){if(Array.isArray(e)){this.x=e[0];this.y=e[1];this.width=e[2];this.height=e[3];s=1}else if(e.x!==undefined||e.width!==undefined){this.x=e.x||0;this.y=e.y||0;this.width=e.width||0;this.height=e.height||0;s=1}else if(e.from===undefined&&e.to===undefined){this.x=this.y=this.width=this.height=0;this._set(e);s=1}}if(!s){var o=Point.readNamed(arguments,"from"),u=Base.peek(arguments);this.x=o.x;this.y=o.y;if(u&&u.x!==undefined||Base.hasNamed(arguments,"to")){var a=Point.readNamed(arguments,"to");this.width=a.x-o.x;this.height=a.y-o.y;if(this.width<0){this.x=a.x;this.width=-this.width}if(this.height<0){this.y=a.y;this.height=-this.height}}else{var f=Size.read(arguments);this.width=f.width;this.height=f.height}s=arguments._index}if(this._read)this._read=s},set:function(e,t,n,r){this.x=e;this.y=t;this.width=n;this.height=r;return this},clone:function(){return Rectangle.create(this.x,this.y,this.width,this.height)},equals:function(e){e=Rectangle.read(arguments);return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},toString:function(){var e=Format.number;return"{ x: "+e(this.x)+", y: "+e(this.y)+", width: "+e(this.width)+", height: "+e(this.height)+" }"},_serialize:function(e){var t=Format.number,n=e.precision;return[t(this.x,n),t(this.y,n),t(this.width,n),t(this.height,n)]},getPoint:function(){return LinkedPoint.create(this,"setPoint",this.x,this.y,arguments[0])},setPoint:function(e){e=Point.read(arguments);this.x=e.x;this.y=e.y},getSize:function(){return LinkedSize.create(this,"setSize",this.width,this.height,arguments[0])},setSize:function(e){e=Size.read(arguments);this.width=e.width;this.height=e.height},getLeft:function(){return this.x},setLeft:function(e){this.width-=e-this.x;this.x=e},getTop:function(){return this.y},setTop:function(e){this.height-=e-this.y;this.y=e},getRight:function(){return this.x+this.width},setRight:function(e){this.width=e-this.x},getBottom:function(){return this.y+this.height},setBottom:function(e){this.height=e-this.y},getCenterX:function(){return this.x+this.width*.5},setCenterX:function(e){this.x=e-this.width*.5},getCenterY:function(){return this.y+this.height*.5},setCenterY:function(e){this.y=e-this.height*.5},getCenter:function(){return LinkedPoint.create(this,"setCenter",this.getCenterX(),this.getCenterY(),arguments[0])},setCenter:function(e){e=Point.read(arguments);this.setCenterX(e.x);this.setCenterY(e.y);return this},isEmpty:function(){return this.width==0||this.height==0},contains:function(e){return e&&e.width!==undefined||(Array.isArray(e)?e:arguments).length==4?this._containsRectangle(Rectangle.read(arguments)):this._containsPoint(Point.read(arguments))},_containsPoint:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t+e.width<=this.x+this.width&&n+e.height<=this.y+this.height},intersects:function(e){e=Rectangle.read(arguments);return e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x+this.width&&e.y<this.y+this.height},intersect:function(e){e=Rectangle.read(arguments);var t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),r=Math.min(this.x+this.width,e.x+e.width),i=Math.min(this.y+this.height,e.y+e.height);return Rectangle.create(t,n,r-t,i-n)},unite:function(e){e=Rectangle.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x+e.width),i=Math.max(this.y+this.height,e.y+e.height);return Rectangle.create(t,n,r-t,i-n)},include:function(e){e=Point.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x),i=Math.max(this.y+this.height,e.y);return Rectangle.create(t,n,r-t,i-n)},expand:function(e,t){if(t===undefined)t=e;return Rectangle.create(this.x-e/2,this.y-t/2,this.width+e,this.height+t)},scale:function(e,t){return this.expand(this.width*e-this.width,this.height*(t===undefined?e:t)-this.height)},statics:{create:function(e,t,n,r){return Base.create(Rectangle).set(e,t,n,r)}}},new function(){return Base.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,t){var n=e.join("");var r=/^[RL]/.test(n);if(t>=4)e[1]+=r?"Y":"X";var i=e[r?0:1],s=e[r?1:0],o="get"+i,u="get"+s,a="set"+i,f="set"+s,l="get"+n,c="set"+n;this[l]=function(){return LinkedPoint.create(this,c,this[o](),this[u](),arguments[0])};this[c]=function(e){e=Point.read(arguments);this[a](e.x);this[f](e.y)}},{})});var LinkedRectangle=Rectangle.extend({set:function(e,t,n,r,i){this._x=e;this._y=t;this._width=n;this._height=r;if(!i)this._owner[this._setter](this);return this},statics:{create:function(e,t,n,r,i,s){var o=Base.create(LinkedRectangle).set(n,r,i,s,true);o._owner=e;o._setter=t;return o}}},new function(){var e=Rectangle.prototype;return Base.each(["x","y","width","height"],function(e){var t=Base.capitalize(e);var n="_"+e;this["get"+t]=function(){return this[n]};this["set"+t]=function(e){this[n]=e;if(!this._dontNotify)this._owner[this._setter](this)}},Base.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(t){var n="set"+t;this[n]=function(t){this._dontNotify=true;e[n].apply(this,arguments);delete this._dontNotify;this._owner[this._setter](this)}},{isSelected:function(){return this._owner._boundsSelected},setSelected:function(e){var t=this._owner;if(t.setSelected){t._boundsSelected=e;t.setSelected(e||t._selectedSegmentState>0)}}}))});var Matrix=this.Matrix=Base.extend({_type:"Matrix",initialize:function(e){var t=arguments.length,n=true;if(t==6){this.set.apply(this,arguments)}else if(t==1){if(e instanceof Matrix){this.set(e._a,e._c,e._b,e._d,e._tx,e._ty)}else if(Array.isArray(e)){this.set.apply(this,e)}else{n=false}}else if(t==0){this.reset()}else{n=false}if(!n)throw new Error("Unsupported matrix parameters")},set:function(e,t,n,r,i,s){this._a=e;this._c=t;this._b=n;this._d=r;this._tx=i;this._ty=s;return this},_serialize:function(e){return Base.serialize(this.getValues(),e)},clone:function(){return Matrix.create(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(e){return e&&this._a==e._a&&this._b==e._b&&this._c==e._c&&this._d==e._d&&this._tx==e._tx&&this._ty==e._ty},toString:function(){var e=Format.number;return"[["+[e(this._a),e(this._b),e(this._tx)].join(", ")+"], ["+[e(this._c),e(this._d),e(this._ty)].join(", ")+"]]"},reset:function(){this._a=this._d=1;this._c=this._b=this._tx=this._ty=0;return this},scale:function(e,t){var n=Point.read(arguments),r=Point.read(arguments,0,0,false,true);if(r)this.translate(r);this._a*=n.x;this._c*=n.x;this._b*=n.y;this._d*=n.y;if(r)this.translate(r.negate());return this},translate:function(e){e=Point.read(arguments);var t=e.x,n=e.y;this._tx+=t*this._a+n*this._b;this._ty+=t*this._c+n*this._d;return this},rotate:function(e,t){t=Point.read(arguments,1);e=e*Math.PI/180;var n=t.x,r=t.y,i=Math.cos(e),s=Math.sin(e),o=n-n*i+r*s,u=r-n*s-r*i,a=this._a,f=this._b,l=this._c,c=this._d;this._a=i*a+s*f;this._b=-s*a+i*f;this._c=i*l+s*c;this._d=-s*l+i*c;this._tx+=o*a+u*f;this._ty+=o*l+u*c;return this},shear:function(e,t){var n=Point.read(arguments),r=Point.read(arguments);if(r)this.translate(r);var i=this._a,s=this._c;this._a+=n.y*this._b;this._c+=n.y*this._d;this._b+=n.x*i;this._d+=n.x*s;if(r)this.translate(r.negate());return this},isIdentity:function(){return this._a==1&&this._c==0&&this._b==0&&this._d==1&&this._tx==0&&this._ty==0},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},concatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d;this._a=e._a*t+e._c*n;this._b=e._b*t+e._d*n;this._c=e._a*r+e._c*i;this._d=e._b*r+e._d*i;this._tx+=e._tx*t+e._ty*n;this._ty+=e._tx*r+e._ty*i;return this},preConcatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d,s=this._tx,o=this._ty;this._a=e._a*t+e._b*r;this._b=e._a*n+e._b*i;this._c=e._c*t+e._d*r;this._d=e._c*n+e._d*i;this._tx=e._a*s+e._b*o+e._tx;this._ty=e._c*s+e._d*o+e._ty;return this},transform:function(e,t,n,r,i){return arguments.length<5?this._transformPoint(Point.read(arguments)):this._transformCoordinates(e,t,n,r,i)},_transformPoint:function(e,t,n){var r=e.x,i=e.y;if(!t)t=Base.create(Point);return t.set(r*this._a+i*this._b+this._tx,r*this._c+i*this._d+this._ty,n)},_transformCoordinates:function(e,t,n,r,i){var s=t,o=r,u=t+2*i;while(s<u){var a=e[s++],f=e[s++];n[o++]=a*this._a+f*this._b+this._tx;n[o++]=a*this._c+f*this._d+this._ty}return n},_transformCorners:function(e){var t=e.x,n=e.y,r=t+e.width,i=n+e.height,s=[t,n,r,n,r,i,t,i];return this._transformCoordinates(s,0,s,0,4)},_transformBounds:function(e,t,n){var r=this._transformCorners(e),i=r.slice(0,2),s=r.slice(0);for(var o=2;o<8;o++){var u=r[o],a=o&1;if(u<i[a])i[a]=u;else if(u>s[a])s[a]=u}if(!t)t=Base.create(Rectangle);return t.set(i[0],i[1],s[0]-i[0],s[1]-i[1],n)},inverseTransform:function(e){return this._inverseTransform(Point.read(arguments))},_getDeterminant:function(){var e=this._a*this._d-this._b*this._c;return isFinite(e)&&!Numerical.isZero(e)&&isFinite(this._tx)&&isFinite(this._ty)?e:null},_inverseTransform:function(e,t,n){var r=this._getDeterminant();if(!r)return null;var i=e.x-this._tx,s=e.y-this._ty;if(!t)t=Base.create(Point);return t.set((i*this._d-s*this._b)/r,(s*this._a-i*this._c)/r,n)},decompose:function(){var e=this._a,t=this._b,n=this._c,r=this._d;if(Numerical.isZero(e*r-t*n))return null;var i=Math.sqrt(e*e+t*t);e/=i;t/=i;var s=e*n+t*r;n-=e*s;r-=t*s;var o=Math.sqrt(n*n+r*r);n/=o;r/=o;s/=o;if(e*r<t*n){e=-e;t=-t;s=-s;i=-i}return{translation:this.getTranslation(),scaling:Point.create(i,o),rotation:-Math.atan2(t,e)*180/Math.PI,shearing:s}},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return Point.create(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var e=this._getDeterminant();return e&&Matrix.create(this._d/e,-this._c/e,-this._b/e,this._a/e,(this._b*this._ty-this._d*this._tx)/e,(this._c*this._tx-this._a*this._ty)/e)},shiftless:function(){return Matrix.create(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(e,t){e[t?"setTransform":"transform"](this._a,this._c,this._b,this._d,this._tx,this._ty);return this},statics:{create:function(e,t,n,r,i,s){return Base.create(Matrix).set(e,t,n,r,i,s)}}},new function(){return Base.each({scaleX:"_a",scaleY:"_d",translateX:"_tx",translateY:"_ty",shearX:"_b",shearY:"_c"},function(e,t){t=Base.capitalize(t);this["get"+t]=function(){return this[e]};this["set"+t]=function(t){this[e]=t}},{})});var Line=this.Line=Base.extend({initialize:function(e,t,n){var r=Point.read(arguments),i=Point.read(arguments),s=Base.read(arguments);if(s!==undefined){this.point=r;this.vector=i.subtract(r);this.infinite=s}else{this.point=r;this.vector=i;this.infinite=true}},intersect:function(e){var t=this.vector.cross(e.vector);if(Numerical.isZero(t))return null;var n=e.point.subtract(this.point),r=n.cross(e.vector)/t,i=n.cross(this.vector)/t;return(this.infinite||0<=r&&r<=1)&&(e.infinite||0<=i&&i<=1)?this.point.add(this.vector.multiply(r)):null},getSide:function(e){var t=this.vector,n=e.subtract(this.point),r=n.cross(t);if(r===0){r=n.dot(t);if(r>0){r=n.subtract(t).dot(t);if(r<0)r=0}}return r<0?-1:r>0?1:0},getDistance:function(e){var t=this.vector.y/this.vector.x,n=this.point.y-t*this.point.x;var r=Math.abs(e.y-t*e.x-n)/Math.sqrt(t*t+1);return this.infinite?r:Math.min(r,e.getDistance(this.point),e.getDistance(this.point.add(this.vector)))}});var Project=this.Project=PaperScopeItem.extend({_list:"projects",_reference:"project",initialize:function(e){this.base(true);this.layers=[];this.symbols=[];this.activeLayer=new Layer;if(e)this.view=e instanceof View?e:View.create(e);this._currentStyle=new PathStyle;this._selectedItems={};this._selectedItemCount=0;this._drawCount=0;this.options={}},_serialize:function(e,t){return Base.serialize(this.layers,e,false,t)},_needsRedraw:function(){if(this.view)this.view._redrawNeeded=true},remove:function(){if(!this.base())return false;if(this.view)this.view.remove();return true},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.initialize(e)},getIndex:function(){return this._index},getSelectedItems:function(){var e=[];for(var t in this._selectedItems){var n=this._selectedItems[t];if(n._drawCount===this._drawCount)e.push(n)}return e},_updateSelection:function(e){if(e._selected){this._selectedItemCount++;this._selectedItems[e._id]=e;if(e.isInserted())e._drawCount=this._drawCount}else{this._selectedItemCount--;delete this._selectedItems[e._id]}},selectAll:function(){for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].setSelected(true)},deselectAll:function(){for(var e in this._selectedItems)this._selectedItems[e].setSelected(false)},hitTest:function(e,t){e=Point.read(arguments);t=HitResult.getOptions(Base.read(arguments));for(var n=this.layers.length-1;n>=0;n--){var r=this.layers[n].hitTest(e,t);if(r)return r}return null},importJson:function(e){return Base.importJson(e)},draw:function(e,t){function r(e,t,i){var s=i&&n[e._id];if(s)return s.clone();if(e._parent)t=r(e._parent,t,true);if(!e._matrix.isIdentity())t.concatenate(e._matrix);if(i)n[e._id]=t.clone();return t}var n={};this._drawCount++;e.save();if(!t.isIdentity())t.applyToContext(e);var i={offset:new Point(0,0)};for(var s=0,o=this.layers.length;s<o;s++)Item.draw(this.layers[s],e,i);e.restore();if(this._selectedItemCount>0){e.save();e.strokeWidth=1;e.strokeStyle=e.fillStyle="#009dec";for(var u in this._selectedItems){var a=this._selectedItems[u];if(a._drawCount===this._drawCount&&(a.drawSelected||a._boundsSelected)){var f=r(a,t.clone());if(a.drawSelected)a.drawSelected(e,f);if(a._boundsSelected)Item.drawSelectedBounds(a._getBounds("getBounds"),e,f)}}e.restore()}}});var Symbol=this.Symbol=Base.extend({_type:"Symbol",initialize:function(e,t){this._id=++Base._uid;this.project=paper.project;this.project.symbols.push(this);if(e)this.setDefinition(e,t);this._instances={}},_serialize:function(e,t){return t.add(this,function(){return Base.serialize([this._type,this._definition],e,false,t)})},_changed:function(e){Base.each(this._instances,function(t){t._changed(e)})},getDefinition:function(){return this._definition},setDefinition:function(e){if(e._parentSymbol)e=e.clone();if(this._definition)delete this._definition._parentSymbol;this._definition=e;e.remove();e.setSelected(false);if(!arguments[1])e.setPosition(new Point);e._parentSymbol=this;this._changed(5)},place:function(e){return new PlacedSymbol(this,e)},clone:function(){return new Symbol(this._definition.clone())}});var Item=this.Item=Base.extend(Callback,{statics:{extend:function(e){if(e._serializeFields)e._serializeFields=Base.merge(this.prototype._serializeFields,e._serializeFields);return this.base.apply(this,arguments)}}},{_boundsSelected:false,_serializeFields:{name:null,matrix:new Matrix,locked:false,visible:true,blendMode:"normal",opacity:1,guide:false,clipMask:false,data:{}},initialize:function(e){this._id=++Base._uid;if(!this._project)paper.project.activeLayer.addChild(this);if(!this._style)this._style=PathStyle.create(this);this.setStyle(this._project.getCurrentStyle());this._matrix=new Matrix;if(e)this._matrix.translate(e)},_events:new function(){var e={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};var t={install:function(t){var n=this._project.view._eventCounters;if(n){for(var r in e){n[r]=(n[r]||0)+(e[r][t]||0)}}},uninstall:function(t){var n=this._project.view._eventCounters;if(n){for(var r in e)n[r]-=e[r][t]||0}}};return Base.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],function(e){this[e]=t},{onFrame:{install:function(){this._project.view._animateItem(this,true)},uninstall:function(){this._project.view._animateItem(this,false)}},onLoad:{}})},_serialize:function(e,t){function i(i,s){for(var o in i){var u=r[o];if(!Base.equals(u,i[o]))n[o]=Base.serialize(u,e,s&&o!=="data",t)}}var n={},r=this;i(this._serializeFields,true);if(!(this instanceof Group))i(this._style._defaults,false);return[this._type,n]},_changed:function(e){if(e&4){delete this._bounds;delete this._position}if(this._parent&&e&(4|8)){this._parent._clearBoundsCache()}if(e&2){this._clearBoundsCache()}if(e&1){this._project._needsRedraw()}if(this._parentSymbol)this._parentSymbol._changed(e);if(this._project._changes){var t=this._project._changesById[this._id];if(t){t.flags|=e}else{t={item:this,flags:e};this._project._changesById[this._id]=t;this._project._changes.push(t)}}},set:function(e){this._set(e);return this},getId:function(){return this._id},getType:function(){return this._type},getName:function(){return this._name},setName:function(e,t){if(this._name)this._removeFromNamed();if(e&&this._parent){var n=this._parent._children,r=this._parent._namedChildren,i=e,s=1;while(t&&n[e])e=i+" "+s++;(r[e]=r[e]||[]).push(this);n[e]=this}this._name=e||undefined;this._changed(32)}},Base.each(["locked","visible","blendMode","opacity","guide"],function(e){var t=Base.capitalize(e),e="_"+e;this["get"+t]=function(){return this[e]};this["set"+t]=function(t){if(t!=this[e]){this[e]=t;this._changed(e==="_locked"?32:33)}}},{}),{_locked:false,_visible:true,_blendMode:"normal",_opacity:1,_guide:false,applyMatrix:false,isSelected:function(){if(this._children){for(var e=0,t=this._children.length;e<t;e++)if(this._children[e].isSelected())return true}return this._selected},setSelected:function(e){if(this._children&&!arguments[1]){for(var t=0,n=this._children.length;t<n;t++)this._children[t].setSelected(e)}if((e=!!e)!=this._selected){this._selected=e;this._project._updateSelection(this);this._changed(33)}},_selected:false,isFullySelected:function(){if(this._children&&this._selected){for(var e=0,t=this._children.length;e<t;e++)if(!this._children[e].isFullySelected())return false;return true}return this._selected},setFullySelected:function(e){if(this._children){for(var t=0,n=this._children.length;t<n;t++)this._children[t].setFullySelected(e)}this.setSelected(e,true)},isClipMask:function(){return this._clipMask},setClipMask:function(e){if(this._clipMask!=(e=!!e)){this._clipMask=e;if(e){this.setFillColor(null);this.setStrokeColor(null)}this._changed(33);if(this._parent)this._parent._changed(256)}},_clipMask:false,getData:function(){if(!this._data)this._data={};return this._data},setData:function(e){this._data=e},getPosition:function(){var e=this._position||(this._position=this.getBounds().getCenter(true));return arguments[0]?e:LinkedPoint.create(this,"setPosition",e.x,e.y)},setPosition:function(e){this.translate(Point.read(arguments).subtract(this.getPosition(true)))},getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix.initialize(e);this._changed(5)},isEmpty:function(){return this._children.length==0}},Base.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){var t=this._boundsGetter,n=this._getCachedBounds(typeof t=="string"?t:t&&t[e]||e,arguments[0]);return e=="getBounds"?LinkedRectangle.create(this,"setBounds",n.x,n.y,n.width,n.height):n}},{_getCachedBounds:function(e,t,n){var r=(!t||t.equals(this._matrix))&&e;if(n&&this._parent){var i=n._id,s=this._parent._boundsCache=this._parent._boundsCache||{ids:{},list:[]};if(!s.ids[i]){s.list.push(n);s.ids[i]=n}}if(r&&this._bounds&&this._bounds[r])return this._bounds[r].clone();var o=this._matrix.isIdentity();t=!t||t.isIdentity()?o?null:this._matrix:o?t:t.clone().concatenate(this._matrix);var u=this._getBounds(e,t,r?this:n);if(r){if(!this._bounds)this._bounds={};this._bounds[r]=u.clone()}return u},_clearBoundsCache:function(){if(this._boundsCache){for(var e=0,t=this._boundsCache.list,n=t.length;e<n;e++){var r=t[e];delete r._bounds;if(r!=this&&r._boundsCache)r._clearBoundsCache()}delete this._boundsCache}},_getBounds:function(e,t,n){var r=this._children;if(!r||r.length==0)return new Rectangle;var i=Infinity,s=-i,o=i,u=s;for(var a=0,f=r.length;a<f;a++){var l=r[a];if(l._visible&&!l.isEmpty()){var c=l._getCachedBounds(e,t,n);i=Math.min(c.x,i);o=Math.min(c.y,o);s=Math.max(c.x+c.width,s);u=Math.max(c.y+c.height,u)}}return Rectangle.create(i,o,s-i,u-o)},setBounds:function(e){e=Rectangle.read(arguments);var t=this.getBounds(),n=new Matrix,r=e.getCenter();n.translate(r);if(e.width!=t.width||e.height!=t.height){n.scale(t.width!=0?e.width/t.width:1,t.height!=0?e.height/t.height:1)}r=t.getCenter();n.translate(-r.x,-r.y);this.transform(n)}}),{getProject:function(){return this._project},_setProject:function(e){if(this._project!=e){this._project=e;if(this._children){for(var t=0,n=this._children.length;t<n;t++){this._children[t]._setProject(e)}}}},getLayer:function(){var e=this;while(e=e._parent){if(e instanceof Layer)return e}return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},getChildren:function(){return this._children},setChildren:function(e){this.removeChildren();this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},isInserted:function(){return this._parent?this._parent.isInserted():false},clone:function(){return this._clone(new this.constructor)},_clone:function(e){e.setStyle(this._style);if(this._children){for(var t=0,n=this._children.length;t<n;t++)e.addChild(this._children[t].clone(),true)}var r=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide","applyMatrix"];for(var t=0,n=r.length;t<n;t++){var i=r[t];if(this.hasOwnProperty(i))e[i]=this[i]}e._matrix.initialize(this._matrix);e.setSelected(this._selected);if(this._name)e.setName(this._name,true);return e},copyTo:function(e){var t=this.clone();if(e.layers){e.activeLayer.addChild(t)}else{e.addChild(t)}return t},rasterize:function(e){var t=this.getStrokeBounds(),n=(e||72)/72,r=CanvasProvider.getCanvas(t.getSize().multiply(n)),i=r.getContext("2d");(new Matrix).scale(n).translate(-t.x,-t.y).applyToContext(i);Item.draw(this,i,{});var s=new Raster(r);s.setBounds(t);return s},hitTest:function(e,t){function n(n,s){var o=r["get"+s]();if(e.getDistance(o)<t.tolerance)return new HitResult(n,i,{name:Base.hyphenate(s),point:o})}if(this._locked)return null;e=Point.read(arguments);t=HitResult.getOptions(Base.read(arguments));if(!this._children&&!this.getRoughBounds().expand(t.tolerance)._containsPoint(e))return null;e=this._matrix._inverseTransform(e);if((t.center||t.bounds)&&!(this instanceof Layer&&!this._parent)){var r=this.getBounds(),i=this,s=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],o;if(t.center&&(o=n("center","Center")))return o;if(t.bounds){for(var u=0;u<8;u++)if(o=n("bounds",s[u]))return o}}return this._children||!(t.guides&&!this._guide||t.selected&&!this._selected)?this._hitTest(e,t):null},_hitTest:function(e,t){if(this._children){for(var n=this._children.length-1;n>=0;n--){var r=this._children[n].hitTest(e,t);if(r)return r}}},addChild:function(e,t){return this.insertChild(undefined,e,t)},insertChild:function(e,t,n){if(this._children){t._remove(true);Base.splice(this._children,[t],e,0);t._parent=this;t._setProject(this._project);if(t._name)t.setName(t._name);this._changed(3);return t}return null},addChildren:function(e,t){return this.insertChildren(this._children.length,e,t)},insertChildren:function(e,t,n){t=t&&Array.prototype.slice.apply(t);var r=this._children,i=r.length,s=e;for(var o=0,u=t&&t.length;o<u;o++){if(this.insertChild(s,t[o],n)){var a=r.length;s+=a-i;i=a}}return s!=e},insertAbove:function(e,t){var n=e._index;if(e._parent==this._parent&&n<this._index)n++;return e._parent.insertChild(n,this,t)},insertBelow:function(e,t){var n=e._index;if(e._parent==this._parent&&n>this._index)n--;return e._parent.insertChild(n,this,t)},sendToBack:function(){return this._parent.insertChild(0,this)},bringToFront:function(){return this._parent.addChild(this)},appendTop:function(e){return this.addChild(e)},appendBottom:function(e){return this.insertChild(0,e)},moveAbove:function(e){return this.insertAbove(e)},moveBelow:function(e){return this.insertBelow(e)},_removeFromNamed:function(){var e=this._parent._children,t=this._parent._namedChildren,n=this._name,r=t[n],i=r?r.indexOf(this):-1;if(i==-1)return;if(e[n]==this)delete e[n];r.splice(i,1);if(r.length){e[n]=r[r.length-1]}else{delete t[n]}},_remove:function(e){if(this._parent){if(this._name)this._removeFromNamed();if(this._index!=null)Base.splice(this._parent._children,null,this._index,1);if(e)this._parent._changed(3);this._parent=null;return true}return false},remove:function(){return this._remove(true)},removeChildren:function(e,t){if(!this._children)return null;e=e||0;t=Base.pick(t,this._children.length);var n=Base.splice(this._children,null,e,t-e);for(var r=n.length-1;r>=0;r--)n[r]._remove(false);if(n.length>0)this._changed(3);return n},reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,t=this._children.length;e<t;e++)this._children[e]._index=e;this._changed(3)}},isEditable:function(){var e=this;while(e){if(!e._visible||e._locked)return false;e=e._parent}return true},_getOrder:function(e){function t(e){var t=[];do{t.unshift(e)}while(e=e._parent);return t}var n=t(this),r=t(e);for(var i=0,s=Math.min(n.length,r.length);i<s;i++){if(n[i]!=r[i]){return n[i]._index<r[i]._index?1:-1}}return 0},hasChildren:function(){return this._children&&this._children.length>0},isAbove:function(e){return this._getOrder(e)==-1},isBelow:function(e){return this._getOrder(e)==1},isParent:function(e){return this._parent==e},isChild:function(e){return e&&e._parent==this},isDescendant:function(e){var t=this;while(t=t._parent){if(t==e)return true}return false},isAncestor:function(e){return e?e.isDescendant(this):false},isGroupedWith:function(e){var t=this._parent;while(t){if(t._parent&&(t instanceof Group||t instanceof CompoundPath)&&e.isDescendant(t))return true;t=t._parent}return false},scale:function(e,t,n){if(arguments.length<2||typeof t==="object"){n=t;t=e}return this.transform((new Matrix).scale(e,t,n||this.getPosition(true)))},translate:function(e){var t=new Matrix;return this.transform(t.translate.apply(t,arguments))},rotate:function(e,t){return this.transform((new Matrix).rotate(e,t||this.getPosition(true)))},shear:function(e,t,n){if(arguments.length<2||typeof t==="object"){n=t;t=e}return this.transform((new Matrix).shear(e,t,n||this.getPosition(true)))},transform:function(e){var t=this._bounds,n=this._position;this._matrix.preConcatenate(e);if(this._transform)this._transform(e);if((this.applyMatrix||arguments[1])&&this._applyMatrix(this._matrix))this._matrix.reset();this._changed(5);if(t&&e.getRotation()%90===0){for(var r in t){var i=t[r];e._transformBounds(i,i)}var s=this._boundsGetter,i=t[s&&s.getBounds||s||"getBounds"];if(i)this._position=i.getCenter(true);this._bounds=t}else if(n){this._position=e._transformPoint(n,n)}return this},_applyMatrix:function(e){if(this._children){for(var t=0,n=this._children.length;t<n;t++)this._children[t].transform(e,true);return true}},fitBounds:function(e,t){e=Rectangle.read(arguments);var n=this.getBounds(),r=n.height/n.width,i=e.height/e.width,s=(t?r>i:r<i)?e.width/n.width:e.height/n.height,o=new Rectangle(new Point,Size.create(n.width*s,n.height*s));o.setCenter(e.getCenter());this.setBounds(o)},importJson:function(e){return this.addChild(Base.importJson(e))},_setStyles:function(e){var t=this._style,n=t._strokeWidth,r=t._strokeJoin,i=t._strokeCap,s=t._miterLimit,o=t._fillColor,u=t._strokeColor,a=t._dashArray,f=t._dashOffset;if(n!=null)e.lineWidth=n;if(r)e.lineJoin=r;if(i)e.lineCap=i;if(s)e.miterLimit=s;if(o)e.fillStyle=o.toCanvasStyle(e);if(u){e.strokeStyle=u.toCanvasStyle(e);if(paper.support.nativeDash&&a&&a.length){if("setLineDash"in e){e.setLineDash(a);e.lineDashOffset=f}else{e.mozDash=a;e.mozDashOffset=f}}}if(!o||!u)e.globalAlpha=this._opacity},statics:{drawSelectedBounds:function(e,t,n){var r=n._transformCorners(e);t.beginPath();for(var i=0;i<8;i++)t[i==0?"moveTo":"lineTo"](r[i],r[++i]);t.closePath();t.stroke();for(var i=0;i<8;i++){t.beginPath();t.rect(r[i]-2,r[++i]-2,4,4);t.fill()}},draw:function(e,t,n){if(!e._visible||e._opacity==0)return;e._drawCount=e._project._drawCount;var r,i,s;if(e._blendMode!=="normal"||e._opacity<1&&e._type!=="Raster"&&(e._type!=="Path"||e.getFillColor()&&e.getStrokeColor())){var o=e.getStrokeBounds();if(!o.width||!o.height)return;s=n.offset;i=n.offset=o.getTopLeft().floor();r=t;t=CanvasProvider.getContext(o.getSize().ceil().add(Size.create(1,1)))}if(!n.clipping)t.save();if(r)t.translate(-i.x,-i.y);e._matrix.applyToContext(t);e.draw(t,n);if(!n.clipping)t.restore();if(r){n.offset=s;if(e._blendMode!=="normal"){BlendMode.process(e._blendMode,t,r,e._opacity,i.subtract(s))}else{r.save();r.globalAlpha=e._opacity;r.drawImage(t.canvas,i.x,i.y);r.restore()}CanvasProvider.release(t)}}}},Base.each(["down","drag","up","move"],function(e){this["removeOn"+Base.capitalize(e)]=function(){var t={};t[e]=true;return this.removeOn(t)}},{removeOn:function(e){for(var t in e){if(e[t]){var n="mouse"+t,r=Tool._removeSets=Tool._removeSets||{};r[n]=r[n]||{};r[n][this._id]=this}}return this}}));var Group=this.Group=Item.extend({_type:"Group",_serializeFields:{children:[]},initialize:function(e){this.base();this._children=[];this._namedChildren={};if(!this._set(e))this.addChildren(Array.isArray(e)?e:arguments)},_changed:function(e){Item.prototype._changed.call(this,e);if(e&(2|256)){delete this._clipItem}},_getClipItem:function(){if(this._clipItem!==undefined)return this._clipItem;for(var e=0,t=this._children.length;e<t;e++){var n=this._children[e];if(n._clipMask)return this._clipItem=n}return this._clipItem=null},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var t=this.getFirstChild();if(t)t.setClipMask(e)},draw:function(e,t){var n=this._getClipItem();if(n){t.clipping=true;Item.draw(n,e,t);delete t.clipping}for(var r=0,i=this._children.length;r<i;r++){var s=this._children[r];if(s!=n)Item.draw(s,e,t)}}});var Layer=this.Layer=Group.extend({_type:"Layer",initialize:function(e){this._project=paper.project;this._index=this._project.layers.push(this)-1;this.base.apply(this,arguments);this.activate()},_remove:function(e){if(this._parent)return this.base(e);if(this._index!=null){Base.splice(this._project.layers,null,this._index,1);this._project._needsRedraw();return true}return false},getNextSibling:function(){return this._parent?this.base():this._project.layers[this._index+1]||null},getPreviousSibling:function(){return this._parent?this.base():this._project.layers[this._index-1]||null},isInserted:function(){return this._index!=null},activate:function(){this._project.activeLayer=this}},new function(){function e(e){return function(t){if(t instanceof Layer&&!t._parent&&this._remove(true)){Base.splice(t._project.layers,[this],t._index+(e?1:0),0);this._setProject(t._project);return true}return this.base(t)}}return{insertAbove:e(true),insertBelow:e(false)}});var PlacedItem=this.PlacedItem=Item.extend({_boundsGetter:{getBounds:"getStrokeBounds"},_hitTest:function(e,t,n){var r=this._symbol._definition._hitTest(e,t,n);if(r)r.item=this;return r}});var Raster=this.Raster=PlacedItem.extend({_type:"Raster",_boundsSelected:true,_serializeFields:{source:null},_boundsGetter:"getBounds",initialize:function(e,t){this.base(t!==undefined&&Point.read(arguments,1));if(e&&!this._set(e)){if(e.getContext){this.setCanvas(e)}else if(typeof e==="string"){this.setSource(e)}else{this.setImage(e)}}if(!this._size)this._size=new Size},clone:function(){var e=this._image;if(!e){e=CanvasProvider.getCanvas(this._size);e.getContext("2d").drawImage(this._canvas,0,0)}var t=new Raster(e);return this._clone(t)},getSize:function(){return this._size},setSize:function(){var e=Size.read(arguments);if(!this._size.equals(e)){var t=this.getElement();this.setCanvas(CanvasProvider.getCanvas(e));if(t)this.getContext(true).drawImage(t,0,0,e.width,e.height)}},getWidth:function(){return this._size.width},getHeight:function(){return this._size.height},isEmpty:function(){return this._size.width==0&&this._size.height==0},getPpi:function(){var e=this._matrix,t=(new Point(0,0)).transform(e),n=(new Point(1,0)).transform(e).subtract(t),r=(new Point(0,1)).transform(e).subtract(t);return Size.create(72/n.getLength(),72/r.getLength())},getContext:function(){if(!this._context)this._context=this.getCanvas().getContext("2d");if(arguments[0]){this._image=null;this._changed(129)}return this._context},setContext:function(e){this._context=e},getCanvas:function(){if(!this._canvas){var e=CanvasProvider.getContext(this._size);try{if(this._image)e.drawImage(this._image,0,0);this._canvas=e.canvas}catch(t){CanvasProvider.release(e)}}return this._canvas},setCanvas:function(e){if(this._canvas)CanvasProvider.release(this._canvas);this._canvas=e;this._size=Size.create(e.width,e.height);this._image=null;this._context=null;this._changed(5|129)},getImage:function(){return this._image},setImage:function(e){if(this._canvas)CanvasProvider.release(this._canvas);this._image=e;this._size=Size.create(e.naturalWidth,e.naturalHeight);this._canvas=null;this._context=null;this._changed(5)},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(e){function r(){t.fire("load");if(t._project.view)t._project.view.draw(true)}var t=this,n=document.getElementById(e)||new Image;DomEvent.add(n,{load:function(){t.setImage(n);r()}});if(n.width&&n.height){setTimeout(r,0)}else if(!n.src){n.src=e}this.setImage(n)},getElement:function(){return this._canvas||this._image},getSubImage:function(e){e=Rectangle.read(arguments);var t=CanvasProvider.getContext(e.getSize());t.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height);return t.canvas},toDataURL:function(){var e=this._image&&this._image.src;if(/^data:/.test(e))return e;var t=this.getCanvas();return t?t.toDataURL():null},drawImage:function(e,t){t=Point.read(arguments,1);this.getContext(true).drawImage(e,t.x,t.y)},getAverageColor:function(e){var t,n;if(!e){t=this.getBounds()}else if(e instanceof PathItem){n=e;t=e.getBounds()}else if(e.width){t=new Rectangle(e)}else if(e.x){t=Rectangle.create(e.x-.5,e.y-.5,1,1)}var r=32,i=Math.min(t.width,r),s=Math.min(t.height,r);var o=Raster._sampleContext;if(!o){o=Raster._sampleContext=CanvasProvider.getContext(new Size(r))}else{o.clearRect(0,0,r+1,r+1)}o.save();o.scale(i/t.width,s/t.height);o.translate(-t.x,-t.y);if(n)n.draw(o,{clip:true});this._matrix.applyToContext(o);o.drawImage(this.getElement(),-this._size.width/2,-this._size.height/2);o.restore();var u=o.getImageData(.5,.5,Math.ceil(i),Math.ceil(s)).data,a=[0,0,0],f=0;for(var l=0,c=u.length;l<c;l+=4){var h=u[l+3];f+=h;h/=255;a[0]+=u[l]*h;a[1]+=u[l+1]*h;a[2]+=u[l+2]*h}for(var l=0;l<3;l++)a[l]/=f;return f?Color.read(a):null},getPixel:function(e){e=Point.read(arguments);var t=this.getContext().getImageData(e.x,e.y,1,1).data,n=new Array(4);for(var r=0;r<4;r++)n[r]=t[r]/255;return RgbColor.read(n)},setPixel:function(e,t){var n=Point.read(arguments),r=Color.read(arguments);var i=this.getContext(true),s=i.createImageData(1,1),o=r.getAlpha();s.data[0]=r.getRed()*255;s.data[1]=r.getGreen()*255;s.data[2]=r.getBlue()*255;s.data[3]=o!=null?o*255:255;i.putImageData(s,n.x,n.y)},createImageData:function(e){e=Size.read(arguments);return this.getContext().createImageData(e.width,e.height)},getImageData:function(e){e=Rectangle.read(arguments);if(e.isEmpty())e=new Rectangle(this.getSize());return this.getContext().getImageData(e.x,e.y,e.width,e.height)},setImageData:function(e,t){t=Point.read(arguments,1);this.getContext(true).putImageData(e,t.x,t.y)},_getBounds:function(e,t){var n=(new Rectangle(this._size)).setCenter(0,0);return t?t._transformBounds(n):n},_hitTest:function(e,t){if(e.isInside(this._getBounds())){var n=this;return new HitResult("pixel",n,{offset:e.add(n._size.divide(2)).round(),color:{get:function(){return n.getPixel(this.offset)}}})}},draw:function(e,t){var n=this.getElement();if(n){e.globalAlpha=this._opacity;e.drawImage(n,-this._size.width/2,-this._size.height/2)}}});var PlacedSymbol=this.PlacedSymbol=PlacedItem.extend({_type:"PlacedSymbol",_boundsSelected:true,_serializeFields:{symbol:null},initialize:function(e,t){this.base(t!==undefined&&Point.read(arguments,1));if(!this._set(e))this.setSymbol(e instanceof Symbol?e:new Symbol(e))},getSymbol:function(){return this._symbol},setSymbol:function(e){if(this._symbol)delete this._symbol._instances[this._id];this._symbol=e;e._instances[this._id]=this},clone:function(){return this._clone(new PlacedSymbol(this.symbol))},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(e,t){return this.symbol._definition._getCachedBounds(e,t)},draw:function(e,t){Item.draw(this.symbol._definition,e,t)}});var HitResult=this.HitResult=Base.extend({initialize:function(e,t,n){this.type=e;this.item=t;if(n){n.enumerable=true;this.inject(n)}},statics:{getOptions:function(e){return e&&e._merged?e:Base.merge({type:null,tolerance:paper.project.options.hitTolerance||2,fill:!e,stroke:!e,segments:!e,handles:false,ends:false,center:false,bounds:false,guides:false,selected:false,_merged:true},e)}}});var Segment=this.Segment=Base.extend({_type:"Segment",initialize:function(e,t,n,r,i,s){var o=arguments.length,u=SegmentPoint.create,a,f,l;if(o==0){}else if(o==1){if(e.point){a=e.point;f=e.handleIn;l=e.handleOut}else{a=e}}else if(o<6){if(o==2&&t.x===undefined){a=[e,t]}else{a=e;f=t;l=n}}else if(o==6){a=[e,t];f=[n,r];l=[i,s]}u(this,"_point",a);u(this,"_handleIn",f);u(this,"_handleOut",l)},_serialize:function(e){return Base.serialize(this._handleIn.isZero()&&this._handleOut.isZero()?this._point:[this._point,this._handleIn,this._handleOut],e,true)},_changed:function(e){if(!this._path)return;var t=this._path._curves&&this.getCurve(),n;if(t){t._changed();if(n=t[e==this._point||e==this._handleIn&&t._segment1==this?"getPrevious":"getNext"]()){n._changed()}}this._path._changed(5)},getPoint:function(){return this._point},setPoint:function(e){e=Point.read(arguments);this._point.set(e.x,e.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(e){e=Point.read(arguments);this._handleIn.set(e.x,e.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(e){e=Point.read(arguments);this._handleOut.set(e.x,e.y)},isLinear:function(){return this._handleIn.isZero()&&this._handleOut.isZero()},setLinear:function(){this._handleIn.set(0,0);this._handleOut.set(0,0)},_isSelected:function(e){var t=this._selectionState;return e==this._point?!!(t&4):e==this._handleIn?!!(t&1):e==this._handleOut?!!(t&2):false},_setSelected:function(e,t){var n=this._path,t=!!t,r=this._selectionState||0,i=[!!(r&4),!!(r&1),!!(r&2)];if(e==this._point){if(t){i[1]=i[2]=false}else{var s=this.getPrevious(),o=this.getNext();i[1]=s&&(s._point.isSelected()||s._handleOut.isSelected());i[2]=o&&(o._point.isSelected()||o._handleIn.isSelected())}i[0]=t}else{var u=e==this._handleIn?1:2;if(i[u]!=t){if(t)i[0]=false;i[u]=t}}this._selectionState=(i[0]?4:0)|(i[1]?1:0)|(i[2]?2:0);if(n&&r!=this._selectionState){n._updateSelection(this,r,this._selectionState);n._changed(33)}},isSelected:function(){return this._isSelected(this._point)},setSelected:function(e){this._setSelected(this._point,e)},getIndex:function(){return this._index!==undefined?this._index:null},getPath:function(){return this._path||null},getCurve:function(){if(this._path){var e=this._index;if(!this._path._closed&&e==this._path._segments.length-1)e--;return this._path.getCurves()[e]||null}return null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},reverse:function(){return new Segment(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):false},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut)},equals:function(e){return e==this||e&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)},toString:function(){var e=["point: "+this._point];if(!this._handleIn.isZero())e.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())e.push("handleOut: "+this._handleOut);return"{ "+e.join(", ")+" }"},_transformCoordinates:function(e,t,n){var r=this._point,i=!n||!this._handleIn.isZero()?this._handleIn:null,s=!n||!this._handleOut.isZero()?this._handleOut:null,o=r._x,u=r._y,a=2;t[0]=o;t[1]=u;if(i){t[a++]=i._x+o;t[a++]=i._y+u}if(s){t[a++]=s._x+o;t[a++]=s._y+u}if(e){e._transformCoordinates(t,0,t,0,a/2);o=t[0];u=t[1];if(n){r._x=o;r._y=u;a=2;if(i){i._x=t[a++]-o;i._y=t[a++]-u}if(s){s._x=t[a++]-o;s._y=t[a++]-u}}else{if(!i){t[a++]=o;t[a++]=u}if(!s){t[a++]=o;t[a++]=u}}}return t;nop().nop()}});var SegmentPoint=Point.extend({set:function(e,t){this._x=e;this._y=t;this._owner._changed(this);return this},getX:function(){return this._x},setX:function(e){this._x=e;this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e;this._owner._changed(this)},isZero:function(){return Numerical.isZero(this._x)&&Numerical.isZero(this._y)},setSelected:function(e){this._owner._setSelected(this,e)},isSelected:function(){return this._owner._isSelected(this)},statics:{create:function(e,t,n){var r=Base.create(SegmentPoint),i,s,o;if(!n){i=s=0}else if((i=n[0])!==undefined){s=n[1]}else{if((i=n.x)===undefined){n=Point.read(arguments,2);i=n.x}s=n.y;o=n.selected}r._x=i;r._y=s;r._owner=e;e[t]=r;if(o)r.setSelected(true);return r}}});var Curve=this.Curve=Base.extend({initialize:function(e,t,n,r,i,s,o,u){var a=arguments.length;if(a==0){this._segment1=new Segment;this._segment2=new Segment}else if(a==1){this._segment1=new Segment(e.segment1);this._segment2=new Segment(e.segment2)}else if(a==2){this._segment1=new Segment(e);this._segment2=new Segment(t)}else{var f,l,c,h;if(a==4){f=e;l=t;c=n;h=r}else if(a==8){f=[e,t];h=[o,u];l=[n-e,u-t];c=[i-o,s-u]}this._segment1=new Segment(f,null,l);this._segment2=new Segment(h,c,null)}},_changed:function(){delete this._length;delete this._bounds},getPoint1:function(){return this._segment1._point},setPoint1:function(e){e=Point.read(arguments);this._segment1._point.set(e.x,e.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(e){e=Point.read(arguments);this._segment2._point.set(e.x,e.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(e){e=Point.read(arguments);this._segment1._handleOut.set(e.x,e.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(e){e=Point.read(arguments);this._segment2._handleIn.set(e.x,e.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isSelected:function(){return this.getHandle1().isSelected()&&this.getHandle2().isSelected()},setSelected:function(e){this.getHandle1().setSelected(e);this.getHandle2().setSelected(e)},getValues:function(){return Curve.getValues(this._segment1,this._segment2)},getPoints:function(){var e=this.getValues(),t=[];for(var n=0;n<8;n+=2)t.push(Point.create(e[n],e[n+1]));return t},getLength:function(){var e=arguments[0],t=arguments[1],n=arguments.length==0||e==0&&t==1;if(n&&this._length!=null)return this._length;var r=Curve.getLength(this.getValues(),e,t);if(n)this._length=r;return r},getPart:function(e,t){return new Curve(Curve.getPart(this.getValues(),e,t))},isLinear:function(){return this._segment1._handleOut.isZero()&&this._segment2._handleIn.isZero()},getIntersections:function(e){return Curve._addIntersections(this.getValues(),e.getValues(),this,[])},getCrossings:function(e,t){var n=this.getValues(),r=Curve.solveCubic(n,1,e.y,t),i=0;for(var s=0;s<r;s++){var o=t[s];if(o>=0&&o<1&&Curve.evaluate(n,o,true,0).x>e.x){if(o<1e-5&&Curve.evaluate(this.getPrevious().getValues(),1,true,1).y*Curve.evaluate(n,o,true,1).y>=1e-5)continue;i++}}return i},reverse:function(){return new Curve(this._segment2.reverse(),this._segment1.reverse())},divide:function(e){var t=null;if(e&&e.curve===this)e=e.parameter;if(e>0&&e<1){var n=Curve.subdivide(this.getValues(),e),r=this.isLinear(),i=n[0],s=n[1],o=this._segment1._point,u=this._segment2._point;if(!r){this._segment1._handleOut.set(i[2]-o._x,i[3]-o._y);this._segment2._handleIn.set(s[4]-u._x,s[5]-u._y)}var a=i[6],f=i[7],l=new Segment(Point.create(a,f),r?null:Point.create(i[4]-a,i[5]-f),r?null:Point.create(s[2]-a,s[3]-f));if(this._path){if(this._segment1._index>0&&this._segment2._index===0){this._path.add(l)}else{this._path.insert(this._segment2._index,l)}t=this}else{var c=this._segment2;this._segment2=l;t=new Curve(l,c)}}return t},split:function(e){return this._path?this._path.split(this._segment1._index,e):null},clone:function(){return new Curve(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())e.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())e.push("handle2: "+this._segment2._handleIn);e.push("point2: "+this._segment2._point);return"{ "+e.join(", ")+" }"},statics:{create:function(e,t,n){var r=Base.create(Curve);r._path=e;r._segment1=t;r._segment2=n;return r},getValues:function(e,t){var n=e._point,r=e._handleOut,i=t._handleIn,s=t._point;return[n._x,n._y,n._x+r._x,n._y+r._y,s._x+i._x,s._y+i._y,s._x,s._y]},evaluate:function(e,t,n,r){var i=n?t:Curve.getParameterAt(e,t,0),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7],p,d;if(r==0&&(i==0||i==1)){p=i==0?s:c;d=i==0?o:h}else{var v=1e-5;if(i<v&&u==s&&a==o)i=v;else if(i>1-v&&f==c&&l==h)i=1-v;var m=3*(u-s),g=3*(f-u)-m,y=c-s-m-g,b=3*(a-o),w=3*(l-a)-b,E=h-o-b-w;switch(r){case 0:p=((y*i+g)*i+m)*i+s;d=((E*i+w)*i+b)*i+o;break;case 1:case 2:p=(3*y*i+2*g)*i+m;d=(3*E*i+2*w)*i+b;break}}return r==2?new Point(d,-p):new Point(p,d)},subdivide:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7];if(t===undefined)t=.5;var l=1-t,c=l*n+t*i,h=l*r+t*s,p=l*i+t*o,d=l*s+t*u,v=l*o+t*a,m=l*u+t*f,g=l*c+t*p,y=l*h+t*d,b=l*p+t*v,w=l*d+t*m,E=l*g+t*b,S=l*y+t*w;return[[n,r,c,h,g,y,E,S],[E,S,b,w,v,m,a,f]]},solveCubic:function(e,t,n,r){var i=e[t],s=e[t+2],o=e[t+4],u=e[t+6],a=3*(s-i),f=3*(o-s)-a,l=u-i-a-f;return Numerical.solveCubic(l,f,a,i-n,r,1e-5)},getParameterOf:function(e,t,n){if(Math.abs(e[0]-t)<1e-5&&Math.abs(e[1]-n)<1e-5)return 0;if(Math.abs(e[6]-t)<1e-5&&Math.abs(e[7]-n)<1e-5)return 1;var r=[],i=[],s=Curve.solveCubic(e,0,t,r),o=Curve.solveCubic(e,1,n,i),u,a;for(var f=0;s==-1||f<s;){if(s==-1||(u=r[f++])>=0&&u<=1){for(var l=0;o==-1||l<o;){if(o==-1||(a=i[l++])>=0&&a<=1){if(s==-1)u=a;else if(o==-1)a=u;if(Math.abs(u-a)<1e-5)return(u+a)*.5}}if(s==-1)break}}return null},getPart:function(e,t,n){if(t>0)e=Curve.subdivide(e,t)[1];if(n<1)e=Curve.subdivide(e,(n-t)/(1-t))[0];return e},isFlatEnough:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=3*i-2*n-a,c=3*s-2*r-f,h=3*o-2*a-n,p=3*u-2*f-r;return Math.max(l*l,h*h)+Math.max(c*c,p*p)<16*t*t},getBounds:function(e){var t=e.slice(0,2),n=t.slice(0),r=new Array(2);for(var i=0;i<2;i++)Curve._addBounds(e[i],e[i+2],e[i+4],e[i+6],i,0,t,n,r);return Rectangle.create(t[0],t[1],n[0]-t[0],n[1]-t[1])},_addBounds:function(e,t,n,r,i,s,o,u,a){function f(e,t){var n=e-t,r=e+t;if(n<o[i])o[i]=n;if(r>u[i])u[i]=r}var l=3*(t-n)-e+r,c=2*(e+n)-4*t,h=t-e,p=Numerical.solveQuadratic(l,c,h,a,1e-5),d=1e-5,v=1-d;f(r,0);for(var m=0;m<p;m++){var g=a[m],y=1-g;if(d<g&&g<v)f(y*y*y*e+3*y*y*g*t+3*y*g*g*n+g*g*g*r,s)}},_addIntersections:function(e,t,n,r){var i=Curve.getBounds(e),s=Curve.getBounds(t);if(i.x+i.width>=s.x&&i.y+i.height>=s.y&&i.x<s.x+s.width&&i.y<s.y+s.height){if(Curve.isFlatEnough(e,1e-5)&&Curve.isFlatEnough(t,1e-5)){var o=(new Line(e[0],e[1],e[6],e[7],false)).intersect(new Line(t[0],t[1],t[6],t[7],false));if(o)r.push(new CurveLocation(n,null,o))}else{var u=Curve.subdivide(e),a=Curve.subdivide(t);for(var f=0;f<2;f++)for(var l=0;l<2;l++)this._addIntersections(u[f],a[l],n,r)}}return r}}},Base.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){if(!this._bounds)this._bounds={};var t=this._bounds[e];if(!t){t=this._bounds[e]=Path[e]([this._segment1,this._segment2],false,this._path._style)}return t.clone()}},{}),Base.each(["getPoint","getTangent","getNormal"],function(e,t){this[e+"At"]=function(e,n){return Curve.evaluate(this.getValues(),e,n,t)};this[e]=function(e){return Curve.evaluate(this.getValues(),e,true,t)}},{getParameterAt:function(e,t){return Curve.getParameterAt(this.getValues(),e,t!==undefined?t:e<0?1:0)},getParameterOf:function(e){e=Point.read(arguments);return Curve.getParameterOf(this.getValues(),e.x,e.y)},getLocationAt:function(e,t){if(!t)e=this.getParameterAt(e);return new CurveLocation(this,e)},getLocationOf:function(e){var t=this.getParameterOf.apply(this,arguments);return t!=null?new CurveLocation(this,t):null}}),new function(){function e(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=9*(r-s)+3*(u-t),l=6*(t+s)-12*r,c=3*(r-t),h=9*(i-o)+3*(a-n),p=6*(n+o)-12*i,d=3*(i-n);return function(e){var t=(f*e+l)*e+c,n=(h*e+p)*e+d;return Math.sqrt(t*t+n*n)}}function t(e,t){return Math.max(2,Math.min(16,Math.ceil(Math.abs(t-e)*32)))}return{statics:true,getLength:function(n,r,i){if(r===undefined)r=0;if(i===undefined)i=1;if(n[0]==n[2]&&n[1]==n[3]&&n[6]==n[4]&&n[7]==n[5]){var s=n[6]-n[0],o=n[7]-n[1];return(i-r)*Math.sqrt(s*s+o*o)}var u=e(n);return Numerical.integrate(u,r,i,t(r,i))},getParameterAt:function(n,r,i){function h(e){var n=t(i,e);c+=i<e?Numerical.integrate(a,i,e,n):-Numerical.integrate(a,e,i,n);i=e;return c-r}if(r==0)return i;var s=r>0,o=s?i:0,u=s?1:i,r=Math.abs(r),a=e(n),f=Numerical.integrate(a,o,u,t(o,u));if(r>=f)return s?u:o;var l=r/f,c=0;return Numerical.findRoot(h,a,s?o+l:u-l,o,u,16,1e-5)}}},new function(){function i(e,t){var r=3,i=5,s=[],o=[],u=[],a=[];for(var f=0;f<=r;f++){s[f]=e[f].subtract(t);if(f<r)o[f]=e[f+1].subtract(e[f]).multiply(r)}for(var l=0;l<r;l++){u[l]=[];for(var c=0;c<=r;c++)u[l][c]=o[l].dot(s[c])}for(var f=0;f<=i;f++)a[f]=new Point(f/i,0);for(var h=0;h<=i;h++){var p=Math.max(0,h-r+1),d=Math.min(h,r);for(var f=p;f<=d;f++){var v=h-f;a[h].y+=u[v][f]*n[v][f]}}return a}function s(t,n){switch(o(t)){case 0:return[];case 1:if(n>=e)return[.5*(t[0].x+t[5].x)];if(u(t)){var i=new Line(t[0],t[5],true);return[Numerical.isZero(i.vector.getLength(true))?i.point.x:r.intersect(i).x]}}var a=[[]],f=[],l=[];for(var c=0;c<=5;c++)a[0][c]=new Point(t[c]);for(var h=1;h<=5;h++){a[h]=[];for(var c=0;c<=5-h;c++)a[h][c]=a[h-1][c].add(a[h-1][c+1]).multiply(.5)}for(var c=0;c<=5;c++){f[c]=a[c][0];l[c]=a[5-c][c]}return s(f,n+1).concat(s(l,n+1))}function o(e){var t=0,n=null;for(var r=0,i=e.length;r<i;r++){var s=e[r].y<0?-1:1;if(n!=null&&s!=n)t++;n=s}return t}function u(e){var n=e.length-1,r=e[0].y-e[n].y,i=e[n].x-e[0].x,s=e[0].x*e[n].y-e[n].x*e[0].y,o=0,u=0;for(var a=1;a<n;a++){var f=r*e[a].x+i*e[a].y+s,l=f*f;if(f<0&&l>u){u=l}else if(l>o){o=l}}return Math.abs((o+u)/(2*r*(r*r+i*i)))<t}var e=32,t=Math.pow(2,-e-1);var n=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];var r=new Line(new Point(0,0),new Point(1,0));return{getNearestLocation:function(e){var t=i(this.getPoints(),e);var n=s(t,0).concat([0,1]);var r=Infinity,o,u;for(var a=0;a<n.length;a++){var f=this.getPointAt(n[a],true),l=e.getDistance(f,true);if(l<r){r=l;o=n[a];u=f}}return new CurveLocation(this,o,u,Math.sqrt(r))},getNearestPoint:function(e){return this.getNearestLocation(e).getPoint()}}});var CurveLocation=this.CurveLocation=Base.extend({initialize:function(e,t,n,r){this._curve=e;this._segment1=e._segment1;this._segment2=e._segment2;this._parameter=t;this._point=n;this._distance=r},getSegment:function(){if(!this._segment){var e=this.getCurve(),t=this.getParameter();if(t==0){this._segment=e._segment1}else if(t==1){this._segment=e._segment2}else if(t==null){return null}else{this._segment=e.getLength(0,t)<e.getLength(t,1)?e._segment1:e._segment2}}return this._segment},getCurve:function(){if(!this._curve||arguments[0]){this._curve=this._segment1.getCurve();if(this._curve.getParameterOf(this._point)==null)this._curve=this._segment2.getPrevious().getCurve()}return this._curve},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getOffset:function(){var e=this.getPath();return e&&e._getOffset(this)},getCurveOffset:function(){var e=this.getCurve(),t=this.getParameter();return t!=null&&e&&e.getLength(0,t)},getParameter:function(){if((this._parameter==null||arguments[0])&&this._point){var e=this.getCurve(arguments[0]&&this._point);this._parameter=e&&e.getParameterOf(this._point)}return this._parameter},getPoint:function(){if(!this._point&&this._parameter!=null){var e=this.getCurve();this._point=e&&e.getPointAt(this._parameter,true)}return this._point},getTangent:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getTangentAt(e,true)},getNormal:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getNormalAt(e,true)},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(true);return e&&e.divide(this.getParameter(true))},split:function(){var e=this.getCurve(true);return e&&e.split(this.getParameter(true))},toString:function(){var e=[],t=this.getPoint();if(t)e.push("point: "+t);var n=this.getIndex();if(n!=null)e.push("index: "+n);var r=this.getParameter();if(r!=null)e.push("parameter: "+Format.number(r));if(this._distance!=null)e.push("distance: "+Format.number(this._distance));return"{ "+e.join(", ")+" }"}});var PathItem=this.PathItem=Item.extend({getIntersections:function(e){if(!this.getBounds().intersects(e.getBounds()))return[];var t=[],n=this.getCurves(),r=e.getCurves(),i=r.length,s=[];for(var o=0;o<i;o++)s[o]=r[o].getValues();for(var o=0,u=n.length;o<u;o++){var a=n[o],f=a.getValues();for(var l=0;l<i;l++)Curve._addIntersections(f,s[l],a,t)}return t},setPathData:function(e){function o(e,t,i){var o=parseFloat(n[e]);if(r)o+=s[t];if(i)s[t]=o;return o}function u(e,t){return new Point(o(e,"x",t),o(e+1,"y",t))}var t=e.match(/[a-z][^a-z]*/ig),n,r=false,i,s=new Point;if(this._type==="Path")this.removeSegments();else this.removeChildren();for(var a=0,f=t.length;a<f;a++){var l=t[a];cmd=l[0],lower=cmd.toLowerCase();n=l.slice(1).trim().split(/[\s,]+|(?=[+-])/);r=cmd===lower;switch(lower){case"m":case"l":for(var c=0;c<n.length;c+=2)this[c===0&&lower==="m"?"moveTo":"lineTo"](u(c,true));break;case"h":case"v":var h=lower=="h"?"x":"y";for(var c=0;c<n.length;c++){o(c,h,true);this.lineTo(s)}break;case"c":this.cubicCurveTo(u(0),i=u(2),u(4,true));break;case"s":this.cubicCurveTo(s.multiply(2).subtract(i),i=u(0),u(2,true));break;case"q":this.quadraticCurveTo(i=u(0),u(2,true));break;case"t":for(var c=0;c<n.length;c+=2){this.quadraticCurveTo(i=s.multiply(2).subtract(i),u(c,true))}break;case"a":break;case"z":this.closePath();break}}}});var Path=this.Path=PathItem.extend({_type:"Path",_serializeFields:{segments:[],closed:false},initialize:function(e){this._closed=false;this._segments=[];this.base();var t=Array.isArray(e)?typeof e[0]==="object"?e:arguments:e&&(e.point!==undefined||e.x!==undefined)?arguments:null;this.setSegments(t||[]);if(!t)this._set(e)},clone:function(){var e=this._clone(new Path(this._segments));e._closed=this._closed;if(this._clockwise!==undefined)e._clockwise=this._clockwise;return e},_changed:function(e){Item.prototype._changed.call(this,e);if(e&4){delete this._length;delete this._clockwise;if(this._curves){for(var t=0,n=this._curves.length;t<n;t++){this._curves[t]._changed(5)}}}else if(e&8){delete this._bounds}},getSegments:function(){return this._segments},setSegments:function(e){this._selectedSegmentState=0;this._segments.length=0;delete this._curves;this._add(Segment.readAll(e))},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,t=this._segments;if(!e){var n=this._countCurves();e=this._curves=new Array(n);for(var r=0;r<n;r++)e[r]=Curve.create(this,t[r],t[r+1]||t[0])}return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},getPathData:function(){function o(e,t,i){var o=e._point,u=t._point,a=e._handleOut,f=t._handleIn;if(a.isZero()&&f.isZero()){if(!i){s.push("L"+n(u,r))}}else{var l=u.subtract(o);s.push("c"+n(a,r)+" "+n(l.add(f),r)+" "+n(l,r))}}var e=this._segments,t=this._style,n=Format.point,r=arguments[0],s=[];if(e.length===0)return"";s.push("M"+n(e[0]._point));for(i=0,l=e.length-1;i<l;i++)o(e[i],e[i+1],false);if(this._closed&&t._strokeColor||t._fillColor)o(e[e.length-1],e[0],true);if(this._closed)s.push("z");return s.join("")},isClosed:function(){return this._closed},setClosed:function(e){if(this._closed!=(e=!!e)){this._closed=e;if(this._curves){var t=this._curves.length=this._countCurves();if(e)this._curves[t-1]=Curve.create(this,this._segments[t-1],this._segments[0])}this._changed(5)}},isEmpty:function(){return this._segments.length===0},isPolygon:function(){for(var e=0,t=this._segments.length;e<t;e++){if(!this._segments[e].isLinear())return false}return true},applyMatrix:true,_applyMatrix:function(e){var t=new Array(6);for(var n=0,r=this._segments.length;n<r;n++){this._segments[n]._transformCoordinates(e,t,true)}var i=this._style,s=i._fillColor,o=i._strokeColor;if(s&&s.transform)s.transform(e);if(o&&o.transform)o.transform(e);return true},_add:function(e,t){var n=this._segments,r=this._curves,i=e.length,s=t==null,t=s?n.length:t,o=this.isFullySelected();for(var u=0;u<i;u++){var a=e[u];if(a._path)a=e[u]=a.clone();a._path=this;a._index=t+u;if(o)a._selectionState=4;if(a._selectionState)this._updateSelection(a,0,a._selectionState)}if(s){n.push.apply(n,e)}else{n.splice.apply(n,[t,0].concat(e));for(var u=t+i,f=n.length;u<f;u++)n[u]._index=u}if(r||e._curves){if(!r)r=this._curves=[];var l=t>0?t-1:t,c=l,h=Math.min(l+i,this._countCurves());if(e._curves){r.splice.apply(r,[l,0].concat(e._curves));c+=e._curves.length}for(var u=c;u<h;u++)r.splice(u,0,Base.create(Curve));this._adjustCurves(l,h)}this._changed(5);return e},_adjustCurves:function(e,t){var n=this._segments,r=this._curves,i;for(var s=e;s<t;s++){i=r[s];i._path=this;i._segment1=n[s];i._segment2=n[s+1]||n[0]}if(i=r[this._closed&&e===0?n.length-1:e-1])i._segment2=n[e]||n[0];if(i=r[t])i._segment1=n[t]},_countCurves:function(){var e=this._segments.length;return!this._closed&&e>0?e-1:e},add:function(e){return arguments.length>1&&typeof e!=="number"?this._add(Segment.readAll(arguments)):this._add([Segment.read(arguments)])[0]},insert:function(e,t){return arguments.length>2&&typeof t!=="number"?this._add(Segment.readAll(arguments,1),e):this._add([Segment.read(arguments,1)],e)[0]},addSegment:function(e){return this._add([Segment.read(arguments)])[0]},insertSegment:function(e,t){return this._add([Segment.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(Segment.readAll(e))},insertSegments:function(e,t){return this._add(Segment.readAll(t),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(e,t){e=e||0;t=Base.pick(t,this._segments.length);var n=this._segments,r=this._curves,i=n.length,s=n.splice(e,t-e),o=s.length;if(!o)return s;for(var u=0;u<o;u++){var a=s[u];if(a._selectionState)this._updateSelection(a,a._selectionState,0);delete a._index;delete a._path}for(var u=e,f=n.length;u<f;u++)n[u]._index=u;if(r){var l=t==i+(this._closed?1:0)?e-1:e,r=r.splice(l,o);if(arguments[2])s._curves=r.slice(1);this._adjustCurves(l,l)}this._changed(5);return s},isFullySelected:function(){return this._selected&&this._selectedSegmentState==this._segments.length*4},setFullySelected:function(e){if(e)this._selectSegments(true);this.setSelected(e)},setSelected:function(e){if(!e)this._selectSegments(false);this.base(e)},_selectSegments:function(e){var t=this._segments.length;this._selectedSegmentState=e?t*4:0;for(var n=0;n<t;n++)this._segments[n]._selectionState=e?4:0},_updateSelection:function(e,t,n){e._selectionState=n;var r=this._selectedSegmentState+=n-t;if(r>0)this.setSelected(true)},flatten:function(e){var t=new PathFlattener(this),n=0,r=t.length/Math.ceil(t.length/e),i=t.length+(this._closed?-r:r)/2;var s=[];while(n<=i){s.push(new Segment(t.evaluate(n,0)));n+=r}this.setSegments(s)},simplify:function(e){if(this._segments.length>2){var t=new PathFitter(this,e||2.5);this.setSegments(t.fit())}},split:function(e,t){if(t===null)return;if(arguments.length==1){var n=e;if(typeof n==="number")n=this.getLocationAt(n);e=n.index;t=n.parameter}if(t>=1){e++;t--}var r=this.getCurves();if(e>=0&&e<r.length){if(t>0){r[e++].divide(t)}var i=this.removeSegments(e,this._segments.length,true),s;if(this._closed){this.setClosed(false);s=this}else if(e>0){s=this._clone((new Path).insertAbove(this,true))}s._add(i,0);this.addSegment(i[0]);return s}return null},isClockwise:function(){function r(r,i){if(t!==undefined)e+=(t-r)*(i+n);t=r;n=i}if(this._clockwise!==undefined)return this._clockwise;var e=0,t,n;for(var i=0,s=this._segments.length;i<s;i++){var o=this._segments[i],u=this._segments[i+1<s?i+1:0],a=o._point,f=o._handleOut,l=u._handleIn,c=u._point;r(a._x,a._y);r(a._x+f._x,a._y+f._y);r(c._x+l._x,c._y+l._y);r(c._x,c._y)}return e>0},setClockwise:function(e){if(this.isClockwise()!=(e=!!e)){this.reverse()}this._clockwise=e},reverse:function(){this._segments.reverse();for(var e=0,t=this._segments.length;e<t;e++){var n=this._segments[e];var r=n._handleIn;n._handleIn=n._handleOut;n._handleOut=r;n._index=e}if(this._clockwise!==undefined)this._clockwise=!this._clockwise},join:function(e){if(e){var t=e._segments,n=this.getLastSegment(),r=e.getLastSegment();if(n._point.equals(r._point))e.reverse();var i=e.getFirstSegment();if(n._point.equals(i._point)){n.setHandleOut(i._handleOut);this._add(t.slice(1))}else{var s=this.getFirstSegment();if(s._point.equals(i._point))e.reverse();r=e.getLastSegment();if(s._point.equals(r._point)){s.setHandleIn(r._handleIn);this._add(t.slice(0,t.length-1),0)}else{this._add(t.slice(0))}}e.remove();var s=this.getFirstSegment();n=this.getLastSegment();if(n._point.equals(s._point)){s.setHandleIn(n._handleIn);n.remove();this.setClosed(true)}this._changed(5);return true}return false},reduce:function(){return this},getLength:function(){if(this._length==null){var e=this.getCurves();this._length=0;for(var t=0,n=e.length;t<n;t++)this._length+=e[t].getLength()}return this._length},_getOffset:function(e){var t=e&&e.getIndex();if(t!=null){var n=this.getCurves(),r=0;for(var i=0;i<t;i++)r+=n[i].getLength();var s=n[t];return r+s.getLength(0,e.getParameter())}return null},getLocationOf:function(e){e=Point.read(arguments);var t=this.getCurves();for(var n=0,r=t.length;n<r;n++){var i=t[n].getLocationOf(e);if(i)return i}return null},getLocationAt:function(e,t){var n=this.getCurves(),r=0;if(t){var i=~~e;return n[i].getLocationAt(e-i,true)}for(var s=0,o=n.length;s<o;s++){var u=r,a=n[s];r+=a.getLength();if(r>=e){return a.getLocationAt(e-u)}}if(e<=this.getLength())return new CurveLocation(n[n.length-1],1);return null},getPointAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getPoint()},getTangentAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getTangent()},getNormalAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getNormal()},getNearestLocation:function(e){var t=this.getCurves(),n=Infinity,r=null;for(var i=0,s=t.length;i<s;i++){var o=t[i].getNearestLocation(e);if(o._distance<n){n=o._distance;r=o}}return r},getNearestPoint:function(e){return this.getNearestLocation(e).getPoint()},hasFill:function(){return this._style._fillColor||this._parent instanceof CompoundPath&&this._parent._style._fillColor},contains:function(e){e=Point.read(arguments);var t=this.hasFill();if(!this._closed&&!t||!this.getRoughBounds()._containsPoint(e))return false;var n=this.getCurves(),r=this._segments,i=0,s=new Array(3);for(var o=0,u=n.length;o<u;o++)i+=n[o].getCrossings(e,s);if(!this._closed&&t)i+=Curve.create(this,r[r.length-1],r[0]).getCrossings(e,s);return(i&1)==1},_hitTest:function(e,t){function f(t,n,i){if(e.getDistance(n)<r)return new HitResult(i,a,{segment:t,point:n})}function l(e,n){var r=e._point;return(n||t.segments)&&f(e,r,"segment")||!n&&t.handles&&(f(e,r.add(e._handleIn),"handle-in")||f(e,r.add(e._handleOut),"handle-out"))}var n=this._style,r=t.tolerance||0,i=(t.stroke&&n._strokeColor?n._strokeWidth/2:0)+r,s,o;var u=[],a=this;if(t.ends&&!t.segments&&!this._closed){if(o=l(this.getFirstSegment(),true)||l(this.getLastSegment(),true))return o}else if(t.segments||t.handles){for(var c=0,h=this._segments.length;c<h;c++){if(o=l(this._segments[c]))return o}}if(t.stroke&&i>0)s=this.getNearestLocation(e);if(!(s&&s._distance<=i)&&t.fill&&this.hasFill()&&this.contains(e))return new HitResult("fill",this);if(!s&&t.stroke&&i>0)s=this.getNearestLocation(e);if(s&&s._distance<=i)return t.stroke?new HitResult("stroke",this,{location:s}):new HitResult("fill",this)}},new function(){function e(e,t,n,r){function s(t){var n=o[t],r=o[t+1];if(h!=n||p!=r){e.beginPath();e.moveTo(h,p);e.lineTo(n,r);e.stroke();e.beginPath();e.arc(n,r,i,0,Math.PI*2,true);e.fill()}}var i=r/2;var o=new Array(6);for(var u=0,a=t.length;u<a;u++){var f=t[u];f._transformCoordinates(n,o,false);var l=f._selectionState,c=l&4,h=o[0],p=o[1];if(c||l&1)s(2);if(c||l&2)s(4);e.save();e.beginPath();e.rect(h-i,p-i,r,r);e.fill();if(!c){e.beginPath();e.rect(h-i+1,p-i+1,r-2,r-2);e.fillStyle="#ffffff";e.fill()}e.restore()}}function t(e,t,n){function v(t){var i=r[t];if(n){i._transformCoordinates(n,s,false);u=s[0];a=s[1]}else{var v=i._point;u=v._x;a=v._y}if(o){e.moveTo(u,a);o=false}else{if(n){c=s[2];h=s[3]}else{var m=i._handleIn;c=u+m._x;h=a+m._y}if(c==u&&h==a&&p==f&&d==l){e.lineTo(u,a)}else{e.bezierCurveTo(p,d,c,h,u,a)}}f=u;l=a;if(n){p=s[4];d=s[5]}else{var m=i._handleOut;p=f+m._x;d=l+m._y}}var r=t._segments,i=r.length,s=new Array(6),o=true,u,a,f,l,c,h,p,d;for(var m=0;m<i;m++)v(m);if(t._closed&&i>1)v(0)}return{draw:function(e,n){if(!n.compound)e.beginPath();var r=this._style,i=r._fillColor,s=r._strokeColor,o=r._dashArray,u=!paper.support.nativeDash&&s&&o&&o.length,a=n.clip||this._clipMask;if(n.compound||a||i||s&&!u)t(e,this);if(this._closed)e.closePath();if(a){e.clip()}else if(!n.compound&&(i||s)){this._setStyles(e);if(i)e.fill();if(s){if(u){e.beginPath();var f=new PathFlattener(this),l=r._dashOffset,c,h=0;while(l<f.length){c=l+o[h++%o.length];f.drawPart(e,l,c);l=c+o[h++%o.length]}}e.stroke()}}},drawSelected:function(n,r){n.beginPath();t(n,this,r);n.stroke();e(n,this._segments,r,this._project.options.handleSize||4)}}},new function(){function e(e){var t=e.length,n=[],r=[],i=2;n[0]=e[0]/i;for(var s=1;s<t;s++){r[s]=1/i;i=(s<t-1?4:2)-r[s];n[s]=(e[s]-n[s-1])/i}for(var s=1;s<t;s++){n[t-s-1]-=r[t-s]*n[t-s]}return n}return{smooth:function(){var t=this._segments,n=t.length,r=n,i;if(n<=2)return;if(this._closed){i=Math.min(n,4);r+=Math.min(n,i)*2}else{i=0}var s=[];for(var o=0;o<n;o++)s[o+i]=t[o]._point;if(this._closed){for(var o=0;o<i;o++){s[o]=t[o+n-i]._point;s[o+n+i]=t[o]._point}}else{r--}var u=[];for(var o=1;o<r-1;o++)u[o]=4*s[o]._x+2*s[o+1]._x;u[0]=s[0]._x+2*s[1]._x;u[r-1]=3*s[r-1]._x;var a=e(u);for(var o=1;o<r-1;o++)u[o]=4*s[o]._y+2*s[o+1]._y;u[0]=s[0]._y+2*s[1]._y;u[r-1]=3*s[r-1]._y;var f=e(u);if(this._closed){for(var o=0,l=n;o<i;o++,l++){var c=o/i,h=1-c,p=o+i,d=l+i;a[l]=a[o]*c+a[l]*h;f[l]=f[o]*c+f[l]*h;a[d]=a[p]*h+a[d]*c;f[d]=f[p]*h+f[d]*c}r--}var v=null;for(var o=i;o<=r-i;o++){var m=t[o-i];if(v)m.setHandleIn(v.subtract(m._point));if(o<r){m.setHandleOut(Point.create(a[o],f[o]).subtract(m._point));if(o<r-1)v=Point.create(2*s[o+1]._x-a[o+1],2*s[o+1]._y-f[o+1]);else v=Point.create((s[r]._x+a[r-1])/2,(s[r]._y+f[r-1])/2)}}if(this._closed&&v){var m=this._segments[0];m.setHandleIn(v.subtract(m._point))}}}},new function(){function e(e){var t=e._segments;if(t.length==0)throw new Error("Use a moveTo() command first");return t[t.length-1]}return{moveTo:function(e){if(this._segments.length===1)this.removeSegment(0);if(!this._segments.length)this._add([new Segment(Point.read(arguments))])},moveBy:function(e){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(e){this._add([new Segment(Point.read(arguments))])},cubicCurveTo:function(t,n,r){var i=Point.read(arguments),s=Point.read(arguments),o=Point.read(arguments);var u=e(this);u.setHandleOut(i.subtract(u._point));this._add([new Segment(o,s.subtract(r))])},quadraticCurveTo:function(t,n){var r=Point.read(arguments),n=Point.read(arguments);var i=e(this)._point;this.cubicCurveTo(r.add(i.subtract(r).multiply(1/3)),r.add(n.subtract(r).multiply(1/3)),n)},curveTo:function(t,n,r){var i=Point.read(arguments),s=Point.read(arguments),o=Base.pick(Base.read(arguments),.5),u=1-o,a=e(this)._point,f=i.subtract(a.multiply(u*u)).subtract(s.multiply(o*o)).divide(2*o*u);if(f.isNaN())throw new Error("Cannot put a curve through points with parameter = "+o);this.quadraticCurveTo(f,s)},arcTo:function(t,n){var r=e(this),i=r._point,s,o=Point.read(arguments),u=Base.pick(Base.peek(arguments),true);if(typeof u==="boolean"){t=o;n=u;var a=i.add(t).divide(2),s=a.add(a.subtract(i).rotate(n?-90:90))}else{s=o;t=Point.read(arguments)}var f=new Line(i.add(s).divide(2),s.subtract(i).rotate(90)),l=new Line(s.add(t).divide(2),t.subtract(s).rotate(90)),c=f.intersect(l),h=new Line(i,t,true),p=h.getSide(s);if(!c){if(!p)return this.lineTo(t);throw new Error("Cannot put an arc through the given points: "+[i,s,t])}var d=i.subtract(c),v=d.getLength(),m=d.getDirectedAngle(t.subtract(c)),g=h.getSide(c);if(g==0){m=p*Math.abs(m)}else if(p==g){m-=360*(m<0?-1:1)}var y=Math.abs(m),b=y>=360?4:Math.ceil(y/90),w=m/b,E=w*Math.PI/360,S=4/3*Math.sin(E)/(1+Math.cos(E)),x=[];for(var T=0;T<=b;T++){var N=T<b?c.add(d):t;var C=T<b?d.rotate(90).multiply(S):null;if(T==0){r.setHandleOut(C)}else{x.push(new Segment(N,d.rotate(-90).multiply(S),C))}d=d.rotate(w)}this._add(x)},lineBy:function(t){t=Point.read(arguments);var n=e(this);this.lineTo(n._point.add(t))},curveBy:function(t,n,r){t=Point.read(t);n=Point.read(n);var i=e(this)._point;this.curveTo(i.add(t),i.add(n),r)},arcBy:function(t,n){t=Point.read(t);n=Point.read(n);var r=e(this)._point;this.arcBy(r.add(t),r.add(n))},closePath:function(){var e=this.getFirstSegment(),t=this.getLastSegment();if(e._point.equals(t._point)){e.setHandleIn(t._handleIn);t.remove()}this.setClosed(true)}}},{_getBounds:function(e,t){return Path[e](this._segments,this._closed,this._style,t)},statics:{getBounds:function(e,t,n,r,i){function c(e){e._transformCoordinates(r,o,false);for(var t=0;t<2;t++){Curve._addBounds(u[t],u[t+4],o[t+2],o[t],t,i?i[t]:0,a,f,l)}var n=u;u=o;o=n}var s=e[0];if(!s)return new Rectangle;var o=new Array(6),u=s._transformCoordinates(r,new Array(6),false),a=u.slice(0,2),f=a.slice(0),l=new Array(2);for(var h=1,p=e.length;h<p;h++)c(e[h]);if(t)c(s);return Rectangle.create(a[0],a[1],f[0]-a[0],f[1]-a[1])},getStrokeBounds:function(e,t,n,r){function i(e,t){if(!t)return[e,e];var n=t.shiftless(),r=n.transform(Point.create(e,0)),i=n.transform(Point.create(0,e)),s=r.getAngleInRadians(),o=r.getLength(),u=i.getLength();var a=Math.sin(s),f=Math.cos(s),l=Math.tan(s),c=-Math.atan(u*l/o),h=Math.atan(u/(l*o));return[Math.abs(o*Math.cos(c)*f-u*Math.sin(c)*a),Math.abs(u*Math.sin(h)*f+o*Math.cos(h)*a)]}function h(e){u=u.include(r?r._transformPoint(e,e):e)}function p(e,t){var n=e.getPointAt(t,true),r=e.getNormalAt(t,true).normalize(s);h(n.add(r));h(n.subtract(r))}function d(e,t){if(t==="round"||!e._handleIn.isZero()&&!e._handleOut.isZero()){u=u.unite(c.setCenter(r?r._transformPoint(e._point):e._point))}else if(t=="bevel"){var n=e.getCurve();p(n,0);p(n.getPrevious(),1)}else if(t=="miter"){var i=e.getCurve(),o=i.getPrevious(),a=i.getPointAt(0,true),f=o.getNormalAt(1,true).normalize(s),v=i.getNormalAt(0,true).normalize(s),m=new Line(a.subtract(f),Point.create(-f.y,f.x)),g=new Line(a.subtract(v),Point.create(-v.y,v.x)),y=m.intersect(g);if(!y||a.getDistance(y)>l){d(e,"bevel")}else{h(y)}}}function v(e,t,n){switch(t){case"round":return d(e,t);case"butt":case"square":var r=e.getCurve(),i=r.getPointAt(n,true),o=r.getNormalAt(n,true).normalize(s);if(t==="square")i=i.add(o.rotate(n==0?-90:90));h(i.add(o));h(i.subtract(o));break}}if(!n._strokeColor||!n._strokeWidth)return Path.getBounds(e,t,n,r);var s=n._strokeWidth/2,o=i(s,r),u=Path.getBounds(e,t,n,r,o),a=n._strokeJoin,f=n._strokeCap,l=n._miterLimit*n._strokeWidth/2;var c=new Rectangle((new Size(o)).multiply(2));for(var m=1,g=e.length-(t?0:1);m<g;m++)d(e[m],a);if(t){d(e[0],a)}else{v(e[0],f,0);v(e[e.length-1],f,1)}return u},getHandleBounds:function(e,t,n,r,i,s){var o=new Array(6),u=Infinity,a=-u,f=u,l=a;i=i/2||0;s=s/2||0;for(var c=0,h=e.length;c<h;c++){var p=e[c];p._transformCoordinates(r,o,false);for(var d=0;d<6;d+=2){var v=d==0?s:i,m=o[d],g=o[d+1],y=m-v,b=m+v,w=g-v,E=g+v;if(y<u)u=y;if(b>a)a=b;if(w<f)f=w;if(E>l)l=E}}return Rectangle.create(u,f,a-u,l-f)},getRoughBounds:function(e,t,n,r){var i=n._strokeColor?n._strokeWidth:0;return Path.getHandleBounds(e,t,n,r,i,n._strokeJoin=="miter"?i*n._miterLimit:i)}}});Path.inject({statics:new function(){function e(e){return(new Path).set(Base.getNamed(e))}function t(){var t=Rectangle.readNamed(arguments,"rectangle"),n=t.getLeft(),r=t.getTop(),i=t.getRight(),s=t.getBottom(),o=e(arguments);o._add([new Segment(Point.create(n,s)),new Segment(Point.create(n,r)),new Segment(Point.create(i,r)),new Segment(Point.create(i,s))]);o._closed=true;return o}function i(){var t=Rectangle.readNamed(arguments,"rectangle"),n=e(arguments),i=t.getPoint(true),s=t.getSize(true),o=new Array(4);for(var u=0;u<4;u++){var a=r[u];o[u]=new Segment(a._point.multiply(s).add(i),a._handleIn.multiply(s),a._handleOut.multiply(s))}n._add(o);n._closed=true;return n}var n=2*(Math.sqrt(2)-1)/3;var r=[new Segment([0,.5],[0,n],[0,-n]),new Segment([.5,0],[-n,0],[n,0]),new Segment([1,.5],[0,-n],[0,n]),new Segment([.5,1],[n,0],[-n,0])];return{Line:function(){return(new Path(Point.readNamed(arguments,"from"),Point.readNamed(arguments,"to"))).set(Base.getNamed(arguments))},Rectangle:t,RoundRectangle:function(){var r=Rectangle.readNamed(arguments,"rectangle"),i=Size.readNamed(arguments,"radius");if(i.isZero())return t(r);i=Size.min(i,r.getSize(true).divide(2));var s=r.getBottomLeft(true),o=r.getTopLeft(true),u=r.getTopRight(true),a=r.getBottomRight(true),f=i.multiply(n*2),l=e(arguments);l._add([new Segment(s.add(i.width,0),null,[-f.width,0]),new Segment(s.subtract(0,i.height),[0,f.height],null),new Segment(o.add(0,i.height),null,[0,-f.height]),new Segment(o.add(i.width,0),[-f.width,0],null),new Segment(u.subtract(i.width,0),null,[f.width,0]),new Segment(u.add(0,i.height),[0,-f.height],null),new Segment(a.subtract(0,i.height),null,[0,f.height]),new Segment(a.subtract(i.width,0),[f.width,0],null)]);l._closed=true;return l},Ellipse:i,Oval:i,Circle:function(){var e=Point.readNamed(arguments,"center"),t=Base.readNamed(arguments,"radius");return i(new Rectangle(e.subtract(t),Size.create(t*2,t*2))).set(Base.getNamed(arguments))},Arc:function(){var t=Point.readNamed(arguments,"from"),n=Point.readNamed(arguments,"through"),r=Point.readNamed(arguments,"to"),i=e(arguments);i.moveTo(t);i.arcTo(n,r);return i},RegularPolygon:function(){var t=Point.readNamed(arguments,"center"),n=Base.readNamed(arguments,"sides"),r=Base.readNamed(arguments,"radius"),i=e(arguments),s=360/n,o=!(n%3),u=new Point(0,o?-r:r),a=o?-1:.5,f=new Array(n);for(var l=0;l<n;l++){f[l]=new Segment(t.add(u.rotate((l+a)*s)))}i._add(f);i._closed=true;return i},Star:function(){var t=Point.readNamed(arguments,"center"),n=Base.readNamed(arguments,"points")*2,r=Base.readNamed(arguments,"radius1"),i=Base.readNamed(arguments,"radius2"),s=e(arguments),o=360/n,u=new Point(0,-1),a=new Array(n);for(var f=0;f<n;f++){a[f]=new Segment(t.add(u.rotate(o*f).multiply(f%2?i:r)))}s._add(a);s._closed=true;return s}}}});var CompoundPath=this.CompoundPath=PathItem.extend({_type:"CompoundPath",_serializeFields:{pathData:""},initialize:function(e){this.base();this._children=[];this._namedChildren={};if(!this._set(e))this.addChildren(Array.isArray(e)?e:arguments)},insertChild:function(e,t,n){if(t._type!=="Path")return null;t=this.base(e,t);if(!n&&t&&t._clockwise===undefined)t.setClockwise(t._index==0);return t},reduce:function(){if(this._children.length==1){var e=this._children[0];e.insertAbove(this);this.remove();return e}return this},smooth:function(){for(var e=0,t=this._children.length;e<t;e++)this._children[e].smooth()},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t=t.concat(e[n].getCurves());return t},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getFirstCurve()},getPathData:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n].getPathData(arguments[0]));return t.join(" ")},_contains:function(e){var t=[];for(var n=0,r=this._children.length;n<r;n++){var i=this._children[n];if(i.contains(e))t.push(i)}return(t.length&1)==1&&t},contains:function(e){return!!this._contains(Point.read(arguments))},_hitTest:function(e,t){var n=this.base(e,Base.merge(t,{fill:false}));if(!n&&t.fill&&this._style._fillColor){n=this._contains(e);n=n?new HitResult("fill",n[0]):null}return n},draw:function(e,t){var n=this._children,r=this._style;if(n.length==0)return;e.beginPath();t.compound=true;for(var i=0,s=n.length;i<s;i++)Item.draw(n[i],e,t);t.compound=false;if(t.clip||this._clipMask){e.clip()}else{this._setStyles(e);if(r._fillColor)e.fill();if(r._strokeColor)e.stroke()}}},new function(){function e(e){if(!e._children.length)throw new Error("Use a moveTo() command first");return e._children[e._children.length-1]}var t={moveTo:function(e){var t=new Path;this.addChild(t);t.moveTo.apply(t,arguments)},moveBy:function(t){this.moveTo(e(this).getLastSegment()._point.add(Point.read(arguments)))},closePath:function(){e(this).closePath()}};Base.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","curveBy","arcBy"],function(n){t[n]=function(){var t=e(this);t[n].apply(t,arguments)}});return t});var PathFlattener=Base.extend({initialize:function(e){function s(e,t){var n=Curve.getValues(e,t);i.curves.push(n);i._computeParts(n,e._index,0,1)}this.curves=[];this.parts=[];this.length=0;this.index=0;var t=e._segments,n=t[0],r,i=this;for(var o=1,u=t.length;o<u;o++){r=t[o];s(n,r);n=r}if(e._closed)s(r,t[0])},_computeParts:function(e,t,n,r){if(r-n>1/32&&!Curve.isFlatEnough(e,.25)){var i=Curve.subdivide(e);var s=(n+r)/2;this._computeParts(i[0],t,n,s);this._computeParts(i[1],t,s,r)}else{var o=e[6]-e[0],u=e[7]-e[1],a=Math.sqrt(o*o+u*u);if(a>1e-5){this.length+=a;this.parts.push({offset:this.length,value:r,index:t})}}},getParameterAt:function(e){var t,n=this.index;for(;;){t=n;if(n==0||this.parts[--n].offset<e)break}for(var r=this.parts.length;t<r;t++){var i=this.parts[t];if(i.offset>=e){this.index=t;var s=this.parts[t-1];var o=s&&s.index==i.index?s.value:0,u=s?s.offset:0;return{value:o+(i.value-o)*(e-u)/(i.offset-u),index:i.index}}}var i=this.parts[this.parts.length-1];return{value:1,index:i.index}},evaluate:function(e,t){var n=this.getParameterAt(e);return Curve.evaluate(this.curves[n.index],n.value,true,t)},drawPart:function(e,t,n){t=this.getParameterAt(t);n=this.getParameterAt(n);for(var r=t.index;r<=n.index;r++){var i=Curve.getPart(this.curves[r],r==t.index?t.value:0,r==n.index?n.value:1);if(r==t.index)e.moveTo(i[0],i[1]);e.bezierCurveTo.apply(e,i.slice(2))}}});var PathFitter=Base.extend({initialize:function(e,t){this.points=[];var n=e._segments,r;for(var i=0,s=n.length;i<s;i++){var o=n[i].point.clone();if(!r||!r.equals(o)){this.points.push(o);r=o}}this.error=t},fit:function(){var e=this.points,t=e.length;this.segments=t>0?[new Segment(e[0])]:[];if(t>1)this.fitCubic(0,t-1,e[1].subtract(e[0]).normalize(),e[t-2].subtract(e[t-1]).normalize());return this.segments},fitCubic:function(e,t,n,r){if(t-e==1){var i=this.points[e],s=this.points[t],o=i.getDistance(s)/3;this.addCurve([i,i.add(n.normalize(o)),s.add(r.normalize(o)),s]);return}var u=this.chordLengthParameterize(e,t),a=Math.max(this.error,this.error*this.error),f,l;for(var c=0;c<=4;c++){var h=this.generateBezier(e,t,u,n,r);var p=this.findMaxError(e,t,h,u);if(p.error<this.error){this.addCurve(h);return}l=p.index;if(p.error>=a)break;this.reparameterize(e,t,u,h);a=p.error}var d=this.points[l-1].subtract(this.points[l]),v=this.points[l].subtract(this.points[l+1]),m=d.add(v).divide(2).normalize();this.fitCubic(e,l,n,m);this.fitCubic(l,t,m.negate(),r)},addCurve:function(e){var t=this.segments[this.segments.length-1];t.setHandleOut(e[1].subtract(e[0]));this.segments.push(new Segment(e[3],e[2].subtract(e[3])))},generateBezier:function(e,t,n,r,i){var s=1e-11,o=this.points[e],u=this.points[t],a=[[0,0],[0,0]],f=[0,0];for(var l=0,c=t-e+1;l<c;l++){var h=n[l],p=1-h,d=3*h*p,v=p*p*p,m=d*p,g=d*h,y=h*h*h,b=r.normalize(m),w=i.normalize(g),E=this.points[e+l].subtract(o.multiply(v+m)).subtract(u.multiply(g+y));a[0][0]+=b.dot(b);a[0][1]+=b.dot(w);a[1][0]=a[0][1];a[1][1]+=w.dot(w);f[0]+=b.dot(E);f[1]+=w.dot(E)}var S=a[0][0]*a[1][1]-a[1][0]*a[0][1],x,T;if(Math.abs(S)>s){var N=a[0][0]*f[1]-a[1][0]*f[0],C=f[0]*a[1][1]-f[1]*a[0][1];x=C/S;T=N/S}else{var k=a[0][0]+a[0][1],L=a[1][0]+a[1][1];if(Math.abs(k)>s){x=T=f[0]/k}else if(Math.abs(L)>s){x=T=f[1]/L}else{x=T=0}}var A=u.getDistance(o);s*=A;if(x<s||T<s){x=T=A/3}return[o,o.add(r.normalize(x)),u.add(i.normalize(T)),u]},reparameterize:function(e,t,n,r){for(var i=e;i<=t;i++){n[i-e]=this.findRoot(r,this.points[i],n[i-e])}},findRoot:function(e,t,n){var r=[],i=[];for(var s=0;s<=2;s++){r[s]=e[s+1].subtract(e[s]).multiply(3)}for(var s=0;s<=1;s++){i[s]=r[s+1].subtract(r[s]).multiply(2)}var o=this.evaluate(3,e,n),u=this.evaluate(2,r,n),a=this.evaluate(1,i,n),f=o.subtract(t),l=u.dot(u)+f.dot(a);if(Math.abs(l)<1e-5)return n;return n-f.dot(u)/l},evaluate:function(e,t,n){var r=t.slice();for(var i=1;i<=e;i++){for(var s=0;s<=e-i;s++){r[s]=r[s].multiply(1-n).add(r[s+1].multiply(n))}}return r[0]},chordLengthParameterize:function(e,t){var n=[0];for(var r=e+1;r<=t;r++){n[r-e]=n[r-e-1]+this.points[r].getDistance(this.points[r-1])}for(var r=1,i=t-e;r<=i;r++){n[r]/=n[i]}return n},findMaxError:function(e,t,n,r){var i=Math.floor((t-e+1)/2),s=0;for(var o=e+1;o<t;o++){var u=this.evaluate(3,n,r[o-e]);var a=u.subtract(this.points[o]);var f=a.x*a.x+a.y*a.y;if(f>=s){s=f;i=o}}return{error:s,index:i}}});var TextItem=this.TextItem=Item.extend({_boundsSelected:true,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(e){this._style=CharacterStyle.create(this);this._paragraphStyle=ParagraphStyle.create(this);var t=Base.isPlainObject(e)&&e.x===undefined&&e.y===undefined;this.base(t?null:Point.read(arguments));this.setParagraphStyle();this._content="";this._lines=[];if(t){this._set(e)}},_clone:function(e){e.setContent(this._content);e.setParagraphStyle(this._paragraphStyle);return this.base(e)},getContent:function(){return this._content},setContent:function(e){this._content=""+e;this._lines=this._content.split(/\r\n|\n|\r/mg);this._changed(69)},isEmpty:function(){return!this._content},getCharacterStyle:function(){return this.getStyle()},setCharacterStyle:function(e){this.setStyle(e)}});var PointText=this.PointText=TextItem.extend({_type:"PointText",clone:function(){return this._clone(new PointText)},getPoint:function(){var e=this._matrix.getTranslation();return LinkedPoint.create(this,"setPoint",e.x,e.y)},setPoint:function(e){this.translate(Point.read(arguments).subtract(this._matrix.getTranslation()))},draw:function(e){if(!this._content)return;this._setStyles(e);var t=this._style,n=this.getLeading(),r=this._lines;e.font=t.getFontStyle();e.textAlign=this.getJustification();for(var i=0,s=r.length;i<s;i++){var o=r[i];if(t._fillColor)e.fillText(o,0,0);if(t._strokeColor)e.strokeText(o,0,0);e.translate(0,n)}}},new function(){var e=null;return{_getBounds:function(t,n){if(!e)e=CanvasProvider.getContext(1,1);var r=this.getJustification(),i=0;e.font=this._style.getFontStyle();var s=0;for(var o=0,u=this._lines.length;o<u;o++)s=Math.max(s,e.measureText(this._lines[o]).width);if(r!=="left")i-=s/(r==="center"?2:1);var a=this.getLeading(),f=this._lines.length,l=Rectangle.create(i,f?a/4+(f-1)*a:0,s,-f*a);return n?n._transformBounds(l,l):l}}});var Style=Base.extend({initialize:function(e){var t=e instanceof Style;return Base.each(this._defaults,function(n,r){n=e&&e[r]||n;this[r]=n&&t&&n.clone?n.clone():n},this)},_getChildren:function(){return this._item instanceof Group&&this._item._children},statics:{create:function(e){var t=Base.create(this);t._item=e;return t},extend:function(e){var t="_"+e._style,n=Base.capitalize(e._style),r=e._flags||{},i={};i["get"+n]=function(){return this[t]};i["set"+n]=function(e){this[t].initialize(e)};Base.each(e._defaults,function(n,s){var o=/Color$/.test(s),u=Base.capitalize(s),a="set"+u,f="get"+u;e[a]=function(e){var n=this._getChildren();e=o?Color.read(arguments,0,0,true):e;if(n&&n.length>0){for(var i=0,u=n.length;i<u;i++)n[i][t][a](e)}else{var f=this["_"+s];if(!Base.equals(f,e)){if(o){if(f)delete f._owner;if(e){e._owner=this._item}}this["_"+s]=e;if(this._item)this._item._changed(r[s]||17)}}};e[f]=function(){var e=this._getChildren(),n;if(!e||e.length===0)return this["_"+s];for(var r=0,i=e.length;r<i;r++){var o=e[r][t][f]();if(!n){n=o}else if(!Base.equals(n,o)){return undefined}}return n};i[f]=function(){return this[t][f]()};i[a]=function(e){this[t][a](e)}});e._owner.inject(i);return this.base.apply(this,arguments)}}});var PathStyle=this.PathStyle=Style.extend({_owner:Item,_style:"style",_defaults:{fillColor:undefined,strokeColor:undefined,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",miterLimit:10,dashOffset:0,dashArray:[]},_flags:{strokeWidth:25,strokeCap:25,strokeJoin:25,miterLimit:25}});var ParagraphStyle=this.ParagraphStyle=Style.extend({_owner:TextItem,_style:"paragraphStyle",_defaults:{justification:"left"},_flags:{justification:5}});var CharacterStyle=this.CharacterStyle=PathStyle.extend({_owner:TextItem,_style:"style",_defaults:Base.merge(PathStyle.prototype._defaults,{fillColor:"black",fontSize:12,leading:null,font:"sans-serif"}),_flags:{fontSize:5,leading:5,font:5}},{getLeading:function(){var e=this.base();return e!=null?e:this.getFontSize()*1.2},getFontStyle:function(){var e=this._fontSize;return(/[a-z]/i.test(e)?e+" ":e+"px ")+this._font}});var Color=this.Color=Base.extend(new function(){function r(e){var r=t[e];if(r)return r.clone();if(!n){n=CanvasProvider.getContext(1,1);n.globalCompositeOperation="copy"}n.fillStyle="rgba(0,0,0,0)";n.fillStyle=e;n.fillRect(0,0,1,1);var i=n.getImageData(0,0,1,1).data,s=[i[0]/255,i[1]/255,i[2]/255];return(t[e]=RgbColor.read(s)).clone()}function i(e){var t=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);if(t.length>=4){var n=new Array(3);for(var r=0;r<3;r++){var i=t[r+1];n[r]=parseInt(i.length==1?i+i:i,16)/255}return RgbColor.read(n)}}var e={gray:["gray"],rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsb:["hue","saturation","brightness"]};var t={},n;var s=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];var o={"rgb-hsb":function(e){var t=e._red,n=e._green,r=e._blue,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s,u=o==0?0:(i==t?(n-r)/o+(n<r?6:0):i==n?(r-t)/o+2:(t-n)/o+4)*60,a=i==0?0:o/i,f=i;return new HsbColor(u,a,f,e._alpha)},"hsb-rgb":function(e){var t=e._hue/60%6,n=e._saturation,r=e._brightness,i=Math.floor(t),o=t-i,i=s[i],u=[r,r*(1-n),r*(1-n*o),r*(1-n*(1-o))];return new RgbColor(u[i[0]],u[i[1]],u[i[2]],e._alpha)},"rgb-hsl":function(e){var t=e._red,n=e._green,r=e._blue,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s,u=o==0,a=u?0:(i==t?(n-r)/o+(n<r?6:0):i==n?(r-t)/o+2:(t-n)/o+4)*60,f=(i+s)/2,l=u?0:f<.5?o/(i+s):o/(2-i-s);return new HslColor(a,l,f,e._alpha)},"hsl-rgb":function(e){var t=e._saturation,n=e._hue/360,r=e._lightness;if(t==0)return new RgbColor(r,r,r,e._alpha);var i=[n+1/3,n,n-1/3],s=r<.5?r*(1+t):r+t-r*t,o=2*r-s,u=[];for(var a=0;a<3;a++){var f=i[a];if(f<0)f+=1;if(f>1)f-=1;u[a]=6*f<1?o+(s-o)*6*f:2*f<1?s:3*f<2?o+(s-o)*(2/3-f)*6:o}return new RgbColor(u[0],u[1],u[2],e._alpha)},"rgb-gray":function(e){return new GrayColor(1-(e._red*.2989+e._green*.587+e._blue*.114),e._alpha)},"gray-rgb":function(e){var t=1-e._gray;return new RgbColor(t,t,t,e._alpha)},"gray-hsb":function(e){return new HsbColor(0,0,1-e._gray,e._alpha)},"gray-hsl":function(e){return new HslColor(0,0,1-e._gray,e._alpha)}};var u={_readNull:true,_readIndex:true,initialize:function(e){var t=Array.isArray(e),n=this._type,s;if(typeof e==="object"&&!t){if(!n){s=e.red!==undefined?new RgbColor(e.red,e.green,e.blue,e.alpha):e.gray!==undefined?new GrayColor(e.gray,e.alpha):e.lightness!==undefined?new HslColor(e.hue,e.saturation,e.lightness,e.alpha):e.hue!==undefined?new HsbColor(e.hue,e.saturation,e.brightness,e.alpha):new RgbColor;if(this._read)s._read=1}else{s=Color.read(arguments).convert(n);if(this._read)s._read=arguments._read}}else if(typeof e==="string"){var o=e.match(/^#[0-9a-f]{3,6}$/i)?i(e):r(e);s=n?o.convert(n):o;if(this._read)s._read=1}else{var u=t?e:Array.prototype.slice.call(arguments);if(!n){var a=u.length>=3?RgbColor:GrayColor;s=new a(u)}else{s=Base.each(this._components,function(e,t){var n=u[t];this["_"+e]=n!==undefined?n:null},this)}if(this._read)s._read=s._components.length}return s},_serialize:function(e){var t=[this._type];for(var n=0,r=this._components.length;n<r;n++){var i=this._components[n],s=this["_"+i];if(i!=="alpha"||s!=null&&s<1)t.push(Format.number(s,e.precision))}return t},clone:function(){var e=Base.create(this.constructor),t=this._components;for(var n=0,r=t.length;n<r;n++){var i="_"+t[n];e[i]=this[i]}return e},convert:function(e){var t;return this._type==e?this.clone():(t=o[this._type+"-"+e])?t(this):o["rgb-"+e](o[this._type+"-rgb"](this))},statics:{extend:function(t){var n=e[t._type];if(n){t._components=n.concat(["alpha"]);Base.each(n,function(e){var t=e==="hue",n=Base.capitalize(e),e="_"+e;this["get"+n]=function(){return this[e]};this["set"+n]=function(n){this[e]=t?(n%360+360)%360:Math.min(Math.max(n,0),1);this._changed()}},t)}return this.base.apply(this,arguments)},random:function(){return new RgbColor(Math.random(),Math.random(),Math.random())}}};Base.each(e,function(e,t){Base.each(e,function(e){var n=Base.capitalize(e);u["get"+n]=function(){return this.convert(t)[e]};u["set"+n]=function(n){var r=this.convert(t);r[e]=n;r=r.convert(this._type);for(var i=0,s=this._components.length;i<s;i++){var o=this._components[i];this[o]=r[o]}}})});return u},{_changed:function(){this._css=null;if(this._owner)this._owner._changed(17)},getType:function(){return this._type},getComponents:function(){var e=this._components.length;var t=new Array(e);for(var n=0;n<e;n++)t[n]=this["_"+this._components[n]];return t},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(e){this._alpha=e==null?null:Math.min(Math.max(e,0),1);this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(e){if(e&&e._type===this._type){for(var t=0,n=this._components.length;t<n;t++){var r="_"+this._components[t];if(this[r]!==e[r])return false}return true}return false},toString:function(){var e=[],t=Format.number;for(var n=0,r=this._components.length;n<r;n++){var i=this._components[n],s=this["_"+i];if(i==="alpha"&&s==null)s=1;e.push(i+": "+t(s))}return"{ "+e.join(", ")+" }"},toCss:function(e){var t=this._css;if(!t||e){var n=this.convert("rgb"),r=e?1:n.getAlpha(),i=[Math.round(n._red*255),Math.round(n._green*255),Math.round(n._blue*255)];if(r<1)i.push(r);var t=(i.length==4?"rgba(":"rgb(")+i.join(", ")+")";if(!e)this._css=t}return t},toCanvasStyle:function(){return this.toCss()}});var GrayColor=this.GrayColor=Color.extend({_type:"gray"});var RgbColor=this.RgbColor=this.RGBColor=Color.extend({_type:"rgb"});var HsbColor=this.HsbColor=this.HSBColor=Color.extend({_type:"hsb"});var HslColor=this.HslColor=this.HSLColor=Color.extend({_type:"hsl"});var GradientColor=this.GradientColor=Color.extend({_type:"gradient",initialize:function(e,t,n,r){this._id=++Base._uid;if(!this._set(e)){this.setGradient(e||new LinearGradient);this.setOrigin(t);this.setDestination(n);if(r)this.setHilite(r)}},clone:function(){return new GradientColor(this._gradient,this._origin,this._destination,this._hilite)},_serialize:function(e,t){var n=[this._gradient,this._origin,this._destination];if(this._hilite)n.push(this._hilite);return Base.serialize(n,e,true,t)},getGradient:function(){return this._gradient},setGradient:function(e){this._gradient=e;e._addOwner(this);this._changed()},getOrigin:function(){return this._origin},setOrigin:function(e){e=Point.read(arguments,0,0,true);this._origin=e;if(this._destination)this._radius=this._destination.getDistance(this._origin);this._changed()},getDestination:function(){return this._destination},setDestination:function(e){e=Point.read(arguments,0,0,true);this._destination=e;this._radius=this._destination.getDistance(this._origin);this._changed()},getHilite:function(){return this._hilite},setHilite:function(e){e=Point.read(arguments,0,0,true);var t=e.subtract(this._origin);if(t.getLength()>this._radius){this._hilite=this._origin.add(t.normalize(this._radius-.1))}else{this._hilite=e}this._changed()},toCanvasStyle:function(e){var t,n=this._gradient._stops;if(this._gradient._type==="LinearGradient"){t=e.createLinearGradient(this._origin.x,this._origin.y,this._destination.x,this._destination.y)}else{var r=this._hilite||this._origin;t=e.createRadialGradient(r.x,r.y,0,this._origin.x,this._origin.y,this._radius)}for(var i=0,s=n.length;i<s;i++){var o=n[i];t.addColorStop(o._rampPoint,o._color.toCss())}return t},equals:function(e){return e===this||e&&e._type===this._type&&this._gradient.equals(e._gradient)&&this._origin.equals(e._origin)&&this._destination.equals(e._destination)},transform:function(e){e._transformPoint(this._origin,this._origin,true);e._transformPoint(this._destination,this._destination,true);if(this._hilite)e._transformPoint(this._hilite,this._hilite,true);this._radius=this._destination.getDistance(this._origin)}});var Gradient=this.Gradient=Base.extend({initialize:function(e,t){if(this.constructor===Gradient)return new(t==="radial"?RadialGradient:LinearGradient)(e);this._id=++Base._uid;this.setStops((arguments.length>1?arguments:e)||["white","black"])},_serialize:function(e,t){return t.add(this,function(){return Base.serialize([this._type,this._stops],e,true,t)})},_changed:function(){for(var e=0,t=this._owners&&this._owners.length;e<t;e++)this._owners[e]._changed()},_addOwner:function(e){if(!this._owners)this._owners=[];this._owners.push(e)},_removeOwner:function(e){var t=this._owners?this._owners.indexOf(e):-1;if(t!=-1){this._owners.splice(t,1);if(this._owners.length==0)delete this._owners}},clone:function(){var e=[];for(var t=0,n=this._stops.length;t<n;t++)e[t]=this._stops[t].clone();return new this.constructor(e)},getStops:function(){return this._stops},setStops:function(e){if(this.stops){for(var t=0,n=this._stops.length;t<n;t++)delete this._stops[t]._owner}if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");this._stops=GradientStop.readAll(e,0,true);for(var t=0,n=this._stops.length;t<n;t++){var r=this._stops[t];r._owner=this;if(r._defaultRamp)r.setRampPoint(t/(n-1))}this._changed()},equals:function(e){if(e&&e.constructor==this.constructor&&this._stops.length==e._stops.length){for(var t=0,n=this._stops.length;t<n;t++){if(!this._stops[t].equals(e._stops[t]))return false}return true}return false}});var LinearGradient=this.LinearGradient=Gradient.extend({_type:"LinearGradient"});var RadialGradient=this.RadialGradient=Gradient.extend({_type:"RadialGradient"});var GradientStop=this.GradientStop=Base.extend({initialize:function(e,t){if(e){var n,r;if(t===undefined&&Array.isArray(e)){n=e[0];r=e[1]}else if(e.color){n=e.color;r=e.rampPoint}else{n=e;r=t}this.setColor(n);this.setRampPoint(r)}},clone:function(){return new GradientStop(this._color.clone(),this._rampPoint)},_serialize:function(e,t){return Base.serialize([this._color,this._rampPoint],e,false,t)},_changed:function(){if(this._owner)this._owner._changed(17)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(e){this._defaultRamp=e==null;this._rampPoint=e||0;this._changed()},getColor:function(){return this._color},setColor:function(e){this._color=Color.read(arguments);if(this._color===e)this._color=e.clone();this._color._owner=this;this._changed()},equals:function(e){return e==this||e instanceof GradientStop&&this._color.equals(e._color)&&this._rampPoint==e._rampPoint}});var DomElement=new function(){function r(e,t){var n=[];for(var i=0,s=e&&e.length;i<s;){var o=e[i++];if(typeof o==="string"){o=document.createElement(o)}else if(!o||!o.nodeType){continue}if(Base.isPlainObject(e[i]))DomElement.set(o,e[i++]);if(Array.isArray(e[i]))r(e[i++],o);if(t)t.appendChild(o);n.push(o)}return n}var e=/^(checked|value|selected|disabled)$/i,t={text:"textContent",html:"innerHTML"},n={lineHeight:1,zoom:1,zIndex:1,opacity:1};return{create:function(e,t){var n=Array.isArray(e),i=r(n?e:arguments,n?t:null);return i.length==1?i[0]:i},find:function(e,t){return(t||document).querySelector(e)},findAll:function(e,t){return(t||document).querySelectorAll(e)},get:function(n,r){return n?e.test(r)?r==="value"||typeof n[r]!=="string"?n[r]:true:r in t?n[t[r]]:n.getAttribute(r):null},set:function(n,r,i){if(typeof r!=="string"){for(var s in r)if(r.hasOwnProperty(s))this.set(n,s,r[s])}else if(!n||i===undefined){return n}else if(e.test(r)){n[r]=i}else if(r in t){n[t[r]]=i}else if(r==="style"){this.setStyle(n,i)}else if(r==="events"){DomEvent.add(n,i)}else{n.setAttribute(r,i)}return n},getStyles:function(e){var t=e&&e.ownerDocument.defaultView;return t&&t.getComputedStyle(e,"")},getStyle:function(e,t){return e&&e.style[t]||this.getStyles(e)[t]||null},setStyle:function(e,t,r){if(typeof t!=="string"){for(var i in t)if(t.hasOwnProperty(i))this.setStyle(e,i,t[i])}else{if(/^-?[\d\.]+$/.test(r)&&!(t in n))r+="px";e.style[t]=r}return e},hasClass:function(e,t){return(new RegExp("\\s*"+t+"\\s*")).test(e.className)},addClass:function(e,t){e.className=(e.className+" "+t).trim()},removeClass:function(e,t){e.className=e.className.replace(new RegExp("\\s*"+t+"\\s*")," ").trim()},remove:function(e){if(e.parentNode)e.parentNode.removeChild(e)},removeChildren:function(e){while(e.firstChild)e.removeChild(e.firstChild)},getBounds:function(e,t){var n=e.getBoundingClientRect(),r=e.ownerDocument,i=r.body,s=r.documentElement,o=n.left-(s.clientLeft||i.clientLeft||0),u=n.top-(s.clientTop||i.clientTop||0);if(!t){var a=r.defaultView;o+=a.pageXOffset||s.scrollLeft||i.scrollLeft;u+=a.pageYOffset||s.scrollTop||i.scrollTop}return new Rectangle(o,u,n.width,n.height)},getViewportBounds:function(e){var t=e.ownerDocument,n=t.defaultView,r=t.documentElement;return Rectangle.create(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(e,t){return this.getBounds(e,t).getPoint()},getSize:function(e){return this.getBounds(e,true).getSize()},isInvisible:function(e){return this.getSize(e).equals([0,0])},isInView:function(e){return!this.isInvisible(e)&&this.getViewportBounds(e).intersects(this.getBounds(e,true))}}};var DomEvent={add:function(e,t){for(var n in t){var r=t[n];if(e.addEventListener){e.addEventListener(n,r,false)}else if(e.attachEvent){e.attachEvent("on"+n,r.bound=function(){r.call(e,window.event)})}}},remove:function(e,t){for(var n in t){var r=t[n];if(e.removeEventListener){e.removeEventListener(n,r,false)}else if(e.detachEvent){e.detachEvent("on"+n,r.bound)}}},getPoint:function(e){var t=e.targetTouches?e.targetTouches.length?e.targetTouches[0]:e.changedTouches[0]:e;return Point.create(t.pageX||t.clientX+document.documentElement.scrollLeft,t.pageY||t.clientY+document.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getOffset:function(e,t){return DomEvent.getPoint(e).subtract(DomElement.getOffset(t||DomEvent.getTarget(e)))},preventDefault:function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},stop:function(e){DomEvent.stopPropagation(e);DomEvent.preventDefault(e)}};DomEvent.requestAnimationFrame=new function(){var e="equestAnimationFrame",t=window["r"+e]||window["webkitR"+e]||window["mozR"+e]||window["oR"+e]||window["msR"+e];if(t){t(function(e){if(e==null)t=null})}var n=[],r=true,i;DomEvent.add(window,{focus:function(){r=true},blur:function(){r=false}});return function(e,s){if(t)return t(e,s);n.push([e,s]);if(i)return;i=setInterval(function(){for(var e=n.length-1;e>=0;e--){var t=n[e],i=t[0],s=t[1];if(!s||(PaperScript.getAttribute(s,"keepalive")=="true"||r)&&DomElement.isInView(s)){n.splice(e,1);i(Date.now())}}},1e3/60)}};var View=this.View=Base.extend(Callback,{initialize:function(e){this._scope=paper;this._project=paper.project;this._element=e;var t;this._id=e.getAttribute("id");if(this._id==null)e.setAttribute("id",this._id="view-"+View._id++);DomEvent.add(e,this._viewHandlers);if(PaperScript.hasAttribute(e,"resize")){var n=DomElement.getOffset(e,true),r=this;t=DomElement.getViewportBounds(e).getSize().subtract(n);this._windowHandlers={resize:function(t){if(!DomElement.isInvisible(e))n=DomElement.getOffset(e,true);r.setViewSize(DomElement.getViewportBounds(e).getSize().subtract(n))}};DomEvent.add(window,this._windowHandlers)}else{t=Size.create(parseInt(e.getAttribute("width"),10),parseInt(e.getAttribute("height"),10));if(t.isNaN())t=DomElement.getSize(e)}e.width=t.width;e.height=t.height;if(PaperScript.hasAttribute(e,"stats")){this._stats=new Stats;var i=this._stats.domElement,s=i.style,n=DomElement.getOffset(e);s.position="absolute";s.left=n.x+"px";s.top=n.y+"px";document.body.appendChild(i)}View._views.push(this);View._viewsById[this._id]=this;this._viewSize=LinkedSize.create(this,"setViewSize",t.width,t.height);this._matrix=new Matrix;this._zoom=1;if(!View._focused)View._focused=this;this._frameItems={};this._frameItemCount=0},remove:function(){if(!this._project)return false;if(View._focused==this)View._focused=null;View._views.splice(View._views.indexOf(this),1);delete View._viewsById[this._id];if(this._project.view==this)this._project.view=null;DomEvent.remove(this._element,this._viewHandlers);DomEvent.remove(window,this._windowHandlers);this._element=this._project=null;this.detach("frame");this._frameItems={};return true},_events:{onFrame:{install:function(){if(!this._requested){this._animate=true;this._handleFrame(true)}},uninstall:function(){this._animate=false}},onResize:{}},_animate:false,_time:0,_count:0,_handleFrame:function(e){this._requested=false;if(!this._animate)return;paper=this._scope;if(e){this._requested=true;var t=this;DomEvent.requestAnimationFrame(function(){t._handleFrame(true)},this._element)}var n=Date.now()/1e3,r=this._before?n-this._before:0;this._before=n;this.fire("frame",Base.merge({delta:r,time:this._time+=r,count:this._count++}));if(this._stats)this._stats.update();this.draw(true)},_animateItem:function(e,t){var n=this._frameItems;if(t){n[e._id]={item:e,time:0,count:0};if(++this._frameItemCount==1)this.attach("frame",this._handleFrameItems)}else{delete n[e._id];if(--this._frameItemCount==0){this.detach("frame",this._handleFrameItems)}}},_handleFrameItems:function(e){for(var t in this._frameItems){var n=this._frameItems[t];n.item.fire("frame",Base.merge(e,{time:n.time+=e.delta,count:n.count++}))}},_redraw:function(){this._redrawNeeded=true;if(this._animate){this._handleFrame()}else{this.draw()}},_transform:function(e){this._matrix.concatenate(e);this._bounds=null;this._inverse=null;this._redraw()},getElement:function(){return this._element},getViewSize:function(){return this._viewSize},setViewSize:function(e){e=Size.read(arguments);var t=e.subtract(this._viewSize);if(t.isZero())return;this._element.width=e.width;this._element.height=e.height;this._viewSize.set(e.width,e.height,true);this._bounds=null;this.fire("resize",{size:e,delta:t});this._redraw()},getBounds:function(){if(!this._bounds)this._bounds=this._getInverse()._transformBounds(new Rectangle(new Point,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(e){this.scrollBy(Point.read(arguments).subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(e){this._transform((new Matrix).scale(e/this._zoom,this.getCenter()));this._zoom=e},isVisible:function(){return DomElement.isInView(this._element)},scrollBy:function(e){this._transform((new Matrix).translate(Point.read(arguments).negate()))},projectToView:function(e){return this._matrix._transformPoint(Point.read(arguments))},viewToProject:function(e){return this._getInverse()._transformPoint(Point.read(arguments))},_getInverse:function(){if(!this._inverse)this._inverse=this._matrix.inverted();return this._inverse}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e){if(typeof e==="string")e=document.getElementById(e);return new CanvasView(e)}}},new function(){function i(e){var t=DomEvent.getTarget(e);return t.getAttribute&&View._viewsById[t.getAttribute("id")]}function s(e,t){return e.viewToProject(DomEvent.getOffset(t,e._element))}function o(){if(!View._focused||!View._focused.isVisible()){for(var e=0,t=View._views.length;e<t;e++){var r=View._views[e];if(r&&r.isVisible()){View._focused=n=r;break}}}}function u(t){var n=View._focused=i(t),o=s(n,t);r=true;if(n._onMouseDown)n._onMouseDown(t,o);if(e=n._scope._tool)e._onHandleEvent("mousedown",o,t);n.draw(true)}function a(u){var a;if(!r){a=i(u);if(a){t=View._focused;View._focused=n=a}else if(n&&n==View._focused){View._focused=t;o()}}if(!(a=a||View._focused))return;var f=u&&s(a,u);if(a._onMouseMove)a._onMouseMove(u,f);if(e=a._scope._tool){if(e._onHandleEvent(r&&e.responds("mousedrag")?"mousedrag":"mousemove",f,u))DomEvent.stop(u)}a.draw(true)}function f(t){var n=View._focused;if(!n||!r)return;var i=s(n,t);curPoint=null;r=false;if(n._onMouseUp)n._onMouseUp(t,i);if(e&&e._onHandleEvent("mouseup",i,t))DomEvent.stop(t);n.draw(true)}function l(e){if(r)DomEvent.stop(e)}var e,t,n,r=false;DomEvent.add(document,{mousemove:a,mouseup:f,touchmove:a,touchend:f,selectstart:l,scroll:o});DomEvent.add(window,{load:o});return{_viewHandlers:{mousedown:u,touchstart:u,selectstart:l},statics:{updateFocus:o}}});var CanvasView=View.extend({initialize:function(e){if(!(e instanceof HTMLCanvasElement)){var t=Size.read(arguments,1);if(t.isZero())t=Size.create(1024,768);e=CanvasProvider.getCanvas(t)}this._context=e.getContext("2d");this._eventCounters={};this.base(e)},draw:function(e){if(e&&!this._redrawNeeded)return false;var t=this._context,n=this._viewSize;t.clearRect(0,0,n._width+1,n._height+1);this._project.draw(t,this._matrix);this._redrawNeeded=false;return true}},new function(){function f(e,t,n,r,i,s){var o=r,u;while(o){if(o.responds(e)){if(!u)u=new MouseEvent(e,t,n,r,i?n.subtract(i):null);if(o.fire(e,u)&&(!s||u._stopped))return false}o=o.getParent()}return true}function l(e,t,n,r,i){if(e._eventCounters[t]){var u=e._project,a=u.hitTest(r,{tolerance:u.options.hitTolerance||0,fill:true,stroke:true}),l=a&&a.item;if(l){if(t==="mousemove"&&l!=s)i=r;if(t!=="mousemove"||!o)f(t,n,r,l,i);return l}}}var e,t,n,r,i,s,o,u,a;return{_onMouseDown:function(s,f){var c=l(this,"mousedown",s,f);u=i==c&&Date.now()-a<300;r=i=c;e=t=n=f;o=r&&r.responds("mousedrag")},_onMouseUp:function(i,s){var c=l(this,"mouseup",i,s);if(o){if(t&&!t.equals(s))f("mousedrag",i,s,r,t);if(c!=r){n=s;f("mousemove",i,s,c,n)}}if(c===r){a=Date.now();if(!u||f("doubleclick",i,e,c))f("click",i,e,c);u=false}r=null;o=false},_onMouseMove:function(e,i){if(r)f("mousedrag",e,i,r,t);var o=l(this,"mousemove",e,i,n);t=n=i;if(o!==s){f("mouseleave",e,i,s);s=o;f("mouseenter",e,i,o)}}}});var Event=this.Event=Base.extend({initialize:function(e){this.event=e},preventDefault:function(){this._prevented=true;DomEvent.preventDefault(this.event)},stopPropagation:function(){this._stopped=true;DomEvent.stopPropagation(this.event)},stop:function(){this.stopPropagation();this.preventDefault()},getModifiers:function(){return Key.modifiers}});var KeyEvent=this.KeyEvent=Event.extend({initialize:function(e,t,n,r){this.base(r);this.type=e?"keydown":"keyup";this.key=t;this.character=n},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}});var Key=this.Key=new function(){function s(t,n,i,s){var o=String.fromCharCode(i),u=e[n]||o.toLowerCase(),a=t?"keydown":"keyup",f=View._focused,l=f&&f.isVisible()&&f._scope,c=l&&l._tool;r[u]=t;if(c&&c.responds(a)){c.fire(a,new KeyEvent(t,u,o,s));if(f)f.draw(true)}}var e={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},t=Base.merge({shift:false,control:false,option:false,command:false,capsLock:false,space:false}),n={},r={},i;DomEvent.add(document,{keydown:function(r){var o=r.which||r.keyCode;var u=e[o],a;if(u){if((a=Base.camelize(u))in t)t[a]=true;n[o]=0;s(true,o,null,r)}else{i=o}},keypress:function(e){if(i!=null){var t=e.which||e.keyCode;n[i]=t;s(true,i,t,e);i=null}},keyup:function(r){var i=r.which||r.keyCode,o=e[i],u;if(o&&(u=Base.camelize(o))in t)t[u]=false;if(n[i]!=null){s(false,i,n[i],r);delete n[i]}}});return{modifiers:t,isDown:function(e){return!!r[e]}}};var MouseEvent=this.MouseEvent=Event.extend({initialize:function(e,t,n,r,i){this.base(t);this.type=e;this.point=n;this.target=r;this.delta=i},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}});var Palette=this.Palette=Base.extend(Callback,{_events:["onChange"],initialize:function(e,t,n){var r=DomElement.find(".palettejs-panel")||DomElement.find("body").appendChild(DomElement.create("div",{"class":"palettejs-panel"}));this._element=r.appendChild(DomElement.create("table",{"class":"palettejs-pane"})),this._title=e;if(!n)n={};for(var i in this._components=t){var s=t[i];if(!(s instanceof Component)){if(s.value==null)s.value=n[i];s.name=i;s=t[i]=new Component(s)}this._element.appendChild(s._element);s._palette=this;if(n[i]===undefined)n[i]=s.value}this._values=Base.each(n,function(e,r){var i=t[r];if(i){Base.define(n,r,{enumerable:true,configurable:true,writable:true,get:function(){return i._value},set:function(e){i.setValue(e)}})}});if(window.paper)paper.palettes.push(this)},reset:function(){for(var e in this._components)this._components[e].reset()},remove:function(){DomElement.remove(this._element)}});var Component=this.Component=Base.extend(Callback,{_events:["onChange","onClick"],_types:{"boolean":{type:"checkbox",value:"checked"},string:{type:"text"},number:{type:"number",number:true},button:{type:"button"},text:{tag:"div",value:"text"},slider:{type:"range",number:true},list:{tag:"select",options:function(){DomElement.removeChildren(this._inputItem);DomElement.create(Base.each(this._options,function(e){this.push("option",{value:e,text:e})},[]),this._inputItem)}}},initialize:function(e){this._type=e.type in this._types?e.type:"options"in e?"list":"onClick"in e?"button":typeof e.value;this._info=this._types[this._type]||{type:this._type};var t=this,n=false;this._inputItem=DomElement.create(this._info.tag||"input",{type:this._info.type,events:{change:function(){t.setValue(DomElement.get(this,t._info.value||"value"));if(n){t._palette.fire("change",t,t.name,t._value);t.fire("change",t._value)}},click:function(){t.fire("click")}}});this._element=DomElement.create("tr",[this._labelItem=DomElement.create("td"),"td",[this._inputItem]]);Base.each(e,function(e,t){this[t]=e},this);this._defaultValue=this._value;n=true},getType:function(){return this._type},getLabel:function(){return this._label},setLabel:function(e){this._label=e;DomElement.set(this._labelItem,"text",e+":")},getOptions:function(){return this._options},setOptions:function(e){this._options=e;if(this._info.options)this._info.options.call(this)},getValue:function(){return this._value},setValue:function(e){var t=this._info.value||"value";DomElement.set(this._inputItem,t,e);e=DomElement.get(this._inputItem,t);this._value=this._info.number?parseFloat(e,10):e},getRange:function(){return[parseFloat(DomElement.get(this._inputItem,"min")),parseFloat(DomElement.get(this._inputItem,"max"))]},setRange:function(e,t){var n=Array.isArray(e)?e:[e,t];DomElement.set(this._inputItem,{min:n[0],max:n[1]})},getMin:function(){return this.getRange()[0]},setMin:function(e){this.setRange(e,this.getMax())},getMax:function(){return this.getRange()[1]},setMax:function(e){this.setRange(this.getMin(),e)},getStep:function(){return parseFloat(DomElement.get(this._inputItem,"step"))},setStep:function(e){DomElement.set(this._inputItem,"step",e)},reset:function(){this.setValue(this._defaultValue)}});var ToolEvent=this.ToolEvent=Event.extend({_item:null,initialize:function(e,t,n){this.tool=e;this.type=t;this.event=n},_choosePoint:function(e,t){return e?e:t?t.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint){return this.tool._point.add(this.tool._lastPoint).divide(2)}return this.middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){var t=e.item,n=t._parent;while(n instanceof Group&&!(n instanceof Layer)||n instanceof CompoundPath){t=n;n=n._parent}this._item=t}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}});var Tool=this.Tool=PaperScopeItem.extend({_list:"tools",_reference:"_tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(e){this.base();this._firstMove=true;this._count=0;this._downCount=0;this._set(e)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){this._minDistance=e;if(this._minDistance!=null&&this._maxDistance!=null&&this._minDistance>this._maxDistance){this._maxDistance=this._minDistance}},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e;if(this._minDistance!=null&&this._maxDistance!=null&&this._maxDistance<this._minDistance){this._minDistance=e}},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=e;this._maxDistance=e},_updateEvent:function(e,t,n,r,i,s,o){if(!i){if(n!=null||r!=null){var u=n!=null?n:0,a=t.subtract(this._point),f=a.getLength();if(f<u)return false;var l=r!=null?r:0;if(l!=0){if(f>l){t=this._point.add(a.normalize(l))}else if(o){return false}}}if(s&&t.equals(this._point))return false}this._lastPoint=i&&e=="mousemove"?t:this._point;this._point=t;switch(e){case"mousedown":this._lastPoint=this._downPoint;this._downPoint=this._point;this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint;break}this._count=i?0:this._count+1;return true},fire:function(e,t){var n=Tool._removeSets;if(n){if(e==="mouseup")n.mousedrag=null;var r=n[e];if(r){for(var i in r){var s=r[i];for(var o in n){var u=n[o];if(u&&u!=r)delete u[s._id]}s.remove()}n[e]=null}}return this.base(e,t)},_onHandleEvent:function(e,t,n){paper=this._scope;var r=false;switch(e){case"mousedown":this._updateEvent(e,t,null,null,true,false,false);if(this.responds(e))r=this.fire(e,new ToolEvent(this,e,n));break;case"mousedrag":var i=false,s=false;while(this._updateEvent(e,t,this.minDistance,this.maxDistance,false,i,s)){if(this.responds(e))r=this.fire(e,new ToolEvent(this,e,n));i=true;s=true}break;case"mouseup":if(!t.equals(this._point)&&this._updateEvent("mousedrag",t,this.minDistance,this.maxDistance,false,false,false)){if(this.responds("mousedrag"))r=this.fire("mousedrag",new ToolEvent(this,e,n))}this._updateEvent(e,t,null,this.maxDistance,false,false,false);if(this.responds(e))r=this.fire(e,new ToolEvent(this,e,n));this._updateEvent(e,t,null,null,true,false,false);this._firstMove=true;break;case"mousemove":while(this._updateEvent(e,t,this.minDistance,this.maxDistance,this._firstMove,true,false)){if(this.responds(e))r=this.fire(e,new ToolEvent(this,e,n));this._firstMove=false}break}return r}});var Format=new function(){function t(t,n){n=n?e[n]||(e[n]=Math.pow(10,n)):1e5;return Math.round(t*n)/n}function n(e,n,r){return t(e.x,n)+(r||",")+t(e.y,n)}function r(e,n,r){return t(e.width,n)+(r||",")+t(e.height,n)}function i(e,t,i){return n(e,t,i)+(i||",")+r(e,t,i)}var e={};return{number:t,point:n,size:r,rectangle:i}};var CanvasProvider={canvases:[],getCanvas:function(e,t){var n=t===undefined?e:Size.create(e,t);if(this.canvases.length){var r=this.canvases.pop();if(r.width!=n.width||r.height!=n.height){r.width=n.width;r.height=n.height}else{r.getContext("2d").clearRect(0,0,n.width+1,n.height+1)}return r}else{var r=document.createElement("canvas");r.width=n.width;r.height=n.height;return r}},getContext:function(e,t){return this.getCanvas(e,t).getContext("2d")},release:function(e){this.canvases.push(e.canvas?e.canvas:e)}};var Numerical=new function(){function u(e){return e>0?i(e,1/3):e<0?-i(-e,1/3):0}var e=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]];var t=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]];var n=Math.abs,r=Math.sqrt,i=Math.pow,s=Math.cos,o=Math.PI;return{TOLERANCE:1e-5,EPSILON:1e-11,isZero:function(e){return Math.abs(e)<=this.EPSILON},integrate:function(n,r,i,s){var o=e[s-2],u=t[s-2],a=.5*(i-r),f=a+r,l=0,c=s+1>>1,h=s&1?u[l++]*n(f):0;while(l<c){var p=a*o[l];h+=u[l++]*(n(f+p)+n(f-p))}return a*h},findRoot:function(e,t,r,i,s,o,u){for(var a=0;a<o;a++){var f=e(r),l=f/t(r);if(n(l)<u)return r;var c=r-l;if(f>0){s=r;r=c<=i?.5*(i+s):c}else{i=r;r=c>=s?.5*(i+s):c}}},solveQuadratic:function(e,t,i,s,o){if(n(e)<o){if(n(t)>=o){s[0]=-i/t;return 1}return n(i)<o?-1:0}var u=t*t-4*e*i;if(u<0)return 0;u=r(u);e*=2;var a=0;s[a++]=(-t-u)/e;if(u>0)s[a++]=(-t+u)/e;return a},solveCubic:function(e,t,i,a,f,l){if(n(e)<l)return Numerical.solveQuadratic(t,i,a,f,l);t/=e;i/=e;a/=e;var c=t*t,h=1/3*(-1/3*c+i),p=1/2*(2/27*t*c-1/3*t*i+a),d=h*h*h,v=p*p+d;t/=3;if(n(v)<l){if(n(p)<l){f[0]=-t;return 1}else{var m=u(-p);f[0]=2*m-t;f[1]=-m-t;return 2}}else if(v<0){var g=1/3*Math.acos(-p/r(-d));var y=2*r(-h);f[0]=y*s(g)-t;f[1]=-y*s(g+o/3)-t;f[2]=-y*s(g-o/3)-t;return 3}else{v=r(v);f[0]=u(v-p)-u(v+p)-t;return 1}}}};var BlendMode={process:function(e,t,n,r,i){function x(e,t,n){return.2989*e+.587*t+.114*n}function T(e,t,n,r){var i=r-x(e,t,n);w=e+i;E=t+i;S=n+i;var r=x(w,E,S),s=f(w,E,S),o=l(w,E,S);if(s<0){var u=r-s;w=r+(w-r)*r/u;E=r+(E-r)*r/u;S=r+(S-r)*r/u}if(o>255){var a=255-r,c=o-r;w=r+(w-r)*a/c;E=r+(E-r)*a/c;S=r+(S-r)*a/c}}function N(e,t,n){return l(e,t,n)-f(e,t,n)}function C(e,t,n,r){var i=[e,t,n],s=l(e,t,n),o=f(e,t,n),u;o=o==e?0:o==t?1:2;s=s==e?0:s==t?1:2;u=f(o,s)==0?l(o,s)==1?2:1:0;if(i[s]>i[o]){i[u]=(i[u]-i[o])*r/(i[s]-i[o]);i[s]=r}else{i[u]=i[s]=0}i[o]=0;w=i[0];E=i[1];S=i[2]}var s=t.canvas,o=n.getImageData(i.x,i.y,s.width,s.height),u=o.data,a=t.getImageData(0,0,s.width,s.height).data,f=Math.min,l=Math.max,c=Math.abs,h,p,d,v,m,g,y,b,w,E,S;var k={multiply:function(){w=m*h/255;E=g*p/255;S=y*d/255},screen:function(){w=255-(255-m)*(255-h)/255;E=255-(255-g)*(255-p)/255;S=255-(255-y)*(255-d)/255},overlay:function(){w=m<128?2*m*h/255:255-2*(255-m)*(255-h)/255;E=g<128?2*g*p/255:255-2*(255-g)*(255-p)/255;S=y<128?2*y*d/255:255-2*(255-y)*(255-d)/255},"soft-light":function(){var e=h*m/255;w=e+m*(255-(255-m)*(255-h)/255-e)/255;e=p*g/255;E=e+g*(255-(255-g)*(255-p)/255-e)/255;e=d*y/255;S=e+y*(255-(255-y)*(255-d)/255-e)/255},"hard-light":function(){w=h<128?2*h*m/255:255-2*(255-h)*(255-m)/255;E=p<128?2*p*g/255:255-2*(255-p)*(255-g)/255;S=d<128?2*d*y/255:255-2*(255-d)*(255-y)/255},"color-dodge":function(){w=h==255?h:f(255,m*255/(255-h));E=p==255?p:f(255,g*255/(255-p));S=d==255?d:f(255,y*255/(255-d))},"color-burn":function(){w=h==0?0:l(255-(255-m)*255/h,0);E=p==0?0:l(255-(255-g)*255/p,0);S=d==0?0:l(255-(255-y)*255/d,0)},darken:function(){w=m<h?m:h;E=g<p?g:p;S=y<d?y:d},lighten:function(){w=m>h?m:h;E=g>p?g:p;S=y>d?y:d},difference:function(){w=m-h;if(w<0)w=-w;E=g-p;if(E<0)E=-E;S=y-d;if(S<0)S=-S},exclusion:function(){w=m+h*(255-m-m)/255;E=g+p*(255-g-g)/255;S=y+d*(255-y-y)/255},hue:function(){C(h,p,d,N(m,g,y));T(w,E,S,x(m,g,y))},saturation:function(){C(m,g,y,N(h,p,d));T(w,E,S,x(m,g,y))},luminosity:function(){T(m,g,y,x(h,p,d))},color:function(){T(h,p,d,x(m,g,y))},add:function(){w=f(m+h,255);E=f(g+p,255);S=f(y+d,255)},subtract:function(){w=l(m-h,0);E=l(g-p,0);S=l(y-d,0)},average:function(){w=(m+h)/2;E=(g+p)/2;S=(y+d)/2},negation:function(){w=255-c(255-h-m);E=255-c(255-p-g);S=255-c(255-d-y)}};var L=k[e];if(!L)return;for(var A=0,O=u.length;A<O;A+=4){h=a[A];m=u[A];p=a[A+1];g=u[A+1];d=a[A+2];y=u[A+2];v=a[A+3];b=u[A+3];L();var M=v*r/255,_=1-M;u[A]=M*w+_*m;u[A+1]=M*E+_*g;u[A+2]=M*S+_*y;u[A+3]=v*r+_*b}n.putImageData(o,i.x,i.y)}};var SvgStyles=Base.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"]},function(e,t){var n=Base.capitalize(t);this[t]={type:e[1],property:t,attribute:e[0],get:"get"+n,set:"set"+n}},{});new function(){function n(n,r){for(var i in r){var s=r[i],o=t[i];if(typeof s==="number")s=e(s);if(o){n.setAttributeNS(o,i,s)}else{n.setAttribute(i,s)}}return n}function r(e,t){return n(document.createElementNS("http://www.w3.org/2000/svg",e),t)}function s(e,t,n){return e[t]._point.getDistance(e[n]._point)}function o(t,n){var r=t._matrix,i=r.getTranslation(),s={};if(n){r=r.shiftless();var o=r._inverseTransform(i);s.x=o.x;s.y=o.y;i=null}if(r.isIdentity())return s;var u=r.decompose();if(u&&!u.shearing){var a=[],f=u.rotation,l=u.scaling;if(i&&!i.isZero())a.push("translate("+Format.point(i)+")");if(!Numerical.isZero(l.x-1)||!Numerical.isZero(l.y-1))a.push("scale("+Format.point(l)+")");if(f)a.push("rotate("+e(f)+")");s.transform=a.join(" ")}else{s.transform="matrix("+r.getValues().join(",")+")"}return s}function u(e,t,n,r){var i=n==="rect"?t[1]._point.add(t[2]._point).divide(2):n==="roundrect"?t[3]._point.add(t[4]._point).divide(2):n==="circle"||n==="ellipse"?t[1]._point:null;var s=i&&i.subtract(r).getAngle()+90;return Numerical.isZero(s||0)?0:s}function a(e,t){function n(e,n){var r=t[e],i=r.getNext(),s=t[n],o=s.getNext();return r._handleOut.isZero()&&i._handleIn.isZero()&&s._handleOut.isZero()&&o._handleIn.isZero()&&i._point.subtract(r._point).isColinear(o._point.subtract(s._point))}function i(e){var n=t[e],i=n.getNext(),s=n._handleOut,o=i._handleIn;if(s.isOrthogonal(o)){var u=n._point,a=i._point,f=(new Line(u,s)).intersect(new Line(a,o));return f&&Numerical.isZero(s.getLength()/f.subtract(u).getLength()-r)&&Numerical.isZero(o.getLength()/f.subtract(a).getLength()-r)}}var r=4*(Math.sqrt(2)-1)/3;if(e.isPolygon()){return t.length===4&&e._closed&&n(0,2)&&n(1,3)?"rect":t.length===0?"empty":t.length>=3?e._closed?"polygon":"polyline":"line"}else if(e._closed){if(t.length===8&&i(0)&&i(2)&&i(4)&&i(6)&&n(1,5)&&n(3,7)){return"roundrect"}else if(t.length===4&&i(0)&&i(1)&&i(2)&&i(3)){return Numerical.isZero(s(t,0,2)-s(t,1,3))?"circle":"ellipse"}}return"path"}function f(e){var t=o(e),n=e._children;t.fill="none";var i=r("g",t);for(var s=0,u=n.length;s<u;s++){var a=x(n[s]);if(a)i.appendChild(a)}return i}function c(e){var t=o(e,true),n=e.getSize();t.x-=n.width/2;t.y-=n.height/2;t.width=n.width;t.height=n.height;t.href=e.toDataURL();return r("image",t)}function h(e){var t=o(e,true),n=e._style;if(n._font!=null)t["font-family"]=n._font;if(n._fontSize!=null)t["font-size"]=n._fontSize;var i=r("text",t);i.textContent=e._content;return i}function p(t){var n=t._segments,o=t.getPosition(true),f=a(t,n),c=u(t,n,f,o),h;switch(f){case"empty":return null;case"path":var p=t.getPathData();h=p&&{d:p};break;case"polyline":case"polygon":var d=[];for(i=0,l=n.length;i<l;i++)d.push(Format.point(n[i]._point));h={points:d.join(" ")};break;case"rect":var v=s(n,0,3),m=s(n,0,1),g=n[1]._point.rotate(-c,o);h={x:g.x,y:g.y,width:v,height:m};break;case"roundrect":f="rect";var v=s(n,1,6),m=s(n,0,3),y=(v-s(n,0,7))/2,b=(m-s(n,1,2))/2,w=n[3]._point,E=n[4]._point,g=w.subtract(E.subtract(w).normalize(y)).rotate(-c,o);h={x:g.x,y:g.y,width:v,height:m,rx:y,ry:b};break;case"line":var S=n[0]._point,x=n[n.length-1]._point;h={x1:S._x,y1:S._y,x2:x._x,y2:x._y};break;case"circle":var T=s(n,0,2)/2;h={cx:o.x,cy:o.y,r:T};break;case"ellipse":var y=s(n,2,0)/2,b=s(n,3,1)/2;h={cx:o.x,cy:o.y,rx:y,ry:b};break}if(c){h.transform="rotate("+e(c)+","+Format.point(o)+")";t._gradientMatrix=(new Matrix).rotate(-c,o)}return r(f,h)}function d(e){var t=o(e,true);var n=e.getPathData();if(n)t.d=n;return r("path",t)}function v(t){var n=o(t,true),i=t.getSymbol(),s=w(i);definition=i.getDefinition(),bounds=definition.getBounds();if(!s){s=r("symbol",{viewBox:Format.rectangle(bounds)});s.appendChild(x(definition));E(i,s)}n.href="#"+s.id;n.x+=bounds.x;n.y+=bounds.y;n.width=e(bounds.width);n.height=e(bounds.height);return r("use",n)}function m(e,t){var n=w(e);if(!n){var i=e.gradient,s=i._type,o=t._gradientMatrix,u=e._origin.transform(o),a=e._destination.transform(o),f=e._hilite&&e._hilite.transform(o),l;if(s=="RadialGradient"){l={cx:u.x,cy:u.y,r:u.getDistance(a)};if(f){l.fx=f.x;l.fy=f.y}}else{l={x1:u.x,y1:u.y,x2:a.x,y2:a.y}}l.gradientUnits="userSpaceOnUse";n=r(s[0].toLowerCase()+s.slice(1),l);var c=i._stops;for(var h=0,p=c.length;h<p;h++){var d=c[h],v=d._color;l={offset:d._rampPoint,"stop-color":v.toCss(true)};if(v.getAlpha()<1)l["stop-opacity"]=v._alpha;n.appendChild(r("stop",l))}E(e,n)}return"url(#"+n.id+")"}function y(t,r){var i={},s=t._style,o=t.getParent(),u=o&&o._style;if(t._name!=null)i.id=t._name;Base.each(SvgStyles,function(n){var r=s[n.get]();if(!u||!Base.equals(u[n.get](),r)){if(n.type==="color"&&r!=null&&r.getAlpha()<1)i[n.attribute+"-opacity"]=r._alpha;i[n.attribute]=r==null?"none":n.type==="color"?r.gradient?m(r,t):r.toCss(true):n.type==="array"?r.join(","):n.type==="number"?e(r):r}});if(t._opacity!=null&&t._opacity<1)i.opacity=t._opacity;if(t._visibility!=null&&!t._visibility)i.visibility="hidden";delete t._gradientMatrix;return n(r,i)}function w(e){if(!b)b={ids:{},svgs:{}};return b.svgs[e._id]}function E(e,t){var n=e._type,r=b.ids[n]=(b.ids[n]||0)+1;t.id=n+"-"+r;b.svgs[e._id]=t}function S(e){if(!b)return e;var t=e.nodeName=="svg"&&e,n=t?t.firstChild:e;for(var i in b.svgs){if(!t){t=r("svg");t.appendChild(e)}t.insertBefore(b.svgs[i],n)}b=null;return t}function x(e){var t=g[e._type],n=t&&t(e,e._type);return n&&y(e,n)}var e=Format.number,t={href:"http://www.w3.org/1999/xlink"};var g={Group:f,Layer:f,Raster:c,PointText:h,PlacedSymbol:v,Path:p,CompoundPath:d};var b;Item.inject({exportSvg:function(){var e=x(this);return S(e)}});Project.inject({exportSvg:function(){var e=r("svg"),t=this.layers;for(var n=0,i=t.length;n<i;n++)e.appendChild(x(t[n]));return S(e)}})};new function(){function e(e,t,n,r){var i=(!n||e.getAttribute(t)!=null)&&e[t]&&e[t].baseVal;return i?r!==undefined?r<i.numberOfItems?Base.pick((i=i.getItem(r)).value,i):null:Base.pick(i.value,i):null}function t(t,n,r,i,s){n=e(t,n,i,s);r=e(t,r,i,s);return i&&n==null&&r==null?null:Point.create(n||0,r||0)}function n(t,n,r,i,s){n=e(t,n,i,s);r=e(t,r,i,s);return i&&n==null&&r==null?null:Size.create(n||0,r||0)}function r(e,t){return e==="none"?null:t==="number"?parseFloat(e):t==="array"?e?e.split(/[\s,]+/g).map(parseFloat):[]:t==="color"&&m(e)||e}function i(e,t){var n=e.childNodes,r=t==="clipPath",i=r?new CompoundPath:new Group,s=i._project,o=s._currentStyle;i.setFillColor("black");if(!r){i=d(i,e);s._currentStyle=i._style.clone()}for(var u=0,a=n.length;u<a;u++){var f=n[u],l;if(f.nodeType==1&&(l=g(f))){if(r&&l instanceof CompoundPath){i.addChildren(l.removeChildren());l.remove()}else if(!(l instanceof Symbol)){i.addChild(l)}}}if(r)i=d(i.reduce(),e);s._currentStyle=o;if(r||t==="defs"){i.remove();i=null}return i}function s(e,t){var n=new Path,r=e.points;n.moveTo(r.getItem(0));for(var i=1,s=r.numberOfItems;i<s;i++)n.lineTo(r.getItem(i));if(t==="polygon")n.closePath();return n}function o(e){var t=e.getAttribute("d"),n=t.match(/m/gi).length>1?new CompoundPath:new Path;n.setPathData(t);return n}function u(n,r){var i=n.childNodes,s=[];for(var o=0,u=i.length;o<u;o++){var a=i[o];if(a.nodeType==1)s.push(d(new GradientStop,a))}var f=r==="radialGradient",l=new(f?RadialGradient:LinearGradient)(s),c,h,p;if(f){c=t(n,"cx","cy");h=c.add(e(n,"r"),0);p=t(n,"fx","fy",true)}else{c=t(n,"x1","y1");h=t(n,"x2","y2")}d(new GradientColor(l,c,h,p),n);return null}function f(e,t,n,r){var i=r[n].baseVal,s=new Matrix;for(var o=0,u=i.numberOfItems;o<u;o++){var a=i.getItem(o).matrix;s.concatenate(new Matrix(a.a,a.b,a.c,a.d,a.e,a.f))}e.transform(s)}function l(e,t,n){var r=e._style[n==="fill-opacity"?"getFillColor":"getStrokeColor"]();if(r)r.setAlpha(parseFloat(t))}function c(e,t){if(e instanceof TextItem){t(e)}else if(e instanceof Group){var n=e._children;for(var r=0,i=n.length;r<i;r++)t(n[r])}}function p(e,t,n){var r=e.attributes[t],i=r&&r.value;if(!i){var s=Base.camelize(t);i=e.style[s];if(!i&&n.node[s]!==n.parent[s])i=n.node[s]}return!i?undefined:i==="none"?null:i}function d(e,t){var n={node:DomElement.getStyles(t)||{},parent:DomElement.getStyles(t.parentNode)||{}};Base.each(h,function(r,i){var s=p(t,i,n);if(s!==undefined)e=Base.pick(r(e,s,i,t,n),e)});return e}function m(e){var t=e&&e.match(/\((?:#|)([^)']+)/);return t&&v[t[1]]}function g(e,t){var n=e.nodeName,r=a[n],i=r&&r(e,n);if(i&&i._type!=="Group")i=d(i,e);if(t)v={};return i}var a={g:i,svg:i,clipPath:i,polygon:s,polyline:s,path:o,linearGradient:u,radialGradient:u,image:function(r){var i=new Raster(e(r,"href"));i.attach("load",function(){var e=n(r,"width","height");this.setSize(e);this.translate(t(r,"x","y").add(e.divide(2)))});return i},symbol:function(e,t){return new Symbol(i(e,t),true)},defs:i,use:function(n,r){var i=(e(n,"href")||"").substring(1),s=v[i],o=t(n,"x","y");return s?s instanceof Symbol?s.place(o):s.clone().translate(o):null},circle:function(n){return new Path.Circle(t(n,"cx","cy"),e(n,"r"))},ellipse:function(e){var r=t(e,"cx","cy"),i=n(e,"rx","ry");return new Path.Ellipse(new Rectangle(r.subtract(i),r.add(i)))},rect:function(e){var r=t(e,"x","y"),i=n(e,"width","height"),s=n(e,"rx","ry");return new Path.RoundRectangle(new Rectangle(r,i),s)},line:function(e){return new Path.Line(t(e,"x1","y1"),t(e,"x2","y2"))},text:function(e){var n=new PointText(t(e,"x","y",false,0).add(t(e,"dx","dy",false,0)));n.setContent(e.textContent.trim()||"");return n}};var h=Base.each(SvgStyles,function(e){this[e.attribute]=function(t,n,i,s){t._style[e.set](r(n,e.type))}},{id:function(e,t){v[t]=e;if(e.setName)e.setName(t)},"clip-path":function(e,t){var n=m(t);if(n){n=n.clone();n.setClipMask(true);return new Group(n,e)}},gradientTransform:f,transform:f,opacity:function(e,t){e.setOpacity(parseFloat(t))},"fill-opacity":l,"stroke-opacity":l,"font-family":function(e,t){c(e,function(e){e.setFont(t.split(",")[0].replace(/^\s+|\s+$/g,""))})},"font-size":function(e,t){c(e,function(e){e.setFontSize(parseFloat(t))})},"text-anchor":function(e,t){c(e,function(e){e.setJustification({start:"left",middle:"center",end:"right"}[t])})},visibility:function(e,t){e.setVisible(t==="visible")},"stop-color":function(e,t){e.setColor(t)},"stop-opacity":function(e,t){if(e._color)e._color.setAlpha(parseFloat(t))},offset:function(e,t){var n=t.match(/(.*)%$/);e.setRampPoint(n?n[1]/100:t)},viewBox:function(e,t,i,s,o){var u=Rectangle.create.apply(this,r(t,"array")),a=n(s,"width","height",true);if(e instanceof Group){var f=a?u.getSize().divide(a):1,l=(new Matrix).translate(u.getPoint()).scale(f);e.transform(l.inverted())}else if(e instanceof Symbol){if(a)u.setSize(a);var c=p(s,"overflow",o)!="visible",h=e._definition;if(c&&!u.contains(h.getBounds())){c=(new Path.Rectangle(u)).transform(h._matrix);c.setClipMask(true);h.addChild(c)}}}});var v={};Item.inject({importSvg:function(e){return this.addChild(g(e,true))}});Project.inject({importSvg:function(e){this.activate();return g(e,true)}})};(function(e){"use strict";function t(e){pt=e||{};for(var t in gt)pt.hasOwnProperty(t)||(pt[t]=gt[t]);mt=pt.sourceFile||null}function n(e,t){var n=yt(dt,e);t+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=bt,r}function r(e){function t(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var t=0;e.length>t;++t)n+="case "+JSON.stringify(e[t])+":";n+="return true}return false;"}e=e.split(" ");var n="",r=[];e:for(var i=0;e.length>i;++i){for(var s=0;r.length>s;++s)if(r[s][0].length==e[i].length){r[s].push(e[i]);continue e}r.push([e[i]])}if(r.length>3){r.sort(function(e,t){return t.length-e.length}),n+="switch(str.length){";for(var i=0;r.length>i;++i){var o=r[i];n+="case "+o[0].length+":",t(o)}n+="}"}else t(e);return Function("str",n)}function i(e){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Kn.test(String.fromCharCode(e))}function s(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Qn.test(String.fromCharCode(e))}function o(){this.line=kt,this.column=bt-Lt}function u(){kt=1,bt=Lt=0,Ct=!0,c()}function a(e,t){Et=bt,pt.locations&&(xt=new o),Tt=e,c(),Nt=t,Ct=e.beforeExpr}function f(){var e=pt.onComment&&pt.locations&&new o,t=bt,r=dt.indexOf("*/",bt+=2);if(-1===r&&n(bt-2,"Unterminated comment"),bt=r+2,pt.locations){Yn.lastIndex=t;for(var i;(i=Yn.exec(dt))&&bt>i.index;)++kt,Lt=i.index+i[0].length}pt.onComment&&pt.onComment(!0,dt.slice(t+2,r),t,bt,e,pt.locations&&new o)}function l(){for(var e=bt,t=pt.onComment&&pt.locations&&new o,n=dt.charCodeAt(bt+=2);vt>bt&&10!==n&&13!==n&&8232!==n&&8329!==n;)++bt,n=dt.charCodeAt(bt);pt.onComment&&pt.onComment(!1,dt.slice(e+2,bt),e,bt,t,pt.locations&&new o)}function c(){for(;vt>bt;){var e=dt.charCodeAt(bt);if(32===e)++bt;else if(13===e){++bt;var t=dt.charCodeAt(bt);10===t&&++bt,pt.locations&&(++kt,Lt=bt)}else if(10===e)++bt,++kt,Lt=bt;else if(14>e&&e>8)++bt;else if(47===e){var t=dt.charCodeAt(bt+1);if(42===t)f();else{if(47!==t)break;l()}}else if(14>e&&e>8||32===e||160===e)++bt;else{if(!(e>=5760&&Vn.test(String.fromCharCode(e))))break;++bt}}}function h(){var e=dt.charCodeAt(bt+1);return e>=48&&57>=e?C(!0):(++bt,a(Sn))}function p(){var e=dt.charCodeAt(bt+1);return Ct?(++bt,x()):61===e?S(Cn,2):S(Tn,1)}function d(){var e=dt.charCodeAt(bt+1);return 61===e?S(Cn,2):S(Fn,1)}function v(e){var t=dt.charCodeAt(bt+1);return t===e?S(124===e?On:Mn,2):61===t?S(Cn,2):S(124===e?_n:Pn,1)}function m(){var e=dt.charCodeAt(bt+1);return 61===e?S(Cn,2):S(Dn,1)}function g(e){var t=dt.charCodeAt(bt+1);return t===e?S(Ln,2):61===t?S(Cn,2):S(kn,1)}function y(e){var t=dt.charCodeAt(bt+1),n=1;return t===e?(n=62===e&&62===dt.charCodeAt(bt+2)?3:2,61===dt.charCodeAt(bt+n)?S(Cn,n+1):S(jn,n)):(61===t&&(n=61===dt.charCodeAt(bt+2)?3:2),S(Bn,n))}function b(e){var t=dt.charCodeAt(bt+1);return 61===t?S(Hn,61===dt.charCodeAt(bt+2)?3:2):S(61===e?Nn:An,1)}function w(e){switch(e){case 46:return h();case 40:return++bt,a(gn);case 41:return++bt,a(yn);case 59:return++bt,a(wn);case 44:return++bt,a(bn);case 91:return++bt,a(pn);case 93:return++bt,a(dn);case 123:return++bt,a(vn);case 125:return++bt,a(mn);case 58:return++bt,a(En);case 63:return++bt,a(xn);case 48:var t=dt.charCodeAt(bt+1);if(120===t||88===t)return N();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return C(!1);case 34:case 39:return k(e);case 47:return p(e);case 37:case 42:return d();case 124:case 38:return v(e);case 94:return m();case 43:case 45:return g(e);case 60:case 62:return y(e);case 61:case 33:return b(e);case 126:return S(An,1)}return!1}function E(e){if(wt=bt,pt.locations&&(St=new o),e)return x();if(bt>=vt)return a(It);var t=dt.charCodeAt(bt);if(i(t)||92===t)return O();var r=w(t);if(r===!1){var s=String.fromCharCode(t);if("\\"===s||Kn.test(s))return O();n(bt,"Unexpected character '"+s+"'")}return r}function S(e,t){var n=dt.slice(bt,bt+t);bt+=t,a(e,n)}function x(){for(var e,t,r="",i=bt;;){bt>=vt&&n(i,"Unterminated regular expression");var s=dt.charAt(bt);if(Gn.test(s)&&n(i,"Unterminated regular expression"),e)e=!1;else{if("["===s)t=!0;else if("]"===s&&t)t=!1;else if("/"===s&&!t)break;e="\\"===s}++bt}var r=dt.slice(i,bt);++bt;var o=A();return o&&!/^[gmsiy]*$/.test(o)&&n(i,"Invalid regexp flag"),a(Bt,RegExp(r,o))}function T(e,t){for(var n=bt,r=0,i=0,s=null==t?1/0:t;s>i;++i){var o,u=dt.charCodeAt(bt);if(o=u>=97?u-97+10:u>=65?u-65+10:u>=48&&57>=u?u-48:1/0,o>=e)break;++bt,r=r*e+o}return bt===n||null!=t&&bt-n!==t?null:r}function N(){bt+=2;var e=T(16);return null==e&&n(wt+2,"Expected hexadecimal number"),i(dt.charCodeAt(bt))&&n(bt,"Identifier directly after number"),a(Ht,e)}function C(e){var t=bt,r=!1,s=48===dt.charCodeAt(bt);e||null!==T(10)||n(t,"Invalid number"),46===dt.charCodeAt(bt)&&(++bt,T(10),r=!0);var o=dt.charCodeAt(bt);(69===o||101===o)&&(o=dt.charCodeAt(++bt),(43===o||45===o)&&++bt,null===T(10)&&n(t,"Invalid number"),r=!0),i(dt.charCodeAt(bt))&&n(bt,"Identifier directly after number");var u,f=dt.slice(t,bt);return r?u=parseFloat(f):s&&1!==f.length?/[89]/.test(f)||Pt?n(t,"Invalid number"):u=parseInt(f,8):u=parseInt(f,10),a(Ht,u)}function k(e){bt++;for(var t="";;){bt>=vt&&n(wt,"Unterminated string constant");var r=dt.charCodeAt(bt);if(r===e)return++bt,a(jt,t);if(92===r){r=dt.charCodeAt(++bt);var i=/^[0-7]+/.exec(dt.slice(bt,bt+3));for(i&&(i=i[0]);i&&parseInt(i,8)>255;)i=i.slice(0,i.length-1);if("0"===i&&(i=null),++bt,i)Pt&&n(bt-2,"Octal literal in strict mode"),t+=String.fromCharCode(parseInt(i,8)),bt+=i.length-1;else switch(r){case 110:t+="\n";break;case 114:t+="\r";break;case 120:t+=String.fromCharCode(L(2));break;case 117:t+=String.fromCharCode(L(4));break;case 85:t+=String.fromCharCode(L(8));break;case 116:t+="	";break;case 98:t+="\b";break;case 118:t+="";break;case 102:t+="\f";break;case 48:t+="\0";break;case 13:10===dt.charCodeAt(bt)&&++bt;case 10:pt.locations&&(Lt=bt,++kt);break;default:t+=String.fromCharCode(r)}}else(13===r||10===r||8232===r||8329===r)&&n(wt,"Unterminated string constant"),t+=String.fromCharCode(r),++bt}}function L(e){var t=T(16,e);return null===t&&n(wt,"Bad character escape sequence"),t}function A(){qn=!1;for(var e,t=!0,r=bt;;){var o=dt.charCodeAt(bt);if(s(o))qn&&(e+=dt.charAt(bt)),++bt;else{if(92!==o)break;qn||(e=dt.slice(r,bt)),qn=!0,117!=dt.charCodeAt(++bt)&&n(bt,"Expecting Unicode escape sequence \\uXXXX"),++bt;var u=L(4),a=String.fromCharCode(u);a||n(bt-1,"Invalid Unicode escape"),(t?i(u):s(u))||n(bt-4,"Invalid Unicode escape"),e+=a}t=!1}return qn?e:dt.slice(r,bt)}function O(){var e=A(),t=Ft;return qn||(Xn(e)?t=hn[e]:(pt.forbidReserved&&(3===pt.ecmaVersion?Rn:Un)(e)||Pt&&zn(e))&&n(wt,"The keyword '"+e+"' is reserved")),a(t,e)}function M(){At=wt,Ot=Et,Mt=xt,E()}function _(e){Pt=e,bt=Ot,c(),E()}function D(){this.type=null,this.start=wt,this.end=null}function P(){this.start=St,this.end=null,null!==mt&&(this.source=mt)}function H(){var e=new D;return pt.locations&&(e.loc=new P),pt.ranges&&(e.range=[wt,0]),e}function B(e){var t=new D;return t.start=e.start,pt.locations&&(t.loc=new P,t.loc.start=e.loc.start),pt.ranges&&(t.range=[e.range[0],0]),t}function j(e,t){return e.type=t,e.end=Ot,pt.locations&&(e.loc.end=Mt),pt.ranges&&(e.range[1]=Ot),e}function F(e){return pt.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function I(e){return Tt===e?(M(),!0):void 0}function q(){return!pt.strictSemicolons&&(Tt===It||Tt===mn||Gn.test(dt.slice(Ot,wt)))}function R(){I(wn)||q()||z()}function U(e){Tt===e?M():z()}function z(){n(wt,"Unexpected token")}function W(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&n(e.start,"Assigning to rvalue"),Pt&&"Identifier"===e.type&&Wn(e.name)&&n(e.start,"Assigning to "+e.name+" in strict mode")}function X(e){At=Ot=bt,pt.locations&&(Mt=new o),_t=Pt=null,Dt=[],E();var t=e||H(),n=!0;for(e||(t.body=[]);Tt!==It;){var r=V();t.body.push(r),n&&F(r)&&_(!0),n=!1}return j(t,"Program")}function V(){Tt===Tn&&E(!0);var e=Tt,t=H();switch(e){case qt:case zt:M();var r=e===qt;I(wn)||q()?t.label=null:Tt!==Ft?z():(t.label=ht(),R());for(var i=0;Dt.length>i;++i){var s=Dt[i];if(null==t.label||s.name===t.label.name){if(null!=s.kind&&(r||"loop"===s.kind))break;if(t.label&&r)break}}return i===Dt.length&&n(t.start,"Unsyntactic "+e.keyword),j(t,r?"BreakStatement":"ContinueStatement");case Wt:return M(),R(),j(t,"DebuggerStatement");case Vt:return M(),Dt.push(Zn),t.body=V(),Dt.pop(),U(rn),t.test=$(),R(),j(t,"DoWhileStatement");case Kt:if(M(),Dt.push(Zn),U(gn),Tt===wn)return K(t,null);if(Tt===nn){var o=H();return M(),G(o,!0),1===o.declarations.length&&I(cn)?Q(t,o):K(t,o)}var o=Y(!1,!0);return I(cn)?(W(o),Q(t,o)):K(t,o);case Qt:return M(),lt(t,!0);case Gt:return M(),t.test=$(),t.consequent=V(),t.alternate=I($t)?V():null,j(t,"IfStatement");case Yt:return _t||n(wt,"'return' outside of function"),M(),I(wn)||q()?t.argument=null:(t.argument=Y(),R()),j(t,"ReturnStatement");case Zt:M(),t.discriminant=$(),t.cases=[],U(vn),Dt.push(er);for(var u,a;Tt!=mn;)if(Tt===Rt||Tt===Xt){var f=Tt===Rt;u&&j(u,"SwitchCase"),t.cases.push(u=H()),u.consequent=[],M(),f?u.test=Y():(a&&n(At,"Multiple default clauses"),a=!0,u.test=null),U(En)}else u||z(),u.consequent.push(V());return u&&j(u,"SwitchCase"),M(),Dt.pop(),j(t,"SwitchStatement");case en:return M(),Gn.test(dt.slice(Ot,wt))&&n(Ot,"Illegal newline after throw"),t.argument=Y(),R(),j(t,"ThrowStatement");case tn:for(M(),t.block=J(),t.handlers=[];Tt===Ut;){var l=H();M(),U(gn),l.param=ht(),Pt&&Wn(l.param.name)&&n(l.param.start,"Binding "+l.param.name+" in strict mode"),U(yn),l.guard=null,l.body=J(),t.handlers.push(j(l,"CatchClause"))}return t.finalizer=I(Jt)?J():null,t.handlers.length||t.finalizer||n(t.start,"Missing catch or finally clause"),j(t,"TryStatement");case nn:return M(),t=G(t),R(),t;case rn:return M(),t.test=$(),Dt.push(Zn),t.body=V(),Dt.pop(),j(t,"WhileStatement");case sn:return Pt&&n(wt,"'with' in strict mode"),M(),t.object=$(),t.body=V(),j(t,"WithStatement");case vn:return J();case wn:return M(),j(t,"EmptyStatement");default:var c=Nt,h=Y();if(e===Ft&&"Identifier"===h.type&&I(En)){for(var i=0;Dt.length>i;++i)Dt[i].name===c&&n(h.start,"Label '"+c+"' is already declared");var p=Tt.isLoop?"loop":Tt===Zt?"switch":null;return Dt.push({name:c,kind:p}),t.body=V(),Dt.pop(),t.label=h,j(t,"LabeledStatement")}return t.expression=h,R(),j(t,"ExpressionStatement")}}function $(){U(gn);var e=Y();return U(yn),e}function J(){var e,t=H(),n=!0,r=!1;for(t.body=[],U(vn);!I(mn);){var i=V();t.body.push(i),n&&F(i)&&(e=r,_(r=!0)),n=!1}return r&&!e&&_(!1),j(t,"BlockStatement")}function K(e,t){return e.init=t,U(wn),e.test=Tt===wn?null:Y(),U(wn),e.update=Tt===yn?null:Y(),U(yn),e.body=V(),Dt.pop(),j(e,"ForStatement")}function Q(e,t){return e.left=t,e.right=Y(),U(yn),e.body=V(),Dt.pop(),j(e,"ForInStatement")}function G(e,t){for(e.declarations=[],e.kind="var";;){var r=H();if(r.id=ht(),Pt&&Wn(r.id.name)&&n(r.id.start,"Binding "+r.id.name+" in strict mode"),r.init=I(Nn)?Y(!0,t):null,e.declarations.push(j(r,"VariableDeclarator")),!I(bn))break}return j(e,"VariableDeclaration")}function Y(e,t){var n=Z(t);if(!e&&Tt===bn){var r=B(n);for(r.expressions=[n];I(bn);)r.expressions.push(Z(t));return j(r,"SequenceExpression")}return n}function Z(e){var t=et(e);if(Tt.isAssign){var n=B(t);return n.operator=Nt,n.left=t,M(),n.right=Z(e),W(t),j(n,"AssignmentExpression")}return t}function et(e){var t=tt(e);if(I(xn)){var n=B(t);return n.test=t,n.consequent=Y(!0),U(En),n.alternate=Y(!0,e),j(n,"ConditionalExpression")}return t}function tt(e){return nt(rt(e),-1,e)}function nt(e,t,n){var r=Tt.binop;if(null!=r&&(!n||Tt!==cn)&&r>t){var i=B(e);i.left=e,i.operator=Nt,M(),i.right=nt(rt(n),r,n);var i=j(i,/&&|\|\|/.test(i.operator)?"LogicalExpression":"BinaryExpression");return nt(i,t,n)}return e}function rt(e){if(Tt.prefix){var t=H(),r=Tt.isUpdate;return t.operator=Nt,t.prefix=!0,M(),t.argument=rt(e),r?W(t.argument):Pt&&"delete"===t.operator&&"Identifier"===t.argument.type&&n(t.start,"Deleting local variable in strict mode"),j(t,r?"UpdateExpression":"UnaryExpression")}for(var i=it();Tt.postfix&&!q();){var t=B(i);t.operator=Nt,t.prefix=!1,t.argument=i,W(i),M(),i=j(t,"UpdateExpression")}return i}function it(){return st(ot())}function st(e,t){if(I(Sn)){var n=B(e);return n.object=e,n.property=ht(!0),n.computed=!1,st(j(n,"MemberExpression"),t)}if(I(pn)){var n=B(e);return n.object=e,n.property=Y(),n.computed=!0,U(dn),st(j(n,"MemberExpression"),t)}if(!t&&I(gn)){var n=B(e);return n.callee=e,n.arguments=ct(yn,!1),st(j(n,"CallExpression"),t)}return e}function ot(){switch(Tt){case un:var e=H();return M(),j(e,"ThisExpression");case Ft:return ht();case Ht:case jt:case Bt:var e=H();return e.value=Nt,e.raw=dt.slice(wt,Et),M(),j(e,"Literal");case an:case fn:case ln:var e=H();return e.value=Tt.atomValue,e.raw=Tt.keyword,M(),j(e,"Literal");case gn:var t=St,n=wt;M();var r=Y();return r.start=n,r.end=Et,pt.locations&&(r.loc.start=t,r.loc.end=xt),pt.ranges&&(r.range=[n,Et]),U(yn),r;case pn:var e=H();return M(),e.elements=ct(dn,!0,!0),j(e,"ArrayExpression");case vn:return at();case Qt:var e=H();return M(),lt(e,!1);case on:return ut();default:z()}}function ut(){var e=H();return M(),e.callee=st(ot(),!0),e.arguments=I(gn)?ct(yn,!1):[],j(e,"NewExpression")}function at(){var e=H(),t=!0,r=!1;for(e.properties=[],M();!I(mn);){if(t)t=!1;else if(U(bn),pt.allowTrailingCommas&&I(mn))break;var i,s={key:ft()},o=!1;if(I(En)?(s.value=Y(!0),i=s.kind="init"):pt.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(o=r=!0,i=s.kind=s.key.name,s.key=ft(),Tt!==gn&&z(),s.value=lt(H(),!1)):z(),"Identifier"===s.key.type&&(Pt||r))for(var u=0;e.properties.length>u;++u){var a=e.properties[u];if(a.key.name===s.key.name){var f=i==a.kind||o&&"init"===a.kind||"init"===i&&("get"===a.kind||"set"===a.kind);f&&!Pt&&"init"===i&&"init"===a.kind&&(f=!1),f&&n(s.key.start,"Redefinition of property")}}e.properties.push(s)}return j(e,"ObjectExpression")}function ft(){return Tt===Ht||Tt===jt?ot():ht(!0)}function lt(e,t){Tt===Ft?e.id=ht():t?z():e.id=null,e.params=[];var r=!0;for(U(gn);!I(yn);)r?r=!1:U(bn),e.params.push(ht());var i=_t,s=Dt;if(_t=!0,Dt=[],e.body=J(!0),_t=i,Dt=s,Pt||e.body.body.length&&F(e.body.body[0]))for(var o=e.id?-1:0;e.params.length>o;++o){var u=0>o?e.id:e.params[o];if((zn(u.name)||Wn(u.name))&&n(u.start,"Defining '"+u.name+"' in strict mode"),o>=0)for(var a=0;o>a;++a)u.name===e.params[a].name&&n(u.start,"Argument name clash in strict mode")}return j(e,t?"FunctionDeclaration":"FunctionExpression")}function ct(e,t,n){for(var r=[],i=!0;!I(e);){if(i)i=!1;else if(U(bn),t&&pt.allowTrailingCommas&&I(e))break;n&&Tt===bn?r.push(null):r.push(Y(!0))}return r}function ht(e){var t=H();return t.name=Tt===Ft?Nt:e&&!pt.forbidReserved&&Tt.keyword||z(),M(),j(t,"Identifier")}e.version="0.1.01";var pt,dt,vt,mt;e.parse=function(e,n){return dt=e+"",vt=dt.length,t(n),u(),X(pt.program)};var gt=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},yt=e.getLineInfo=function(e,t){for(var n=1,r=0;;){Yn.lastIndex=r;var i=Yn.exec(e);if(!(i&&t>i.index))break;++n,r=i.index+i[0].length}return{line:n,column:t-r}};e.tokenize=function(e,n){function r(e){return E(e),i.start=wt,i.end=Et,i.startLoc=St,i.endLoc=xt,i.type=Tt,i.value=Nt,i}dt=e+"",vt=dt.length,t(n),u();var i={};return r.jumpTo=function(e,t){if(bt=e,pt.locations){kt=Lt=Yn.lastIndex=0;for(var n;(n=Yn.exec(dt))&&e>n.index;)++kt,Lt=n.index+n[0].length}dt.charAt(e-1),Ct=t,c()},r};var bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht={type:"num"},Bt={type:"regexp"},jt={type:"string"},Ft={type:"name"},It={type:"eof"},qt={keyword:"break"},Rt={keyword:"case",beforeExpr:!0},Ut={keyword:"catch"},zt={keyword:"continue"},Wt={keyword:"debugger"},Xt={keyword:"default"},Vt={keyword:"do",isLoop:!0},$t={keyword:"else",beforeExpr:!0},Jt={keyword:"finally"},Kt={keyword:"for",isLoop:!0},Qt={keyword:"function"},Gt={keyword:"if"},Yt={keyword:"return",beforeExpr:!0},Zt={keyword:"switch"},en={keyword:"throw",beforeExpr:!0},tn={keyword:"try"},nn={keyword:"var"},rn={keyword:"while",isLoop:!0},sn={keyword:"with"},on={keyword:"new",beforeExpr:!0},un={keyword:"this"},an={keyword:"null",atomValue:null},fn={keyword:"true",atomValue:!0},ln={keyword:"false",atomValue:!1},cn={keyword:"in",binop:7,beforeExpr:!0},hn={"break":qt,"case":Rt,"catch":Ut,"continue":zt,"debugger":Wt,"default":Xt,"do":Vt,"else":$t,"finally":Jt,"for":Kt,"function":Qt,"if":Gt,"return":Yt,"switch":Zt,"throw":en,"try":tn,"var":nn,"while":rn,"with":sn,"null":an,"true":fn,"false":ln,"new":on,"in":cn,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":un,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},pn={type:"[",beforeExpr:!0},dn={type:"]"},vn={type:"{",beforeExpr:!0},mn={type:"}"},gn={type:"(",beforeExpr:!0},yn={type:")"},bn={type:",",beforeExpr:!0},wn={type:";",beforeExpr:!0},En={type:":",beforeExpr:!0},Sn={type:"."},xn={type:"?",beforeExpr:!0},Tn={binop:10,beforeExpr:!0},Nn={isAssign:!0,beforeExpr:!0},Cn={isAssign:!0,beforeExpr:!0},kn={binop:9,prefix:!0,beforeExpr:!0},Ln={postfix:!0,prefix:!0,isUpdate:!0},An={prefix:!0,beforeExpr:!0},On={binop:1,beforeExpr:!0},Mn={binop:2,beforeExpr:!0},_n={binop:3,beforeExpr:!0},Dn={binop:4,beforeExpr:!0},Pn={binop:5,beforeExpr:!0},Hn={binop:6,beforeExpr:!0},Bn={binop:7,beforeExpr:!0},jn={binop:8,beforeExpr:!0},Fn={binop:10,beforeExpr:!0};e.tokTypes={bracketL:pn,bracketR:dn,braceL:vn,braceR:mn,parenL:gn,parenR:yn,comma:bn,semi:wn,colon:En,dot:Sn,question:xn,slash:Tn,eq:Nn,name:Ft,eof:It,num:Ht,regexp:Bt,string:jt};for(var In in hn)e.tokTypes[In]=hn[In];var qn,Rn=r("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Un=r("class enum extends super const export import"),zn=r("implements interface let package private protected public static yield"),Wn=r("eval arguments"),Xn=r("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Vn=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,$n="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Jn="ͱ-ʹ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Kn=RegExp("["+$n+"]"),Qn=RegExp("["+$n+Jn+"]"),Gn=/[\n\r\u2028\u2029]/,Yn=/\r\n|[\n\r\u2028\u2029]/g,Zn={kind:"loop"},er={kind:"switch"}})("undefined"==typeof exports?self.acorn={}:exports);var PaperScript=this.PaperScript=new function(){function _$_(e,t,n){var r=binaryOperators[t];if(e&&e[r]){var i=e[r](n);return t==="!="?!i:i}switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"%":return e%n;case"==":return e==n;case"!=":return e!=n}}function $_(e,t){var n=unaryOperators[e];if(n&&t&&t[n])return t[n]();switch(e){case"+":return+t;case"-":return-t}}function compile(e){function n(e){var n=e;for(var r=0,i=t.length;r<i;r++){var s=t[r];if(s[0]>=e)break;e+=s[1]}return e}function r(t){return e.substring(n(t.range[0]),n(t.range[1]))}function i(r,i){var s=n(r.range[0]),o=n(r.range[1]);var u=0;for(var a=t.length-1;a>=0;a--){if(s>t[a][0]){u=a+1;break}}t.splice(u,0,[s,i.length-o+s]);e=e.substring(0,s)+i+e.substring(o)}function s(e){for(var t in e){if(t==="range")continue;var n=e[t];if(Array.isArray(n)){for(var o=0,u=n.length;o<u;o++)s(n[o])}else if(n&&typeof n==="object"){s(n)}}switch(e&&e.type){case"BinaryExpression":if(e.operator in binaryOperators&&e.left.type!=="Literal"){var a=r(e.left),f=r(e.right);i(e,"_$_("+a+', "'+e.operator+'", '+f+")")}break;case"AssignmentExpression":if(/^.=$/.test(e.operator)&&e.left.type!=="Literal"){var a=r(e.left),f=r(e.right);i(e,a+" = _$_("+a+', "'+e.operator[0]+'", '+f+")")}break;case"UpdateExpression":if(!e.prefix){var l=r(e.argument);i(e,l+" = _$_("+l+', "'+e.operator[0]+'", 1)')}break;case"UnaryExpression":if(e.operator in unaryOperators&&e.argument.type!=="Literal"){var l=r(e.argument);i(e,'$_("'+e.operator+'", '+l+")")}break}}var t=[];s(acorn.parse(e,{ranges:true}));return e}function evaluate(code,scope){paper=scope;var view=scope.project&&scope.project.view,res;with(scope){(function(){var onActivate,onDeactivate,onEditOptions,onMouseDown,onMouseUp,onMouseDrag,onMouseMove,onKeyDown,onKeyUp,onFrame,onResize;res=eval(compile(code));if(/on(?:Key|Mouse)(?:Up|Down|Move|Drag)/.test(code)){Base.each(Tool.prototype._events,function(key){var value=eval(key);if(value){scope.getTool()[key]=value}})}if(view){view.setOnResize(onResize);view.fire("resize",{size:view.size,delta:new Point});view.setOnFrame(onFrame);view.draw()}}).call(scope)}return res}function request(e,t){var n=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");n.open("GET",e,true);if(n.overrideMimeType)n.overrideMimeType("text/plain");n.onreadystatechange=function(){if(n.readyState===4){return evaluate(n.responseText,t)}};return n.send(null)}function load(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;t++){var r=e[t];if(/^text\/(?:x-|)paperscript$/.test(r.type)&&!r.getAttribute("data-paper-ignore")){var i=PaperScript.getAttribute(r,"canvas"),s=PaperScope.get(i)||(new PaperScope(r)).setup(i);if(r.src){request(r.src,s)}else{evaluate(r.innerHTML,s)}r.setAttribute("data-paper-ignore",true)}}}function handleAttribute(e){e+="Attribute";return function(t,n){return t[e](n)||t[e]("data-paper-"+n)}}var binaryOperators={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"modulo","==":"equals","!=":"equals"};var unaryOperators={"-":"negate","+":null};if(document.readyState==="complete"){setTimeout(load)}else{DomEvent.add(window,{load:load})}return{compile:compile,evaluate:evaluate,load:load,getAttribute:handleAttribute("get"),hasAttribute:handleAttribute("has")}};this.enumerable=true;return new(PaperScope.inject(this))}